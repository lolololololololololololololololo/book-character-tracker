var Iu=Object.defineProperty;var Jl=or=>{throw TypeError(or)};var Fu=(or,ar,lr)=>ar in or?Iu(or,ar,{enumerable:!0,configurable:!0,writable:!0,value:lr}):or[ar]=lr;var Zs=(or,ar,lr)=>Fu(or,typeof ar!="symbol"?ar+"":ar,lr),Yo=(or,ar,lr)=>ar.has(or)||Jl("Cannot "+lr);var Gr=(or,ar,lr)=>(Yo(or,ar,"read from private field"),lr?lr.call(or):ar.get(or)),Ts=(or,ar,lr)=>ar.has(or)?Jl("Cannot add the same private member more than once"):ar instanceof WeakSet?ar.add(or):ar.set(or,lr),_s=(or,ar,lr,ur)=>(Yo(or,ar,"write to private field"),ur?ur.call(or,lr):ar.set(or,lr),lr),ws=(or,ar,lr)=>(Yo(or,ar,"access private method"),lr);var So=(or,ar,lr,ur)=>({set _(cr){_s(or,ar,cr,lr)},get _(){return Gr(or,ar,ur)}});(function(){const ar=document.createElement("link").relList;if(ar&&ar.supports&&ar.supports("modulepreload"))return;for(const cr of document.querySelectorAll('link[rel="modulepreload"]'))ur(cr);new MutationObserver(cr=>{for(const hr of cr)if(hr.type==="childList")for(const dr of hr.addedNodes)dr.tagName==="LINK"&&dr.rel==="modulepreload"&&ur(dr)}).observe(document,{childList:!0,subtree:!0});function lr(cr){const hr={};return cr.integrity&&(hr.integrity=cr.integrity),cr.referrerPolicy&&(hr.referrerPolicy=cr.referrerPolicy),cr.crossOrigin==="use-credentials"?hr.credentials="include":cr.crossOrigin==="anonymous"?hr.credentials="omit":hr.credentials="same-origin",hr}function ur(cr){if(cr.ep)return;cr.ep=!0;const hr=lr(cr);fetch(cr.href,hr)}})();var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$1(or){return or&&or.__esModule&&Object.prototype.hasOwnProperty.call(or,"default")?or.default:or}function getAugmentedNamespace(or){if(or.__esModule)return or;var ar=or.default;if(typeof ar=="function"){var lr=function ur(){return this instanceof ur?Reflect.construct(ar,arguments,this.constructor):ar.apply(this,arguments)};lr.prototype=ar.prototype}else lr={};return Object.defineProperty(lr,"__esModule",{value:!0}),Object.keys(or).forEach(function(ur){var cr=Object.getOwnPropertyDescriptor(or,ur);Object.defineProperty(lr,ur,cr.get?cr:{enumerable:!0,get:function(){return or[ur]}})}),lr}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$2=Symbol.for("react.element"),n$2=Symbol.for("react.portal"),p$4=Symbol.for("react.fragment"),q$2=Symbol.for("react.strict_mode"),r$1=Symbol.for("react.profiler"),t$1=Symbol.for("react.provider"),u$1=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x$2=Symbol.for("react.memo"),y$2=Symbol.for("react.lazy"),z$2=Symbol.iterator;function A$2(or){return or===null||typeof or!="object"?null:(or=z$2&&or[z$2]||or["@@iterator"],typeof or=="function"?or:null)}var B$2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$2=Object.assign,D$2={};function E$2(or,ar,lr){this.props=or,this.context=ar,this.refs=D$2,this.updater=lr||B$2}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(or,ar){if(typeof or!="object"&&typeof or!="function"&&or!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,or,ar,"setState")};E$2.prototype.forceUpdate=function(or){this.updater.enqueueForceUpdate(this,or,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$2(or,ar,lr){this.props=or,this.context=ar,this.refs=D$2,this.updater=lr||B$2}var H$2=G$2.prototype=new F$1;H$2.constructor=G$2;C$2(H$2,E$2.prototype);H$2.isPureReactComponent=!0;var I$2=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$3={current:null},L$2={key:!0,ref:!0,__self:!0,__source:!0};function M$2(or,ar,lr){var ur,cr={},hr=null,dr=null;if(ar!=null)for(ur in ar.ref!==void 0&&(dr=ar.ref),ar.key!==void 0&&(hr=""+ar.key),ar)J$1.call(ar,ur)&&!L$2.hasOwnProperty(ur)&&(cr[ur]=ar[ur]);var fr=arguments.length-2;if(fr===1)cr.children=lr;else if(1<fr){for(var pr=Array(fr),vr=0;vr<fr;vr++)pr[vr]=arguments[vr+2];cr.children=pr}if(or&&or.defaultProps)for(ur in fr=or.defaultProps,fr)cr[ur]===void 0&&(cr[ur]=fr[ur]);return{$$typeof:l$2,type:or,key:hr,ref:dr,props:cr,_owner:K$3.current}}function N$2(or,ar){return{$$typeof:l$2,type:or.type,key:ar,ref:or.ref,props:or.props,_owner:or._owner}}function O$2(or){return typeof or=="object"&&or!==null&&or.$$typeof===l$2}function escape$1(or){var ar={"=":"=0",":":"=2"};return"$"+or.replace(/[=:]/g,function(lr){return ar[lr]})}var P$2=/\/+/g;function Q$2(or,ar){return typeof or=="object"&&or!==null&&or.key!=null?escape$1(""+or.key):ar.toString(36)}function R$2(or,ar,lr,ur,cr){var hr=typeof or;(hr==="undefined"||hr==="boolean")&&(or=null);var dr=!1;if(or===null)dr=!0;else switch(hr){case"string":case"number":dr=!0;break;case"object":switch(or.$$typeof){case l$2:case n$2:dr=!0}}if(dr)return dr=or,cr=cr(dr),or=ur===""?"."+Q$2(dr,0):ur,I$2(cr)?(lr="",or!=null&&(lr=or.replace(P$2,"$&/")+"/"),R$2(cr,ar,lr,"",function(vr){return vr})):cr!=null&&(O$2(cr)&&(cr=N$2(cr,lr+(!cr.key||dr&&dr.key===cr.key?"":(""+cr.key).replace(P$2,"$&/")+"/")+or)),ar.push(cr)),1;if(dr=0,ur=ur===""?".":ur+":",I$2(or))for(var fr=0;fr<or.length;fr++){hr=or[fr];var pr=ur+Q$2(hr,fr);dr+=R$2(hr,ar,lr,pr,cr)}else if(pr=A$2(or),typeof pr=="function")for(or=pr.call(or),fr=0;!(hr=or.next()).done;)hr=hr.value,pr=ur+Q$2(hr,fr++),dr+=R$2(hr,ar,lr,pr,cr);else if(hr==="object")throw ar=String(or),Error("Objects are not valid as a React child (found: "+(ar==="[object Object]"?"object with keys {"+Object.keys(or).join(", ")+"}":ar)+"). If you meant to render a collection of children, use an array instead.");return dr}function S$2(or,ar,lr){if(or==null)return or;var ur=[],cr=0;return R$2(or,ur,"","",function(hr){return ar.call(lr,hr,cr++)}),ur}function T$2(or){if(or._status===-1){var ar=or._result;ar=ar(),ar.then(function(lr){(or._status===0||or._status===-1)&&(or._status=1,or._result=lr)},function(lr){(or._status===0||or._status===-1)&&(or._status=2,or._result=lr)}),or._status===-1&&(or._status=0,or._result=ar)}if(or._status===1)return or._result.default;throw or._result}var U$2={current:null},V$2={transition:null},W$2={ReactCurrentDispatcher:U$2,ReactCurrentBatchConfig:V$2,ReactCurrentOwner:K$3};function X$2(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$2,forEach:function(or,ar,lr){S$2(or,function(){ar.apply(this,arguments)},lr)},count:function(or){var ar=0;return S$2(or,function(){ar++}),ar},toArray:function(or){return S$2(or,function(ar){return ar})||[]},only:function(or){if(!O$2(or))throw Error("React.Children.only expected to receive a single React element child.");return or}};react_production_min.Component=E$2;react_production_min.Fragment=p$4;react_production_min.Profiler=r$1;react_production_min.PureComponent=G$2;react_production_min.StrictMode=q$2;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.act=X$2;react_production_min.cloneElement=function(or,ar,lr){if(or==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+or+".");var ur=C$2({},or.props),cr=or.key,hr=or.ref,dr=or._owner;if(ar!=null){if(ar.ref!==void 0&&(hr=ar.ref,dr=K$3.current),ar.key!==void 0&&(cr=""+ar.key),or.type&&or.type.defaultProps)var fr=or.type.defaultProps;for(pr in ar)J$1.call(ar,pr)&&!L$2.hasOwnProperty(pr)&&(ur[pr]=ar[pr]===void 0&&fr!==void 0?fr[pr]:ar[pr])}var pr=arguments.length-2;if(pr===1)ur.children=lr;else if(1<pr){fr=Array(pr);for(var vr=0;vr<pr;vr++)fr[vr]=arguments[vr+2];ur.children=fr}return{$$typeof:l$2,type:or.type,key:cr,ref:hr,props:ur,_owner:dr}};react_production_min.createContext=function(or){return or={$$typeof:u$1,_currentValue:or,_currentValue2:or,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},or.Provider={$$typeof:t$1,_context:or},or.Consumer=or};react_production_min.createElement=M$2;react_production_min.createFactory=function(or){var ar=M$2.bind(null,or);return ar.type=or,ar};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(or){return{$$typeof:v$2,render:or}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(or){return{$$typeof:y$2,_payload:{_status:-1,_result:or},_init:T$2}};react_production_min.memo=function(or,ar){return{$$typeof:x$2,type:or,compare:ar===void 0?null:ar}};react_production_min.startTransition=function(or){var ar=V$2.transition;V$2.transition={};try{or()}finally{V$2.transition=ar}};react_production_min.unstable_act=X$2;react_production_min.useCallback=function(or,ar){return U$2.current.useCallback(or,ar)};react_production_min.useContext=function(or){return U$2.current.useContext(or)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(or){return U$2.current.useDeferredValue(or)};react_production_min.useEffect=function(or,ar){return U$2.current.useEffect(or,ar)};react_production_min.useId=function(){return U$2.current.useId()};react_production_min.useImperativeHandle=function(or,ar,lr){return U$2.current.useImperativeHandle(or,ar,lr)};react_production_min.useInsertionEffect=function(or,ar){return U$2.current.useInsertionEffect(or,ar)};react_production_min.useLayoutEffect=function(or,ar){return U$2.current.useLayoutEffect(or,ar)};react_production_min.useMemo=function(or,ar){return U$2.current.useMemo(or,ar)};react_production_min.useReducer=function(or,ar,lr){return U$2.current.useReducer(or,ar,lr)};react_production_min.useRef=function(or){return U$2.current.useRef(or)};react_production_min.useState=function(or){return U$2.current.useState(or)};react_production_min.useSyncExternalStore=function(or,ar,lr){return U$2.current.useSyncExternalStore(or,ar,lr)};react_production_min.useTransition=function(){return U$2.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs$1(reactExports);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$1=Symbol.for("react.element"),l$1=Symbol.for("react.fragment"),m$2=Object.prototype.hasOwnProperty,n$1=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$3={key:!0,ref:!0,__self:!0,__source:!0};function q$1(or,ar,lr){var ur,cr={},hr=null,dr=null;lr!==void 0&&(hr=""+lr),ar.key!==void 0&&(hr=""+ar.key),ar.ref!==void 0&&(dr=ar.ref);for(ur in ar)m$2.call(ar,ur)&&!p$3.hasOwnProperty(ur)&&(cr[ur]=ar[ur]);if(or&&or.defaultProps)for(ur in ar=or.defaultProps,ar)cr[ur]===void 0&&(cr[ur]=ar[ur]);return{$$typeof:k$1,type:or,key:hr,ref:dr,props:cr,_owner:n$1.current}}reactJsxRuntime_production_min.Fragment=l$1;reactJsxRuntime_production_min.jsx=q$1;reactJsxRuntime_production_min.jsxs=q$1;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(or){function ar(zr,Hr){var Wr=zr.length;zr.push(Hr);e:for(;0<Wr;){var Yr=Wr-1>>>1,qr=zr[Yr];if(0<cr(qr,Hr))zr[Yr]=Hr,zr[Wr]=qr,Wr=Yr;else break e}}function lr(zr){return zr.length===0?null:zr[0]}function ur(zr){if(zr.length===0)return null;var Hr=zr[0],Wr=zr.pop();if(Wr!==Hr){zr[0]=Wr;e:for(var Yr=0,qr=zr.length,Br=qr>>>1;Yr<Br;){var Ur=2*(Yr+1)-1,Vr=zr[Ur],Xr=Ur+1,Zr=zr[Xr];if(0>cr(Vr,Wr))Xr<qr&&0>cr(Zr,Vr)?(zr[Yr]=Zr,zr[Xr]=Wr,Yr=Xr):(zr[Yr]=Vr,zr[Ur]=Wr,Yr=Ur);else if(Xr<qr&&0>cr(Zr,Wr))zr[Yr]=Zr,zr[Xr]=Wr,Yr=Xr;else break e}}return Hr}function cr(zr,Hr){var Wr=zr.sortIndex-Hr.sortIndex;return Wr!==0?Wr:zr.id-Hr.id}if(typeof performance=="object"&&typeof performance.now=="function"){var hr=performance;or.unstable_now=function(){return hr.now()}}else{var dr=Date,fr=dr.now();or.unstable_now=function(){return dr.now()-fr}}var pr=[],vr=[],gr=1,mr=null,br=3,yr=!1,xr=!1,Cr=!1,Sr=typeof setTimeout=="function"?setTimeout:null,wr=typeof clearTimeout=="function"?clearTimeout:null,Er=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function Ar(zr){for(var Hr=lr(vr);Hr!==null;){if(Hr.callback===null)ur(vr);else if(Hr.startTime<=zr)ur(vr),Hr.sortIndex=Hr.expirationTime,ar(pr,Hr);else break;Hr=lr(vr)}}function Tr(zr){if(Cr=!1,Ar(zr),!xr)if(lr(pr)!==null)xr=!0,jr(Rr);else{var Hr=lr(vr);Hr!==null&&Fr(Tr,Hr.startTime-zr)}}function Rr(zr,Hr){xr=!1,Cr&&(Cr=!1,wr(kr),kr=-1),yr=!0;var Wr=br;try{for(Ar(Hr),mr=lr(pr);mr!==null&&(!(mr.expirationTime>Hr)||zr&&!Lr());){var Yr=mr.callback;if(typeof Yr=="function"){mr.callback=null,br=mr.priorityLevel;var qr=Yr(mr.expirationTime<=Hr);Hr=or.unstable_now(),typeof qr=="function"?mr.callback=qr:mr===lr(pr)&&ur(pr),Ar(Hr)}else ur(pr);mr=lr(pr)}if(mr!==null)var Br=!0;else{var Ur=lr(vr);Ur!==null&&Fr(Tr,Ur.startTime-Hr),Br=!1}return Br}finally{mr=null,br=Wr,yr=!1}}var Pr=!1,_r=null,kr=-1,Dr=5,Nr=-1;function Lr(){return!(or.unstable_now()-Nr<Dr)}function Or(){if(_r!==null){var zr=or.unstable_now();Nr=zr;var Hr=!0;try{Hr=_r(!0,zr)}finally{Hr?Ir():(Pr=!1,_r=null)}}else Pr=!1}var Ir;if(typeof Er=="function")Ir=function(){Er(Or)};else if(typeof MessageChannel<"u"){var Mr=new MessageChannel,$r=Mr.port2;Mr.port1.onmessage=Or,Ir=function(){$r.postMessage(null)}}else Ir=function(){Sr(Or,0)};function jr(zr){_r=zr,Pr||(Pr=!0,Ir())}function Fr(zr,Hr){kr=Sr(function(){zr(or.unstable_now())},Hr)}or.unstable_IdlePriority=5,or.unstable_ImmediatePriority=1,or.unstable_LowPriority=4,or.unstable_NormalPriority=3,or.unstable_Profiling=null,or.unstable_UserBlockingPriority=2,or.unstable_cancelCallback=function(zr){zr.callback=null},or.unstable_continueExecution=function(){xr||yr||(xr=!0,jr(Rr))},or.unstable_forceFrameRate=function(zr){0>zr||125<zr?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Dr=0<zr?Math.floor(1e3/zr):5},or.unstable_getCurrentPriorityLevel=function(){return br},or.unstable_getFirstCallbackNode=function(){return lr(pr)},or.unstable_next=function(zr){switch(br){case 1:case 2:case 3:var Hr=3;break;default:Hr=br}var Wr=br;br=Hr;try{return zr()}finally{br=Wr}},or.unstable_pauseExecution=function(){},or.unstable_requestPaint=function(){},or.unstable_runWithPriority=function(zr,Hr){switch(zr){case 1:case 2:case 3:case 4:case 5:break;default:zr=3}var Wr=br;br=zr;try{return Hr()}finally{br=Wr}},or.unstable_scheduleCallback=function(zr,Hr,Wr){var Yr=or.unstable_now();switch(typeof Wr=="object"&&Wr!==null?(Wr=Wr.delay,Wr=typeof Wr=="number"&&0<Wr?Yr+Wr:Yr):Wr=Yr,zr){case 1:var qr=-1;break;case 2:qr=250;break;case 5:qr=1073741823;break;case 4:qr=1e4;break;default:qr=5e3}return qr=Wr+qr,zr={id:gr++,callback:Hr,priorityLevel:zr,startTime:Wr,expirationTime:qr,sortIndex:-1},Wr>Yr?(zr.sortIndex=Wr,ar(vr,zr),lr(pr)===null&&zr===lr(vr)&&(Cr?(wr(kr),kr=-1):Cr=!0,Fr(Tr,Wr-Yr))):(zr.sortIndex=qr,ar(pr,zr),xr||yr||(xr=!0,jr(Rr))),zr},or.unstable_shouldYield=Lr,or.unstable_wrapCallback=function(zr){var Hr=br;return function(){var Wr=br;br=Hr;try{return zr.apply(this,arguments)}finally{br=Wr}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa=reactExports,ca=schedulerExports;function p$2(or){for(var ar="https://reactjs.org/docs/error-decoder.html?invariant="+or,lr=1;lr<arguments.length;lr++)ar+="&args[]="+encodeURIComponent(arguments[lr]);return"Minified React error #"+or+"; visit "+ar+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da=new Set,ea={};function fa(or,ar){ha(or,ar),ha(or+"Capture",ar)}function ha(or,ar){for(ea[or]=ar,or=0;or<ar.length;or++)da.add(ar[or])}var ia=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja=Object.prototype.hasOwnProperty,ka=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la={},ma={};function oa(or){return ja.call(ma,or)?!0:ja.call(la,or)?!1:ka.test(or)?ma[or]=!0:(la[or]=!0,!1)}function pa(or,ar,lr,ur){if(lr!==null&&lr.type===0)return!1;switch(typeof ar){case"function":case"symbol":return!0;case"boolean":return ur?!1:lr!==null?!lr.acceptsBooleans:(or=or.toLowerCase().slice(0,5),or!=="data-"&&or!=="aria-");default:return!1}}function qa(or,ar,lr,ur){if(ar===null||typeof ar>"u"||pa(or,ar,lr,ur))return!0;if(ur)return!1;if(lr!==null)switch(lr.type){case 3:return!ar;case 4:return ar===!1;case 5:return isNaN(ar);case 6:return isNaN(ar)||1>ar}return!1}function v$1(or,ar,lr,ur,cr,hr,dr){this.acceptsBooleans=ar===2||ar===3||ar===4,this.attributeName=ur,this.attributeNamespace=cr,this.mustUseProperty=lr,this.propertyName=or,this.type=ar,this.sanitizeURL=hr,this.removeEmptyString=dr}var z$1={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(or){z$1[or]=new v$1(or,0,!1,or,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(or){var ar=or[0];z$1[ar]=new v$1(ar,1,!1,or[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(or){z$1[or]=new v$1(or,2,!1,or.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(or){z$1[or]=new v$1(or,2,!1,or,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(or){z$1[or]=new v$1(or,3,!1,or.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(or){z$1[or]=new v$1(or,3,!0,or,null,!1,!1)});["capture","download"].forEach(function(or){z$1[or]=new v$1(or,4,!1,or,null,!1,!1)});["cols","rows","size","span"].forEach(function(or){z$1[or]=new v$1(or,6,!1,or,null,!1,!1)});["rowSpan","start"].forEach(function(or){z$1[or]=new v$1(or,5,!1,or.toLowerCase(),null,!1,!1)});var ra=/[\-:]([a-z])/g;function sa(or){return or[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(or){var ar=or.replace(ra,sa);z$1[ar]=new v$1(ar,1,!1,or,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(or){var ar=or.replace(ra,sa);z$1[ar]=new v$1(ar,1,!1,or,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(or){var ar=or.replace(ra,sa);z$1[ar]=new v$1(ar,1,!1,or,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(or){z$1[or]=new v$1(or,1,!1,or.toLowerCase(),null,!1,!1)});z$1.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(or){z$1[or]=new v$1(or,1,!1,or.toLowerCase(),null,!0,!0)});function ta(or,ar,lr,ur){var cr=z$1.hasOwnProperty(ar)?z$1[ar]:null;(cr!==null?cr.type!==0:ur||!(2<ar.length)||ar[0]!=="o"&&ar[0]!=="O"||ar[1]!=="n"&&ar[1]!=="N")&&(qa(ar,lr,cr,ur)&&(lr=null),ur||cr===null?oa(ar)&&(lr===null?or.removeAttribute(ar):or.setAttribute(ar,""+lr)):cr.mustUseProperty?or[cr.propertyName]=lr===null?cr.type===3?!1:"":lr:(ar=cr.attributeName,ur=cr.attributeNamespace,lr===null?or.removeAttribute(ar):(cr=cr.type,lr=cr===3||cr===4&&lr===!0?"":""+lr,ur?or.setAttributeNS(ur,ar,lr):or.setAttribute(ar,lr))))}var ua=aa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va=Symbol.for("react.element"),wa=Symbol.for("react.portal"),ya=Symbol.for("react.fragment"),za=Symbol.for("react.strict_mode"),Aa=Symbol.for("react.profiler"),Ba=Symbol.for("react.provider"),Ca=Symbol.for("react.context"),Da=Symbol.for("react.forward_ref"),Ea=Symbol.for("react.suspense"),Fa=Symbol.for("react.suspense_list"),Ga=Symbol.for("react.memo"),Ha=Symbol.for("react.lazy"),Ia=Symbol.for("react.offscreen"),Ja=Symbol.iterator;function Ka(or){return or===null||typeof or!="object"?null:(or=Ja&&or[Ja]||or["@@iterator"],typeof or=="function"?or:null)}var A$1=Object.assign,La;function Ma(or){if(La===void 0)try{throw Error()}catch(lr){var ar=lr.stack.trim().match(/\n( *(at )?)/);La=ar&&ar[1]||""}return`
`+La+or}var Na=!1;function Oa(or,ar){if(!or||Na)return"";Na=!0;var lr=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(ar)if(ar=function(){throw Error()},Object.defineProperty(ar.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ar,[])}catch(vr){var ur=vr}Reflect.construct(or,[],ar)}else{try{ar.call()}catch(vr){ur=vr}or.call(ar.prototype)}else{try{throw Error()}catch(vr){ur=vr}or()}}catch(vr){if(vr&&ur&&typeof vr.stack=="string"){for(var cr=vr.stack.split(`
`),hr=ur.stack.split(`
`),dr=cr.length-1,fr=hr.length-1;1<=dr&&0<=fr&&cr[dr]!==hr[fr];)fr--;for(;1<=dr&&0<=fr;dr--,fr--)if(cr[dr]!==hr[fr]){if(dr!==1||fr!==1)do if(dr--,fr--,0>fr||cr[dr]!==hr[fr]){var pr=`
`+cr[dr].replace(" at new "," at ");return or.displayName&&pr.includes("<anonymous>")&&(pr=pr.replace("<anonymous>",or.displayName)),pr}while(1<=dr&&0<=fr);break}}}finally{Na=!1,Error.prepareStackTrace=lr}return(or=or?or.displayName||or.name:"")?Ma(or):""}function Pa(or){switch(or.tag){case 5:return Ma(or.type);case 16:return Ma("Lazy");case 13:return Ma("Suspense");case 19:return Ma("SuspenseList");case 0:case 2:case 15:return or=Oa(or.type,!1),or;case 11:return or=Oa(or.type.render,!1),or;case 1:return or=Oa(or.type,!0),or;default:return""}}function Qa(or){if(or==null)return null;if(typeof or=="function")return or.displayName||or.name||null;if(typeof or=="string")return or;switch(or){case ya:return"Fragment";case wa:return"Portal";case Aa:return"Profiler";case za:return"StrictMode";case Ea:return"Suspense";case Fa:return"SuspenseList"}if(typeof or=="object")switch(or.$$typeof){case Ca:return(or.displayName||"Context")+".Consumer";case Ba:return(or._context.displayName||"Context")+".Provider";case Da:var ar=or.render;return or=or.displayName,or||(or=ar.displayName||ar.name||"",or=or!==""?"ForwardRef("+or+")":"ForwardRef"),or;case Ga:return ar=or.displayName||null,ar!==null?ar:Qa(or.type)||"Memo";case Ha:ar=or._payload,or=or._init;try{return Qa(or(ar))}catch{}}return null}function Ra(or){var ar=or.type;switch(or.tag){case 24:return"Cache";case 9:return(ar.displayName||"Context")+".Consumer";case 10:return(ar._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return or=ar.render,or=or.displayName||or.name||"",ar.displayName||(or!==""?"ForwardRef("+or+")":"ForwardRef");case 7:return"Fragment";case 5:return ar;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa(ar);case 8:return ar===za?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof ar=="function")return ar.displayName||ar.name||null;if(typeof ar=="string")return ar}return null}function Sa(or){switch(typeof or){case"boolean":case"number":case"string":case"undefined":return or;case"object":return or;default:return""}}function Ta(or){var ar=or.type;return(or=or.nodeName)&&or.toLowerCase()==="input"&&(ar==="checkbox"||ar==="radio")}function Ua(or){var ar=Ta(or)?"checked":"value",lr=Object.getOwnPropertyDescriptor(or.constructor.prototype,ar),ur=""+or[ar];if(!or.hasOwnProperty(ar)&&typeof lr<"u"&&typeof lr.get=="function"&&typeof lr.set=="function"){var cr=lr.get,hr=lr.set;return Object.defineProperty(or,ar,{configurable:!0,get:function(){return cr.call(this)},set:function(dr){ur=""+dr,hr.call(this,dr)}}),Object.defineProperty(or,ar,{enumerable:lr.enumerable}),{getValue:function(){return ur},setValue:function(dr){ur=""+dr},stopTracking:function(){or._valueTracker=null,delete or[ar]}}}}function Va(or){or._valueTracker||(or._valueTracker=Ua(or))}function Wa(or){if(!or)return!1;var ar=or._valueTracker;if(!ar)return!0;var lr=ar.getValue(),ur="";return or&&(ur=Ta(or)?or.checked?"true":"false":or.value),or=ur,or!==lr?(ar.setValue(or),!0):!1}function Xa(or){if(or=or||(typeof document<"u"?document:void 0),typeof or>"u")return null;try{return or.activeElement||or.body}catch{return or.body}}function Ya(or,ar){var lr=ar.checked;return A$1({},ar,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:lr??or._wrapperState.initialChecked})}function Za(or,ar){var lr=ar.defaultValue==null?"":ar.defaultValue,ur=ar.checked!=null?ar.checked:ar.defaultChecked;lr=Sa(ar.value!=null?ar.value:lr),or._wrapperState={initialChecked:ur,initialValue:lr,controlled:ar.type==="checkbox"||ar.type==="radio"?ar.checked!=null:ar.value!=null}}function ab(or,ar){ar=ar.checked,ar!=null&&ta(or,"checked",ar,!1)}function bb(or,ar){ab(or,ar);var lr=Sa(ar.value),ur=ar.type;if(lr!=null)ur==="number"?(lr===0&&or.value===""||or.value!=lr)&&(or.value=""+lr):or.value!==""+lr&&(or.value=""+lr);else if(ur==="submit"||ur==="reset"){or.removeAttribute("value");return}ar.hasOwnProperty("value")?cb(or,ar.type,lr):ar.hasOwnProperty("defaultValue")&&cb(or,ar.type,Sa(ar.defaultValue)),ar.checked==null&&ar.defaultChecked!=null&&(or.defaultChecked=!!ar.defaultChecked)}function db$1(or,ar,lr){if(ar.hasOwnProperty("value")||ar.hasOwnProperty("defaultValue")){var ur=ar.type;if(!(ur!=="submit"&&ur!=="reset"||ar.value!==void 0&&ar.value!==null))return;ar=""+or._wrapperState.initialValue,lr||ar===or.value||(or.value=ar),or.defaultValue=ar}lr=or.name,lr!==""&&(or.name=""),or.defaultChecked=!!or._wrapperState.initialChecked,lr!==""&&(or.name=lr)}function cb(or,ar,lr){(ar!=="number"||Xa(or.ownerDocument)!==or)&&(lr==null?or.defaultValue=""+or._wrapperState.initialValue:or.defaultValue!==""+lr&&(or.defaultValue=""+lr))}var eb=Array.isArray;function fb(or,ar,lr,ur){if(or=or.options,ar){ar={};for(var cr=0;cr<lr.length;cr++)ar["$"+lr[cr]]=!0;for(lr=0;lr<or.length;lr++)cr=ar.hasOwnProperty("$"+or[lr].value),or[lr].selected!==cr&&(or[lr].selected=cr),cr&&ur&&(or[lr].defaultSelected=!0)}else{for(lr=""+Sa(lr),ar=null,cr=0;cr<or.length;cr++){if(or[cr].value===lr){or[cr].selected=!0,ur&&(or[cr].defaultSelected=!0);return}ar!==null||or[cr].disabled||(ar=or[cr])}ar!==null&&(ar.selected=!0)}}function gb(or,ar){if(ar.dangerouslySetInnerHTML!=null)throw Error(p$2(91));return A$1({},ar,{value:void 0,defaultValue:void 0,children:""+or._wrapperState.initialValue})}function hb(or,ar){var lr=ar.value;if(lr==null){if(lr=ar.children,ar=ar.defaultValue,lr!=null){if(ar!=null)throw Error(p$2(92));if(eb(lr)){if(1<lr.length)throw Error(p$2(93));lr=lr[0]}ar=lr}ar==null&&(ar=""),lr=ar}or._wrapperState={initialValue:Sa(lr)}}function ib(or,ar){var lr=Sa(ar.value),ur=Sa(ar.defaultValue);lr!=null&&(lr=""+lr,lr!==or.value&&(or.value=lr),ar.defaultValue==null&&or.defaultValue!==lr&&(or.defaultValue=lr)),ur!=null&&(or.defaultValue=""+ur)}function jb(or){var ar=or.textContent;ar===or._wrapperState.initialValue&&ar!==""&&ar!==null&&(or.value=ar)}function kb(or){switch(or){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb(or,ar){return or==null||or==="http://www.w3.org/1999/xhtml"?kb(ar):or==="http://www.w3.org/2000/svg"&&ar==="foreignObject"?"http://www.w3.org/1999/xhtml":or}var mb,nb=function(or){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(ar,lr,ur,cr){MSApp.execUnsafeLocalFunction(function(){return or(ar,lr,ur,cr)})}:or}(function(or,ar){if(or.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in or)or.innerHTML=ar;else{for(mb=mb||document.createElement("div"),mb.innerHTML="<svg>"+ar.valueOf().toString()+"</svg>",ar=mb.firstChild;or.firstChild;)or.removeChild(or.firstChild);for(;ar.firstChild;)or.appendChild(ar.firstChild)}});function ob(or,ar){if(ar){var lr=or.firstChild;if(lr&&lr===or.lastChild&&lr.nodeType===3){lr.nodeValue=ar;return}}or.textContent=ar}var pb={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb=["Webkit","ms","Moz","O"];Object.keys(pb).forEach(function(or){qb.forEach(function(ar){ar=ar+or.charAt(0).toUpperCase()+or.substring(1),pb[ar]=pb[or]})});function rb(or,ar,lr){return ar==null||typeof ar=="boolean"||ar===""?"":lr||typeof ar!="number"||ar===0||pb.hasOwnProperty(or)&&pb[or]?(""+ar).trim():ar+"px"}function sb(or,ar){or=or.style;for(var lr in ar)if(ar.hasOwnProperty(lr)){var ur=lr.indexOf("--")===0,cr=rb(lr,ar[lr],ur);lr==="float"&&(lr="cssFloat"),ur?or.setProperty(lr,cr):or[lr]=cr}}var tb=A$1({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub(or,ar){if(ar){if(tb[or]&&(ar.children!=null||ar.dangerouslySetInnerHTML!=null))throw Error(p$2(137,or));if(ar.dangerouslySetInnerHTML!=null){if(ar.children!=null)throw Error(p$2(60));if(typeof ar.dangerouslySetInnerHTML!="object"||!("__html"in ar.dangerouslySetInnerHTML))throw Error(p$2(61))}if(ar.style!=null&&typeof ar.style!="object")throw Error(p$2(62))}}function vb(or,ar){if(or.indexOf("-")===-1)return typeof ar.is=="string";switch(or){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb=null;function xb(or){return or=or.target||or.srcElement||window,or.correspondingUseElement&&(or=or.correspondingUseElement),or.nodeType===3?or.parentNode:or}var yb=null,zb=null,Ab=null;function Bb(or){if(or=Cb(or)){if(typeof yb!="function")throw Error(p$2(280));var ar=or.stateNode;ar&&(ar=Db(ar),yb(or.stateNode,or.type,ar))}}function Eb(or){zb?Ab?Ab.push(or):Ab=[or]:zb=or}function Fb(){if(zb){var or=zb,ar=Ab;if(Ab=zb=null,Bb(or),ar)for(or=0;or<ar.length;or++)Bb(ar[or])}}function Gb(or,ar){return or(ar)}function Hb(){}var Ib=!1;function Jb(or,ar,lr){if(Ib)return or(ar,lr);Ib=!0;try{return Gb(or,ar,lr)}finally{Ib=!1,(zb!==null||Ab!==null)&&(Hb(),Fb())}}function Kb(or,ar){var lr=or.stateNode;if(lr===null)return null;var ur=Db(lr);if(ur===null)return null;lr=ur[ar];e:switch(ar){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(ur=!ur.disabled)||(or=or.type,ur=!(or==="button"||or==="input"||or==="select"||or==="textarea")),or=!ur;break e;default:or=!1}if(or)return null;if(lr&&typeof lr!="function")throw Error(p$2(231,ar,typeof lr));return lr}var Lb=!1;if(ia)try{var Mb={};Object.defineProperty(Mb,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Mb,Mb),window.removeEventListener("test",Mb,Mb)}catch{Lb=!1}function Nb(or,ar,lr,ur,cr,hr,dr,fr,pr){var vr=Array.prototype.slice.call(arguments,3);try{ar.apply(lr,vr)}catch(gr){this.onError(gr)}}var Ob=!1,Pb=null,Qb=!1,Rb=null,Sb={onError:function(or){Ob=!0,Pb=or}};function Tb(or,ar,lr,ur,cr,hr,dr,fr,pr){Ob=!1,Pb=null,Nb.apply(Sb,arguments)}function Ub(or,ar,lr,ur,cr,hr,dr,fr,pr){if(Tb.apply(this,arguments),Ob){if(Ob){var vr=Pb;Ob=!1,Pb=null}else throw Error(p$2(198));Qb||(Qb=!0,Rb=vr)}}function Vb(or){var ar=or,lr=or;if(or.alternate)for(;ar.return;)ar=ar.return;else{or=ar;do ar=or,ar.flags&4098&&(lr=ar.return),or=ar.return;while(or)}return ar.tag===3?lr:null}function Wb(or){if(or.tag===13){var ar=or.memoizedState;if(ar===null&&(or=or.alternate,or!==null&&(ar=or.memoizedState)),ar!==null)return ar.dehydrated}return null}function Xb(or){if(Vb(or)!==or)throw Error(p$2(188))}function Yb(or){var ar=or.alternate;if(!ar){if(ar=Vb(or),ar===null)throw Error(p$2(188));return ar!==or?null:or}for(var lr=or,ur=ar;;){var cr=lr.return;if(cr===null)break;var hr=cr.alternate;if(hr===null){if(ur=cr.return,ur!==null){lr=ur;continue}break}if(cr.child===hr.child){for(hr=cr.child;hr;){if(hr===lr)return Xb(cr),or;if(hr===ur)return Xb(cr),ar;hr=hr.sibling}throw Error(p$2(188))}if(lr.return!==ur.return)lr=cr,ur=hr;else{for(var dr=!1,fr=cr.child;fr;){if(fr===lr){dr=!0,lr=cr,ur=hr;break}if(fr===ur){dr=!0,ur=cr,lr=hr;break}fr=fr.sibling}if(!dr){for(fr=hr.child;fr;){if(fr===lr){dr=!0,lr=hr,ur=cr;break}if(fr===ur){dr=!0,ur=hr,lr=cr;break}fr=fr.sibling}if(!dr)throw Error(p$2(189))}}if(lr.alternate!==ur)throw Error(p$2(190))}if(lr.tag!==3)throw Error(p$2(188));return lr.stateNode.current===lr?or:ar}function Zb(or){return or=Yb(or),or!==null?$b(or):null}function $b(or){if(or.tag===5||or.tag===6)return or;for(or=or.child;or!==null;){var ar=$b(or);if(ar!==null)return ar;or=or.sibling}return null}var ac=ca.unstable_scheduleCallback,bc=ca.unstable_cancelCallback,cc=ca.unstable_shouldYield,dc=ca.unstable_requestPaint,B$1=ca.unstable_now,ec=ca.unstable_getCurrentPriorityLevel,fc=ca.unstable_ImmediatePriority,gc=ca.unstable_UserBlockingPriority,hc=ca.unstable_NormalPriority,ic=ca.unstable_LowPriority,jc=ca.unstable_IdlePriority,kc=null,lc=null;function mc(or){if(lc&&typeof lc.onCommitFiberRoot=="function")try{lc.onCommitFiberRoot(kc,or,void 0,(or.current.flags&128)===128)}catch{}}var oc=Math.clz32?Math.clz32:nc,pc=Math.log,qc=Math.LN2;function nc(or){return or>>>=0,or===0?32:31-(pc(or)/qc|0)|0}var rc=64,sc=4194304;function tc(or){switch(or&-or){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return or&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return or&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return or}}function uc(or,ar){var lr=or.pendingLanes;if(lr===0)return 0;var ur=0,cr=or.suspendedLanes,hr=or.pingedLanes,dr=lr&268435455;if(dr!==0){var fr=dr&~cr;fr!==0?ur=tc(fr):(hr&=dr,hr!==0&&(ur=tc(hr)))}else dr=lr&~cr,dr!==0?ur=tc(dr):hr!==0&&(ur=tc(hr));if(ur===0)return 0;if(ar!==0&&ar!==ur&&!(ar&cr)&&(cr=ur&-ur,hr=ar&-ar,cr>=hr||cr===16&&(hr&4194240)!==0))return ar;if(ur&4&&(ur|=lr&16),ar=or.entangledLanes,ar!==0)for(or=or.entanglements,ar&=ur;0<ar;)lr=31-oc(ar),cr=1<<lr,ur|=or[lr],ar&=~cr;return ur}function vc(or,ar){switch(or){case 1:case 2:case 4:return ar+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return ar+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc(or,ar){for(var lr=or.suspendedLanes,ur=or.pingedLanes,cr=or.expirationTimes,hr=or.pendingLanes;0<hr;){var dr=31-oc(hr),fr=1<<dr,pr=cr[dr];pr===-1?(!(fr&lr)||fr&ur)&&(cr[dr]=vc(fr,ar)):pr<=ar&&(or.expiredLanes|=fr),hr&=~fr}}function xc(or){return or=or.pendingLanes&-1073741825,or!==0?or:or&1073741824?1073741824:0}function yc(){var or=rc;return rc<<=1,!(rc&4194240)&&(rc=64),or}function zc(or){for(var ar=[],lr=0;31>lr;lr++)ar.push(or);return ar}function Ac(or,ar,lr){or.pendingLanes|=ar,ar!==536870912&&(or.suspendedLanes=0,or.pingedLanes=0),or=or.eventTimes,ar=31-oc(ar),or[ar]=lr}function Bc(or,ar){var lr=or.pendingLanes&~ar;or.pendingLanes=ar,or.suspendedLanes=0,or.pingedLanes=0,or.expiredLanes&=ar,or.mutableReadLanes&=ar,or.entangledLanes&=ar,ar=or.entanglements;var ur=or.eventTimes;for(or=or.expirationTimes;0<lr;){var cr=31-oc(lr),hr=1<<cr;ar[cr]=0,ur[cr]=-1,or[cr]=-1,lr&=~hr}}function Cc(or,ar){var lr=or.entangledLanes|=ar;for(or=or.entanglements;lr;){var ur=31-oc(lr),cr=1<<ur;cr&ar|or[ur]&ar&&(or[ur]|=ar),lr&=~cr}}var C$1=0;function Dc(or){return or&=-or,1<or?4<or?or&268435455?16:536870912:4:1}var Ec,Fc,Gc,Hc,Ic,Jc=!1,Kc=[],Lc=null,Mc=null,Nc=null,Oc=new Map,Pc=new Map,Qc=[],Rc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc(or,ar){switch(or){case"focusin":case"focusout":Lc=null;break;case"dragenter":case"dragleave":Mc=null;break;case"mouseover":case"mouseout":Nc=null;break;case"pointerover":case"pointerout":Oc.delete(ar.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc.delete(ar.pointerId)}}function Tc(or,ar,lr,ur,cr,hr){return or===null||or.nativeEvent!==hr?(or={blockedOn:ar,domEventName:lr,eventSystemFlags:ur,nativeEvent:hr,targetContainers:[cr]},ar!==null&&(ar=Cb(ar),ar!==null&&Fc(ar)),or):(or.eventSystemFlags|=ur,ar=or.targetContainers,cr!==null&&ar.indexOf(cr)===-1&&ar.push(cr),or)}function Uc(or,ar,lr,ur,cr){switch(ar){case"focusin":return Lc=Tc(Lc,or,ar,lr,ur,cr),!0;case"dragenter":return Mc=Tc(Mc,or,ar,lr,ur,cr),!0;case"mouseover":return Nc=Tc(Nc,or,ar,lr,ur,cr),!0;case"pointerover":var hr=cr.pointerId;return Oc.set(hr,Tc(Oc.get(hr)||null,or,ar,lr,ur,cr)),!0;case"gotpointercapture":return hr=cr.pointerId,Pc.set(hr,Tc(Pc.get(hr)||null,or,ar,lr,ur,cr)),!0}return!1}function Vc(or){var ar=Wc(or.target);if(ar!==null){var lr=Vb(ar);if(lr!==null){if(ar=lr.tag,ar===13){if(ar=Wb(lr),ar!==null){or.blockedOn=ar,Ic(or.priority,function(){Gc(lr)});return}}else if(ar===3&&lr.stateNode.current.memoizedState.isDehydrated){or.blockedOn=lr.tag===3?lr.stateNode.containerInfo:null;return}}}or.blockedOn=null}function Xc(or){if(or.blockedOn!==null)return!1;for(var ar=or.targetContainers;0<ar.length;){var lr=Yc(or.domEventName,or.eventSystemFlags,ar[0],or.nativeEvent);if(lr===null){lr=or.nativeEvent;var ur=new lr.constructor(lr.type,lr);wb=ur,lr.target.dispatchEvent(ur),wb=null}else return ar=Cb(lr),ar!==null&&Fc(ar),or.blockedOn=lr,!1;ar.shift()}return!0}function Zc(or,ar,lr){Xc(or)&&lr.delete(ar)}function $c(){Jc=!1,Lc!==null&&Xc(Lc)&&(Lc=null),Mc!==null&&Xc(Mc)&&(Mc=null),Nc!==null&&Xc(Nc)&&(Nc=null),Oc.forEach(Zc),Pc.forEach(Zc)}function ad(or,ar){or.blockedOn===ar&&(or.blockedOn=null,Jc||(Jc=!0,ca.unstable_scheduleCallback(ca.unstable_NormalPriority,$c)))}function bd(or){function ar(cr){return ad(cr,or)}if(0<Kc.length){ad(Kc[0],or);for(var lr=1;lr<Kc.length;lr++){var ur=Kc[lr];ur.blockedOn===or&&(ur.blockedOn=null)}}for(Lc!==null&&ad(Lc,or),Mc!==null&&ad(Mc,or),Nc!==null&&ad(Nc,or),Oc.forEach(ar),Pc.forEach(ar),lr=0;lr<Qc.length;lr++)ur=Qc[lr],ur.blockedOn===or&&(ur.blockedOn=null);for(;0<Qc.length&&(lr=Qc[0],lr.blockedOn===null);)Vc(lr),lr.blockedOn===null&&Qc.shift()}var cd=ua.ReactCurrentBatchConfig,dd=!0;function ed(or,ar,lr,ur){var cr=C$1,hr=cd.transition;cd.transition=null;try{C$1=1,fd(or,ar,lr,ur)}finally{C$1=cr,cd.transition=hr}}function gd(or,ar,lr,ur){var cr=C$1,hr=cd.transition;cd.transition=null;try{C$1=4,fd(or,ar,lr,ur)}finally{C$1=cr,cd.transition=hr}}function fd(or,ar,lr,ur){if(dd){var cr=Yc(or,ar,lr,ur);if(cr===null)hd(or,ar,ur,id,lr),Sc(or,ur);else if(Uc(cr,or,ar,lr,ur))ur.stopPropagation();else if(Sc(or,ur),ar&4&&-1<Rc.indexOf(or)){for(;cr!==null;){var hr=Cb(cr);if(hr!==null&&Ec(hr),hr=Yc(or,ar,lr,ur),hr===null&&hd(or,ar,ur,id,lr),hr===cr)break;cr=hr}cr!==null&&ur.stopPropagation()}else hd(or,ar,ur,null,lr)}}var id=null;function Yc(or,ar,lr,ur){if(id=null,or=xb(ur),or=Wc(or),or!==null)if(ar=Vb(or),ar===null)or=null;else if(lr=ar.tag,lr===13){if(or=Wb(ar),or!==null)return or;or=null}else if(lr===3){if(ar.stateNode.current.memoizedState.isDehydrated)return ar.tag===3?ar.stateNode.containerInfo:null;or=null}else ar!==or&&(or=null);return id=or,null}function jd(or){switch(or){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec()){case fc:return 1;case gc:return 4;case hc:case ic:return 16;case jc:return 536870912;default:return 16}default:return 16}}var kd=null,ld=null,md=null;function nd(){if(md)return md;var or,ar=ld,lr=ar.length,ur,cr="value"in kd?kd.value:kd.textContent,hr=cr.length;for(or=0;or<lr&&ar[or]===cr[or];or++);var dr=lr-or;for(ur=1;ur<=dr&&ar[lr-ur]===cr[hr-ur];ur++);return md=cr.slice(or,1<ur?1-ur:void 0)}function od(or){var ar=or.keyCode;return"charCode"in or?(or=or.charCode,or===0&&ar===13&&(or=13)):or=ar,or===10&&(or=13),32<=or||or===13?or:0}function pd(){return!0}function qd(){return!1}function rd(or){function ar(lr,ur,cr,hr,dr){this._reactName=lr,this._targetInst=cr,this.type=ur,this.nativeEvent=hr,this.target=dr,this.currentTarget=null;for(var fr in or)or.hasOwnProperty(fr)&&(lr=or[fr],this[fr]=lr?lr(hr):hr[fr]);return this.isDefaultPrevented=(hr.defaultPrevented!=null?hr.defaultPrevented:hr.returnValue===!1)?pd:qd,this.isPropagationStopped=qd,this}return A$1(ar.prototype,{preventDefault:function(){this.defaultPrevented=!0;var lr=this.nativeEvent;lr&&(lr.preventDefault?lr.preventDefault():typeof lr.returnValue!="unknown"&&(lr.returnValue=!1),this.isDefaultPrevented=pd)},stopPropagation:function(){var lr=this.nativeEvent;lr&&(lr.stopPropagation?lr.stopPropagation():typeof lr.cancelBubble!="unknown"&&(lr.cancelBubble=!0),this.isPropagationStopped=pd)},persist:function(){},isPersistent:pd}),ar}var sd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(or){return or.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td=rd(sd),ud=A$1({},sd,{view:0,detail:0}),vd=rd(ud),wd,xd,yd,Ad=A$1({},ud,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd,button:0,buttons:0,relatedTarget:function(or){return or.relatedTarget===void 0?or.fromElement===or.srcElement?or.toElement:or.fromElement:or.relatedTarget},movementX:function(or){return"movementX"in or?or.movementX:(or!==yd&&(yd&&or.type==="mousemove"?(wd=or.screenX-yd.screenX,xd=or.screenY-yd.screenY):xd=wd=0,yd=or),wd)},movementY:function(or){return"movementY"in or?or.movementY:xd}}),Bd=rd(Ad),Cd=A$1({},Ad,{dataTransfer:0}),Dd=rd(Cd),Ed=A$1({},ud,{relatedTarget:0}),Fd=rd(Ed),Gd=A$1({},sd,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd=rd(Gd),Id=A$1({},sd,{clipboardData:function(or){return"clipboardData"in or?or.clipboardData:window.clipboardData}}),Jd=rd(Id),Kd=A$1({},sd,{data:0}),Ld=rd(Kd),Md={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd(or){var ar=this.nativeEvent;return ar.getModifierState?ar.getModifierState(or):(or=Od[or])?!!ar[or]:!1}function zd(){return Pd}var Qd=A$1({},ud,{key:function(or){if(or.key){var ar=Md[or.key]||or.key;if(ar!=="Unidentified")return ar}return or.type==="keypress"?(or=od(or),or===13?"Enter":String.fromCharCode(or)):or.type==="keydown"||or.type==="keyup"?Nd[or.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd,charCode:function(or){return or.type==="keypress"?od(or):0},keyCode:function(or){return or.type==="keydown"||or.type==="keyup"?or.keyCode:0},which:function(or){return or.type==="keypress"?od(or):or.type==="keydown"||or.type==="keyup"?or.keyCode:0}}),Rd=rd(Qd),Sd=A$1({},Ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=rd(Sd),Ud=A$1({},ud,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd}),Vd=rd(Ud),Wd=A$1({},sd,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd=rd(Wd),Yd=A$1({},Ad,{deltaX:function(or){return"deltaX"in or?or.deltaX:"wheelDeltaX"in or?-or.wheelDeltaX:0},deltaY:function(or){return"deltaY"in or?or.deltaY:"wheelDeltaY"in or?-or.wheelDeltaY:"wheelDelta"in or?-or.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd=rd(Yd),$d=[9,13,27,32],ae$1=ia&&"CompositionEvent"in window,be$1=null;ia&&"documentMode"in document&&(be$1=document.documentMode);var ce$1=ia&&"TextEvent"in window&&!be$1,de$1=ia&&(!ae$1||be$1&&8<be$1&&11>=be$1),ee$1=" ",fe$1=!1;function ge$1(or,ar){switch(or){case"keyup":return $d.indexOf(ar.keyCode)!==-1;case"keydown":return ar.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(or){return or=or.detail,typeof or=="object"&&"data"in or?or.data:null}var ie$1=!1;function je$1(or,ar){switch(or){case"compositionend":return he$1(ar);case"keypress":return ar.which!==32?null:(fe$1=!0,ee$1);case"textInput":return or=ar.data,or===ee$1&&fe$1?null:or;default:return null}}function ke$1(or,ar){if(ie$1)return or==="compositionend"||!ae$1&&ge$1(or,ar)?(or=nd(),md=ld=kd=null,ie$1=!1,or):null;switch(or){case"paste":return null;case"keypress":if(!(ar.ctrlKey||ar.altKey||ar.metaKey)||ar.ctrlKey&&ar.altKey){if(ar.char&&1<ar.char.length)return ar.char;if(ar.which)return String.fromCharCode(ar.which)}return null;case"compositionend":return de$1&&ar.locale!=="ko"?null:ar.data;default:return null}}var le$1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$1(or){var ar=or&&or.nodeName&&or.nodeName.toLowerCase();return ar==="input"?!!le$1[or.type]:ar==="textarea"}function ne$1(or,ar,lr,ur){Eb(ur),ar=oe$1(ar,"onChange"),0<ar.length&&(lr=new td("onChange","change",null,lr,ur),or.push({event:lr,listeners:ar}))}var pe$1=null,qe$1=null;function re$1(or){se$1(or,0)}function te$1(or){var ar=ue$1(or);if(Wa(ar))return or}function ve$1(or,ar){if(or==="change")return ar}var we$1=!1;if(ia){var xe$1;if(ia){var ye$1="oninput"in document;if(!ye$1){var ze$1=document.createElement("div");ze$1.setAttribute("oninput","return;"),ye$1=typeof ze$1.oninput=="function"}xe$1=ye$1}else xe$1=!1;we$1=xe$1&&(!document.documentMode||9<document.documentMode)}function Ae$1(){pe$1&&(pe$1.detachEvent("onpropertychange",Be$1),qe$1=pe$1=null)}function Be$1(or){if(or.propertyName==="value"&&te$1(qe$1)){var ar=[];ne$1(ar,qe$1,or,xb(or)),Jb(re$1,ar)}}function Ce$1(or,ar,lr){or==="focusin"?(Ae$1(),pe$1=ar,qe$1=lr,pe$1.attachEvent("onpropertychange",Be$1)):or==="focusout"&&Ae$1()}function De$1(or){if(or==="selectionchange"||or==="keyup"||or==="keydown")return te$1(qe$1)}function Ee$1(or,ar){if(or==="click")return te$1(ar)}function Fe$1(or,ar){if(or==="input"||or==="change")return te$1(ar)}function Ge$1(or,ar){return or===ar&&(or!==0||1/or===1/ar)||or!==or&&ar!==ar}var He$1=typeof Object.is=="function"?Object.is:Ge$1;function Ie$1(or,ar){if(He$1(or,ar))return!0;if(typeof or!="object"||or===null||typeof ar!="object"||ar===null)return!1;var lr=Object.keys(or),ur=Object.keys(ar);if(lr.length!==ur.length)return!1;for(ur=0;ur<lr.length;ur++){var cr=lr[ur];if(!ja.call(ar,cr)||!He$1(or[cr],ar[cr]))return!1}return!0}function Je$1(or){for(;or&&or.firstChild;)or=or.firstChild;return or}function Ke$1(or,ar){var lr=Je$1(or);or=0;for(var ur;lr;){if(lr.nodeType===3){if(ur=or+lr.textContent.length,or<=ar&&ur>=ar)return{node:lr,offset:ar-or};or=ur}e:{for(;lr;){if(lr.nextSibling){lr=lr.nextSibling;break e}lr=lr.parentNode}lr=void 0}lr=Je$1(lr)}}function Le$1(or,ar){return or&&ar?or===ar?!0:or&&or.nodeType===3?!1:ar&&ar.nodeType===3?Le$1(or,ar.parentNode):"contains"in or?or.contains(ar):or.compareDocumentPosition?!!(or.compareDocumentPosition(ar)&16):!1:!1}function Me$1(){for(var or=window,ar=Xa();ar instanceof or.HTMLIFrameElement;){try{var lr=typeof ar.contentWindow.location.href=="string"}catch{lr=!1}if(lr)or=ar.contentWindow;else break;ar=Xa(or.document)}return ar}function Ne$1(or){var ar=or&&or.nodeName&&or.nodeName.toLowerCase();return ar&&(ar==="input"&&(or.type==="text"||or.type==="search"||or.type==="tel"||or.type==="url"||or.type==="password")||ar==="textarea"||or.contentEditable==="true")}function Oe$1(or){var ar=Me$1(),lr=or.focusedElem,ur=or.selectionRange;if(ar!==lr&&lr&&lr.ownerDocument&&Le$1(lr.ownerDocument.documentElement,lr)){if(ur!==null&&Ne$1(lr)){if(ar=ur.start,or=ur.end,or===void 0&&(or=ar),"selectionStart"in lr)lr.selectionStart=ar,lr.selectionEnd=Math.min(or,lr.value.length);else if(or=(ar=lr.ownerDocument||document)&&ar.defaultView||window,or.getSelection){or=or.getSelection();var cr=lr.textContent.length,hr=Math.min(ur.start,cr);ur=ur.end===void 0?hr:Math.min(ur.end,cr),!or.extend&&hr>ur&&(cr=ur,ur=hr,hr=cr),cr=Ke$1(lr,hr);var dr=Ke$1(lr,ur);cr&&dr&&(or.rangeCount!==1||or.anchorNode!==cr.node||or.anchorOffset!==cr.offset||or.focusNode!==dr.node||or.focusOffset!==dr.offset)&&(ar=ar.createRange(),ar.setStart(cr.node,cr.offset),or.removeAllRanges(),hr>ur?(or.addRange(ar),or.extend(dr.node,dr.offset)):(ar.setEnd(dr.node,dr.offset),or.addRange(ar)))}}for(ar=[],or=lr;or=or.parentNode;)or.nodeType===1&&ar.push({element:or,left:or.scrollLeft,top:or.scrollTop});for(typeof lr.focus=="function"&&lr.focus(),lr=0;lr<ar.length;lr++)or=ar[lr],or.element.scrollLeft=or.left,or.element.scrollTop=or.top}}var Pe$1=ia&&"documentMode"in document&&11>=document.documentMode,Qe$1=null,Re$1=null,Se$1=null,Te$1=!1;function Ue$1(or,ar,lr){var ur=lr.window===lr?lr.document:lr.nodeType===9?lr:lr.ownerDocument;Te$1||Qe$1==null||Qe$1!==Xa(ur)||(ur=Qe$1,"selectionStart"in ur&&Ne$1(ur)?ur={start:ur.selectionStart,end:ur.selectionEnd}:(ur=(ur.ownerDocument&&ur.ownerDocument.defaultView||window).getSelection(),ur={anchorNode:ur.anchorNode,anchorOffset:ur.anchorOffset,focusNode:ur.focusNode,focusOffset:ur.focusOffset}),Se$1&&Ie$1(Se$1,ur)||(Se$1=ur,ur=oe$1(Re$1,"onSelect"),0<ur.length&&(ar=new td("onSelect","select",null,ar,lr),or.push({event:ar,listeners:ur}),ar.target=Qe$1)))}function Ve$1(or,ar){var lr={};return lr[or.toLowerCase()]=ar.toLowerCase(),lr["Webkit"+or]="webkit"+ar,lr["Moz"+or]="moz"+ar,lr}var We$1={animationend:Ve$1("Animation","AnimationEnd"),animationiteration:Ve$1("Animation","AnimationIteration"),animationstart:Ve$1("Animation","AnimationStart"),transitionend:Ve$1("Transition","TransitionEnd")},Xe$1={},Ye$1={};ia&&(Ye$1=document.createElement("div").style,"AnimationEvent"in window||(delete We$1.animationend.animation,delete We$1.animationiteration.animation,delete We$1.animationstart.animation),"TransitionEvent"in window||delete We$1.transitionend.transition);function Ze$1(or){if(Xe$1[or])return Xe$1[or];if(!We$1[or])return or;var ar=We$1[or],lr;for(lr in ar)if(ar.hasOwnProperty(lr)&&lr in Ye$1)return Xe$1[or]=ar[lr];return or}var $e$1=Ze$1("animationend"),af=Ze$1("animationiteration"),bf=Ze$1("animationstart"),cf=Ze$1("transitionend"),df=new Map,ef="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff(or,ar){df.set(or,ar),fa(ar,[or])}for(var gf=0;gf<ef.length;gf++){var hf=ef[gf],jf=hf.toLowerCase(),kf=hf[0].toUpperCase()+hf.slice(1);ff(jf,"on"+kf)}ff($e$1,"onAnimationEnd");ff(af,"onAnimationIteration");ff(bf,"onAnimationStart");ff("dblclick","onDoubleClick");ff("focusin","onFocus");ff("focusout","onBlur");ff(cf,"onTransitionEnd");ha("onMouseEnter",["mouseout","mouseover"]);ha("onMouseLeave",["mouseout","mouseover"]);ha("onPointerEnter",["pointerout","pointerover"]);ha("onPointerLeave",["pointerout","pointerover"]);fa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf));function nf(or,ar,lr){var ur=or.type||"unknown-event";or.currentTarget=lr,Ub(ur,ar,void 0,or),or.currentTarget=null}function se$1(or,ar){ar=(ar&4)!==0;for(var lr=0;lr<or.length;lr++){var ur=or[lr],cr=ur.event;ur=ur.listeners;e:{var hr=void 0;if(ar)for(var dr=ur.length-1;0<=dr;dr--){var fr=ur[dr],pr=fr.instance,vr=fr.currentTarget;if(fr=fr.listener,pr!==hr&&cr.isPropagationStopped())break e;nf(cr,fr,vr),hr=pr}else for(dr=0;dr<ur.length;dr++){if(fr=ur[dr],pr=fr.instance,vr=fr.currentTarget,fr=fr.listener,pr!==hr&&cr.isPropagationStopped())break e;nf(cr,fr,vr),hr=pr}}}if(Qb)throw or=Rb,Qb=!1,Rb=null,or}function D$1(or,ar){var lr=ar[of];lr===void 0&&(lr=ar[of]=new Set);var ur=or+"__bubble";lr.has(ur)||(pf(ar,or,2,!1),lr.add(ur))}function qf(or,ar,lr){var ur=0;ar&&(ur|=4),pf(lr,or,ur,ar)}var rf="_reactListening"+Math.random().toString(36).slice(2);function sf(or){if(!or[rf]){or[rf]=!0,da.forEach(function(lr){lr!=="selectionchange"&&(mf.has(lr)||qf(lr,!1,or),qf(lr,!0,or))});var ar=or.nodeType===9?or:or.ownerDocument;ar===null||ar[rf]||(ar[rf]=!0,qf("selectionchange",!1,ar))}}function pf(or,ar,lr,ur){switch(jd(ar)){case 1:var cr=ed;break;case 4:cr=gd;break;default:cr=fd}lr=cr.bind(null,ar,lr,or),cr=void 0,!Lb||ar!=="touchstart"&&ar!=="touchmove"&&ar!=="wheel"||(cr=!0),ur?cr!==void 0?or.addEventListener(ar,lr,{capture:!0,passive:cr}):or.addEventListener(ar,lr,!0):cr!==void 0?or.addEventListener(ar,lr,{passive:cr}):or.addEventListener(ar,lr,!1)}function hd(or,ar,lr,ur,cr){var hr=ur;if(!(ar&1)&&!(ar&2)&&ur!==null)e:for(;;){if(ur===null)return;var dr=ur.tag;if(dr===3||dr===4){var fr=ur.stateNode.containerInfo;if(fr===cr||fr.nodeType===8&&fr.parentNode===cr)break;if(dr===4)for(dr=ur.return;dr!==null;){var pr=dr.tag;if((pr===3||pr===4)&&(pr=dr.stateNode.containerInfo,pr===cr||pr.nodeType===8&&pr.parentNode===cr))return;dr=dr.return}for(;fr!==null;){if(dr=Wc(fr),dr===null)return;if(pr=dr.tag,pr===5||pr===6){ur=hr=dr;continue e}fr=fr.parentNode}}ur=ur.return}Jb(function(){var vr=hr,gr=xb(lr),mr=[];e:{var br=df.get(or);if(br!==void 0){var yr=td,xr=or;switch(or){case"keypress":if(od(lr)===0)break e;case"keydown":case"keyup":yr=Rd;break;case"focusin":xr="focus",yr=Fd;break;case"focusout":xr="blur",yr=Fd;break;case"beforeblur":case"afterblur":yr=Fd;break;case"click":if(lr.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":yr=Bd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":yr=Dd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":yr=Vd;break;case $e$1:case af:case bf:yr=Hd;break;case cf:yr=Xd;break;case"scroll":yr=vd;break;case"wheel":yr=Zd;break;case"copy":case"cut":case"paste":yr=Jd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":yr=Td}var Cr=(ar&4)!==0,Sr=!Cr&&or==="scroll",wr=Cr?br!==null?br+"Capture":null:br;Cr=[];for(var Er=vr,Ar;Er!==null;){Ar=Er;var Tr=Ar.stateNode;if(Ar.tag===5&&Tr!==null&&(Ar=Tr,wr!==null&&(Tr=Kb(Er,wr),Tr!=null&&Cr.push(tf(Er,Tr,Ar)))),Sr)break;Er=Er.return}0<Cr.length&&(br=new yr(br,xr,null,lr,gr),mr.push({event:br,listeners:Cr}))}}if(!(ar&7)){e:{if(br=or==="mouseover"||or==="pointerover",yr=or==="mouseout"||or==="pointerout",br&&lr!==wb&&(xr=lr.relatedTarget||lr.fromElement)&&(Wc(xr)||xr[uf]))break e;if((yr||br)&&(br=gr.window===gr?gr:(br=gr.ownerDocument)?br.defaultView||br.parentWindow:window,yr?(xr=lr.relatedTarget||lr.toElement,yr=vr,xr=xr?Wc(xr):null,xr!==null&&(Sr=Vb(xr),xr!==Sr||xr.tag!==5&&xr.tag!==6)&&(xr=null)):(yr=null,xr=vr),yr!==xr)){if(Cr=Bd,Tr="onMouseLeave",wr="onMouseEnter",Er="mouse",(or==="pointerout"||or==="pointerover")&&(Cr=Td,Tr="onPointerLeave",wr="onPointerEnter",Er="pointer"),Sr=yr==null?br:ue$1(yr),Ar=xr==null?br:ue$1(xr),br=new Cr(Tr,Er+"leave",yr,lr,gr),br.target=Sr,br.relatedTarget=Ar,Tr=null,Wc(gr)===vr&&(Cr=new Cr(wr,Er+"enter",xr,lr,gr),Cr.target=Ar,Cr.relatedTarget=Sr,Tr=Cr),Sr=Tr,yr&&xr)t:{for(Cr=yr,wr=xr,Er=0,Ar=Cr;Ar;Ar=vf(Ar))Er++;for(Ar=0,Tr=wr;Tr;Tr=vf(Tr))Ar++;for(;0<Er-Ar;)Cr=vf(Cr),Er--;for(;0<Ar-Er;)wr=vf(wr),Ar--;for(;Er--;){if(Cr===wr||wr!==null&&Cr===wr.alternate)break t;Cr=vf(Cr),wr=vf(wr)}Cr=null}else Cr=null;yr!==null&&wf(mr,br,yr,Cr,!1),xr!==null&&Sr!==null&&wf(mr,Sr,xr,Cr,!0)}}e:{if(br=vr?ue$1(vr):window,yr=br.nodeName&&br.nodeName.toLowerCase(),yr==="select"||yr==="input"&&br.type==="file")var Rr=ve$1;else if(me$1(br))if(we$1)Rr=Fe$1;else{Rr=De$1;var Pr=Ce$1}else(yr=br.nodeName)&&yr.toLowerCase()==="input"&&(br.type==="checkbox"||br.type==="radio")&&(Rr=Ee$1);if(Rr&&(Rr=Rr(or,vr))){ne$1(mr,Rr,lr,gr);break e}Pr&&Pr(or,br,vr),or==="focusout"&&(Pr=br._wrapperState)&&Pr.controlled&&br.type==="number"&&cb(br,"number",br.value)}switch(Pr=vr?ue$1(vr):window,or){case"focusin":(me$1(Pr)||Pr.contentEditable==="true")&&(Qe$1=Pr,Re$1=vr,Se$1=null);break;case"focusout":Se$1=Re$1=Qe$1=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue$1(mr,lr,gr);break;case"selectionchange":if(Pe$1)break;case"keydown":case"keyup":Ue$1(mr,lr,gr)}var _r;if(ae$1)e:{switch(or){case"compositionstart":var kr="onCompositionStart";break e;case"compositionend":kr="onCompositionEnd";break e;case"compositionupdate":kr="onCompositionUpdate";break e}kr=void 0}else ie$1?ge$1(or,lr)&&(kr="onCompositionEnd"):or==="keydown"&&lr.keyCode===229&&(kr="onCompositionStart");kr&&(de$1&&lr.locale!=="ko"&&(ie$1||kr!=="onCompositionStart"?kr==="onCompositionEnd"&&ie$1&&(_r=nd()):(kd=gr,ld="value"in kd?kd.value:kd.textContent,ie$1=!0)),Pr=oe$1(vr,kr),0<Pr.length&&(kr=new Ld(kr,or,null,lr,gr),mr.push({event:kr,listeners:Pr}),_r?kr.data=_r:(_r=he$1(lr),_r!==null&&(kr.data=_r)))),(_r=ce$1?je$1(or,lr):ke$1(or,lr))&&(vr=oe$1(vr,"onBeforeInput"),0<vr.length&&(gr=new Ld("onBeforeInput","beforeinput",null,lr,gr),mr.push({event:gr,listeners:vr}),gr.data=_r))}se$1(mr,ar)})}function tf(or,ar,lr){return{instance:or,listener:ar,currentTarget:lr}}function oe$1(or,ar){for(var lr=ar+"Capture",ur=[];or!==null;){var cr=or,hr=cr.stateNode;cr.tag===5&&hr!==null&&(cr=hr,hr=Kb(or,lr),hr!=null&&ur.unshift(tf(or,hr,cr)),hr=Kb(or,ar),hr!=null&&ur.push(tf(or,hr,cr))),or=or.return}return ur}function vf(or){if(or===null)return null;do or=or.return;while(or&&or.tag!==5);return or||null}function wf(or,ar,lr,ur,cr){for(var hr=ar._reactName,dr=[];lr!==null&&lr!==ur;){var fr=lr,pr=fr.alternate,vr=fr.stateNode;if(pr!==null&&pr===ur)break;fr.tag===5&&vr!==null&&(fr=vr,cr?(pr=Kb(lr,hr),pr!=null&&dr.unshift(tf(lr,pr,fr))):cr||(pr=Kb(lr,hr),pr!=null&&dr.push(tf(lr,pr,fr)))),lr=lr.return}dr.length!==0&&or.push({event:ar,listeners:dr})}var xf=/\r\n?/g,yf=/\u0000|\uFFFD/g;function zf(or){return(typeof or=="string"?or:""+or).replace(xf,`
`).replace(yf,"")}function Af(or,ar,lr){if(ar=zf(ar),zf(or)!==ar&&lr)throw Error(p$2(425))}function Bf(){}var Cf=null,Df=null;function Ef(or,ar){return or==="textarea"||or==="noscript"||typeof ar.children=="string"||typeof ar.children=="number"||typeof ar.dangerouslySetInnerHTML=="object"&&ar.dangerouslySetInnerHTML!==null&&ar.dangerouslySetInnerHTML.__html!=null}var Ff=typeof setTimeout=="function"?setTimeout:void 0,Gf=typeof clearTimeout=="function"?clearTimeout:void 0,Hf=typeof Promise=="function"?Promise:void 0,Jf=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf<"u"?function(or){return Hf.resolve(null).then(or).catch(If)}:Ff;function If(or){setTimeout(function(){throw or})}function Kf(or,ar){var lr=ar,ur=0;do{var cr=lr.nextSibling;if(or.removeChild(lr),cr&&cr.nodeType===8)if(lr=cr.data,lr==="/$"){if(ur===0){or.removeChild(cr),bd(ar);return}ur--}else lr!=="$"&&lr!=="$?"&&lr!=="$!"||ur++;lr=cr}while(lr);bd(ar)}function Lf(or){for(;or!=null;or=or.nextSibling){var ar=or.nodeType;if(ar===1||ar===3)break;if(ar===8){if(ar=or.data,ar==="$"||ar==="$!"||ar==="$?")break;if(ar==="/$")return null}}return or}function Mf(or){or=or.previousSibling;for(var ar=0;or;){if(or.nodeType===8){var lr=or.data;if(lr==="$"||lr==="$!"||lr==="$?"){if(ar===0)return or;ar--}else lr==="/$"&&ar++}or=or.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),Of="__reactFiber$"+Nf,Pf="__reactProps$"+Nf,uf="__reactContainer$"+Nf,of="__reactEvents$"+Nf,Qf="__reactListeners$"+Nf,Rf="__reactHandles$"+Nf;function Wc(or){var ar=or[Of];if(ar)return ar;for(var lr=or.parentNode;lr;){if(ar=lr[uf]||lr[Of]){if(lr=ar.alternate,ar.child!==null||lr!==null&&lr.child!==null)for(or=Mf(or);or!==null;){if(lr=or[Of])return lr;or=Mf(or)}return ar}or=lr,lr=or.parentNode}return null}function Cb(or){return or=or[Of]||or[uf],!or||or.tag!==5&&or.tag!==6&&or.tag!==13&&or.tag!==3?null:or}function ue$1(or){if(or.tag===5||or.tag===6)return or.stateNode;throw Error(p$2(33))}function Db(or){return or[Pf]||null}var Sf=[],Tf=-1;function Uf(or){return{current:or}}function E$1(or){0>Tf||(or.current=Sf[Tf],Sf[Tf]=null,Tf--)}function G$1(or,ar){Tf++,Sf[Tf]=or.current,or.current=ar}var Vf={},H$1=Uf(Vf),Wf=Uf(!1),Xf=Vf;function Yf(or,ar){var lr=or.type.contextTypes;if(!lr)return Vf;var ur=or.stateNode;if(ur&&ur.__reactInternalMemoizedUnmaskedChildContext===ar)return ur.__reactInternalMemoizedMaskedChildContext;var cr={},hr;for(hr in lr)cr[hr]=ar[hr];return ur&&(or=or.stateNode,or.__reactInternalMemoizedUnmaskedChildContext=ar,or.__reactInternalMemoizedMaskedChildContext=cr),cr}function Zf(or){return or=or.childContextTypes,or!=null}function $f(){E$1(Wf),E$1(H$1)}function ag(or,ar,lr){if(H$1.current!==Vf)throw Error(p$2(168));G$1(H$1,ar),G$1(Wf,lr)}function bg(or,ar,lr){var ur=or.stateNode;if(ar=ar.childContextTypes,typeof ur.getChildContext!="function")return lr;ur=ur.getChildContext();for(var cr in ur)if(!(cr in ar))throw Error(p$2(108,Ra(or)||"Unknown",cr));return A$1({},lr,ur)}function cg(or){return or=(or=or.stateNode)&&or.__reactInternalMemoizedMergedChildContext||Vf,Xf=H$1.current,G$1(H$1,or),G$1(Wf,Wf.current),!0}function dg(or,ar,lr){var ur=or.stateNode;if(!ur)throw Error(p$2(169));lr?(or=bg(or,ar,Xf),ur.__reactInternalMemoizedMergedChildContext=or,E$1(Wf),E$1(H$1),G$1(H$1,or)):E$1(Wf),G$1(Wf,lr)}var eg=null,fg=!1,gg=!1;function hg(or){eg===null?eg=[or]:eg.push(or)}function ig(or){fg=!0,hg(or)}function jg(){if(!gg&&eg!==null){gg=!0;var or=0,ar=C$1;try{var lr=eg;for(C$1=1;or<lr.length;or++){var ur=lr[or];do ur=ur(!0);while(ur!==null)}eg=null,fg=!1}catch(cr){throw eg!==null&&(eg=eg.slice(or+1)),ac(fc,jg),cr}finally{C$1=ar,gg=!1}}return null}var kg=[],lg=0,mg=null,ng=0,og=[],pg=0,qg=null,rg=1,sg="";function tg(or,ar){kg[lg++]=ng,kg[lg++]=mg,mg=or,ng=ar}function ug(or,ar,lr){og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,qg=or;var ur=rg;or=sg;var cr=32-oc(ur)-1;ur&=~(1<<cr),lr+=1;var hr=32-oc(ar)+cr;if(30<hr){var dr=cr-cr%5;hr=(ur&(1<<dr)-1).toString(32),ur>>=dr,cr-=dr,rg=1<<32-oc(ar)+cr|lr<<cr|ur,sg=hr+or}else rg=1<<hr|lr<<cr|ur,sg=or}function vg(or){or.return!==null&&(tg(or,1),ug(or,1,0))}function wg(or){for(;or===mg;)mg=kg[--lg],kg[lg]=null,ng=kg[--lg],kg[lg]=null;for(;or===qg;)qg=og[--pg],og[pg]=null,sg=og[--pg],og[pg]=null,rg=og[--pg],og[pg]=null}var xg=null,yg=null,I$1=!1,zg=null;function Ag(or,ar){var lr=Bg(5,null,null,0);lr.elementType="DELETED",lr.stateNode=ar,lr.return=or,ar=or.deletions,ar===null?(or.deletions=[lr],or.flags|=16):ar.push(lr)}function Cg(or,ar){switch(or.tag){case 5:var lr=or.type;return ar=ar.nodeType!==1||lr.toLowerCase()!==ar.nodeName.toLowerCase()?null:ar,ar!==null?(or.stateNode=ar,xg=or,yg=Lf(ar.firstChild),!0):!1;case 6:return ar=or.pendingProps===""||ar.nodeType!==3?null:ar,ar!==null?(or.stateNode=ar,xg=or,yg=null,!0):!1;case 13:return ar=ar.nodeType!==8?null:ar,ar!==null?(lr=qg!==null?{id:rg,overflow:sg}:null,or.memoizedState={dehydrated:ar,treeContext:lr,retryLane:1073741824},lr=Bg(18,null,null,0),lr.stateNode=ar,lr.return=or,or.child=lr,xg=or,yg=null,!0):!1;default:return!1}}function Dg(or){return(or.mode&1)!==0&&(or.flags&128)===0}function Eg(or){if(I$1){var ar=yg;if(ar){var lr=ar;if(!Cg(or,ar)){if(Dg(or))throw Error(p$2(418));ar=Lf(lr.nextSibling);var ur=xg;ar&&Cg(or,ar)?Ag(ur,lr):(or.flags=or.flags&-4097|2,I$1=!1,xg=or)}}else{if(Dg(or))throw Error(p$2(418));or.flags=or.flags&-4097|2,I$1=!1,xg=or}}}function Fg(or){for(or=or.return;or!==null&&or.tag!==5&&or.tag!==3&&or.tag!==13;)or=or.return;xg=or}function Gg(or){if(or!==xg)return!1;if(!I$1)return Fg(or),I$1=!0,!1;var ar;if((ar=or.tag!==3)&&!(ar=or.tag!==5)&&(ar=or.type,ar=ar!=="head"&&ar!=="body"&&!Ef(or.type,or.memoizedProps)),ar&&(ar=yg)){if(Dg(or))throw Hg(),Error(p$2(418));for(;ar;)Ag(or,ar),ar=Lf(ar.nextSibling)}if(Fg(or),or.tag===13){if(or=or.memoizedState,or=or!==null?or.dehydrated:null,!or)throw Error(p$2(317));e:{for(or=or.nextSibling,ar=0;or;){if(or.nodeType===8){var lr=or.data;if(lr==="/$"){if(ar===0){yg=Lf(or.nextSibling);break e}ar--}else lr!=="$"&&lr!=="$!"&&lr!=="$?"||ar++}or=or.nextSibling}yg=null}}else yg=xg?Lf(or.stateNode.nextSibling):null;return!0}function Hg(){for(var or=yg;or;)or=Lf(or.nextSibling)}function Ig(){yg=xg=null,I$1=!1}function Jg(or){zg===null?zg=[or]:zg.push(or)}var Kg=ua.ReactCurrentBatchConfig;function Lg(or,ar,lr){if(or=lr.ref,or!==null&&typeof or!="function"&&typeof or!="object"){if(lr._owner){if(lr=lr._owner,lr){if(lr.tag!==1)throw Error(p$2(309));var ur=lr.stateNode}if(!ur)throw Error(p$2(147,or));var cr=ur,hr=""+or;return ar!==null&&ar.ref!==null&&typeof ar.ref=="function"&&ar.ref._stringRef===hr?ar.ref:(ar=function(dr){var fr=cr.refs;dr===null?delete fr[hr]:fr[hr]=dr},ar._stringRef=hr,ar)}if(typeof or!="string")throw Error(p$2(284));if(!lr._owner)throw Error(p$2(290,or))}return or}function Mg(or,ar){throw or=Object.prototype.toString.call(ar),Error(p$2(31,or==="[object Object]"?"object with keys {"+Object.keys(ar).join(", ")+"}":or))}function Ng(or){var ar=or._init;return ar(or._payload)}function Og(or){function ar(wr,Er){if(or){var Ar=wr.deletions;Ar===null?(wr.deletions=[Er],wr.flags|=16):Ar.push(Er)}}function lr(wr,Er){if(!or)return null;for(;Er!==null;)ar(wr,Er),Er=Er.sibling;return null}function ur(wr,Er){for(wr=new Map;Er!==null;)Er.key!==null?wr.set(Er.key,Er):wr.set(Er.index,Er),Er=Er.sibling;return wr}function cr(wr,Er){return wr=Pg(wr,Er),wr.index=0,wr.sibling=null,wr}function hr(wr,Er,Ar){return wr.index=Ar,or?(Ar=wr.alternate,Ar!==null?(Ar=Ar.index,Ar<Er?(wr.flags|=2,Er):Ar):(wr.flags|=2,Er)):(wr.flags|=1048576,Er)}function dr(wr){return or&&wr.alternate===null&&(wr.flags|=2),wr}function fr(wr,Er,Ar,Tr){return Er===null||Er.tag!==6?(Er=Qg(Ar,wr.mode,Tr),Er.return=wr,Er):(Er=cr(Er,Ar),Er.return=wr,Er)}function pr(wr,Er,Ar,Tr){var Rr=Ar.type;return Rr===ya?gr(wr,Er,Ar.props.children,Tr,Ar.key):Er!==null&&(Er.elementType===Rr||typeof Rr=="object"&&Rr!==null&&Rr.$$typeof===Ha&&Ng(Rr)===Er.type)?(Tr=cr(Er,Ar.props),Tr.ref=Lg(wr,Er,Ar),Tr.return=wr,Tr):(Tr=Rg(Ar.type,Ar.key,Ar.props,null,wr.mode,Tr),Tr.ref=Lg(wr,Er,Ar),Tr.return=wr,Tr)}function vr(wr,Er,Ar,Tr){return Er===null||Er.tag!==4||Er.stateNode.containerInfo!==Ar.containerInfo||Er.stateNode.implementation!==Ar.implementation?(Er=Sg(Ar,wr.mode,Tr),Er.return=wr,Er):(Er=cr(Er,Ar.children||[]),Er.return=wr,Er)}function gr(wr,Er,Ar,Tr,Rr){return Er===null||Er.tag!==7?(Er=Tg(Ar,wr.mode,Tr,Rr),Er.return=wr,Er):(Er=cr(Er,Ar),Er.return=wr,Er)}function mr(wr,Er,Ar){if(typeof Er=="string"&&Er!==""||typeof Er=="number")return Er=Qg(""+Er,wr.mode,Ar),Er.return=wr,Er;if(typeof Er=="object"&&Er!==null){switch(Er.$$typeof){case va:return Ar=Rg(Er.type,Er.key,Er.props,null,wr.mode,Ar),Ar.ref=Lg(wr,null,Er),Ar.return=wr,Ar;case wa:return Er=Sg(Er,wr.mode,Ar),Er.return=wr,Er;case Ha:var Tr=Er._init;return mr(wr,Tr(Er._payload),Ar)}if(eb(Er)||Ka(Er))return Er=Tg(Er,wr.mode,Ar,null),Er.return=wr,Er;Mg(wr,Er)}return null}function br(wr,Er,Ar,Tr){var Rr=Er!==null?Er.key:null;if(typeof Ar=="string"&&Ar!==""||typeof Ar=="number")return Rr!==null?null:fr(wr,Er,""+Ar,Tr);if(typeof Ar=="object"&&Ar!==null){switch(Ar.$$typeof){case va:return Ar.key===Rr?pr(wr,Er,Ar,Tr):null;case wa:return Ar.key===Rr?vr(wr,Er,Ar,Tr):null;case Ha:return Rr=Ar._init,br(wr,Er,Rr(Ar._payload),Tr)}if(eb(Ar)||Ka(Ar))return Rr!==null?null:gr(wr,Er,Ar,Tr,null);Mg(wr,Ar)}return null}function yr(wr,Er,Ar,Tr,Rr){if(typeof Tr=="string"&&Tr!==""||typeof Tr=="number")return wr=wr.get(Ar)||null,fr(Er,wr,""+Tr,Rr);if(typeof Tr=="object"&&Tr!==null){switch(Tr.$$typeof){case va:return wr=wr.get(Tr.key===null?Ar:Tr.key)||null,pr(Er,wr,Tr,Rr);case wa:return wr=wr.get(Tr.key===null?Ar:Tr.key)||null,vr(Er,wr,Tr,Rr);case Ha:var Pr=Tr._init;return yr(wr,Er,Ar,Pr(Tr._payload),Rr)}if(eb(Tr)||Ka(Tr))return wr=wr.get(Ar)||null,gr(Er,wr,Tr,Rr,null);Mg(Er,Tr)}return null}function xr(wr,Er,Ar,Tr){for(var Rr=null,Pr=null,_r=Er,kr=Er=0,Dr=null;_r!==null&&kr<Ar.length;kr++){_r.index>kr?(Dr=_r,_r=null):Dr=_r.sibling;var Nr=br(wr,_r,Ar[kr],Tr);if(Nr===null){_r===null&&(_r=Dr);break}or&&_r&&Nr.alternate===null&&ar(wr,_r),Er=hr(Nr,Er,kr),Pr===null?Rr=Nr:Pr.sibling=Nr,Pr=Nr,_r=Dr}if(kr===Ar.length)return lr(wr,_r),I$1&&tg(wr,kr),Rr;if(_r===null){for(;kr<Ar.length;kr++)_r=mr(wr,Ar[kr],Tr),_r!==null&&(Er=hr(_r,Er,kr),Pr===null?Rr=_r:Pr.sibling=_r,Pr=_r);return I$1&&tg(wr,kr),Rr}for(_r=ur(wr,_r);kr<Ar.length;kr++)Dr=yr(_r,wr,kr,Ar[kr],Tr),Dr!==null&&(or&&Dr.alternate!==null&&_r.delete(Dr.key===null?kr:Dr.key),Er=hr(Dr,Er,kr),Pr===null?Rr=Dr:Pr.sibling=Dr,Pr=Dr);return or&&_r.forEach(function(Lr){return ar(wr,Lr)}),I$1&&tg(wr,kr),Rr}function Cr(wr,Er,Ar,Tr){var Rr=Ka(Ar);if(typeof Rr!="function")throw Error(p$2(150));if(Ar=Rr.call(Ar),Ar==null)throw Error(p$2(151));for(var Pr=Rr=null,_r=Er,kr=Er=0,Dr=null,Nr=Ar.next();_r!==null&&!Nr.done;kr++,Nr=Ar.next()){_r.index>kr?(Dr=_r,_r=null):Dr=_r.sibling;var Lr=br(wr,_r,Nr.value,Tr);if(Lr===null){_r===null&&(_r=Dr);break}or&&_r&&Lr.alternate===null&&ar(wr,_r),Er=hr(Lr,Er,kr),Pr===null?Rr=Lr:Pr.sibling=Lr,Pr=Lr,_r=Dr}if(Nr.done)return lr(wr,_r),I$1&&tg(wr,kr),Rr;if(_r===null){for(;!Nr.done;kr++,Nr=Ar.next())Nr=mr(wr,Nr.value,Tr),Nr!==null&&(Er=hr(Nr,Er,kr),Pr===null?Rr=Nr:Pr.sibling=Nr,Pr=Nr);return I$1&&tg(wr,kr),Rr}for(_r=ur(wr,_r);!Nr.done;kr++,Nr=Ar.next())Nr=yr(_r,wr,kr,Nr.value,Tr),Nr!==null&&(or&&Nr.alternate!==null&&_r.delete(Nr.key===null?kr:Nr.key),Er=hr(Nr,Er,kr),Pr===null?Rr=Nr:Pr.sibling=Nr,Pr=Nr);return or&&_r.forEach(function(Or){return ar(wr,Or)}),I$1&&tg(wr,kr),Rr}function Sr(wr,Er,Ar,Tr){if(typeof Ar=="object"&&Ar!==null&&Ar.type===ya&&Ar.key===null&&(Ar=Ar.props.children),typeof Ar=="object"&&Ar!==null){switch(Ar.$$typeof){case va:e:{for(var Rr=Ar.key,Pr=Er;Pr!==null;){if(Pr.key===Rr){if(Rr=Ar.type,Rr===ya){if(Pr.tag===7){lr(wr,Pr.sibling),Er=cr(Pr,Ar.props.children),Er.return=wr,wr=Er;break e}}else if(Pr.elementType===Rr||typeof Rr=="object"&&Rr!==null&&Rr.$$typeof===Ha&&Ng(Rr)===Pr.type){lr(wr,Pr.sibling),Er=cr(Pr,Ar.props),Er.ref=Lg(wr,Pr,Ar),Er.return=wr,wr=Er;break e}lr(wr,Pr);break}else ar(wr,Pr);Pr=Pr.sibling}Ar.type===ya?(Er=Tg(Ar.props.children,wr.mode,Tr,Ar.key),Er.return=wr,wr=Er):(Tr=Rg(Ar.type,Ar.key,Ar.props,null,wr.mode,Tr),Tr.ref=Lg(wr,Er,Ar),Tr.return=wr,wr=Tr)}return dr(wr);case wa:e:{for(Pr=Ar.key;Er!==null;){if(Er.key===Pr)if(Er.tag===4&&Er.stateNode.containerInfo===Ar.containerInfo&&Er.stateNode.implementation===Ar.implementation){lr(wr,Er.sibling),Er=cr(Er,Ar.children||[]),Er.return=wr,wr=Er;break e}else{lr(wr,Er);break}else ar(wr,Er);Er=Er.sibling}Er=Sg(Ar,wr.mode,Tr),Er.return=wr,wr=Er}return dr(wr);case Ha:return Pr=Ar._init,Sr(wr,Er,Pr(Ar._payload),Tr)}if(eb(Ar))return xr(wr,Er,Ar,Tr);if(Ka(Ar))return Cr(wr,Er,Ar,Tr);Mg(wr,Ar)}return typeof Ar=="string"&&Ar!==""||typeof Ar=="number"?(Ar=""+Ar,Er!==null&&Er.tag===6?(lr(wr,Er.sibling),Er=cr(Er,Ar),Er.return=wr,wr=Er):(lr(wr,Er),Er=Qg(Ar,wr.mode,Tr),Er.return=wr,wr=Er),dr(wr)):lr(wr,Er)}return Sr}var Ug=Og(!0),Vg=Og(!1),Wg=Uf(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(or){var ar=Wg.current;E$1(Wg),or._currentValue=ar}function bh(or,ar,lr){for(;or!==null;){var ur=or.alternate;if((or.childLanes&ar)!==ar?(or.childLanes|=ar,ur!==null&&(ur.childLanes|=ar)):ur!==null&&(ur.childLanes&ar)!==ar&&(ur.childLanes|=ar),or===lr)break;or=or.return}}function ch(or,ar){Xg=or,Zg=Yg=null,or=or.dependencies,or!==null&&or.firstContext!==null&&(or.lanes&ar&&(dh=!0),or.firstContext=null)}function eh(or){var ar=or._currentValue;if(Zg!==or)if(or={context:or,memoizedValue:ar,next:null},Yg===null){if(Xg===null)throw Error(p$2(308));Yg=or,Xg.dependencies={lanes:0,firstContext:or}}else Yg=Yg.next=or;return ar}var fh=null;function gh(or){fh===null?fh=[or]:fh.push(or)}function hh(or,ar,lr,ur){var cr=ar.interleaved;return cr===null?(lr.next=lr,gh(ar)):(lr.next=cr.next,cr.next=lr),ar.interleaved=lr,ih(or,ur)}function ih(or,ar){or.lanes|=ar;var lr=or.alternate;for(lr!==null&&(lr.lanes|=ar),lr=or,or=or.return;or!==null;)or.childLanes|=ar,lr=or.alternate,lr!==null&&(lr.childLanes|=ar),lr=or,or=or.return;return lr.tag===3?lr.stateNode:null}var jh=!1;function kh(or){or.updateQueue={baseState:or.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh(or,ar){or=or.updateQueue,ar.updateQueue===or&&(ar.updateQueue={baseState:or.baseState,firstBaseUpdate:or.firstBaseUpdate,lastBaseUpdate:or.lastBaseUpdate,shared:or.shared,effects:or.effects})}function mh(or,ar){return{eventTime:or,lane:ar,tag:0,payload:null,callback:null,next:null}}function nh(or,ar,lr){var ur=or.updateQueue;if(ur===null)return null;if(ur=ur.shared,K$2&2){var cr=ur.pending;return cr===null?ar.next=ar:(ar.next=cr.next,cr.next=ar),ur.pending=ar,ih(or,lr)}return cr=ur.interleaved,cr===null?(ar.next=ar,gh(ur)):(ar.next=cr.next,cr.next=ar),ur.interleaved=ar,ih(or,lr)}function oh(or,ar,lr){if(ar=ar.updateQueue,ar!==null&&(ar=ar.shared,(lr&4194240)!==0)){var ur=ar.lanes;ur&=or.pendingLanes,lr|=ur,ar.lanes=lr,Cc(or,lr)}}function ph(or,ar){var lr=or.updateQueue,ur=or.alternate;if(ur!==null&&(ur=ur.updateQueue,lr===ur)){var cr=null,hr=null;if(lr=lr.firstBaseUpdate,lr!==null){do{var dr={eventTime:lr.eventTime,lane:lr.lane,tag:lr.tag,payload:lr.payload,callback:lr.callback,next:null};hr===null?cr=hr=dr:hr=hr.next=dr,lr=lr.next}while(lr!==null);hr===null?cr=hr=ar:hr=hr.next=ar}else cr=hr=ar;lr={baseState:ur.baseState,firstBaseUpdate:cr,lastBaseUpdate:hr,shared:ur.shared,effects:ur.effects},or.updateQueue=lr;return}or=lr.lastBaseUpdate,or===null?lr.firstBaseUpdate=ar:or.next=ar,lr.lastBaseUpdate=ar}function qh(or,ar,lr,ur){var cr=or.updateQueue;jh=!1;var hr=cr.firstBaseUpdate,dr=cr.lastBaseUpdate,fr=cr.shared.pending;if(fr!==null){cr.shared.pending=null;var pr=fr,vr=pr.next;pr.next=null,dr===null?hr=vr:dr.next=vr,dr=pr;var gr=or.alternate;gr!==null&&(gr=gr.updateQueue,fr=gr.lastBaseUpdate,fr!==dr&&(fr===null?gr.firstBaseUpdate=vr:fr.next=vr,gr.lastBaseUpdate=pr))}if(hr!==null){var mr=cr.baseState;dr=0,gr=vr=pr=null,fr=hr;do{var br=fr.lane,yr=fr.eventTime;if((ur&br)===br){gr!==null&&(gr=gr.next={eventTime:yr,lane:0,tag:fr.tag,payload:fr.payload,callback:fr.callback,next:null});e:{var xr=or,Cr=fr;switch(br=ar,yr=lr,Cr.tag){case 1:if(xr=Cr.payload,typeof xr=="function"){mr=xr.call(yr,mr,br);break e}mr=xr;break e;case 3:xr.flags=xr.flags&-65537|128;case 0:if(xr=Cr.payload,br=typeof xr=="function"?xr.call(yr,mr,br):xr,br==null)break e;mr=A$1({},mr,br);break e;case 2:jh=!0}}fr.callback!==null&&fr.lane!==0&&(or.flags|=64,br=cr.effects,br===null?cr.effects=[fr]:br.push(fr))}else yr={eventTime:yr,lane:br,tag:fr.tag,payload:fr.payload,callback:fr.callback,next:null},gr===null?(vr=gr=yr,pr=mr):gr=gr.next=yr,dr|=br;if(fr=fr.next,fr===null){if(fr=cr.shared.pending,fr===null)break;br=fr,fr=br.next,br.next=null,cr.lastBaseUpdate=br,cr.shared.pending=null}}while(!0);if(gr===null&&(pr=mr),cr.baseState=pr,cr.firstBaseUpdate=vr,cr.lastBaseUpdate=gr,ar=cr.shared.interleaved,ar!==null){cr=ar;do dr|=cr.lane,cr=cr.next;while(cr!==ar)}else hr===null&&(cr.shared.lanes=0);rh|=dr,or.lanes=dr,or.memoizedState=mr}}function sh(or,ar,lr){if(or=ar.effects,ar.effects=null,or!==null)for(ar=0;ar<or.length;ar++){var ur=or[ar],cr=ur.callback;if(cr!==null){if(ur.callback=null,ur=lr,typeof cr!="function")throw Error(p$2(191,cr));cr.call(ur)}}}var th={},uh=Uf(th),vh=Uf(th),wh=Uf(th);function xh(or){if(or===th)throw Error(p$2(174));return or}function yh(or,ar){switch(G$1(wh,ar),G$1(vh,or),G$1(uh,th),or=ar.nodeType,or){case 9:case 11:ar=(ar=ar.documentElement)?ar.namespaceURI:lb(null,"");break;default:or=or===8?ar.parentNode:ar,ar=or.namespaceURI||null,or=or.tagName,ar=lb(ar,or)}E$1(uh),G$1(uh,ar)}function zh(){E$1(uh),E$1(vh),E$1(wh)}function Ah(or){xh(wh.current);var ar=xh(uh.current),lr=lb(ar,or.type);ar!==lr&&(G$1(vh,or),G$1(uh,lr))}function Bh(or){vh.current===or&&(E$1(uh),E$1(vh))}var L$1=Uf(0);function Ch(or){for(var ar=or;ar!==null;){if(ar.tag===13){var lr=ar.memoizedState;if(lr!==null&&(lr=lr.dehydrated,lr===null||lr.data==="$?"||lr.data==="$!"))return ar}else if(ar.tag===19&&ar.memoizedProps.revealOrder!==void 0){if(ar.flags&128)return ar}else if(ar.child!==null){ar.child.return=ar,ar=ar.child;continue}if(ar===or)break;for(;ar.sibling===null;){if(ar.return===null||ar.return===or)return null;ar=ar.return}ar.sibling.return=ar.return,ar=ar.sibling}return null}var Dh=[];function Eh(){for(var or=0;or<Dh.length;or++)Dh[or]._workInProgressVersionPrimary=null;Dh.length=0}var Fh=ua.ReactCurrentDispatcher,Gh=ua.ReactCurrentBatchConfig,Hh=0,M$1=null,N$1=null,O$1=null,Ih=!1,Jh=!1,Kh=0,Lh=0;function P$1(){throw Error(p$2(321))}function Mh(or,ar){if(ar===null)return!1;for(var lr=0;lr<ar.length&&lr<or.length;lr++)if(!He$1(or[lr],ar[lr]))return!1;return!0}function Nh(or,ar,lr,ur,cr,hr){if(Hh=hr,M$1=ar,ar.memoizedState=null,ar.updateQueue=null,ar.lanes=0,Fh.current=or===null||or.memoizedState===null?Oh:Ph,or=lr(ur,cr),Jh){hr=0;do{if(Jh=!1,Kh=0,25<=hr)throw Error(p$2(301));hr+=1,O$1=N$1=null,ar.updateQueue=null,Fh.current=Qh,or=lr(ur,cr)}while(Jh)}if(Fh.current=Rh,ar=N$1!==null&&N$1.next!==null,Hh=0,O$1=N$1=M$1=null,Ih=!1,ar)throw Error(p$2(300));return or}function Sh(){var or=Kh!==0;return Kh=0,or}function Th(){var or={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M$1.memoizedState=O$1=or:O$1=O$1.next=or,O$1}function Uh(){if(N$1===null){var or=M$1.alternate;or=or!==null?or.memoizedState:null}else or=N$1.next;var ar=O$1===null?M$1.memoizedState:O$1.next;if(ar!==null)O$1=ar,N$1=or;else{if(or===null)throw Error(p$2(310));N$1=or,or={memoizedState:N$1.memoizedState,baseState:N$1.baseState,baseQueue:N$1.baseQueue,queue:N$1.queue,next:null},O$1===null?M$1.memoizedState=O$1=or:O$1=O$1.next=or}return O$1}function Vh(or,ar){return typeof ar=="function"?ar(or):ar}function Wh(or){var ar=Uh(),lr=ar.queue;if(lr===null)throw Error(p$2(311));lr.lastRenderedReducer=or;var ur=N$1,cr=ur.baseQueue,hr=lr.pending;if(hr!==null){if(cr!==null){var dr=cr.next;cr.next=hr.next,hr.next=dr}ur.baseQueue=cr=hr,lr.pending=null}if(cr!==null){hr=cr.next,ur=ur.baseState;var fr=dr=null,pr=null,vr=hr;do{var gr=vr.lane;if((Hh&gr)===gr)pr!==null&&(pr=pr.next={lane:0,action:vr.action,hasEagerState:vr.hasEagerState,eagerState:vr.eagerState,next:null}),ur=vr.hasEagerState?vr.eagerState:or(ur,vr.action);else{var mr={lane:gr,action:vr.action,hasEagerState:vr.hasEagerState,eagerState:vr.eagerState,next:null};pr===null?(fr=pr=mr,dr=ur):pr=pr.next=mr,M$1.lanes|=gr,rh|=gr}vr=vr.next}while(vr!==null&&vr!==hr);pr===null?dr=ur:pr.next=fr,He$1(ur,ar.memoizedState)||(dh=!0),ar.memoizedState=ur,ar.baseState=dr,ar.baseQueue=pr,lr.lastRenderedState=ur}if(or=lr.interleaved,or!==null){cr=or;do hr=cr.lane,M$1.lanes|=hr,rh|=hr,cr=cr.next;while(cr!==or)}else cr===null&&(lr.lanes=0);return[ar.memoizedState,lr.dispatch]}function Xh(or){var ar=Uh(),lr=ar.queue;if(lr===null)throw Error(p$2(311));lr.lastRenderedReducer=or;var ur=lr.dispatch,cr=lr.pending,hr=ar.memoizedState;if(cr!==null){lr.pending=null;var dr=cr=cr.next;do hr=or(hr,dr.action),dr=dr.next;while(dr!==cr);He$1(hr,ar.memoizedState)||(dh=!0),ar.memoizedState=hr,ar.baseQueue===null&&(ar.baseState=hr),lr.lastRenderedState=hr}return[hr,ur]}function Yh(){}function Zh(or,ar){var lr=M$1,ur=Uh(),cr=ar(),hr=!He$1(ur.memoizedState,cr);if(hr&&(ur.memoizedState=cr,dh=!0),ur=ur.queue,$h(ai.bind(null,lr,ur,or),[or]),ur.getSnapshot!==ar||hr||O$1!==null&&O$1.memoizedState.tag&1){if(lr.flags|=2048,bi(9,ci.bind(null,lr,ur,cr,ar),void 0,null),Q$1===null)throw Error(p$2(349));Hh&30||di(lr,ar,cr)}return cr}function di(or,ar,lr){or.flags|=16384,or={getSnapshot:ar,value:lr},ar=M$1.updateQueue,ar===null?(ar={lastEffect:null,stores:null},M$1.updateQueue=ar,ar.stores=[or]):(lr=ar.stores,lr===null?ar.stores=[or]:lr.push(or))}function ci(or,ar,lr,ur){ar.value=lr,ar.getSnapshot=ur,ei(ar)&&fi(or)}function ai(or,ar,lr){return lr(function(){ei(ar)&&fi(or)})}function ei(or){var ar=or.getSnapshot;or=or.value;try{var lr=ar();return!He$1(or,lr)}catch{return!0}}function fi(or){var ar=ih(or,1);ar!==null&&gi(ar,or,1,-1)}function hi(or){var ar=Th();return typeof or=="function"&&(or=or()),ar.memoizedState=ar.baseState=or,or={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh,lastRenderedState:or},ar.queue=or,or=or.dispatch=ii.bind(null,M$1,or),[ar.memoizedState,or]}function bi(or,ar,lr,ur){return or={tag:or,create:ar,destroy:lr,deps:ur,next:null},ar=M$1.updateQueue,ar===null?(ar={lastEffect:null,stores:null},M$1.updateQueue=ar,ar.lastEffect=or.next=or):(lr=ar.lastEffect,lr===null?ar.lastEffect=or.next=or:(ur=lr.next,lr.next=or,or.next=ur,ar.lastEffect=or)),or}function ji(){return Uh().memoizedState}function ki(or,ar,lr,ur){var cr=Th();M$1.flags|=or,cr.memoizedState=bi(1|ar,lr,void 0,ur===void 0?null:ur)}function li(or,ar,lr,ur){var cr=Uh();ur=ur===void 0?null:ur;var hr=void 0;if(N$1!==null){var dr=N$1.memoizedState;if(hr=dr.destroy,ur!==null&&Mh(ur,dr.deps)){cr.memoizedState=bi(ar,lr,hr,ur);return}}M$1.flags|=or,cr.memoizedState=bi(1|ar,lr,hr,ur)}function mi(or,ar){return ki(8390656,8,or,ar)}function $h(or,ar){return li(2048,8,or,ar)}function ni(or,ar){return li(4,2,or,ar)}function oi(or,ar){return li(4,4,or,ar)}function pi(or,ar){if(typeof ar=="function")return or=or(),ar(or),function(){ar(null)};if(ar!=null)return or=or(),ar.current=or,function(){ar.current=null}}function qi(or,ar,lr){return lr=lr!=null?lr.concat([or]):null,li(4,4,pi.bind(null,ar,or),lr)}function ri(){}function si(or,ar){var lr=Uh();ar=ar===void 0?null:ar;var ur=lr.memoizedState;return ur!==null&&ar!==null&&Mh(ar,ur[1])?ur[0]:(lr.memoizedState=[or,ar],or)}function ti(or,ar){var lr=Uh();ar=ar===void 0?null:ar;var ur=lr.memoizedState;return ur!==null&&ar!==null&&Mh(ar,ur[1])?ur[0]:(or=or(),lr.memoizedState=[or,ar],or)}function ui(or,ar,lr){return Hh&21?(He$1(lr,ar)||(lr=yc(),M$1.lanes|=lr,rh|=lr,or.baseState=!0),ar):(or.baseState&&(or.baseState=!1,dh=!0),or.memoizedState=lr)}function vi(or,ar){var lr=C$1;C$1=lr!==0&&4>lr?lr:4,or(!0);var ur=Gh.transition;Gh.transition={};try{or(!1),ar()}finally{C$1=lr,Gh.transition=ur}}function wi(){return Uh().memoizedState}function xi(or,ar,lr){var ur=yi(or);if(lr={lane:ur,action:lr,hasEagerState:!1,eagerState:null,next:null},zi(or))Ai(ar,lr);else if(lr=hh(or,ar,lr,ur),lr!==null){var cr=R$1();gi(lr,or,ur,cr),Bi(lr,ar,ur)}}function ii(or,ar,lr){var ur=yi(or),cr={lane:ur,action:lr,hasEagerState:!1,eagerState:null,next:null};if(zi(or))Ai(ar,cr);else{var hr=or.alternate;if(or.lanes===0&&(hr===null||hr.lanes===0)&&(hr=ar.lastRenderedReducer,hr!==null))try{var dr=ar.lastRenderedState,fr=hr(dr,lr);if(cr.hasEagerState=!0,cr.eagerState=fr,He$1(fr,dr)){var pr=ar.interleaved;pr===null?(cr.next=cr,gh(ar)):(cr.next=pr.next,pr.next=cr),ar.interleaved=cr;return}}catch{}finally{}lr=hh(or,ar,cr,ur),lr!==null&&(cr=R$1(),gi(lr,or,ur,cr),Bi(lr,ar,ur))}}function zi(or){var ar=or.alternate;return or===M$1||ar!==null&&ar===M$1}function Ai(or,ar){Jh=Ih=!0;var lr=or.pending;lr===null?ar.next=ar:(ar.next=lr.next,lr.next=ar),or.pending=ar}function Bi(or,ar,lr){if(lr&4194240){var ur=ar.lanes;ur&=or.pendingLanes,lr|=ur,ar.lanes=lr,Cc(or,lr)}}var Rh={readContext:eh,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh={readContext:eh,useCallback:function(or,ar){return Th().memoizedState=[or,ar===void 0?null:ar],or},useContext:eh,useEffect:mi,useImperativeHandle:function(or,ar,lr){return lr=lr!=null?lr.concat([or]):null,ki(4194308,4,pi.bind(null,ar,or),lr)},useLayoutEffect:function(or,ar){return ki(4194308,4,or,ar)},useInsertionEffect:function(or,ar){return ki(4,2,or,ar)},useMemo:function(or,ar){var lr=Th();return ar=ar===void 0?null:ar,or=or(),lr.memoizedState=[or,ar],or},useReducer:function(or,ar,lr){var ur=Th();return ar=lr!==void 0?lr(ar):ar,ur.memoizedState=ur.baseState=ar,or={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:ar},ur.queue=or,or=or.dispatch=xi.bind(null,M$1,or),[ur.memoizedState,or]},useRef:function(or){var ar=Th();return or={current:or},ar.memoizedState=or},useState:hi,useDebugValue:ri,useDeferredValue:function(or){return Th().memoizedState=or},useTransition:function(){var or=hi(!1),ar=or[0];return or=vi.bind(null,or[1]),Th().memoizedState=or,[ar,or]},useMutableSource:function(){},useSyncExternalStore:function(or,ar,lr){var ur=M$1,cr=Th();if(I$1){if(lr===void 0)throw Error(p$2(407));lr=lr()}else{if(lr=ar(),Q$1===null)throw Error(p$2(349));Hh&30||di(ur,ar,lr)}cr.memoizedState=lr;var hr={value:lr,getSnapshot:ar};return cr.queue=hr,mi(ai.bind(null,ur,hr,or),[or]),ur.flags|=2048,bi(9,ci.bind(null,ur,hr,lr,ar),void 0,null),lr},useId:function(){var or=Th(),ar=Q$1.identifierPrefix;if(I$1){var lr=sg,ur=rg;lr=(ur&~(1<<32-oc(ur)-1)).toString(32)+lr,ar=":"+ar+"R"+lr,lr=Kh++,0<lr&&(ar+="H"+lr.toString(32)),ar+=":"}else lr=Lh++,ar=":"+ar+"r"+lr.toString(32)+":";return or.memoizedState=ar},unstable_isNewReconciler:!1},Ph={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Wh,useRef:ji,useState:function(){return Wh(Vh)},useDebugValue:ri,useDeferredValue:function(or){var ar=Uh();return ui(ar,N$1.memoizedState,or)},useTransition:function(){var or=Wh(Vh)[0],ar=Uh().memoizedState;return[or,ar]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1},Qh={readContext:eh,useCallback:si,useContext:eh,useEffect:$h,useImperativeHandle:qi,useInsertionEffect:ni,useLayoutEffect:oi,useMemo:ti,useReducer:Xh,useRef:ji,useState:function(){return Xh(Vh)},useDebugValue:ri,useDeferredValue:function(or){var ar=Uh();return N$1===null?ar.memoizedState=or:ui(ar,N$1.memoizedState,or)},useTransition:function(){var or=Xh(Vh)[0],ar=Uh().memoizedState;return[or,ar]},useMutableSource:Yh,useSyncExternalStore:Zh,useId:wi,unstable_isNewReconciler:!1};function Ci(or,ar){if(or&&or.defaultProps){ar=A$1({},ar),or=or.defaultProps;for(var lr in or)ar[lr]===void 0&&(ar[lr]=or[lr]);return ar}return ar}function Di(or,ar,lr,ur){ar=or.memoizedState,lr=lr(ur,ar),lr=lr==null?ar:A$1({},ar,lr),or.memoizedState=lr,or.lanes===0&&(or.updateQueue.baseState=lr)}var Ei={isMounted:function(or){return(or=or._reactInternals)?Vb(or)===or:!1},enqueueSetState:function(or,ar,lr){or=or._reactInternals;var ur=R$1(),cr=yi(or),hr=mh(ur,cr);hr.payload=ar,lr!=null&&(hr.callback=lr),ar=nh(or,hr,cr),ar!==null&&(gi(ar,or,cr,ur),oh(ar,or,cr))},enqueueReplaceState:function(or,ar,lr){or=or._reactInternals;var ur=R$1(),cr=yi(or),hr=mh(ur,cr);hr.tag=1,hr.payload=ar,lr!=null&&(hr.callback=lr),ar=nh(or,hr,cr),ar!==null&&(gi(ar,or,cr,ur),oh(ar,or,cr))},enqueueForceUpdate:function(or,ar){or=or._reactInternals;var lr=R$1(),ur=yi(or),cr=mh(lr,ur);cr.tag=2,ar!=null&&(cr.callback=ar),ar=nh(or,cr,ur),ar!==null&&(gi(ar,or,ur,lr),oh(ar,or,ur))}};function Fi(or,ar,lr,ur,cr,hr,dr){return or=or.stateNode,typeof or.shouldComponentUpdate=="function"?or.shouldComponentUpdate(ur,hr,dr):ar.prototype&&ar.prototype.isPureReactComponent?!Ie$1(lr,ur)||!Ie$1(cr,hr):!0}function Gi(or,ar,lr){var ur=!1,cr=Vf,hr=ar.contextType;return typeof hr=="object"&&hr!==null?hr=eh(hr):(cr=Zf(ar)?Xf:H$1.current,ur=ar.contextTypes,hr=(ur=ur!=null)?Yf(or,cr):Vf),ar=new ar(lr,hr),or.memoizedState=ar.state!==null&&ar.state!==void 0?ar.state:null,ar.updater=Ei,or.stateNode=ar,ar._reactInternals=or,ur&&(or=or.stateNode,or.__reactInternalMemoizedUnmaskedChildContext=cr,or.__reactInternalMemoizedMaskedChildContext=hr),ar}function Hi(or,ar,lr,ur){or=ar.state,typeof ar.componentWillReceiveProps=="function"&&ar.componentWillReceiveProps(lr,ur),typeof ar.UNSAFE_componentWillReceiveProps=="function"&&ar.UNSAFE_componentWillReceiveProps(lr,ur),ar.state!==or&&Ei.enqueueReplaceState(ar,ar.state,null)}function Ii(or,ar,lr,ur){var cr=or.stateNode;cr.props=lr,cr.state=or.memoizedState,cr.refs={},kh(or);var hr=ar.contextType;typeof hr=="object"&&hr!==null?cr.context=eh(hr):(hr=Zf(ar)?Xf:H$1.current,cr.context=Yf(or,hr)),cr.state=or.memoizedState,hr=ar.getDerivedStateFromProps,typeof hr=="function"&&(Di(or,ar,hr,lr),cr.state=or.memoizedState),typeof ar.getDerivedStateFromProps=="function"||typeof cr.getSnapshotBeforeUpdate=="function"||typeof cr.UNSAFE_componentWillMount!="function"&&typeof cr.componentWillMount!="function"||(ar=cr.state,typeof cr.componentWillMount=="function"&&cr.componentWillMount(),typeof cr.UNSAFE_componentWillMount=="function"&&cr.UNSAFE_componentWillMount(),ar!==cr.state&&Ei.enqueueReplaceState(cr,cr.state,null),qh(or,lr,cr,ur),cr.state=or.memoizedState),typeof cr.componentDidMount=="function"&&(or.flags|=4194308)}function Ji(or,ar){try{var lr="",ur=ar;do lr+=Pa(ur),ur=ur.return;while(ur);var cr=lr}catch(hr){cr=`
Error generating stack: `+hr.message+`
`+hr.stack}return{value:or,source:ar,stack:cr,digest:null}}function Ki(or,ar,lr){return{value:or,source:null,stack:lr??null,digest:ar??null}}function Li(or,ar){try{console.error(ar.value)}catch(lr){setTimeout(function(){throw lr})}}var Mi=typeof WeakMap=="function"?WeakMap:Map;function Ni(or,ar,lr){lr=mh(-1,lr),lr.tag=3,lr.payload={element:null};var ur=ar.value;return lr.callback=function(){Oi||(Oi=!0,Pi=ur),Li(or,ar)},lr}function Qi(or,ar,lr){lr=mh(-1,lr),lr.tag=3;var ur=or.type.getDerivedStateFromError;if(typeof ur=="function"){var cr=ar.value;lr.payload=function(){return ur(cr)},lr.callback=function(){Li(or,ar)}}var hr=or.stateNode;return hr!==null&&typeof hr.componentDidCatch=="function"&&(lr.callback=function(){Li(or,ar),typeof ur!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var dr=ar.stack;this.componentDidCatch(ar.value,{componentStack:dr!==null?dr:""})}),lr}function Si(or,ar,lr){var ur=or.pingCache;if(ur===null){ur=or.pingCache=new Mi;var cr=new Set;ur.set(ar,cr)}else cr=ur.get(ar),cr===void 0&&(cr=new Set,ur.set(ar,cr));cr.has(lr)||(cr.add(lr),or=Ti.bind(null,or,ar,lr),ar.then(or,or))}function Ui(or){do{var ar;if((ar=or.tag===13)&&(ar=or.memoizedState,ar=ar!==null?ar.dehydrated!==null:!0),ar)return or;or=or.return}while(or!==null);return null}function Vi(or,ar,lr,ur,cr){return or.mode&1?(or.flags|=65536,or.lanes=cr,or):(or===ar?or.flags|=65536:(or.flags|=128,lr.flags|=131072,lr.flags&=-52805,lr.tag===1&&(lr.alternate===null?lr.tag=17:(ar=mh(-1,1),ar.tag=2,nh(lr,ar,1))),lr.lanes|=1),or)}var Wi=ua.ReactCurrentOwner,dh=!1;function Xi(or,ar,lr,ur){ar.child=or===null?Vg(ar,null,lr,ur):Ug(ar,or.child,lr,ur)}function Yi(or,ar,lr,ur,cr){lr=lr.render;var hr=ar.ref;return ch(ar,cr),ur=Nh(or,ar,lr,ur,hr,cr),lr=Sh(),or!==null&&!dh?(ar.updateQueue=or.updateQueue,ar.flags&=-2053,or.lanes&=~cr,Zi(or,ar,cr)):(I$1&&lr&&vg(ar),ar.flags|=1,Xi(or,ar,ur,cr),ar.child)}function $i(or,ar,lr,ur,cr){if(or===null){var hr=lr.type;return typeof hr=="function"&&!aj(hr)&&hr.defaultProps===void 0&&lr.compare===null&&lr.defaultProps===void 0?(ar.tag=15,ar.type=hr,bj(or,ar,hr,ur,cr)):(or=Rg(lr.type,null,ur,ar,ar.mode,cr),or.ref=ar.ref,or.return=ar,ar.child=or)}if(hr=or.child,!(or.lanes&cr)){var dr=hr.memoizedProps;if(lr=lr.compare,lr=lr!==null?lr:Ie$1,lr(dr,ur)&&or.ref===ar.ref)return Zi(or,ar,cr)}return ar.flags|=1,or=Pg(hr,ur),or.ref=ar.ref,or.return=ar,ar.child=or}function bj(or,ar,lr,ur,cr){if(or!==null){var hr=or.memoizedProps;if(Ie$1(hr,ur)&&or.ref===ar.ref)if(dh=!1,ar.pendingProps=ur=hr,(or.lanes&cr)!==0)or.flags&131072&&(dh=!0);else return ar.lanes=or.lanes,Zi(or,ar,cr)}return cj(or,ar,lr,ur,cr)}function dj(or,ar,lr){var ur=ar.pendingProps,cr=ur.children,hr=or!==null?or.memoizedState:null;if(ur.mode==="hidden")if(!(ar.mode&1))ar.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$1(ej,fj),fj|=lr;else{if(!(lr&1073741824))return or=hr!==null?hr.baseLanes|lr:lr,ar.lanes=ar.childLanes=1073741824,ar.memoizedState={baseLanes:or,cachePool:null,transitions:null},ar.updateQueue=null,G$1(ej,fj),fj|=or,null;ar.memoizedState={baseLanes:0,cachePool:null,transitions:null},ur=hr!==null?hr.baseLanes:lr,G$1(ej,fj),fj|=ur}else hr!==null?(ur=hr.baseLanes|lr,ar.memoizedState=null):ur=lr,G$1(ej,fj),fj|=ur;return Xi(or,ar,cr,lr),ar.child}function gj(or,ar){var lr=ar.ref;(or===null&&lr!==null||or!==null&&or.ref!==lr)&&(ar.flags|=512,ar.flags|=2097152)}function cj(or,ar,lr,ur,cr){var hr=Zf(lr)?Xf:H$1.current;return hr=Yf(ar,hr),ch(ar,cr),lr=Nh(or,ar,lr,ur,hr,cr),ur=Sh(),or!==null&&!dh?(ar.updateQueue=or.updateQueue,ar.flags&=-2053,or.lanes&=~cr,Zi(or,ar,cr)):(I$1&&ur&&vg(ar),ar.flags|=1,Xi(or,ar,lr,cr),ar.child)}function hj(or,ar,lr,ur,cr){if(Zf(lr)){var hr=!0;cg(ar)}else hr=!1;if(ch(ar,cr),ar.stateNode===null)ij(or,ar),Gi(ar,lr,ur),Ii(ar,lr,ur,cr),ur=!0;else if(or===null){var dr=ar.stateNode,fr=ar.memoizedProps;dr.props=fr;var pr=dr.context,vr=lr.contextType;typeof vr=="object"&&vr!==null?vr=eh(vr):(vr=Zf(lr)?Xf:H$1.current,vr=Yf(ar,vr));var gr=lr.getDerivedStateFromProps,mr=typeof gr=="function"||typeof dr.getSnapshotBeforeUpdate=="function";mr||typeof dr.UNSAFE_componentWillReceiveProps!="function"&&typeof dr.componentWillReceiveProps!="function"||(fr!==ur||pr!==vr)&&Hi(ar,dr,ur,vr),jh=!1;var br=ar.memoizedState;dr.state=br,qh(ar,ur,dr,cr),pr=ar.memoizedState,fr!==ur||br!==pr||Wf.current||jh?(typeof gr=="function"&&(Di(ar,lr,gr,ur),pr=ar.memoizedState),(fr=jh||Fi(ar,lr,fr,ur,br,pr,vr))?(mr||typeof dr.UNSAFE_componentWillMount!="function"&&typeof dr.componentWillMount!="function"||(typeof dr.componentWillMount=="function"&&dr.componentWillMount(),typeof dr.UNSAFE_componentWillMount=="function"&&dr.UNSAFE_componentWillMount()),typeof dr.componentDidMount=="function"&&(ar.flags|=4194308)):(typeof dr.componentDidMount=="function"&&(ar.flags|=4194308),ar.memoizedProps=ur,ar.memoizedState=pr),dr.props=ur,dr.state=pr,dr.context=vr,ur=fr):(typeof dr.componentDidMount=="function"&&(ar.flags|=4194308),ur=!1)}else{dr=ar.stateNode,lh(or,ar),fr=ar.memoizedProps,vr=ar.type===ar.elementType?fr:Ci(ar.type,fr),dr.props=vr,mr=ar.pendingProps,br=dr.context,pr=lr.contextType,typeof pr=="object"&&pr!==null?pr=eh(pr):(pr=Zf(lr)?Xf:H$1.current,pr=Yf(ar,pr));var yr=lr.getDerivedStateFromProps;(gr=typeof yr=="function"||typeof dr.getSnapshotBeforeUpdate=="function")||typeof dr.UNSAFE_componentWillReceiveProps!="function"&&typeof dr.componentWillReceiveProps!="function"||(fr!==mr||br!==pr)&&Hi(ar,dr,ur,pr),jh=!1,br=ar.memoizedState,dr.state=br,qh(ar,ur,dr,cr);var xr=ar.memoizedState;fr!==mr||br!==xr||Wf.current||jh?(typeof yr=="function"&&(Di(ar,lr,yr,ur),xr=ar.memoizedState),(vr=jh||Fi(ar,lr,vr,ur,br,xr,pr)||!1)?(gr||typeof dr.UNSAFE_componentWillUpdate!="function"&&typeof dr.componentWillUpdate!="function"||(typeof dr.componentWillUpdate=="function"&&dr.componentWillUpdate(ur,xr,pr),typeof dr.UNSAFE_componentWillUpdate=="function"&&dr.UNSAFE_componentWillUpdate(ur,xr,pr)),typeof dr.componentDidUpdate=="function"&&(ar.flags|=4),typeof dr.getSnapshotBeforeUpdate=="function"&&(ar.flags|=1024)):(typeof dr.componentDidUpdate!="function"||fr===or.memoizedProps&&br===or.memoizedState||(ar.flags|=4),typeof dr.getSnapshotBeforeUpdate!="function"||fr===or.memoizedProps&&br===or.memoizedState||(ar.flags|=1024),ar.memoizedProps=ur,ar.memoizedState=xr),dr.props=ur,dr.state=xr,dr.context=pr,ur=vr):(typeof dr.componentDidUpdate!="function"||fr===or.memoizedProps&&br===or.memoizedState||(ar.flags|=4),typeof dr.getSnapshotBeforeUpdate!="function"||fr===or.memoizedProps&&br===or.memoizedState||(ar.flags|=1024),ur=!1)}return jj(or,ar,lr,ur,hr,cr)}function jj(or,ar,lr,ur,cr,hr){gj(or,ar);var dr=(ar.flags&128)!==0;if(!ur&&!dr)return cr&&dg(ar,lr,!1),Zi(or,ar,hr);ur=ar.stateNode,Wi.current=ar;var fr=dr&&typeof lr.getDerivedStateFromError!="function"?null:ur.render();return ar.flags|=1,or!==null&&dr?(ar.child=Ug(ar,or.child,null,hr),ar.child=Ug(ar,null,fr,hr)):Xi(or,ar,fr,hr),ar.memoizedState=ur.state,cr&&dg(ar,lr,!0),ar.child}function kj(or){var ar=or.stateNode;ar.pendingContext?ag(or,ar.pendingContext,ar.pendingContext!==ar.context):ar.context&&ag(or,ar.context,!1),yh(or,ar.containerInfo)}function lj(or,ar,lr,ur,cr){return Ig(),Jg(cr),ar.flags|=256,Xi(or,ar,lr,ur),ar.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(or){return{baseLanes:or,cachePool:null,transitions:null}}function oj(or,ar,lr){var ur=ar.pendingProps,cr=L$1.current,hr=!1,dr=(ar.flags&128)!==0,fr;if((fr=dr)||(fr=or!==null&&or.memoizedState===null?!1:(cr&2)!==0),fr?(hr=!0,ar.flags&=-129):(or===null||or.memoizedState!==null)&&(cr|=1),G$1(L$1,cr&1),or===null)return Eg(ar),or=ar.memoizedState,or!==null&&(or=or.dehydrated,or!==null)?(ar.mode&1?or.data==="$!"?ar.lanes=8:ar.lanes=1073741824:ar.lanes=1,null):(dr=ur.children,or=ur.fallback,hr?(ur=ar.mode,hr=ar.child,dr={mode:"hidden",children:dr},!(ur&1)&&hr!==null?(hr.childLanes=0,hr.pendingProps=dr):hr=pj(dr,ur,0,null),or=Tg(or,ur,lr,null),hr.return=ar,or.return=ar,hr.sibling=or,ar.child=hr,ar.child.memoizedState=nj(lr),ar.memoizedState=mj,or):qj(ar,dr));if(cr=or.memoizedState,cr!==null&&(fr=cr.dehydrated,fr!==null))return rj(or,ar,dr,ur,fr,cr,lr);if(hr){hr=ur.fallback,dr=ar.mode,cr=or.child,fr=cr.sibling;var pr={mode:"hidden",children:ur.children};return!(dr&1)&&ar.child!==cr?(ur=ar.child,ur.childLanes=0,ur.pendingProps=pr,ar.deletions=null):(ur=Pg(cr,pr),ur.subtreeFlags=cr.subtreeFlags&14680064),fr!==null?hr=Pg(fr,hr):(hr=Tg(hr,dr,lr,null),hr.flags|=2),hr.return=ar,ur.return=ar,ur.sibling=hr,ar.child=ur,ur=hr,hr=ar.child,dr=or.child.memoizedState,dr=dr===null?nj(lr):{baseLanes:dr.baseLanes|lr,cachePool:null,transitions:dr.transitions},hr.memoizedState=dr,hr.childLanes=or.childLanes&~lr,ar.memoizedState=mj,ur}return hr=or.child,or=hr.sibling,ur=Pg(hr,{mode:"visible",children:ur.children}),!(ar.mode&1)&&(ur.lanes=lr),ur.return=ar,ur.sibling=null,or!==null&&(lr=ar.deletions,lr===null?(ar.deletions=[or],ar.flags|=16):lr.push(or)),ar.child=ur,ar.memoizedState=null,ur}function qj(or,ar){return ar=pj({mode:"visible",children:ar},or.mode,0,null),ar.return=or,or.child=ar}function sj(or,ar,lr,ur){return ur!==null&&Jg(ur),Ug(ar,or.child,null,lr),or=qj(ar,ar.pendingProps.children),or.flags|=2,ar.memoizedState=null,or}function rj(or,ar,lr,ur,cr,hr,dr){if(lr)return ar.flags&256?(ar.flags&=-257,ur=Ki(Error(p$2(422))),sj(or,ar,dr,ur)):ar.memoizedState!==null?(ar.child=or.child,ar.flags|=128,null):(hr=ur.fallback,cr=ar.mode,ur=pj({mode:"visible",children:ur.children},cr,0,null),hr=Tg(hr,cr,dr,null),hr.flags|=2,ur.return=ar,hr.return=ar,ur.sibling=hr,ar.child=ur,ar.mode&1&&Ug(ar,or.child,null,dr),ar.child.memoizedState=nj(dr),ar.memoizedState=mj,hr);if(!(ar.mode&1))return sj(or,ar,dr,null);if(cr.data==="$!"){if(ur=cr.nextSibling&&cr.nextSibling.dataset,ur)var fr=ur.dgst;return ur=fr,hr=Error(p$2(419)),ur=Ki(hr,ur,void 0),sj(or,ar,dr,ur)}if(fr=(dr&or.childLanes)!==0,dh||fr){if(ur=Q$1,ur!==null){switch(dr&-dr){case 4:cr=2;break;case 16:cr=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:cr=32;break;case 536870912:cr=268435456;break;default:cr=0}cr=cr&(ur.suspendedLanes|dr)?0:cr,cr!==0&&cr!==hr.retryLane&&(hr.retryLane=cr,ih(or,cr),gi(ur,or,cr,-1))}return tj(),ur=Ki(Error(p$2(421))),sj(or,ar,dr,ur)}return cr.data==="$?"?(ar.flags|=128,ar.child=or.child,ar=uj.bind(null,or),cr._reactRetry=ar,null):(or=hr.treeContext,yg=Lf(cr.nextSibling),xg=ar,I$1=!0,zg=null,or!==null&&(og[pg++]=rg,og[pg++]=sg,og[pg++]=qg,rg=or.id,sg=or.overflow,qg=ar),ar=qj(ar,ur.children),ar.flags|=4096,ar)}function vj(or,ar,lr){or.lanes|=ar;var ur=or.alternate;ur!==null&&(ur.lanes|=ar),bh(or.return,ar,lr)}function wj(or,ar,lr,ur,cr){var hr=or.memoizedState;hr===null?or.memoizedState={isBackwards:ar,rendering:null,renderingStartTime:0,last:ur,tail:lr,tailMode:cr}:(hr.isBackwards=ar,hr.rendering=null,hr.renderingStartTime=0,hr.last=ur,hr.tail=lr,hr.tailMode=cr)}function xj(or,ar,lr){var ur=ar.pendingProps,cr=ur.revealOrder,hr=ur.tail;if(Xi(or,ar,ur.children,lr),ur=L$1.current,ur&2)ur=ur&1|2,ar.flags|=128;else{if(or!==null&&or.flags&128)e:for(or=ar.child;or!==null;){if(or.tag===13)or.memoizedState!==null&&vj(or,lr,ar);else if(or.tag===19)vj(or,lr,ar);else if(or.child!==null){or.child.return=or,or=or.child;continue}if(or===ar)break e;for(;or.sibling===null;){if(or.return===null||or.return===ar)break e;or=or.return}or.sibling.return=or.return,or=or.sibling}ur&=1}if(G$1(L$1,ur),!(ar.mode&1))ar.memoizedState=null;else switch(cr){case"forwards":for(lr=ar.child,cr=null;lr!==null;)or=lr.alternate,or!==null&&Ch(or)===null&&(cr=lr),lr=lr.sibling;lr=cr,lr===null?(cr=ar.child,ar.child=null):(cr=lr.sibling,lr.sibling=null),wj(ar,!1,cr,lr,hr);break;case"backwards":for(lr=null,cr=ar.child,ar.child=null;cr!==null;){if(or=cr.alternate,or!==null&&Ch(or)===null){ar.child=cr;break}or=cr.sibling,cr.sibling=lr,lr=cr,cr=or}wj(ar,!0,lr,null,hr);break;case"together":wj(ar,!1,null,null,void 0);break;default:ar.memoizedState=null}return ar.child}function ij(or,ar){!(ar.mode&1)&&or!==null&&(or.alternate=null,ar.alternate=null,ar.flags|=2)}function Zi(or,ar,lr){if(or!==null&&(ar.dependencies=or.dependencies),rh|=ar.lanes,!(lr&ar.childLanes))return null;if(or!==null&&ar.child!==or.child)throw Error(p$2(153));if(ar.child!==null){for(or=ar.child,lr=Pg(or,or.pendingProps),ar.child=lr,lr.return=ar;or.sibling!==null;)or=or.sibling,lr=lr.sibling=Pg(or,or.pendingProps),lr.return=ar;lr.sibling=null}return ar.child}function yj(or,ar,lr){switch(ar.tag){case 3:kj(ar),Ig();break;case 5:Ah(ar);break;case 1:Zf(ar.type)&&cg(ar);break;case 4:yh(ar,ar.stateNode.containerInfo);break;case 10:var ur=ar.type._context,cr=ar.memoizedProps.value;G$1(Wg,ur._currentValue),ur._currentValue=cr;break;case 13:if(ur=ar.memoizedState,ur!==null)return ur.dehydrated!==null?(G$1(L$1,L$1.current&1),ar.flags|=128,null):lr&ar.child.childLanes?oj(or,ar,lr):(G$1(L$1,L$1.current&1),or=Zi(or,ar,lr),or!==null?or.sibling:null);G$1(L$1,L$1.current&1);break;case 19:if(ur=(lr&ar.childLanes)!==0,or.flags&128){if(ur)return xj(or,ar,lr);ar.flags|=128}if(cr=ar.memoizedState,cr!==null&&(cr.rendering=null,cr.tail=null,cr.lastEffect=null),G$1(L$1,L$1.current),ur)break;return null;case 22:case 23:return ar.lanes=0,dj(or,ar,lr)}return Zi(or,ar,lr)}var zj,Aj,Bj,Cj;zj=function(or,ar){for(var lr=ar.child;lr!==null;){if(lr.tag===5||lr.tag===6)or.appendChild(lr.stateNode);else if(lr.tag!==4&&lr.child!==null){lr.child.return=lr,lr=lr.child;continue}if(lr===ar)break;for(;lr.sibling===null;){if(lr.return===null||lr.return===ar)return;lr=lr.return}lr.sibling.return=lr.return,lr=lr.sibling}};Aj=function(){};Bj=function(or,ar,lr,ur){var cr=or.memoizedProps;if(cr!==ur){or=ar.stateNode,xh(uh.current);var hr=null;switch(lr){case"input":cr=Ya(or,cr),ur=Ya(or,ur),hr=[];break;case"select":cr=A$1({},cr,{value:void 0}),ur=A$1({},ur,{value:void 0}),hr=[];break;case"textarea":cr=gb(or,cr),ur=gb(or,ur),hr=[];break;default:typeof cr.onClick!="function"&&typeof ur.onClick=="function"&&(or.onclick=Bf)}ub(lr,ur);var dr;lr=null;for(vr in cr)if(!ur.hasOwnProperty(vr)&&cr.hasOwnProperty(vr)&&cr[vr]!=null)if(vr==="style"){var fr=cr[vr];for(dr in fr)fr.hasOwnProperty(dr)&&(lr||(lr={}),lr[dr]="")}else vr!=="dangerouslySetInnerHTML"&&vr!=="children"&&vr!=="suppressContentEditableWarning"&&vr!=="suppressHydrationWarning"&&vr!=="autoFocus"&&(ea.hasOwnProperty(vr)?hr||(hr=[]):(hr=hr||[]).push(vr,null));for(vr in ur){var pr=ur[vr];if(fr=cr!=null?cr[vr]:void 0,ur.hasOwnProperty(vr)&&pr!==fr&&(pr!=null||fr!=null))if(vr==="style")if(fr){for(dr in fr)!fr.hasOwnProperty(dr)||pr&&pr.hasOwnProperty(dr)||(lr||(lr={}),lr[dr]="");for(dr in pr)pr.hasOwnProperty(dr)&&fr[dr]!==pr[dr]&&(lr||(lr={}),lr[dr]=pr[dr])}else lr||(hr||(hr=[]),hr.push(vr,lr)),lr=pr;else vr==="dangerouslySetInnerHTML"?(pr=pr?pr.__html:void 0,fr=fr?fr.__html:void 0,pr!=null&&fr!==pr&&(hr=hr||[]).push(vr,pr)):vr==="children"?typeof pr!="string"&&typeof pr!="number"||(hr=hr||[]).push(vr,""+pr):vr!=="suppressContentEditableWarning"&&vr!=="suppressHydrationWarning"&&(ea.hasOwnProperty(vr)?(pr!=null&&vr==="onScroll"&&D$1("scroll",or),hr||fr===pr||(hr=[])):(hr=hr||[]).push(vr,pr))}lr&&(hr=hr||[]).push("style",lr);var vr=hr;(ar.updateQueue=vr)&&(ar.flags|=4)}};Cj=function(or,ar,lr,ur){lr!==ur&&(ar.flags|=4)};function Dj(or,ar){if(!I$1)switch(or.tailMode){case"hidden":ar=or.tail;for(var lr=null;ar!==null;)ar.alternate!==null&&(lr=ar),ar=ar.sibling;lr===null?or.tail=null:lr.sibling=null;break;case"collapsed":lr=or.tail;for(var ur=null;lr!==null;)lr.alternate!==null&&(ur=lr),lr=lr.sibling;ur===null?ar||or.tail===null?or.tail=null:or.tail.sibling=null:ur.sibling=null}}function S$1(or){var ar=or.alternate!==null&&or.alternate.child===or.child,lr=0,ur=0;if(ar)for(var cr=or.child;cr!==null;)lr|=cr.lanes|cr.childLanes,ur|=cr.subtreeFlags&14680064,ur|=cr.flags&14680064,cr.return=or,cr=cr.sibling;else for(cr=or.child;cr!==null;)lr|=cr.lanes|cr.childLanes,ur|=cr.subtreeFlags,ur|=cr.flags,cr.return=or,cr=cr.sibling;return or.subtreeFlags|=ur,or.childLanes=lr,ar}function Ej(or,ar,lr){var ur=ar.pendingProps;switch(wg(ar),ar.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S$1(ar),null;case 1:return Zf(ar.type)&&$f(),S$1(ar),null;case 3:return ur=ar.stateNode,zh(),E$1(Wf),E$1(H$1),Eh(),ur.pendingContext&&(ur.context=ur.pendingContext,ur.pendingContext=null),(or===null||or.child===null)&&(Gg(ar)?ar.flags|=4:or===null||or.memoizedState.isDehydrated&&!(ar.flags&256)||(ar.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(or,ar),S$1(ar),null;case 5:Bh(ar);var cr=xh(wh.current);if(lr=ar.type,or!==null&&ar.stateNode!=null)Bj(or,ar,lr,ur,cr),or.ref!==ar.ref&&(ar.flags|=512,ar.flags|=2097152);else{if(!ur){if(ar.stateNode===null)throw Error(p$2(166));return S$1(ar),null}if(or=xh(uh.current),Gg(ar)){ur=ar.stateNode,lr=ar.type;var hr=ar.memoizedProps;switch(ur[Of]=ar,ur[Pf]=hr,or=(ar.mode&1)!==0,lr){case"dialog":D$1("cancel",ur),D$1("close",ur);break;case"iframe":case"object":case"embed":D$1("load",ur);break;case"video":case"audio":for(cr=0;cr<lf.length;cr++)D$1(lf[cr],ur);break;case"source":D$1("error",ur);break;case"img":case"image":case"link":D$1("error",ur),D$1("load",ur);break;case"details":D$1("toggle",ur);break;case"input":Za(ur,hr),D$1("invalid",ur);break;case"select":ur._wrapperState={wasMultiple:!!hr.multiple},D$1("invalid",ur);break;case"textarea":hb(ur,hr),D$1("invalid",ur)}ub(lr,hr),cr=null;for(var dr in hr)if(hr.hasOwnProperty(dr)){var fr=hr[dr];dr==="children"?typeof fr=="string"?ur.textContent!==fr&&(hr.suppressHydrationWarning!==!0&&Af(ur.textContent,fr,or),cr=["children",fr]):typeof fr=="number"&&ur.textContent!==""+fr&&(hr.suppressHydrationWarning!==!0&&Af(ur.textContent,fr,or),cr=["children",""+fr]):ea.hasOwnProperty(dr)&&fr!=null&&dr==="onScroll"&&D$1("scroll",ur)}switch(lr){case"input":Va(ur),db$1(ur,hr,!0);break;case"textarea":Va(ur),jb(ur);break;case"select":case"option":break;default:typeof hr.onClick=="function"&&(ur.onclick=Bf)}ur=cr,ar.updateQueue=ur,ur!==null&&(ar.flags|=4)}else{dr=cr.nodeType===9?cr:cr.ownerDocument,or==="http://www.w3.org/1999/xhtml"&&(or=kb(lr)),or==="http://www.w3.org/1999/xhtml"?lr==="script"?(or=dr.createElement("div"),or.innerHTML="<script><\/script>",or=or.removeChild(or.firstChild)):typeof ur.is=="string"?or=dr.createElement(lr,{is:ur.is}):(or=dr.createElement(lr),lr==="select"&&(dr=or,ur.multiple?dr.multiple=!0:ur.size&&(dr.size=ur.size))):or=dr.createElementNS(or,lr),or[Of]=ar,or[Pf]=ur,zj(or,ar,!1,!1),ar.stateNode=or;e:{switch(dr=vb(lr,ur),lr){case"dialog":D$1("cancel",or),D$1("close",or),cr=ur;break;case"iframe":case"object":case"embed":D$1("load",or),cr=ur;break;case"video":case"audio":for(cr=0;cr<lf.length;cr++)D$1(lf[cr],or);cr=ur;break;case"source":D$1("error",or),cr=ur;break;case"img":case"image":case"link":D$1("error",or),D$1("load",or),cr=ur;break;case"details":D$1("toggle",or),cr=ur;break;case"input":Za(or,ur),cr=Ya(or,ur),D$1("invalid",or);break;case"option":cr=ur;break;case"select":or._wrapperState={wasMultiple:!!ur.multiple},cr=A$1({},ur,{value:void 0}),D$1("invalid",or);break;case"textarea":hb(or,ur),cr=gb(or,ur),D$1("invalid",or);break;default:cr=ur}ub(lr,cr),fr=cr;for(hr in fr)if(fr.hasOwnProperty(hr)){var pr=fr[hr];hr==="style"?sb(or,pr):hr==="dangerouslySetInnerHTML"?(pr=pr?pr.__html:void 0,pr!=null&&nb(or,pr)):hr==="children"?typeof pr=="string"?(lr!=="textarea"||pr!=="")&&ob(or,pr):typeof pr=="number"&&ob(or,""+pr):hr!=="suppressContentEditableWarning"&&hr!=="suppressHydrationWarning"&&hr!=="autoFocus"&&(ea.hasOwnProperty(hr)?pr!=null&&hr==="onScroll"&&D$1("scroll",or):pr!=null&&ta(or,hr,pr,dr))}switch(lr){case"input":Va(or),db$1(or,ur,!1);break;case"textarea":Va(or),jb(or);break;case"option":ur.value!=null&&or.setAttribute("value",""+Sa(ur.value));break;case"select":or.multiple=!!ur.multiple,hr=ur.value,hr!=null?fb(or,!!ur.multiple,hr,!1):ur.defaultValue!=null&&fb(or,!!ur.multiple,ur.defaultValue,!0);break;default:typeof cr.onClick=="function"&&(or.onclick=Bf)}switch(lr){case"button":case"input":case"select":case"textarea":ur=!!ur.autoFocus;break e;case"img":ur=!0;break e;default:ur=!1}}ur&&(ar.flags|=4)}ar.ref!==null&&(ar.flags|=512,ar.flags|=2097152)}return S$1(ar),null;case 6:if(or&&ar.stateNode!=null)Cj(or,ar,or.memoizedProps,ur);else{if(typeof ur!="string"&&ar.stateNode===null)throw Error(p$2(166));if(lr=xh(wh.current),xh(uh.current),Gg(ar)){if(ur=ar.stateNode,lr=ar.memoizedProps,ur[Of]=ar,(hr=ur.nodeValue!==lr)&&(or=xg,or!==null))switch(or.tag){case 3:Af(ur.nodeValue,lr,(or.mode&1)!==0);break;case 5:or.memoizedProps.suppressHydrationWarning!==!0&&Af(ur.nodeValue,lr,(or.mode&1)!==0)}hr&&(ar.flags|=4)}else ur=(lr.nodeType===9?lr:lr.ownerDocument).createTextNode(ur),ur[Of]=ar,ar.stateNode=ur}return S$1(ar),null;case 13:if(E$1(L$1),ur=ar.memoizedState,or===null||or.memoizedState!==null&&or.memoizedState.dehydrated!==null){if(I$1&&yg!==null&&ar.mode&1&&!(ar.flags&128))Hg(),Ig(),ar.flags|=98560,hr=!1;else if(hr=Gg(ar),ur!==null&&ur.dehydrated!==null){if(or===null){if(!hr)throw Error(p$2(318));if(hr=ar.memoizedState,hr=hr!==null?hr.dehydrated:null,!hr)throw Error(p$2(317));hr[Of]=ar}else Ig(),!(ar.flags&128)&&(ar.memoizedState=null),ar.flags|=4;S$1(ar),hr=!1}else zg!==null&&(Fj(zg),zg=null),hr=!0;if(!hr)return ar.flags&65536?ar:null}return ar.flags&128?(ar.lanes=lr,ar):(ur=ur!==null,ur!==(or!==null&&or.memoizedState!==null)&&ur&&(ar.child.flags|=8192,ar.mode&1&&(or===null||L$1.current&1?T$1===0&&(T$1=3):tj())),ar.updateQueue!==null&&(ar.flags|=4),S$1(ar),null);case 4:return zh(),Aj(or,ar),or===null&&sf(ar.stateNode.containerInfo),S$1(ar),null;case 10:return ah(ar.type._context),S$1(ar),null;case 17:return Zf(ar.type)&&$f(),S$1(ar),null;case 19:if(E$1(L$1),hr=ar.memoizedState,hr===null)return S$1(ar),null;if(ur=(ar.flags&128)!==0,dr=hr.rendering,dr===null)if(ur)Dj(hr,!1);else{if(T$1!==0||or!==null&&or.flags&128)for(or=ar.child;or!==null;){if(dr=Ch(or),dr!==null){for(ar.flags|=128,Dj(hr,!1),ur=dr.updateQueue,ur!==null&&(ar.updateQueue=ur,ar.flags|=4),ar.subtreeFlags=0,ur=lr,lr=ar.child;lr!==null;)hr=lr,or=ur,hr.flags&=14680066,dr=hr.alternate,dr===null?(hr.childLanes=0,hr.lanes=or,hr.child=null,hr.subtreeFlags=0,hr.memoizedProps=null,hr.memoizedState=null,hr.updateQueue=null,hr.dependencies=null,hr.stateNode=null):(hr.childLanes=dr.childLanes,hr.lanes=dr.lanes,hr.child=dr.child,hr.subtreeFlags=0,hr.deletions=null,hr.memoizedProps=dr.memoizedProps,hr.memoizedState=dr.memoizedState,hr.updateQueue=dr.updateQueue,hr.type=dr.type,or=dr.dependencies,hr.dependencies=or===null?null:{lanes:or.lanes,firstContext:or.firstContext}),lr=lr.sibling;return G$1(L$1,L$1.current&1|2),ar.child}or=or.sibling}hr.tail!==null&&B$1()>Gj&&(ar.flags|=128,ur=!0,Dj(hr,!1),ar.lanes=4194304)}else{if(!ur)if(or=Ch(dr),or!==null){if(ar.flags|=128,ur=!0,lr=or.updateQueue,lr!==null&&(ar.updateQueue=lr,ar.flags|=4),Dj(hr,!0),hr.tail===null&&hr.tailMode==="hidden"&&!dr.alternate&&!I$1)return S$1(ar),null}else 2*B$1()-hr.renderingStartTime>Gj&&lr!==1073741824&&(ar.flags|=128,ur=!0,Dj(hr,!1),ar.lanes=4194304);hr.isBackwards?(dr.sibling=ar.child,ar.child=dr):(lr=hr.last,lr!==null?lr.sibling=dr:ar.child=dr,hr.last=dr)}return hr.tail!==null?(ar=hr.tail,hr.rendering=ar,hr.tail=ar.sibling,hr.renderingStartTime=B$1(),ar.sibling=null,lr=L$1.current,G$1(L$1,ur?lr&1|2:lr&1),ar):(S$1(ar),null);case 22:case 23:return Hj(),ur=ar.memoizedState!==null,or!==null&&or.memoizedState!==null!==ur&&(ar.flags|=8192),ur&&ar.mode&1?fj&1073741824&&(S$1(ar),ar.subtreeFlags&6&&(ar.flags|=8192)):S$1(ar),null;case 24:return null;case 25:return null}throw Error(p$2(156,ar.tag))}function Ij(or,ar){switch(wg(ar),ar.tag){case 1:return Zf(ar.type)&&$f(),or=ar.flags,or&65536?(ar.flags=or&-65537|128,ar):null;case 3:return zh(),E$1(Wf),E$1(H$1),Eh(),or=ar.flags,or&65536&&!(or&128)?(ar.flags=or&-65537|128,ar):null;case 5:return Bh(ar),null;case 13:if(E$1(L$1),or=ar.memoizedState,or!==null&&or.dehydrated!==null){if(ar.alternate===null)throw Error(p$2(340));Ig()}return or=ar.flags,or&65536?(ar.flags=or&-65537|128,ar):null;case 19:return E$1(L$1),null;case 4:return zh(),null;case 10:return ah(ar.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$1=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V$1=null;function Lj(or,ar){var lr=or.ref;if(lr!==null)if(typeof lr=="function")try{lr(null)}catch(ur){W$1(or,ar,ur)}else lr.current=null}function Mj(or,ar,lr){try{lr()}catch(ur){W$1(or,ar,ur)}}var Nj=!1;function Oj(or,ar){if(Cf=dd,or=Me$1(),Ne$1(or)){if("selectionStart"in or)var lr={start:or.selectionStart,end:or.selectionEnd};else e:{lr=(lr=or.ownerDocument)&&lr.defaultView||window;var ur=lr.getSelection&&lr.getSelection();if(ur&&ur.rangeCount!==0){lr=ur.anchorNode;var cr=ur.anchorOffset,hr=ur.focusNode;ur=ur.focusOffset;try{lr.nodeType,hr.nodeType}catch{lr=null;break e}var dr=0,fr=-1,pr=-1,vr=0,gr=0,mr=or,br=null;t:for(;;){for(var yr;mr!==lr||cr!==0&&mr.nodeType!==3||(fr=dr+cr),mr!==hr||ur!==0&&mr.nodeType!==3||(pr=dr+ur),mr.nodeType===3&&(dr+=mr.nodeValue.length),(yr=mr.firstChild)!==null;)br=mr,mr=yr;for(;;){if(mr===or)break t;if(br===lr&&++vr===cr&&(fr=dr),br===hr&&++gr===ur&&(pr=dr),(yr=mr.nextSibling)!==null)break;mr=br,br=mr.parentNode}mr=yr}lr=fr===-1||pr===-1?null:{start:fr,end:pr}}else lr=null}lr=lr||{start:0,end:0}}else lr=null;for(Df={focusedElem:or,selectionRange:lr},dd=!1,V$1=ar;V$1!==null;)if(ar=V$1,or=ar.child,(ar.subtreeFlags&1028)!==0&&or!==null)or.return=ar,V$1=or;else for(;V$1!==null;){ar=V$1;try{var xr=ar.alternate;if(ar.flags&1024)switch(ar.tag){case 0:case 11:case 15:break;case 1:if(xr!==null){var Cr=xr.memoizedProps,Sr=xr.memoizedState,wr=ar.stateNode,Er=wr.getSnapshotBeforeUpdate(ar.elementType===ar.type?Cr:Ci(ar.type,Cr),Sr);wr.__reactInternalSnapshotBeforeUpdate=Er}break;case 3:var Ar=ar.stateNode.containerInfo;Ar.nodeType===1?Ar.textContent="":Ar.nodeType===9&&Ar.documentElement&&Ar.removeChild(Ar.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$2(163))}}catch(Tr){W$1(ar,ar.return,Tr)}if(or=ar.sibling,or!==null){or.return=ar.return,V$1=or;break}V$1=ar.return}return xr=Nj,Nj=!1,xr}function Pj(or,ar,lr){var ur=ar.updateQueue;if(ur=ur!==null?ur.lastEffect:null,ur!==null){var cr=ur=ur.next;do{if((cr.tag&or)===or){var hr=cr.destroy;cr.destroy=void 0,hr!==void 0&&Mj(ar,lr,hr)}cr=cr.next}while(cr!==ur)}}function Qj(or,ar){if(ar=ar.updateQueue,ar=ar!==null?ar.lastEffect:null,ar!==null){var lr=ar=ar.next;do{if((lr.tag&or)===or){var ur=lr.create;lr.destroy=ur()}lr=lr.next}while(lr!==ar)}}function Rj(or){var ar=or.ref;if(ar!==null){var lr=or.stateNode;switch(or.tag){case 5:or=lr;break;default:or=lr}typeof ar=="function"?ar(or):ar.current=or}}function Sj(or){var ar=or.alternate;ar!==null&&(or.alternate=null,Sj(ar)),or.child=null,or.deletions=null,or.sibling=null,or.tag===5&&(ar=or.stateNode,ar!==null&&(delete ar[Of],delete ar[Pf],delete ar[of],delete ar[Qf],delete ar[Rf])),or.stateNode=null,or.return=null,or.dependencies=null,or.memoizedProps=null,or.memoizedState=null,or.pendingProps=null,or.stateNode=null,or.updateQueue=null}function Tj(or){return or.tag===5||or.tag===3||or.tag===4}function Uj(or){e:for(;;){for(;or.sibling===null;){if(or.return===null||Tj(or.return))return null;or=or.return}for(or.sibling.return=or.return,or=or.sibling;or.tag!==5&&or.tag!==6&&or.tag!==18;){if(or.flags&2||or.child===null||or.tag===4)continue e;or.child.return=or,or=or.child}if(!(or.flags&2))return or.stateNode}}function Vj(or,ar,lr){var ur=or.tag;if(ur===5||ur===6)or=or.stateNode,ar?lr.nodeType===8?lr.parentNode.insertBefore(or,ar):lr.insertBefore(or,ar):(lr.nodeType===8?(ar=lr.parentNode,ar.insertBefore(or,lr)):(ar=lr,ar.appendChild(or)),lr=lr._reactRootContainer,lr!=null||ar.onclick!==null||(ar.onclick=Bf));else if(ur!==4&&(or=or.child,or!==null))for(Vj(or,ar,lr),or=or.sibling;or!==null;)Vj(or,ar,lr),or=or.sibling}function Wj(or,ar,lr){var ur=or.tag;if(ur===5||ur===6)or=or.stateNode,ar?lr.insertBefore(or,ar):lr.appendChild(or);else if(ur!==4&&(or=or.child,or!==null))for(Wj(or,ar,lr),or=or.sibling;or!==null;)Wj(or,ar,lr),or=or.sibling}var X$1=null,Xj=!1;function Yj(or,ar,lr){for(lr=lr.child;lr!==null;)Zj(or,ar,lr),lr=lr.sibling}function Zj(or,ar,lr){if(lc&&typeof lc.onCommitFiberUnmount=="function")try{lc.onCommitFiberUnmount(kc,lr)}catch{}switch(lr.tag){case 5:U$1||Lj(lr,ar);case 6:var ur=X$1,cr=Xj;X$1=null,Yj(or,ar,lr),X$1=ur,Xj=cr,X$1!==null&&(Xj?(or=X$1,lr=lr.stateNode,or.nodeType===8?or.parentNode.removeChild(lr):or.removeChild(lr)):X$1.removeChild(lr.stateNode));break;case 18:X$1!==null&&(Xj?(or=X$1,lr=lr.stateNode,or.nodeType===8?Kf(or.parentNode,lr):or.nodeType===1&&Kf(or,lr),bd(or)):Kf(X$1,lr.stateNode));break;case 4:ur=X$1,cr=Xj,X$1=lr.stateNode.containerInfo,Xj=!0,Yj(or,ar,lr),X$1=ur,Xj=cr;break;case 0:case 11:case 14:case 15:if(!U$1&&(ur=lr.updateQueue,ur!==null&&(ur=ur.lastEffect,ur!==null))){cr=ur=ur.next;do{var hr=cr,dr=hr.destroy;hr=hr.tag,dr!==void 0&&(hr&2||hr&4)&&Mj(lr,ar,dr),cr=cr.next}while(cr!==ur)}Yj(or,ar,lr);break;case 1:if(!U$1&&(Lj(lr,ar),ur=lr.stateNode,typeof ur.componentWillUnmount=="function"))try{ur.props=lr.memoizedProps,ur.state=lr.memoizedState,ur.componentWillUnmount()}catch(fr){W$1(lr,ar,fr)}Yj(or,ar,lr);break;case 21:Yj(or,ar,lr);break;case 22:lr.mode&1?(U$1=(ur=U$1)||lr.memoizedState!==null,Yj(or,ar,lr),U$1=ur):Yj(or,ar,lr);break;default:Yj(or,ar,lr)}}function ak(or){var ar=or.updateQueue;if(ar!==null){or.updateQueue=null;var lr=or.stateNode;lr===null&&(lr=or.stateNode=new Kj),ar.forEach(function(ur){var cr=bk.bind(null,or,ur);lr.has(ur)||(lr.add(ur),ur.then(cr,cr))})}}function ck(or,ar){var lr=ar.deletions;if(lr!==null)for(var ur=0;ur<lr.length;ur++){var cr=lr[ur];try{var hr=or,dr=ar,fr=dr;e:for(;fr!==null;){switch(fr.tag){case 5:X$1=fr.stateNode,Xj=!1;break e;case 3:X$1=fr.stateNode.containerInfo,Xj=!0;break e;case 4:X$1=fr.stateNode.containerInfo,Xj=!0;break e}fr=fr.return}if(X$1===null)throw Error(p$2(160));Zj(hr,dr,cr),X$1=null,Xj=!1;var pr=cr.alternate;pr!==null&&(pr.return=null),cr.return=null}catch(vr){W$1(cr,ar,vr)}}if(ar.subtreeFlags&12854)for(ar=ar.child;ar!==null;)dk(ar,or),ar=ar.sibling}function dk(or,ar){var lr=or.alternate,ur=or.flags;switch(or.tag){case 0:case 11:case 14:case 15:if(ck(ar,or),ek(or),ur&4){try{Pj(3,or,or.return),Qj(3,or)}catch(Cr){W$1(or,or.return,Cr)}try{Pj(5,or,or.return)}catch(Cr){W$1(or,or.return,Cr)}}break;case 1:ck(ar,or),ek(or),ur&512&&lr!==null&&Lj(lr,lr.return);break;case 5:if(ck(ar,or),ek(or),ur&512&&lr!==null&&Lj(lr,lr.return),or.flags&32){var cr=or.stateNode;try{ob(cr,"")}catch(Cr){W$1(or,or.return,Cr)}}if(ur&4&&(cr=or.stateNode,cr!=null)){var hr=or.memoizedProps,dr=lr!==null?lr.memoizedProps:hr,fr=or.type,pr=or.updateQueue;if(or.updateQueue=null,pr!==null)try{fr==="input"&&hr.type==="radio"&&hr.name!=null&&ab(cr,hr),vb(fr,dr);var vr=vb(fr,hr);for(dr=0;dr<pr.length;dr+=2){var gr=pr[dr],mr=pr[dr+1];gr==="style"?sb(cr,mr):gr==="dangerouslySetInnerHTML"?nb(cr,mr):gr==="children"?ob(cr,mr):ta(cr,gr,mr,vr)}switch(fr){case"input":bb(cr,hr);break;case"textarea":ib(cr,hr);break;case"select":var br=cr._wrapperState.wasMultiple;cr._wrapperState.wasMultiple=!!hr.multiple;var yr=hr.value;yr!=null?fb(cr,!!hr.multiple,yr,!1):br!==!!hr.multiple&&(hr.defaultValue!=null?fb(cr,!!hr.multiple,hr.defaultValue,!0):fb(cr,!!hr.multiple,hr.multiple?[]:"",!1))}cr[Pf]=hr}catch(Cr){W$1(or,or.return,Cr)}}break;case 6:if(ck(ar,or),ek(or),ur&4){if(or.stateNode===null)throw Error(p$2(162));cr=or.stateNode,hr=or.memoizedProps;try{cr.nodeValue=hr}catch(Cr){W$1(or,or.return,Cr)}}break;case 3:if(ck(ar,or),ek(or),ur&4&&lr!==null&&lr.memoizedState.isDehydrated)try{bd(ar.containerInfo)}catch(Cr){W$1(or,or.return,Cr)}break;case 4:ck(ar,or),ek(or);break;case 13:ck(ar,or),ek(or),cr=or.child,cr.flags&8192&&(hr=cr.memoizedState!==null,cr.stateNode.isHidden=hr,!hr||cr.alternate!==null&&cr.alternate.memoizedState!==null||(fk=B$1())),ur&4&&ak(or);break;case 22:if(gr=lr!==null&&lr.memoizedState!==null,or.mode&1?(U$1=(vr=U$1)||gr,ck(ar,or),U$1=vr):ck(ar,or),ek(or),ur&8192){if(vr=or.memoizedState!==null,(or.stateNode.isHidden=vr)&&!gr&&or.mode&1)for(V$1=or,gr=or.child;gr!==null;){for(mr=V$1=gr;V$1!==null;){switch(br=V$1,yr=br.child,br.tag){case 0:case 11:case 14:case 15:Pj(4,br,br.return);break;case 1:Lj(br,br.return);var xr=br.stateNode;if(typeof xr.componentWillUnmount=="function"){ur=br,lr=br.return;try{ar=ur,xr.props=ar.memoizedProps,xr.state=ar.memoizedState,xr.componentWillUnmount()}catch(Cr){W$1(ur,lr,Cr)}}break;case 5:Lj(br,br.return);break;case 22:if(br.memoizedState!==null){gk(mr);continue}}yr!==null?(yr.return=br,V$1=yr):gk(mr)}gr=gr.sibling}e:for(gr=null,mr=or;;){if(mr.tag===5){if(gr===null){gr=mr;try{cr=mr.stateNode,vr?(hr=cr.style,typeof hr.setProperty=="function"?hr.setProperty("display","none","important"):hr.display="none"):(fr=mr.stateNode,pr=mr.memoizedProps.style,dr=pr!=null&&pr.hasOwnProperty("display")?pr.display:null,fr.style.display=rb("display",dr))}catch(Cr){W$1(or,or.return,Cr)}}}else if(mr.tag===6){if(gr===null)try{mr.stateNode.nodeValue=vr?"":mr.memoizedProps}catch(Cr){W$1(or,or.return,Cr)}}else if((mr.tag!==22&&mr.tag!==23||mr.memoizedState===null||mr===or)&&mr.child!==null){mr.child.return=mr,mr=mr.child;continue}if(mr===or)break e;for(;mr.sibling===null;){if(mr.return===null||mr.return===or)break e;gr===mr&&(gr=null),mr=mr.return}gr===mr&&(gr=null),mr.sibling.return=mr.return,mr=mr.sibling}}break;case 19:ck(ar,or),ek(or),ur&4&&ak(or);break;case 21:break;default:ck(ar,or),ek(or)}}function ek(or){var ar=or.flags;if(ar&2){try{e:{for(var lr=or.return;lr!==null;){if(Tj(lr)){var ur=lr;break e}lr=lr.return}throw Error(p$2(160))}switch(ur.tag){case 5:var cr=ur.stateNode;ur.flags&32&&(ob(cr,""),ur.flags&=-33);var hr=Uj(or);Wj(or,hr,cr);break;case 3:case 4:var dr=ur.stateNode.containerInfo,fr=Uj(or);Vj(or,fr,dr);break;default:throw Error(p$2(161))}}catch(pr){W$1(or,or.return,pr)}or.flags&=-3}ar&4096&&(or.flags&=-4097)}function hk(or,ar,lr){V$1=or,ik(or)}function ik(or,ar,lr){for(var ur=(or.mode&1)!==0;V$1!==null;){var cr=V$1,hr=cr.child;if(cr.tag===22&&ur){var dr=cr.memoizedState!==null||Jj;if(!dr){var fr=cr.alternate,pr=fr!==null&&fr.memoizedState!==null||U$1;fr=Jj;var vr=U$1;if(Jj=dr,(U$1=pr)&&!vr)for(V$1=cr;V$1!==null;)dr=V$1,pr=dr.child,dr.tag===22&&dr.memoizedState!==null?jk(cr):pr!==null?(pr.return=dr,V$1=pr):jk(cr);for(;hr!==null;)V$1=hr,ik(hr),hr=hr.sibling;V$1=cr,Jj=fr,U$1=vr}kk(or)}else cr.subtreeFlags&8772&&hr!==null?(hr.return=cr,V$1=hr):kk(or)}}function kk(or){for(;V$1!==null;){var ar=V$1;if(ar.flags&8772){var lr=ar.alternate;try{if(ar.flags&8772)switch(ar.tag){case 0:case 11:case 15:U$1||Qj(5,ar);break;case 1:var ur=ar.stateNode;if(ar.flags&4&&!U$1)if(lr===null)ur.componentDidMount();else{var cr=ar.elementType===ar.type?lr.memoizedProps:Ci(ar.type,lr.memoizedProps);ur.componentDidUpdate(cr,lr.memoizedState,ur.__reactInternalSnapshotBeforeUpdate)}var hr=ar.updateQueue;hr!==null&&sh(ar,hr,ur);break;case 3:var dr=ar.updateQueue;if(dr!==null){if(lr=null,ar.child!==null)switch(ar.child.tag){case 5:lr=ar.child.stateNode;break;case 1:lr=ar.child.stateNode}sh(ar,dr,lr)}break;case 5:var fr=ar.stateNode;if(lr===null&&ar.flags&4){lr=fr;var pr=ar.memoizedProps;switch(ar.type){case"button":case"input":case"select":case"textarea":pr.autoFocus&&lr.focus();break;case"img":pr.src&&(lr.src=pr.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(ar.memoizedState===null){var vr=ar.alternate;if(vr!==null){var gr=vr.memoizedState;if(gr!==null){var mr=gr.dehydrated;mr!==null&&bd(mr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$2(163))}U$1||ar.flags&512&&Rj(ar)}catch(br){W$1(ar,ar.return,br)}}if(ar===or){V$1=null;break}if(lr=ar.sibling,lr!==null){lr.return=ar.return,V$1=lr;break}V$1=ar.return}}function gk(or){for(;V$1!==null;){var ar=V$1;if(ar===or){V$1=null;break}var lr=ar.sibling;if(lr!==null){lr.return=ar.return,V$1=lr;break}V$1=ar.return}}function jk(or){for(;V$1!==null;){var ar=V$1;try{switch(ar.tag){case 0:case 11:case 15:var lr=ar.return;try{Qj(4,ar)}catch(pr){W$1(ar,lr,pr)}break;case 1:var ur=ar.stateNode;if(typeof ur.componentDidMount=="function"){var cr=ar.return;try{ur.componentDidMount()}catch(pr){W$1(ar,cr,pr)}}var hr=ar.return;try{Rj(ar)}catch(pr){W$1(ar,hr,pr)}break;case 5:var dr=ar.return;try{Rj(ar)}catch(pr){W$1(ar,dr,pr)}}}catch(pr){W$1(ar,ar.return,pr)}if(ar===or){V$1=null;break}var fr=ar.sibling;if(fr!==null){fr.return=ar.return,V$1=fr;break}V$1=ar.return}}var lk=Math.ceil,mk=ua.ReactCurrentDispatcher,nk=ua.ReactCurrentOwner,ok=ua.ReactCurrentBatchConfig,K$2=0,Q$1=null,Y$1=null,Z$1=0,fj=0,ej=Uf(0),T$1=0,pk=null,rh=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi=!1,Pi=null,Ri=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K$2&6?B$1():Ak!==-1?Ak:Ak=B$1()}function yi(or){return or.mode&1?K$2&2&&Z$1!==0?Z$1&-Z$1:Kg.transition!==null?(Bk===0&&(Bk=yc()),Bk):(or=C$1,or!==0||(or=window.event,or=or===void 0?16:jd(or.type)),or):1}function gi(or,ar,lr,ur){if(50<yk)throw yk=0,zk=null,Error(p$2(185));Ac(or,lr,ur),(!(K$2&2)||or!==Q$1)&&(or===Q$1&&(!(K$2&2)&&(qk|=lr),T$1===4&&Ck(or,Z$1)),Dk(or,ur),lr===1&&K$2===0&&!(ar.mode&1)&&(Gj=B$1()+500,fg&&jg()))}function Dk(or,ar){var lr=or.callbackNode;wc(or,ar);var ur=uc(or,or===Q$1?Z$1:0);if(ur===0)lr!==null&&bc(lr),or.callbackNode=null,or.callbackPriority=0;else if(ar=ur&-ur,or.callbackPriority!==ar){if(lr!=null&&bc(lr),ar===1)or.tag===0?ig(Ek.bind(null,or)):hg(Ek.bind(null,or)),Jf(function(){!(K$2&6)&&jg()}),lr=null;else{switch(Dc(ur)){case 1:lr=fc;break;case 4:lr=gc;break;case 16:lr=hc;break;case 536870912:lr=jc;break;default:lr=hc}lr=Fk(lr,Gk.bind(null,or))}or.callbackPriority=ar,or.callbackNode=lr}}function Gk(or,ar){if(Ak=-1,Bk=0,K$2&6)throw Error(p$2(327));var lr=or.callbackNode;if(Hk()&&or.callbackNode!==lr)return null;var ur=uc(or,or===Q$1?Z$1:0);if(ur===0)return null;if(ur&30||ur&or.expiredLanes||ar)ar=Ik(or,ur);else{ar=ur;var cr=K$2;K$2|=2;var hr=Jk();(Q$1!==or||Z$1!==ar)&&(uk=null,Gj=B$1()+500,Kk(or,ar));do try{Lk();break}catch(fr){Mk(or,fr)}while(!0);$g(),mk.current=hr,K$2=cr,Y$1!==null?ar=0:(Q$1=null,Z$1=0,ar=T$1)}if(ar!==0){if(ar===2&&(cr=xc(or),cr!==0&&(ur=cr,ar=Nk(or,cr))),ar===1)throw lr=pk,Kk(or,0),Ck(or,ur),Dk(or,B$1()),lr;if(ar===6)Ck(or,ur);else{if(cr=or.current.alternate,!(ur&30)&&!Ok(cr)&&(ar=Ik(or,ur),ar===2&&(hr=xc(or),hr!==0&&(ur=hr,ar=Nk(or,hr))),ar===1))throw lr=pk,Kk(or,0),Ck(or,ur),Dk(or,B$1()),lr;switch(or.finishedWork=cr,or.finishedLanes=ur,ar){case 0:case 1:throw Error(p$2(345));case 2:Pk(or,tk,uk);break;case 3:if(Ck(or,ur),(ur&130023424)===ur&&(ar=fk+500-B$1(),10<ar)){if(uc(or,0)!==0)break;if(cr=or.suspendedLanes,(cr&ur)!==ur){R$1(),or.pingedLanes|=or.suspendedLanes&cr;break}or.timeoutHandle=Ff(Pk.bind(null,or,tk,uk),ar);break}Pk(or,tk,uk);break;case 4:if(Ck(or,ur),(ur&4194240)===ur)break;for(ar=or.eventTimes,cr=-1;0<ur;){var dr=31-oc(ur);hr=1<<dr,dr=ar[dr],dr>cr&&(cr=dr),ur&=~hr}if(ur=cr,ur=B$1()-ur,ur=(120>ur?120:480>ur?480:1080>ur?1080:1920>ur?1920:3e3>ur?3e3:4320>ur?4320:1960*lk(ur/1960))-ur,10<ur){or.timeoutHandle=Ff(Pk.bind(null,or,tk,uk),ur);break}Pk(or,tk,uk);break;case 5:Pk(or,tk,uk);break;default:throw Error(p$2(329))}}}return Dk(or,B$1()),or.callbackNode===lr?Gk.bind(null,or):null}function Nk(or,ar){var lr=sk;return or.current.memoizedState.isDehydrated&&(Kk(or,ar).flags|=256),or=Ik(or,ar),or!==2&&(ar=tk,tk=lr,ar!==null&&Fj(ar)),or}function Fj(or){tk===null?tk=or:tk.push.apply(tk,or)}function Ok(or){for(var ar=or;;){if(ar.flags&16384){var lr=ar.updateQueue;if(lr!==null&&(lr=lr.stores,lr!==null))for(var ur=0;ur<lr.length;ur++){var cr=lr[ur],hr=cr.getSnapshot;cr=cr.value;try{if(!He$1(hr(),cr))return!1}catch{return!1}}}if(lr=ar.child,ar.subtreeFlags&16384&&lr!==null)lr.return=ar,ar=lr;else{if(ar===or)break;for(;ar.sibling===null;){if(ar.return===null||ar.return===or)return!0;ar=ar.return}ar.sibling.return=ar.return,ar=ar.sibling}}return!0}function Ck(or,ar){for(ar&=~rk,ar&=~qk,or.suspendedLanes|=ar,or.pingedLanes&=~ar,or=or.expirationTimes;0<ar;){var lr=31-oc(ar),ur=1<<lr;or[lr]=-1,ar&=~ur}}function Ek(or){if(K$2&6)throw Error(p$2(327));Hk();var ar=uc(or,0);if(!(ar&1))return Dk(or,B$1()),null;var lr=Ik(or,ar);if(or.tag!==0&&lr===2){var ur=xc(or);ur!==0&&(ar=ur,lr=Nk(or,ur))}if(lr===1)throw lr=pk,Kk(or,0),Ck(or,ar),Dk(or,B$1()),lr;if(lr===6)throw Error(p$2(345));return or.finishedWork=or.current.alternate,or.finishedLanes=ar,Pk(or,tk,uk),Dk(or,B$1()),null}function Qk(or,ar){var lr=K$2;K$2|=1;try{return or(ar)}finally{K$2=lr,K$2===0&&(Gj=B$1()+500,fg&&jg())}}function Rk(or){wk!==null&&wk.tag===0&&!(K$2&6)&&Hk();var ar=K$2;K$2|=1;var lr=ok.transition,ur=C$1;try{if(ok.transition=null,C$1=1,or)return or()}finally{C$1=ur,ok.transition=lr,K$2=ar,!(K$2&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(or,ar){or.finishedWork=null,or.finishedLanes=0;var lr=or.timeoutHandle;if(lr!==-1&&(or.timeoutHandle=-1,Gf(lr)),Y$1!==null)for(lr=Y$1.return;lr!==null;){var ur=lr;switch(wg(ur),ur.tag){case 1:ur=ur.type.childContextTypes,ur!=null&&$f();break;case 3:zh(),E$1(Wf),E$1(H$1),Eh();break;case 5:Bh(ur);break;case 4:zh();break;case 13:E$1(L$1);break;case 19:E$1(L$1);break;case 10:ah(ur.type._context);break;case 22:case 23:Hj()}lr=lr.return}if(Q$1=or,Y$1=or=Pg(or.current,null),Z$1=fj=ar,T$1=0,pk=null,rk=qk=rh=0,tk=sk=null,fh!==null){for(ar=0;ar<fh.length;ar++)if(lr=fh[ar],ur=lr.interleaved,ur!==null){lr.interleaved=null;var cr=ur.next,hr=lr.pending;if(hr!==null){var dr=hr.next;hr.next=cr,ur.next=dr}lr.pending=ur}fh=null}return or}function Mk(or,ar){do{var lr=Y$1;try{if($g(),Fh.current=Rh,Ih){for(var ur=M$1.memoizedState;ur!==null;){var cr=ur.queue;cr!==null&&(cr.pending=null),ur=ur.next}Ih=!1}if(Hh=0,O$1=N$1=M$1=null,Jh=!1,Kh=0,nk.current=null,lr===null||lr.return===null){T$1=1,pk=ar,Y$1=null;break}e:{var hr=or,dr=lr.return,fr=lr,pr=ar;if(ar=Z$1,fr.flags|=32768,pr!==null&&typeof pr=="object"&&typeof pr.then=="function"){var vr=pr,gr=fr,mr=gr.tag;if(!(gr.mode&1)&&(mr===0||mr===11||mr===15)){var br=gr.alternate;br?(gr.updateQueue=br.updateQueue,gr.memoizedState=br.memoizedState,gr.lanes=br.lanes):(gr.updateQueue=null,gr.memoizedState=null)}var yr=Ui(dr);if(yr!==null){yr.flags&=-257,Vi(yr,dr,fr,hr,ar),yr.mode&1&&Si(hr,vr,ar),ar=yr,pr=vr;var xr=ar.updateQueue;if(xr===null){var Cr=new Set;Cr.add(pr),ar.updateQueue=Cr}else xr.add(pr);break e}else{if(!(ar&1)){Si(hr,vr,ar),tj();break e}pr=Error(p$2(426))}}else if(I$1&&fr.mode&1){var Sr=Ui(dr);if(Sr!==null){!(Sr.flags&65536)&&(Sr.flags|=256),Vi(Sr,dr,fr,hr,ar),Jg(Ji(pr,fr));break e}}hr=pr=Ji(pr,fr),T$1!==4&&(T$1=2),sk===null?sk=[hr]:sk.push(hr),hr=dr;do{switch(hr.tag){case 3:hr.flags|=65536,ar&=-ar,hr.lanes|=ar;var wr=Ni(hr,pr,ar);ph(hr,wr);break e;case 1:fr=pr;var Er=hr.type,Ar=hr.stateNode;if(!(hr.flags&128)&&(typeof Er.getDerivedStateFromError=="function"||Ar!==null&&typeof Ar.componentDidCatch=="function"&&(Ri===null||!Ri.has(Ar)))){hr.flags|=65536,ar&=-ar,hr.lanes|=ar;var Tr=Qi(hr,fr,ar);ph(hr,Tr);break e}}hr=hr.return}while(hr!==null)}Sk(lr)}catch(Rr){ar=Rr,Y$1===lr&&lr!==null&&(Y$1=lr=lr.return);continue}break}while(!0)}function Jk(){var or=mk.current;return mk.current=Rh,or===null?Rh:or}function tj(){(T$1===0||T$1===3||T$1===2)&&(T$1=4),Q$1===null||!(rh&268435455)&&!(qk&268435455)||Ck(Q$1,Z$1)}function Ik(or,ar){var lr=K$2;K$2|=2;var ur=Jk();(Q$1!==or||Z$1!==ar)&&(uk=null,Kk(or,ar));do try{Tk();break}catch(cr){Mk(or,cr)}while(!0);if($g(),K$2=lr,mk.current=ur,Y$1!==null)throw Error(p$2(261));return Q$1=null,Z$1=0,T$1}function Tk(){for(;Y$1!==null;)Uk(Y$1)}function Lk(){for(;Y$1!==null&&!cc();)Uk(Y$1)}function Uk(or){var ar=Vk(or.alternate,or,fj);or.memoizedProps=or.pendingProps,ar===null?Sk(or):Y$1=ar,nk.current=null}function Sk(or){var ar=or;do{var lr=ar.alternate;if(or=ar.return,ar.flags&32768){if(lr=Ij(lr,ar),lr!==null){lr.flags&=32767,Y$1=lr;return}if(or!==null)or.flags|=32768,or.subtreeFlags=0,or.deletions=null;else{T$1=6,Y$1=null;return}}else if(lr=Ej(lr,ar,fj),lr!==null){Y$1=lr;return}if(ar=ar.sibling,ar!==null){Y$1=ar;return}Y$1=ar=or}while(ar!==null);T$1===0&&(T$1=5)}function Pk(or,ar,lr){var ur=C$1,cr=ok.transition;try{ok.transition=null,C$1=1,Wk(or,ar,lr,ur)}finally{ok.transition=cr,C$1=ur}return null}function Wk(or,ar,lr,ur){do Hk();while(wk!==null);if(K$2&6)throw Error(p$2(327));lr=or.finishedWork;var cr=or.finishedLanes;if(lr===null)return null;if(or.finishedWork=null,or.finishedLanes=0,lr===or.current)throw Error(p$2(177));or.callbackNode=null,or.callbackPriority=0;var hr=lr.lanes|lr.childLanes;if(Bc(or,hr),or===Q$1&&(Y$1=Q$1=null,Z$1=0),!(lr.subtreeFlags&2064)&&!(lr.flags&2064)||vk||(vk=!0,Fk(hc,function(){return Hk(),null})),hr=(lr.flags&15990)!==0,lr.subtreeFlags&15990||hr){hr=ok.transition,ok.transition=null;var dr=C$1;C$1=1;var fr=K$2;K$2|=4,nk.current=null,Oj(or,lr),dk(lr,or),Oe$1(Df),dd=!!Cf,Df=Cf=null,or.current=lr,hk(lr),dc(),K$2=fr,C$1=dr,ok.transition=hr}else or.current=lr;if(vk&&(vk=!1,wk=or,xk=cr),hr=or.pendingLanes,hr===0&&(Ri=null),mc(lr.stateNode),Dk(or,B$1()),ar!==null)for(ur=or.onRecoverableError,lr=0;lr<ar.length;lr++)cr=ar[lr],ur(cr.value,{componentStack:cr.stack,digest:cr.digest});if(Oi)throw Oi=!1,or=Pi,Pi=null,or;return xk&1&&or.tag!==0&&Hk(),hr=or.pendingLanes,hr&1?or===zk?yk++:(yk=0,zk=or):yk=0,jg(),null}function Hk(){if(wk!==null){var or=Dc(xk),ar=ok.transition,lr=C$1;try{if(ok.transition=null,C$1=16>or?16:or,wk===null)var ur=!1;else{if(or=wk,wk=null,xk=0,K$2&6)throw Error(p$2(331));var cr=K$2;for(K$2|=4,V$1=or.current;V$1!==null;){var hr=V$1,dr=hr.child;if(V$1.flags&16){var fr=hr.deletions;if(fr!==null){for(var pr=0;pr<fr.length;pr++){var vr=fr[pr];for(V$1=vr;V$1!==null;){var gr=V$1;switch(gr.tag){case 0:case 11:case 15:Pj(8,gr,hr)}var mr=gr.child;if(mr!==null)mr.return=gr,V$1=mr;else for(;V$1!==null;){gr=V$1;var br=gr.sibling,yr=gr.return;if(Sj(gr),gr===vr){V$1=null;break}if(br!==null){br.return=yr,V$1=br;break}V$1=yr}}}var xr=hr.alternate;if(xr!==null){var Cr=xr.child;if(Cr!==null){xr.child=null;do{var Sr=Cr.sibling;Cr.sibling=null,Cr=Sr}while(Cr!==null)}}V$1=hr}}if(hr.subtreeFlags&2064&&dr!==null)dr.return=hr,V$1=dr;else e:for(;V$1!==null;){if(hr=V$1,hr.flags&2048)switch(hr.tag){case 0:case 11:case 15:Pj(9,hr,hr.return)}var wr=hr.sibling;if(wr!==null){wr.return=hr.return,V$1=wr;break e}V$1=hr.return}}var Er=or.current;for(V$1=Er;V$1!==null;){dr=V$1;var Ar=dr.child;if(dr.subtreeFlags&2064&&Ar!==null)Ar.return=dr,V$1=Ar;else e:for(dr=Er;V$1!==null;){if(fr=V$1,fr.flags&2048)try{switch(fr.tag){case 0:case 11:case 15:Qj(9,fr)}}catch(Rr){W$1(fr,fr.return,Rr)}if(fr===dr){V$1=null;break e}var Tr=fr.sibling;if(Tr!==null){Tr.return=fr.return,V$1=Tr;break e}V$1=fr.return}}if(K$2=cr,jg(),lc&&typeof lc.onPostCommitFiberRoot=="function")try{lc.onPostCommitFiberRoot(kc,or)}catch{}ur=!0}return ur}finally{C$1=lr,ok.transition=ar}}return!1}function Xk(or,ar,lr){ar=Ji(lr,ar),ar=Ni(or,ar,1),or=nh(or,ar,1),ar=R$1(),or!==null&&(Ac(or,1,ar),Dk(or,ar))}function W$1(or,ar,lr){if(or.tag===3)Xk(or,or,lr);else for(;ar!==null;){if(ar.tag===3){Xk(ar,or,lr);break}else if(ar.tag===1){var ur=ar.stateNode;if(typeof ar.type.getDerivedStateFromError=="function"||typeof ur.componentDidCatch=="function"&&(Ri===null||!Ri.has(ur))){or=Ji(lr,or),or=Qi(ar,or,1),ar=nh(ar,or,1),or=R$1(),ar!==null&&(Ac(ar,1,or),Dk(ar,or));break}}ar=ar.return}}function Ti(or,ar,lr){var ur=or.pingCache;ur!==null&&ur.delete(ar),ar=R$1(),or.pingedLanes|=or.suspendedLanes&lr,Q$1===or&&(Z$1&lr)===lr&&(T$1===4||T$1===3&&(Z$1&130023424)===Z$1&&500>B$1()-fk?Kk(or,0):rk|=lr),Dk(or,ar)}function Yk(or,ar){ar===0&&(or.mode&1?(ar=sc,sc<<=1,!(sc&130023424)&&(sc=4194304)):ar=1);var lr=R$1();or=ih(or,ar),or!==null&&(Ac(or,ar,lr),Dk(or,lr))}function uj(or){var ar=or.memoizedState,lr=0;ar!==null&&(lr=ar.retryLane),Yk(or,lr)}function bk(or,ar){var lr=0;switch(or.tag){case 13:var ur=or.stateNode,cr=or.memoizedState;cr!==null&&(lr=cr.retryLane);break;case 19:ur=or.stateNode;break;default:throw Error(p$2(314))}ur!==null&&ur.delete(ar),Yk(or,lr)}var Vk;Vk=function(or,ar,lr){if(or!==null)if(or.memoizedProps!==ar.pendingProps||Wf.current)dh=!0;else{if(!(or.lanes&lr)&&!(ar.flags&128))return dh=!1,yj(or,ar,lr);dh=!!(or.flags&131072)}else dh=!1,I$1&&ar.flags&1048576&&ug(ar,ng,ar.index);switch(ar.lanes=0,ar.tag){case 2:var ur=ar.type;ij(or,ar),or=ar.pendingProps;var cr=Yf(ar,H$1.current);ch(ar,lr),cr=Nh(null,ar,ur,or,cr,lr);var hr=Sh();return ar.flags|=1,typeof cr=="object"&&cr!==null&&typeof cr.render=="function"&&cr.$$typeof===void 0?(ar.tag=1,ar.memoizedState=null,ar.updateQueue=null,Zf(ur)?(hr=!0,cg(ar)):hr=!1,ar.memoizedState=cr.state!==null&&cr.state!==void 0?cr.state:null,kh(ar),cr.updater=Ei,ar.stateNode=cr,cr._reactInternals=ar,Ii(ar,ur,or,lr),ar=jj(null,ar,ur,!0,hr,lr)):(ar.tag=0,I$1&&hr&&vg(ar),Xi(null,ar,cr,lr),ar=ar.child),ar;case 16:ur=ar.elementType;e:{switch(ij(or,ar),or=ar.pendingProps,cr=ur._init,ur=cr(ur._payload),ar.type=ur,cr=ar.tag=Zk(ur),or=Ci(ur,or),cr){case 0:ar=cj(null,ar,ur,or,lr);break e;case 1:ar=hj(null,ar,ur,or,lr);break e;case 11:ar=Yi(null,ar,ur,or,lr);break e;case 14:ar=$i(null,ar,ur,Ci(ur.type,or),lr);break e}throw Error(p$2(306,ur,""))}return ar;case 0:return ur=ar.type,cr=ar.pendingProps,cr=ar.elementType===ur?cr:Ci(ur,cr),cj(or,ar,ur,cr,lr);case 1:return ur=ar.type,cr=ar.pendingProps,cr=ar.elementType===ur?cr:Ci(ur,cr),hj(or,ar,ur,cr,lr);case 3:e:{if(kj(ar),or===null)throw Error(p$2(387));ur=ar.pendingProps,hr=ar.memoizedState,cr=hr.element,lh(or,ar),qh(ar,ur,null,lr);var dr=ar.memoizedState;if(ur=dr.element,hr.isDehydrated)if(hr={element:ur,isDehydrated:!1,cache:dr.cache,pendingSuspenseBoundaries:dr.pendingSuspenseBoundaries,transitions:dr.transitions},ar.updateQueue.baseState=hr,ar.memoizedState=hr,ar.flags&256){cr=Ji(Error(p$2(423)),ar),ar=lj(or,ar,ur,lr,cr);break e}else if(ur!==cr){cr=Ji(Error(p$2(424)),ar),ar=lj(or,ar,ur,lr,cr);break e}else for(yg=Lf(ar.stateNode.containerInfo.firstChild),xg=ar,I$1=!0,zg=null,lr=Vg(ar,null,ur,lr),ar.child=lr;lr;)lr.flags=lr.flags&-3|4096,lr=lr.sibling;else{if(Ig(),ur===cr){ar=Zi(or,ar,lr);break e}Xi(or,ar,ur,lr)}ar=ar.child}return ar;case 5:return Ah(ar),or===null&&Eg(ar),ur=ar.type,cr=ar.pendingProps,hr=or!==null?or.memoizedProps:null,dr=cr.children,Ef(ur,cr)?dr=null:hr!==null&&Ef(ur,hr)&&(ar.flags|=32),gj(or,ar),Xi(or,ar,dr,lr),ar.child;case 6:return or===null&&Eg(ar),null;case 13:return oj(or,ar,lr);case 4:return yh(ar,ar.stateNode.containerInfo),ur=ar.pendingProps,or===null?ar.child=Ug(ar,null,ur,lr):Xi(or,ar,ur,lr),ar.child;case 11:return ur=ar.type,cr=ar.pendingProps,cr=ar.elementType===ur?cr:Ci(ur,cr),Yi(or,ar,ur,cr,lr);case 7:return Xi(or,ar,ar.pendingProps,lr),ar.child;case 8:return Xi(or,ar,ar.pendingProps.children,lr),ar.child;case 12:return Xi(or,ar,ar.pendingProps.children,lr),ar.child;case 10:e:{if(ur=ar.type._context,cr=ar.pendingProps,hr=ar.memoizedProps,dr=cr.value,G$1(Wg,ur._currentValue),ur._currentValue=dr,hr!==null)if(He$1(hr.value,dr)){if(hr.children===cr.children&&!Wf.current){ar=Zi(or,ar,lr);break e}}else for(hr=ar.child,hr!==null&&(hr.return=ar);hr!==null;){var fr=hr.dependencies;if(fr!==null){dr=hr.child;for(var pr=fr.firstContext;pr!==null;){if(pr.context===ur){if(hr.tag===1){pr=mh(-1,lr&-lr),pr.tag=2;var vr=hr.updateQueue;if(vr!==null){vr=vr.shared;var gr=vr.pending;gr===null?pr.next=pr:(pr.next=gr.next,gr.next=pr),vr.pending=pr}}hr.lanes|=lr,pr=hr.alternate,pr!==null&&(pr.lanes|=lr),bh(hr.return,lr,ar),fr.lanes|=lr;break}pr=pr.next}}else if(hr.tag===10)dr=hr.type===ar.type?null:hr.child;else if(hr.tag===18){if(dr=hr.return,dr===null)throw Error(p$2(341));dr.lanes|=lr,fr=dr.alternate,fr!==null&&(fr.lanes|=lr),bh(dr,lr,ar),dr=hr.sibling}else dr=hr.child;if(dr!==null)dr.return=hr;else for(dr=hr;dr!==null;){if(dr===ar){dr=null;break}if(hr=dr.sibling,hr!==null){hr.return=dr.return,dr=hr;break}dr=dr.return}hr=dr}Xi(or,ar,cr.children,lr),ar=ar.child}return ar;case 9:return cr=ar.type,ur=ar.pendingProps.children,ch(ar,lr),cr=eh(cr),ur=ur(cr),ar.flags|=1,Xi(or,ar,ur,lr),ar.child;case 14:return ur=ar.type,cr=Ci(ur,ar.pendingProps),cr=Ci(ur.type,cr),$i(or,ar,ur,cr,lr);case 15:return bj(or,ar,ar.type,ar.pendingProps,lr);case 17:return ur=ar.type,cr=ar.pendingProps,cr=ar.elementType===ur?cr:Ci(ur,cr),ij(or,ar),ar.tag=1,Zf(ur)?(or=!0,cg(ar)):or=!1,ch(ar,lr),Gi(ar,ur,cr),Ii(ar,ur,cr,lr),jj(null,ar,ur,!0,or,lr);case 19:return xj(or,ar,lr);case 22:return dj(or,ar,lr)}throw Error(p$2(156,ar.tag))};function Fk(or,ar){return ac(or,ar)}function $k(or,ar,lr,ur){this.tag=or,this.key=lr,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=ar,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=ur,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(or,ar,lr,ur){return new $k(or,ar,lr,ur)}function aj(or){return or=or.prototype,!(!or||!or.isReactComponent)}function Zk(or){if(typeof or=="function")return aj(or)?1:0;if(or!=null){if(or=or.$$typeof,or===Da)return 11;if(or===Ga)return 14}return 2}function Pg(or,ar){var lr=or.alternate;return lr===null?(lr=Bg(or.tag,ar,or.key,or.mode),lr.elementType=or.elementType,lr.type=or.type,lr.stateNode=or.stateNode,lr.alternate=or,or.alternate=lr):(lr.pendingProps=ar,lr.type=or.type,lr.flags=0,lr.subtreeFlags=0,lr.deletions=null),lr.flags=or.flags&14680064,lr.childLanes=or.childLanes,lr.lanes=or.lanes,lr.child=or.child,lr.memoizedProps=or.memoizedProps,lr.memoizedState=or.memoizedState,lr.updateQueue=or.updateQueue,ar=or.dependencies,lr.dependencies=ar===null?null:{lanes:ar.lanes,firstContext:ar.firstContext},lr.sibling=or.sibling,lr.index=or.index,lr.ref=or.ref,lr}function Rg(or,ar,lr,ur,cr,hr){var dr=2;if(ur=or,typeof or=="function")aj(or)&&(dr=1);else if(typeof or=="string")dr=5;else e:switch(or){case ya:return Tg(lr.children,cr,hr,ar);case za:dr=8,cr|=8;break;case Aa:return or=Bg(12,lr,ar,cr|2),or.elementType=Aa,or.lanes=hr,or;case Ea:return or=Bg(13,lr,ar,cr),or.elementType=Ea,or.lanes=hr,or;case Fa:return or=Bg(19,lr,ar,cr),or.elementType=Fa,or.lanes=hr,or;case Ia:return pj(lr,cr,hr,ar);default:if(typeof or=="object"&&or!==null)switch(or.$$typeof){case Ba:dr=10;break e;case Ca:dr=9;break e;case Da:dr=11;break e;case Ga:dr=14;break e;case Ha:dr=16,ur=null;break e}throw Error(p$2(130,or==null?or:typeof or,""))}return ar=Bg(dr,lr,ar,cr),ar.elementType=or,ar.type=ur,ar.lanes=hr,ar}function Tg(or,ar,lr,ur){return or=Bg(7,or,ur,ar),or.lanes=lr,or}function pj(or,ar,lr,ur){return or=Bg(22,or,ur,ar),or.elementType=Ia,or.lanes=lr,or.stateNode={isHidden:!1},or}function Qg(or,ar,lr){return or=Bg(6,or,null,ar),or.lanes=lr,or}function Sg(or,ar,lr){return ar=Bg(4,or.children!==null?or.children:[],or.key,ar),ar.lanes=lr,ar.stateNode={containerInfo:or.containerInfo,pendingChildren:null,implementation:or.implementation},ar}function al(or,ar,lr,ur,cr){this.tag=ar,this.containerInfo=or,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc(0),this.expirationTimes=zc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc(0),this.identifierPrefix=ur,this.onRecoverableError=cr,this.mutableSourceEagerHydrationData=null}function bl(or,ar,lr,ur,cr,hr,dr,fr,pr){return or=new al(or,ar,lr,fr,pr),ar===1?(ar=1,hr===!0&&(ar|=8)):ar=0,hr=Bg(3,null,null,ar),or.current=hr,hr.stateNode=or,hr.memoizedState={element:ur,isDehydrated:lr,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh(hr),or}function cl(or,ar,lr){var ur=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa,key:ur==null?null:""+ur,children:or,containerInfo:ar,implementation:lr}}function dl(or){if(!or)return Vf;or=or._reactInternals;e:{if(Vb(or)!==or||or.tag!==1)throw Error(p$2(170));var ar=or;do{switch(ar.tag){case 3:ar=ar.stateNode.context;break e;case 1:if(Zf(ar.type)){ar=ar.stateNode.__reactInternalMemoizedMergedChildContext;break e}}ar=ar.return}while(ar!==null);throw Error(p$2(171))}if(or.tag===1){var lr=or.type;if(Zf(lr))return bg(or,lr,ar)}return ar}function el(or,ar,lr,ur,cr,hr,dr,fr,pr){return or=bl(lr,ur,!0,or,cr,hr,dr,fr,pr),or.context=dl(null),lr=or.current,ur=R$1(),cr=yi(lr),hr=mh(ur,cr),hr.callback=ar??null,nh(lr,hr,cr),or.current.lanes=cr,Ac(or,cr,ur),Dk(or,ur),or}function fl(or,ar,lr,ur){var cr=ar.current,hr=R$1(),dr=yi(cr);return lr=dl(lr),ar.context===null?ar.context=lr:ar.pendingContext=lr,ar=mh(hr,dr),ar.payload={element:or},ur=ur===void 0?null:ur,ur!==null&&(ar.callback=ur),or=nh(cr,ar,dr),or!==null&&(gi(or,cr,dr,hr),oh(or,cr,dr)),dr}function gl(or){if(or=or.current,!or.child)return null;switch(or.child.tag){case 5:return or.child.stateNode;default:return or.child.stateNode}}function hl(or,ar){if(or=or.memoizedState,or!==null&&or.dehydrated!==null){var lr=or.retryLane;or.retryLane=lr!==0&&lr<ar?lr:ar}}function il(or,ar){hl(or,ar),(or=or.alternate)&&hl(or,ar)}function jl(){return null}var kl=typeof reportError=="function"?reportError:function(or){console.error(or)};function ll(or){this._internalRoot=or}ml.prototype.render=ll.prototype.render=function(or){var ar=this._internalRoot;if(ar===null)throw Error(p$2(409));fl(or,ar,null,null)};ml.prototype.unmount=ll.prototype.unmount=function(){var or=this._internalRoot;if(or!==null){this._internalRoot=null;var ar=or.containerInfo;Rk(function(){fl(null,or,null,null)}),ar[uf]=null}};function ml(or){this._internalRoot=or}ml.prototype.unstable_scheduleHydration=function(or){if(or){var ar=Hc();or={blockedOn:null,target:or,priority:ar};for(var lr=0;lr<Qc.length&&ar!==0&&ar<Qc[lr].priority;lr++);Qc.splice(lr,0,or),lr===0&&Vc(or)}};function nl(or){return!(!or||or.nodeType!==1&&or.nodeType!==9&&or.nodeType!==11)}function ol(or){return!(!or||or.nodeType!==1&&or.nodeType!==9&&or.nodeType!==11&&(or.nodeType!==8||or.nodeValue!==" react-mount-point-unstable "))}function pl(){}function ql(or,ar,lr,ur,cr){if(cr){if(typeof ur=="function"){var hr=ur;ur=function(){var vr=gl(dr);hr.call(vr)}}var dr=el(ar,ur,or,0,null,!1,!1,"",pl);return or._reactRootContainer=dr,or[uf]=dr.current,sf(or.nodeType===8?or.parentNode:or),Rk(),dr}for(;cr=or.lastChild;)or.removeChild(cr);if(typeof ur=="function"){var fr=ur;ur=function(){var vr=gl(pr);fr.call(vr)}}var pr=bl(or,0,!1,null,null,!1,!1,"",pl);return or._reactRootContainer=pr,or[uf]=pr.current,sf(or.nodeType===8?or.parentNode:or),Rk(function(){fl(ar,pr,lr,ur)}),pr}function rl(or,ar,lr,ur,cr){var hr=lr._reactRootContainer;if(hr){var dr=hr;if(typeof cr=="function"){var fr=cr;cr=function(){var pr=gl(dr);fr.call(pr)}}fl(ar,dr,or,cr)}else dr=ql(lr,ar,or,cr,ur);return gl(dr)}Ec=function(or){switch(or.tag){case 3:var ar=or.stateNode;if(ar.current.memoizedState.isDehydrated){var lr=tc(ar.pendingLanes);lr!==0&&(Cc(ar,lr|1),Dk(ar,B$1()),!(K$2&6)&&(Gj=B$1()+500,jg()))}break;case 13:Rk(function(){var ur=ih(or,1);if(ur!==null){var cr=R$1();gi(ur,or,1,cr)}}),il(or,1)}};Fc=function(or){if(or.tag===13){var ar=ih(or,134217728);if(ar!==null){var lr=R$1();gi(ar,or,134217728,lr)}il(or,134217728)}};Gc=function(or){if(or.tag===13){var ar=yi(or),lr=ih(or,ar);if(lr!==null){var ur=R$1();gi(lr,or,ar,ur)}il(or,ar)}};Hc=function(){return C$1};Ic=function(or,ar){var lr=C$1;try{return C$1=or,ar()}finally{C$1=lr}};yb=function(or,ar,lr){switch(ar){case"input":if(bb(or,lr),ar=lr.name,lr.type==="radio"&&ar!=null){for(lr=or;lr.parentNode;)lr=lr.parentNode;for(lr=lr.querySelectorAll("input[name="+JSON.stringify(""+ar)+'][type="radio"]'),ar=0;ar<lr.length;ar++){var ur=lr[ar];if(ur!==or&&ur.form===or.form){var cr=Db(ur);if(!cr)throw Error(p$2(90));Wa(ur),bb(ur,cr)}}}break;case"textarea":ib(or,lr);break;case"select":ar=lr.value,ar!=null&&fb(or,!!lr.multiple,ar,!1)}};Gb=Qk;Hb=Rk;var sl={usingClientEntryPoint:!1,Events:[Cb,ue$1,Db,Eb,Fb,Qk]},tl={findFiberByHostInstance:Wc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul={bundleType:tl.bundleType,version:tl.version,rendererPackageName:tl.rendererPackageName,rendererConfig:tl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua.ReactCurrentDispatcher,findHostInstanceByFiber:function(or){return or=Zb(or),or===null?null:or.stateNode},findFiberByHostInstance:tl.findFiberByHostInstance||jl,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl.isDisabled&&vl.supportsFiber)try{kc=vl.inject(ul),lc=vl}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl;reactDom_production_min.createPortal=function(or,ar){var lr=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl(ar))throw Error(p$2(200));return cl(or,ar,null,lr)};reactDom_production_min.createRoot=function(or,ar){if(!nl(or))throw Error(p$2(299));var lr=!1,ur="",cr=kl;return ar!=null&&(ar.unstable_strictMode===!0&&(lr=!0),ar.identifierPrefix!==void 0&&(ur=ar.identifierPrefix),ar.onRecoverableError!==void 0&&(cr=ar.onRecoverableError)),ar=bl(or,1,!1,null,null,lr,!1,ur,cr),or[uf]=ar.current,sf(or.nodeType===8?or.parentNode:or),new ll(ar)};reactDom_production_min.findDOMNode=function(or){if(or==null)return null;if(or.nodeType===1)return or;var ar=or._reactInternals;if(ar===void 0)throw typeof or.render=="function"?Error(p$2(188)):(or=Object.keys(or).join(","),Error(p$2(268,or)));return or=Zb(ar),or=or===null?null:or.stateNode,or};reactDom_production_min.flushSync=function(or){return Rk(or)};reactDom_production_min.hydrate=function(or,ar,lr){if(!ol(ar))throw Error(p$2(200));return rl(null,or,ar,!0,lr)};reactDom_production_min.hydrateRoot=function(or,ar,lr){if(!nl(or))throw Error(p$2(405));var ur=lr!=null&&lr.hydratedSources||null,cr=!1,hr="",dr=kl;if(lr!=null&&(lr.unstable_strictMode===!0&&(cr=!0),lr.identifierPrefix!==void 0&&(hr=lr.identifierPrefix),lr.onRecoverableError!==void 0&&(dr=lr.onRecoverableError)),ar=el(ar,null,or,1,lr??null,cr,!1,hr,dr),or[uf]=ar.current,sf(or),ur)for(or=0;or<ur.length;or++)lr=ur[or],cr=lr._getVersion,cr=cr(lr._source),ar.mutableSourceEagerHydrationData==null?ar.mutableSourceEagerHydrationData=[lr,cr]:ar.mutableSourceEagerHydrationData.push(lr,cr);return new ml(ar)};reactDom_production_min.render=function(or,ar,lr){if(!ol(ar))throw Error(p$2(200));return rl(null,or,ar,!1,lr)};reactDom_production_min.unmountComponentAtNode=function(or){if(!ol(or))throw Error(p$2(40));return or._reactRootContainer?(Rk(function(){rl(null,null,or,!1,function(){or._reactRootContainer=null,or[uf]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(or,ar,lr,ur){if(!ol(lr))throw Error(p$2(200));if(or==null||or._reactInternals===void 0)throw Error(p$2(38));return rl(or,ar,lr,!1,ur)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(or){console.error(or)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports,m$1=reactDomExports;client.createRoot=m$1.createRoot,client.hydrateRoot=m$1.hydrateRoot;const scriptRel="modulepreload",assetsURL=function(or){return"/book-character-tracker/"+or},seen={},__vitePreload=function(ar,lr,ur){let cr=Promise.resolve();if(lr&&lr.length>0){document.getElementsByTagName("link");const dr=document.querySelector("meta[property=csp-nonce]"),fr=(dr==null?void 0:dr.nonce)||(dr==null?void 0:dr.getAttribute("nonce"));cr=Promise.allSettled(lr.map(pr=>{if(pr=assetsURL(pr),pr in seen)return;seen[pr]=!0;const vr=pr.endsWith(".css"),gr=vr?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${pr}"]${gr}`))return;const mr=document.createElement("link");if(mr.rel=vr?"stylesheet":scriptRel,vr||(mr.as="script"),mr.crossOrigin="",mr.href=pr,fr&&mr.setAttribute("nonce",fr),document.head.appendChild(mr),vr)return new Promise((br,yr)=>{mr.addEventListener("load",br),mr.addEventListener("error",()=>yr(new Error(`Unable to preload CSS for ${pr}`)))})}))}function hr(dr){const fr=new Event("vite:preloadError",{cancelable:!0});if(fr.payload=dr,window.dispatchEvent(fr),!fr.defaultPrevented)throw dr}return cr.then(dr=>{for(const fr of dr||[])fr.status==="rejected"&&hr(fr.reason);return ar().catch(hr)})},e=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,t=Object.keys,n=Array.isArray;function r(or,ar){return typeof ar!="object"||t(ar).forEach(function(lr){or[lr]=ar[lr]}),or}typeof Promise>"u"||e.Promise||(e.Promise=Promise);const s=Object.getPrototypeOf,i$1={}.hasOwnProperty;function o(or,ar){return i$1.call(or,ar)}function a(or,ar){typeof ar=="function"&&(ar=ar(s(or))),(typeof Reflect>"u"?t:Reflect.ownKeys)(ar).forEach(lr=>{l(or,lr,ar[lr])})}const u=Object.defineProperty;function l(or,ar,lr,ur){u(or,ar,r(lr&&o(lr,"get")&&typeof lr.get=="function"?{get:lr.get,set:lr.set,configurable:!0}:{value:lr,configurable:!0,writable:!0},ur))}function c(or){return{from:function(ar){return or.prototype=Object.create(ar.prototype),l(or.prototype,"constructor",or),{extend:a.bind(null,or.prototype)}}}}const h=Object.getOwnPropertyDescriptor;function d(or,ar){let lr;return h(or,ar)||(lr=s(or))&&d(lr,ar)}const f=[].slice;function p$1(or,ar,lr){return f.call(or,ar,lr)}function y$1(or,ar){return ar(or)}function m(or){if(!or)throw new Error("Assertion Failed")}function v(or){e.setImmediate?setImmediate(or):setTimeout(or,0)}function g(or,ar){return or.reduce((lr,ur,cr)=>{var hr=ar(ur,cr);return hr&&(lr[hr[0]]=hr[1]),lr},{})}function b(or,ar){if(typeof ar=="string"&&o(or,ar))return or[ar];if(!ar)return or;if(typeof ar!="string"){for(var lr=[],ur=0,cr=ar.length;ur<cr;++ur){var hr=b(or,ar[ur]);lr.push(hr)}return lr}var dr=ar.indexOf(".");if(dr!==-1){var fr=or[ar.substr(0,dr)];return fr==null?void 0:b(fr,ar.substr(dr+1))}}function _(or,ar,lr){if(or&&ar!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(or)))if(typeof ar!="string"&&"length"in ar){m(typeof lr!="string"&&"length"in lr);for(var ur=0,cr=ar.length;ur<cr;++ur)_(or,ar[ur],lr[ur])}else{var hr=ar.indexOf(".");if(hr!==-1){var dr=ar.substr(0,hr),fr=ar.substr(hr+1);if(fr==="")lr===void 0?n(or)&&!isNaN(parseInt(dr))?or.splice(dr,1):delete or[dr]:or[dr]=lr;else{var pr=or[dr];pr&&o(or,dr)||(pr=or[dr]={}),_(pr,fr,lr)}}else lr===void 0?n(or)&&!isNaN(parseInt(ar))?or.splice(ar,1):delete or[ar]:or[ar]=lr}}function w(or){var ar={};for(var lr in or)o(or,lr)&&(ar[lr]=or[lr]);return ar}const x$1=[].concat;function k(or){return x$1.apply([],or)}const E="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(k([8,16,32,64].map(or=>["Int","Uint","Float"].map(ar=>ar+or+"Array")))).filter(or=>e[or]),P=E.map(or=>e[or]);g(E,or=>[or,!0]);let K$1=null;function O(or){K$1=typeof WeakMap<"u"&&new WeakMap;const ar=S(or);return K$1=null,ar}function S(or){if(!or||typeof or!="object")return or;let ar=K$1&&K$1.get(or);if(ar)return ar;if(n(or)){ar=[],K$1&&K$1.set(or,ar);for(var lr=0,ur=or.length;lr<ur;++lr)ar.push(S(or[lr]))}else if(P.indexOf(or.constructor)>=0)ar=or;else{const hr=s(or);for(var cr in ar=hr===Object.prototype?{}:Object.create(hr),K$1&&K$1.set(or,ar),or)o(or,cr)&&(ar[cr]=S(or[cr]))}return ar}const{toString:A}={};function C(or){return A.call(or).slice(8,-1)}const j=typeof Symbol<"u"?Symbol.iterator:"@@iterator",D=typeof j=="symbol"?function(or){var ar;return or!=null&&(ar=or[j])&&ar.apply(or)}:function(){return null},I={};function B(or){var ar,lr,ur,cr;if(arguments.length===1){if(n(or))return or.slice();if(this===I&&typeof or=="string")return[or];if(cr=D(or)){for(lr=[];!(ur=cr.next()).done;)lr.push(ur.value);return lr}if(or==null)return[or];if(typeof(ar=or.length)=="number"){for(lr=new Array(ar);ar--;)lr[ar]=or[ar];return lr}return[or]}for(ar=arguments.length,lr=new Array(ar);ar--;)lr[ar]=arguments[ar];return lr}const T=typeof Symbol<"u"?or=>or[Symbol.toStringTag]==="AsyncFunction":()=>!1;var R=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function F(or,ar){R=or,M=ar}var M=()=>!0;const N=!new Error("").stack;function q(){if(N)try{throw q.arguments,new Error}catch(or){return or}return new Error}function $(or,ar){var lr=or.stack;return lr?(ar=ar||0,lr.indexOf(or.name)===0&&(ar+=(or.name+or.message).split(`
`).length),lr.split(`
`).slice(ar).filter(M).map(ur=>`
`+ur).join("")):""}var U=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],L=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(U),V={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function W(or,ar){this._e=q(),this.name=or,this.message=ar}function Y(or,ar){return or+". Errors: "+Object.keys(ar).map(lr=>ar[lr].toString()).filter((lr,ur,cr)=>cr.indexOf(lr)===ur).join(`
`)}function z(or,ar,lr,ur){this._e=q(),this.failures=ar,this.failedKeys=ur,this.successCount=lr,this.message=Y(or,ar)}function G(or,ar){this._e=q(),this.name="BulkError",this.failures=Object.keys(ar).map(lr=>ar[lr]),this.failuresByPos=ar,this.message=Y(or,ar)}c(W).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+$(this._e,2))}},toString:function(){return this.name+": "+this.message}}),c(z).from(W),c(G).from(W);var H=L.reduce((or,ar)=>(or[ar]=ar+"Error",or),{});const Q=W;var X=L.reduce((or,ar)=>{var lr=ar+"Error";function ur(cr,hr){this._e=q(),this.name=lr,cr?typeof cr=="string"?(this.message=`${cr}${hr?`
 `+hr:""}`,this.inner=hr||null):typeof cr=="object"&&(this.message=`${cr.name} ${cr.message}`,this.inner=cr):(this.message=V[ar]||lr,this.inner=null)}return c(ur).from(Q),or[ar]=ur,or},{});X.Syntax=SyntaxError,X.Type=TypeError,X.Range=RangeError;var J=U.reduce((or,ar)=>(or[ar+"Error"]=X[ar],or),{}),Z=L.reduce((or,ar)=>(["Syntax","Type","Range"].indexOf(ar)===-1&&(or[ar+"Error"]=X[ar]),or),{});function ee(){}function te(or){return or}function ne(or,ar){return or==null||or===te?ar:function(lr){return ar(or(lr))}}function re(or,ar){return function(){or.apply(this,arguments),ar.apply(this,arguments)}}function se(or,ar){return or===ee?ar:function(){var lr=or.apply(this,arguments);lr!==void 0&&(arguments[0]=lr);var ur=this.onsuccess,cr=this.onerror;this.onsuccess=null,this.onerror=null;var hr=ar.apply(this,arguments);return ur&&(this.onsuccess=this.onsuccess?re(ur,this.onsuccess):ur),cr&&(this.onerror=this.onerror?re(cr,this.onerror):cr),hr!==void 0?hr:lr}}function ie(or,ar){return or===ee?ar:function(){or.apply(this,arguments);var lr=this.onsuccess,ur=this.onerror;this.onsuccess=this.onerror=null,ar.apply(this,arguments),lr&&(this.onsuccess=this.onsuccess?re(lr,this.onsuccess):lr),ur&&(this.onerror=this.onerror?re(ur,this.onerror):ur)}}function oe(or,ar){return or===ee?ar:function(lr){var ur=or.apply(this,arguments);r(lr,ur);var cr=this.onsuccess,hr=this.onerror;this.onsuccess=null,this.onerror=null;var dr=ar.apply(this,arguments);return cr&&(this.onsuccess=this.onsuccess?re(cr,this.onsuccess):cr),hr&&(this.onerror=this.onerror?re(hr,this.onerror):hr),ur===void 0?dr===void 0?void 0:dr:r(ur,dr)}}function ae(or,ar){return or===ee?ar:function(){return ar.apply(this,arguments)!==!1&&or.apply(this,arguments)}}function ue(or,ar){return or===ee?ar:function(){var lr=or.apply(this,arguments);if(lr&&typeof lr.then=="function"){for(var ur=this,cr=arguments.length,hr=new Array(cr);cr--;)hr[cr]=arguments[cr];return lr.then(function(){return ar.apply(ur,hr)})}return ar.apply(this,arguments)}}Z.ModifyError=z,Z.DexieError=W,Z.BulkError=G;var le={};const ce=100,[he,de,fe]=typeof Promise>"u"?[]:(()=>{let or=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[or,s(or),or];const ar=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[ar,s(ar),or]})(),pe=de&&de.then,ye=he&&he.constructor,me=!!fe;var ve=!1,ge=fe?()=>{fe.then($e)}:e.setImmediate?setImmediate.bind(null,$e):e.MutationObserver?()=>{var or=document.createElement("div");new MutationObserver(()=>{$e(),or=null}).observe(or,{attributes:!0}),or.setAttribute("i","1")}:()=>{setTimeout($e,0)},be=function(or,ar){Se.push([or,ar]),we&&(ge(),we=!1)},_e=!0,we=!0,xe=[],ke=[],Ee=null,Pe=te,Ke={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:dt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(or=>{try{dt(or[0],or[1])}catch{}})}},Oe=Ke,Se=[],Ae=0,Ce=[];function je(or){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ee,this._lib=!1;var ar=this._PSD=Oe;if(R&&(this._stackHolder=q(),this._prev=null,this._numPrev=0),typeof or!="function"){if(or!==le)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&Te(this,this._value))}this._state=null,this._value=null,++ar.ref,Be(this,or)}const De={get:function(){var or=Oe,ar=Xe;function lr(ur,cr){var hr=!or.global&&(or!==Oe||ar!==Xe);const dr=hr&&!tt();var fr=new je((pr,vr)=>{Fe(this,new Ie(lt(ur,or,hr,dr),lt(cr,or,hr,dr),pr,vr,or))});return R&&qe(fr,this),fr}return lr.prototype=le,lr},set:function(or){l(this,"then",or&&or.prototype===le?De:{get:function(){return or},set:De.set})}};function Ie(or,ar,lr,ur,cr){this.onFulfilled=typeof or=="function"?or:null,this.onRejected=typeof ar=="function"?ar:null,this.resolve=lr,this.reject=ur,this.psd=cr}function Be(or,ar){try{ar(lr=>{if(or._state===null){if(lr===or)throw new TypeError("A promise cannot be resolved with itself.");var ur=or._lib&&Ue();lr&&typeof lr.then=="function"?Be(or,(cr,hr)=>{lr instanceof je?lr._then(cr,hr):lr.then(cr,hr)}):(or._state=!0,or._value=lr,Re(or)),ur&&Le()}},Te.bind(null,or))}catch(lr){Te(or,lr)}}function Te(or,ar){if(ke.push(ar),or._state===null){var lr=or._lib&&Ue();ar=Pe(ar),or._state=!1,or._value=ar,R&&ar!==null&&typeof ar=="object"&&!ar._promise&&function(ur,cr,hr){try{ur.apply(null,hr)}catch{}}(()=>{var ur=d(ar,"stack");ar._promise=or,l(ar,"stack",{get:()=>ve?ur&&(ur.get?ur.get.apply(ar):ur.value):or.stack})}),function(ur){xe.some(cr=>cr._value===ur._value)||xe.push(ur)}(or),Re(or),lr&&Le()}}function Re(or){var ar=or._listeners;or._listeners=[];for(var lr=0,ur=ar.length;lr<ur;++lr)Fe(or,ar[lr]);var cr=or._PSD;--cr.ref||cr.finalize(),Ae===0&&(++Ae,be(()=>{--Ae==0&&Ve()},[]))}function Fe(or,ar){if(or._state!==null){var lr=or._state?ar.onFulfilled:ar.onRejected;if(lr===null)return(or._state?ar.resolve:ar.reject)(or._value);++ar.psd.ref,++Ae,be(Me,[lr,or,ar])}else or._listeners.push(ar)}function Me(or,ar,lr){try{Ee=ar;var ur,cr=ar._value;ar._state?ur=or(cr):(ke.length&&(ke=[]),ur=or(cr),ke.indexOf(cr)===-1&&function(hr){for(var dr=xe.length;dr;)if(xe[--dr]._value===hr._value)return void xe.splice(dr,1)}(ar)),lr.resolve(ur)}catch(hr){lr.reject(hr)}finally{Ee=null,--Ae==0&&Ve(),--lr.psd.ref||lr.psd.finalize()}}function Ne(or,ar,lr){if(ar.length===lr)return ar;var ur="";if(or._state===!1){var cr,hr,dr=or._value;dr!=null?(cr=dr.name||"Error",hr=dr.message||dr,ur=$(dr,0)):(cr=dr,hr=""),ar.push(cr+(hr?": "+hr:"")+ur)}return R&&((ur=$(or._stackHolder,2))&&ar.indexOf(ur)===-1&&ar.push(ur),or._prev&&Ne(or._prev,ar,lr)),ar}function qe(or,ar){var lr=ar?ar._numPrev+1:0;lr<100&&(or._prev=ar,or._numPrev=lr)}function $e(){Ue()&&Le()}function Ue(){var or=_e;return _e=!1,we=!1,or}function Le(){var or,ar,lr;do for(;Se.length>0;)for(or=Se,Se=[],lr=or.length,ar=0;ar<lr;++ar){var ur=or[ar];ur[0].apply(null,ur[1])}while(Se.length>0);_e=!0,we=!0}function Ve(){var or=xe;xe=[],or.forEach(ur=>{ur._PSD.onunhandled.call(null,ur._value,ur)});for(var ar=Ce.slice(0),lr=ar.length;lr;)ar[--lr]()}function We(or){return new je(le,!1,or)}function Ye(or,ar){var lr=Oe;return function(){var ur=Ue(),cr=Oe;try{return it(lr,!0),or.apply(this,arguments)}catch(hr){ar&&ar(hr)}finally{it(cr,!1),ur&&Le()}}}a(je.prototype,{then:De,_then:function(or,ar){Fe(this,new Ie(null,null,or,ar,Oe))},catch:function(or){if(arguments.length===1)return this.then(null,or);var ar=arguments[0],lr=arguments[1];return typeof ar=="function"?this.then(null,ur=>ur instanceof ar?lr(ur):We(ur)):this.then(null,ur=>ur&&ur.name===ar?lr(ur):We(ur))},finally:function(or){return this.then(ar=>(or(),ar),ar=>(or(),We(ar)))},stack:{get:function(){if(this._stack)return this._stack;try{ve=!0;var or=Ne(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=or),or}finally{ve=!1}}},timeout:function(or,ar){return or<1/0?new je((lr,ur)=>{var cr=setTimeout(()=>ur(new X.Timeout(ar)),or);this.then(lr,ur).finally(clearTimeout.bind(null,cr))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&l(je.prototype,Symbol.toStringTag,"Dexie.Promise"),Ke.env=ot(),a(je,{all:function(){var or=B.apply(null,arguments).map(nt);return new je(function(ar,lr){or.length===0&&ar([]);var ur=or.length;or.forEach((cr,hr)=>je.resolve(cr).then(dr=>{or[hr]=dr,--ur||ar(or)},lr))})},resolve:or=>{if(or instanceof je)return or;if(or&&typeof or.then=="function")return new je((lr,ur)=>{or.then(lr,ur)});var ar=new je(le,!0,or);return qe(ar,Ee),ar},reject:We,race:function(){var or=B.apply(null,arguments).map(nt);return new je((ar,lr)=>{or.map(ur=>je.resolve(ur).then(ar,lr))})},PSD:{get:()=>Oe,set:or=>Oe=or},totalEchoes:{get:()=>Xe},newPSD:Ze,usePSD:at,scheduler:{get:()=>be,set:or=>{be=or}},rejectionMapper:{get:()=>Pe,set:or=>{Pe=or}},follow:(or,ar)=>new je((lr,ur)=>Ze((cr,hr)=>{var dr=Oe;dr.unhandleds=[],dr.onunhandled=hr,dr.finalize=re(function(){(function(fr){function pr(){fr(),Ce.splice(Ce.indexOf(pr),1)}Ce.push(pr),++Ae,be(()=>{--Ae==0&&Ve()},[])})(()=>{this.unhandleds.length===0?cr():hr(this.unhandleds[0])})},dr.finalize),or()},ar,lr,ur))}),ye&&(ye.allSettled&&l(je,"allSettled",function(){const or=B.apply(null,arguments).map(nt);return new je(ar=>{or.length===0&&ar([]);let lr=or.length;const ur=new Array(lr);or.forEach((cr,hr)=>je.resolve(cr).then(dr=>ur[hr]={status:"fulfilled",value:dr},dr=>ur[hr]={status:"rejected",reason:dr}).then(()=>--lr||ar(ur)))})}),ye.any&&typeof AggregateError<"u"&&l(je,"any",function(){const or=B.apply(null,arguments).map(nt);return new je((ar,lr)=>{or.length===0&&lr(new AggregateError([]));let ur=or.length;const cr=new Array(ur);or.forEach((hr,dr)=>je.resolve(hr).then(fr=>ar(fr),fr=>{cr[dr]=fr,--ur||lr(new AggregateError(cr))}))})}));const ze={awaits:0,echoes:0,id:0};var Ge=0,He=[],Qe=0,Xe=0,Je=0;function Ze(or,ar,lr,ur){var cr=Oe,hr=Object.create(cr);hr.parent=cr,hr.ref=0,hr.global=!1,hr.id=++Je;var dr=Ke.env;hr.env=me?{Promise:je,PromiseProp:{value:je,configurable:!0,writable:!0},all:je.all,race:je.race,allSettled:je.allSettled,any:je.any,resolve:je.resolve,reject:je.reject,nthen:ct(dr.nthen,hr),gthen:ct(dr.gthen,hr)}:{},ar&&r(hr,ar),++cr.ref,hr.finalize=function(){--this.parent.ref||this.parent.finalize()};var fr=at(hr,or,lr,ur);return hr.ref===0&&hr.finalize(),fr}function et(){return ze.id||(ze.id=++Ge),++ze.awaits,ze.echoes+=ce,ze.id}function tt(){return!!ze.awaits&&(--ze.awaits==0&&(ze.id=0),ze.echoes=ze.awaits*ce,!0)}function nt(or){return ze.echoes&&or&&or.constructor===ye?(et(),or.then(ar=>(tt(),ar),ar=>(tt(),ft(ar)))):or}function rt(or){++Xe,ze.echoes&&--ze.echoes!=0||(ze.echoes=ze.id=0),He.push(Oe),it(or,!0)}function st(){var or=He[He.length-1];He.pop(),it(or,!1)}function it(or,ar){var lr=Oe;if((ar?!ze.echoes||Qe++&&or===Oe:!Qe||--Qe&&or===Oe)||ut(ar?rt.bind(null,or):st),or!==Oe&&(Oe=or,lr===Ke&&(Ke.env=ot()),me)){var ur=Ke.env.Promise,cr=or.env;de.then=cr.nthen,ur.prototype.then=cr.gthen,(lr.global||or.global)&&(Object.defineProperty(e,"Promise",cr.PromiseProp),ur.all=cr.all,ur.race=cr.race,ur.resolve=cr.resolve,ur.reject=cr.reject,cr.allSettled&&(ur.allSettled=cr.allSettled),cr.any&&(ur.any=cr.any))}}function ot(){var or=e.Promise;return me?{Promise:or,PromiseProp:Object.getOwnPropertyDescriptor(e,"Promise"),all:or.all,race:or.race,allSettled:or.allSettled,any:or.any,resolve:or.resolve,reject:or.reject,nthen:de.then,gthen:or.prototype.then}:{}}function at(or,ar,lr,ur,cr){var hr=Oe;try{return it(or,!0),ar(lr,ur,cr)}finally{it(hr,!1)}}function ut(or){pe.call(he,or)}function lt(or,ar,lr,ur){return typeof or!="function"?or:function(){var cr=Oe;lr&&et(),it(ar,!0);try{return or.apply(this,arguments)}finally{it(cr,!1),ur&&ut(tt)}}}function ct(or,ar){return function(lr,ur){return or.call(this,lt(lr,ar),lt(ur,ar))}}(""+pe).indexOf("[native code]")===-1&&(et=tt=ee);const ht="unhandledrejection";function dt(or,ar){var lr;try{lr=ar.onuncatched(or)}catch{}if(lr!==!1)try{var ur,cr={promise:ar,reason:or};if(e.document&&document.createEvent?((ur=document.createEvent("Event")).initEvent(ht,!0,!0),r(ur,cr)):e.CustomEvent&&r(ur=new CustomEvent(ht,{detail:cr}),cr),ur&&e.dispatchEvent&&(dispatchEvent(ur),!e.PromiseRejectionEvent&&e.onunhandledrejection))try{e.onunhandledrejection(ur)}catch{}R&&ur&&!ur.defaultPrevented&&console.warn(`Unhandled rejection: ${or.stack||or}`)}catch{}}var ft=je.reject;function pt(or,ar,lr,ur){if(or.idbdb&&(or._state.openComplete||Oe.letThrough||or._vip)){var cr=or._createTransaction(ar,lr,or._dbSchema);try{cr.create(),or._state.PR1398_maxLoop=3}catch(hr){return hr.name===H.InvalidState&&or.isOpen()&&--or._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),or._close(),or.open().then(()=>pt(or,ar,lr,ur))):ft(hr)}return cr._promise(ar,(hr,dr)=>Ze(()=>(Oe.trans=cr,ur(hr,dr,cr)))).then(hr=>cr._completion.then(()=>hr))}if(or._state.openComplete)return ft(new X.DatabaseClosed(or._state.dbOpenError));if(!or._state.isBeingOpened){if(!or._options.autoOpen)return ft(new X.DatabaseClosed);or.open().catch(ee)}return or._state.dbReadyPromise.then(()=>pt(or,ar,lr,ur))}const yt="3.2.7",mt="",vt=-1/0,gt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",bt="String expected.",_t=[],wt=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),xt=wt,kt=wt,Et=or=>!/(dexie\.js|dexie\.min\.js)/.test(or),Pt="__dbnames",Kt="readonly",Ot="readwrite";function St(or,ar){return or?ar?function(){return or.apply(this,arguments)&&ar.apply(this,arguments)}:or:ar}const At={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ct(or){return typeof or!="string"||/\./.test(or)?ar=>ar:ar=>(ar[or]===void 0&&or in ar&&delete(ar=O(ar))[or],ar)}class jt{_trans(ar,lr,ur){const cr=this._tx||Oe.trans,hr=this.name;function dr(pr,vr,gr){if(!gr.schema[hr])throw new X.NotFound("Table "+hr+" not part of transaction");return lr(gr.idbtrans,gr)}const fr=Ue();try{return cr&&cr.db===this.db?cr===Oe.trans?cr._promise(ar,dr,ur):Ze(()=>cr._promise(ar,dr,ur),{trans:cr,transless:Oe.transless||Oe}):pt(this.db,ar,[this.name],dr)}finally{fr&&Le()}}get(ar,lr){return ar&&ar.constructor===Object?this.where(ar).first(lr):this._trans("readonly",ur=>this.core.get({trans:ur,key:ar}).then(cr=>this.hook.reading.fire(cr))).then(lr)}where(ar){if(typeof ar=="string")return new this.db.WhereClause(this,ar);if(n(ar))return new this.db.WhereClause(this,`[${ar.join("+")}]`);const lr=t(ar);if(lr.length===1)return this.where(lr[0]).equals(ar[lr[0]]);const ur=this.schema.indexes.concat(this.schema.primKey).filter(vr=>{if(vr.compound&&lr.every(gr=>vr.keyPath.indexOf(gr)>=0)){for(let gr=0;gr<lr.length;++gr)if(lr.indexOf(vr.keyPath[gr])===-1)return!1;return!0}return!1}).sort((vr,gr)=>vr.keyPath.length-gr.keyPath.length)[0];if(ur&&this.db._maxKey!==mt){const vr=ur.keyPath.slice(0,lr.length);return this.where(vr).equals(vr.map(gr=>ar[gr]))}!ur&&R&&console.warn(`The query ${JSON.stringify(ar)} on ${this.name} would benefit of a compound index [${lr.join("+")}]`);const{idxByName:cr}=this.schema,hr=this.db._deps.indexedDB;function dr(vr,gr){try{return hr.cmp(vr,gr)===0}catch{return!1}}const[fr,pr]=lr.reduce(([vr,gr],mr)=>{const br=cr[mr],yr=ar[mr];return[vr||br,vr||!br?St(gr,br&&br.multi?xr=>{const Cr=b(xr,mr);return n(Cr)&&Cr.some(Sr=>dr(yr,Sr))}:xr=>dr(yr,b(xr,mr))):gr]},[null,null]);return fr?this.where(fr.name).equals(ar[fr.keyPath]).filter(pr):ur?this.filter(pr):this.where(lr).equals("")}filter(ar){return this.toCollection().and(ar)}count(ar){return this.toCollection().count(ar)}offset(ar){return this.toCollection().offset(ar)}limit(ar){return this.toCollection().limit(ar)}each(ar){return this.toCollection().each(ar)}toArray(ar){return this.toCollection().toArray(ar)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(ar){return new this.db.Collection(new this.db.WhereClause(this,n(ar)?`[${ar.join("+")}]`:ar))}reverse(){return this.toCollection().reverse()}mapToClass(ar){this.schema.mappedClass=ar;const lr=ur=>{if(!ur)return ur;const cr=Object.create(ar.prototype);for(var hr in ur)if(o(ur,hr))try{cr[hr]=ur[hr]}catch{}return cr};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=lr,this.hook("reading",lr),ar}defineClass(){return this.mapToClass(function(ar){r(this,ar)})}add(ar,lr){const{auto:ur,keyPath:cr}=this.schema.primKey;let hr=ar;return cr&&ur&&(hr=Ct(cr)(ar)),this._trans("readwrite",dr=>this.core.mutate({trans:dr,type:"add",keys:lr!=null?[lr]:null,values:[hr]})).then(dr=>dr.numFailures?je.reject(dr.failures[0]):dr.lastResult).then(dr=>{if(cr)try{_(ar,cr,dr)}catch{}return dr})}update(ar,lr){if(typeof ar!="object"||n(ar))return this.where(":id").equals(ar).modify(lr);{const ur=b(ar,this.schema.primKey.keyPath);if(ur===void 0)return ft(new X.InvalidArgument("Given object does not contain its primary key"));try{typeof lr!="function"?t(lr).forEach(cr=>{_(ar,cr,lr[cr])}):lr(ar,{value:ar,primKey:ur})}catch{}return this.where(":id").equals(ur).modify(lr)}}put(ar,lr){const{auto:ur,keyPath:cr}=this.schema.primKey;let hr=ar;return cr&&ur&&(hr=Ct(cr)(ar)),this._trans("readwrite",dr=>this.core.mutate({trans:dr,type:"put",values:[hr],keys:lr!=null?[lr]:null})).then(dr=>dr.numFailures?je.reject(dr.failures[0]):dr.lastResult).then(dr=>{if(cr)try{_(ar,cr,dr)}catch{}return dr})}delete(ar){return this._trans("readwrite",lr=>this.core.mutate({trans:lr,type:"delete",keys:[ar]})).then(lr=>lr.numFailures?je.reject(lr.failures[0]):void 0)}clear(){return this._trans("readwrite",ar=>this.core.mutate({trans:ar,type:"deleteRange",range:At})).then(ar=>ar.numFailures?je.reject(ar.failures[0]):void 0)}bulkGet(ar){return this._trans("readonly",lr=>this.core.getMany({keys:ar,trans:lr}).then(ur=>ur.map(cr=>this.hook.reading.fire(cr))))}bulkAdd(ar,lr,ur){const cr=Array.isArray(lr)?lr:void 0,hr=(ur=ur||(cr?void 0:lr))?ur.allKeys:void 0;return this._trans("readwrite",dr=>{const{auto:fr,keyPath:pr}=this.schema.primKey;if(pr&&cr)throw new X.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(cr&&cr.length!==ar.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");const vr=ar.length;let gr=pr&&fr?ar.map(Ct(pr)):ar;return this.core.mutate({trans:dr,type:"add",keys:cr,values:gr,wantResults:hr}).then(({numFailures:mr,results:br,lastResult:yr,failures:xr})=>{if(mr===0)return hr?br:yr;throw new G(`${this.name}.bulkAdd(): ${mr} of ${vr} operations failed`,xr)})})}bulkPut(ar,lr,ur){const cr=Array.isArray(lr)?lr:void 0,hr=(ur=ur||(cr?void 0:lr))?ur.allKeys:void 0;return this._trans("readwrite",dr=>{const{auto:fr,keyPath:pr}=this.schema.primKey;if(pr&&cr)throw new X.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(cr&&cr.length!==ar.length)throw new X.InvalidArgument("Arguments objects and keys must have the same length");const vr=ar.length;let gr=pr&&fr?ar.map(Ct(pr)):ar;return this.core.mutate({trans:dr,type:"put",keys:cr,values:gr,wantResults:hr}).then(({numFailures:mr,results:br,lastResult:yr,failures:xr})=>{if(mr===0)return hr?br:yr;throw new G(`${this.name}.bulkPut(): ${mr} of ${vr} operations failed`,xr)})})}bulkDelete(ar){const lr=ar.length;return this._trans("readwrite",ur=>this.core.mutate({trans:ur,type:"delete",keys:ar})).then(({numFailures:ur,lastResult:cr,failures:hr})=>{if(ur===0)return cr;throw new G(`${this.name}.bulkDelete(): ${ur} of ${lr} operations failed`,hr)})}}function Dt(or){var ar={},lr=function(dr,fr){if(fr){for(var pr=arguments.length,vr=new Array(pr-1);--pr;)vr[pr-1]=arguments[pr];return ar[dr].subscribe.apply(null,vr),or}if(typeof dr=="string")return ar[dr]};lr.addEventType=hr;for(var ur=1,cr=arguments.length;ur<cr;++ur)hr(arguments[ur]);return lr;function hr(dr,fr,pr){if(typeof dr!="object"){var vr;fr||(fr=ae),pr||(pr=ee);var gr={subscribers:[],fire:pr,subscribe:function(mr){gr.subscribers.indexOf(mr)===-1&&(gr.subscribers.push(mr),gr.fire=fr(gr.fire,mr))},unsubscribe:function(mr){gr.subscribers=gr.subscribers.filter(function(br){return br!==mr}),gr.fire=gr.subscribers.reduce(fr,pr)}};return ar[dr]=lr[dr]=gr,gr}t(vr=dr).forEach(function(mr){var br=vr[mr];if(n(br))hr(mr,vr[mr][0],vr[mr][1]);else{if(br!=="asap")throw new X.InvalidArgument("Invalid event config");var yr=hr(mr,te,function(){for(var xr=arguments.length,Cr=new Array(xr);xr--;)Cr[xr]=arguments[xr];yr.subscribers.forEach(function(Sr){v(function(){Sr.apply(null,Cr)})})})}})}}function It(or,ar){return c(ar).from({prototype:or}),ar}function Bt(or,ar){return!(or.filter||or.algorithm||or.or)&&(ar?or.justLimit:!or.replayFilter)}function Tt(or,ar){or.filter=St(or.filter,ar)}function Rt(or,ar,lr){var ur=or.replayFilter;or.replayFilter=ur?()=>St(ur(),ar()):ar,or.justLimit=lr&&!ur}function Ft(or,ar){if(or.isPrimKey)return ar.primaryKey;const lr=ar.getIndexByKeyPath(or.index);if(!lr)throw new X.Schema("KeyPath "+or.index+" on object store "+ar.name+" is not indexed");return lr}function Mt(or,ar,lr){const ur=Ft(or,ar.schema);return ar.openCursor({trans:lr,values:!or.keysOnly,reverse:or.dir==="prev",unique:!!or.unique,query:{index:ur,range:or.range}})}function Nt(or,ar,lr,ur){const cr=or.replayFilter?St(or.filter,or.replayFilter()):or.filter;if(or.or){const hr={},dr=(fr,pr,vr)=>{if(!cr||cr(pr,vr,br=>pr.stop(br),br=>pr.fail(br))){var gr=pr.primaryKey,mr=""+gr;mr==="[object ArrayBuffer]"&&(mr=""+new Uint8Array(gr)),o(hr,mr)||(hr[mr]=!0,ar(fr,pr,vr))}};return Promise.all([or.or._iterate(dr,lr),qt(Mt(or,ur,lr),or.algorithm,dr,!or.keysOnly&&or.valueMapper)])}return qt(Mt(or,ur,lr),St(or.algorithm,cr),ar,!or.keysOnly&&or.valueMapper)}function qt(or,ar,lr,ur){var cr=Ye(ur?(hr,dr,fr)=>lr(ur(hr),dr,fr):lr);return or.then(hr=>{if(hr)return hr.start(()=>{var dr=()=>hr.continue();ar&&!ar(hr,fr=>dr=fr,fr=>{hr.stop(fr),dr=ee},fr=>{hr.fail(fr),dr=ee})||cr(hr.value,hr,fr=>dr=fr),dr()})})}function $t(or,ar){try{const lr=Ut(or),ur=Ut(ar);if(lr!==ur)return lr==="Array"?1:ur==="Array"?-1:lr==="binary"?1:ur==="binary"?-1:lr==="string"?1:ur==="string"?-1:lr==="Date"?1:ur!=="Date"?NaN:-1;switch(lr){case"number":case"Date":case"string":return or>ar?1:or<ar?-1:0;case"binary":return function(cr,hr){const dr=cr.length,fr=hr.length,pr=dr<fr?dr:fr;for(let vr=0;vr<pr;++vr)if(cr[vr]!==hr[vr])return cr[vr]<hr[vr]?-1:1;return dr===fr?0:dr<fr?-1:1}(Lt(or),Lt(ar));case"Array":return function(cr,hr){const dr=cr.length,fr=hr.length,pr=dr<fr?dr:fr;for(let vr=0;vr<pr;++vr){const gr=$t(cr[vr],hr[vr]);if(gr!==0)return gr}return dr===fr?0:dr<fr?-1:1}(or,ar)}}catch{}return NaN}function Ut(or){const ar=typeof or;if(ar!=="object")return ar;if(ArrayBuffer.isView(or))return"binary";const lr=C(or);return lr==="ArrayBuffer"?"binary":lr}function Lt(or){return or instanceof Uint8Array?or:ArrayBuffer.isView(or)?new Uint8Array(or.buffer,or.byteOffset,or.byteLength):new Uint8Array(or)}class Vt{_read(ar,lr){var ur=this._ctx;return ur.error?ur.table._trans(null,ft.bind(null,ur.error)):ur.table._trans("readonly",ar).then(lr)}_write(ar){var lr=this._ctx;return lr.error?lr.table._trans(null,ft.bind(null,lr.error)):lr.table._trans("readwrite",ar,"locked")}_addAlgorithm(ar){var lr=this._ctx;lr.algorithm=St(lr.algorithm,ar)}_iterate(ar,lr){return Nt(this._ctx,ar,lr,this._ctx.table.core)}clone(ar){var lr=Object.create(this.constructor.prototype),ur=Object.create(this._ctx);return ar&&r(ur,ar),lr._ctx=ur,lr}raw(){return this._ctx.valueMapper=null,this}each(ar){var lr=this._ctx;return this._read(ur=>Nt(lr,ar,ur,lr.table.core))}count(ar){return this._read(lr=>{const ur=this._ctx,cr=ur.table.core;if(Bt(ur,!0))return cr.count({trans:lr,query:{index:Ft(ur,cr.schema),range:ur.range}}).then(dr=>Math.min(dr,ur.limit));var hr=0;return Nt(ur,()=>(++hr,!1),lr,cr).then(()=>hr)}).then(ar)}sortBy(ar,lr){const ur=ar.split(".").reverse(),cr=ur[0],hr=ur.length-1;function dr(vr,gr){return gr?dr(vr[ur[gr]],gr-1):vr[cr]}var fr=this._ctx.dir==="next"?1:-1;function pr(vr,gr){var mr=dr(vr,hr),br=dr(gr,hr);return mr<br?-fr:mr>br?fr:0}return this.toArray(function(vr){return vr.sort(pr)}).then(lr)}toArray(ar){return this._read(lr=>{var ur=this._ctx;if(ur.dir==="next"&&Bt(ur,!0)&&ur.limit>0){const{valueMapper:cr}=ur,hr=Ft(ur,ur.table.core.schema);return ur.table.core.query({trans:lr,limit:ur.limit,values:!0,query:{index:hr,range:ur.range}}).then(({result:dr})=>cr?dr.map(cr):dr)}{const cr=[];return Nt(ur,hr=>cr.push(hr),lr,ur.table.core).then(()=>cr)}},ar)}offset(ar){var lr=this._ctx;return ar<=0||(lr.offset+=ar,Bt(lr)?Rt(lr,()=>{var ur=ar;return(cr,hr)=>ur===0||(ur===1?(--ur,!1):(hr(()=>{cr.advance(ur),ur=0}),!1))}):Rt(lr,()=>{var ur=ar;return()=>--ur<0})),this}limit(ar){return this._ctx.limit=Math.min(this._ctx.limit,ar),Rt(this._ctx,()=>{var lr=ar;return function(ur,cr,hr){return--lr<=0&&cr(hr),lr>=0}},!0),this}until(ar,lr){return Tt(this._ctx,function(ur,cr,hr){return!ar(ur.value)||(cr(hr),lr)}),this}first(ar){return this.limit(1).toArray(function(lr){return lr[0]}).then(ar)}last(ar){return this.reverse().first(ar)}filter(ar){var lr,ur;return Tt(this._ctx,function(cr){return ar(cr.value)}),lr=this._ctx,ur=ar,lr.isMatch=St(lr.isMatch,ur),this}and(ar){return this.filter(ar)}or(ar){return new this.db.WhereClause(this._ctx.table,ar,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(ar){var lr=this._ctx;return lr.keysOnly=!lr.isMatch,this.each(function(ur,cr){ar(cr.key,cr)})}eachUniqueKey(ar){return this._ctx.unique="unique",this.eachKey(ar)}eachPrimaryKey(ar){var lr=this._ctx;return lr.keysOnly=!lr.isMatch,this.each(function(ur,cr){ar(cr.primaryKey,cr)})}keys(ar){var lr=this._ctx;lr.keysOnly=!lr.isMatch;var ur=[];return this.each(function(cr,hr){ur.push(hr.key)}).then(function(){return ur}).then(ar)}primaryKeys(ar){var lr=this._ctx;if(lr.dir==="next"&&Bt(lr,!0)&&lr.limit>0)return this._read(cr=>{var hr=Ft(lr,lr.table.core.schema);return lr.table.core.query({trans:cr,values:!1,limit:lr.limit,query:{index:hr,range:lr.range}})}).then(({result:cr})=>cr).then(ar);lr.keysOnly=!lr.isMatch;var ur=[];return this.each(function(cr,hr){ur.push(hr.primaryKey)}).then(function(){return ur}).then(ar)}uniqueKeys(ar){return this._ctx.unique="unique",this.keys(ar)}firstKey(ar){return this.limit(1).keys(function(lr){return lr[0]}).then(ar)}lastKey(ar){return this.reverse().firstKey(ar)}distinct(){var ar=this._ctx,lr=ar.index&&ar.table.schema.idxByName[ar.index];if(!lr||!lr.multi)return this;var ur={};return Tt(this._ctx,function(cr){var hr=cr.primaryKey.toString(),dr=o(ur,hr);return ur[hr]=!0,!dr}),this}modify(ar){var lr=this._ctx;return this._write(ur=>{var cr;if(typeof ar=="function")cr=ar;else{var hr=t(ar),dr=hr.length;cr=function(Cr){for(var Sr=!1,wr=0;wr<dr;++wr){var Er=hr[wr],Ar=ar[Er];b(Cr,Er)!==Ar&&(_(Cr,Er,Ar),Sr=!0)}return Sr}}const fr=lr.table.core,{outbound:pr,extractKey:vr}=fr.schema.primaryKey,gr=this.db._options.modifyChunkSize||200,mr=[];let br=0;const yr=[],xr=(Cr,Sr)=>{const{failures:wr,numFailures:Er}=Sr;br+=Cr-Er;for(let Ar of t(wr))mr.push(wr[Ar])};return this.clone().primaryKeys().then(Cr=>{const Sr=wr=>{const Er=Math.min(gr,Cr.length-wr);return fr.getMany({trans:ur,keys:Cr.slice(wr,wr+Er),cache:"immutable"}).then(Ar=>{const Tr=[],Rr=[],Pr=pr?[]:null,_r=[];for(let Dr=0;Dr<Er;++Dr){const Nr=Ar[Dr],Lr={value:O(Nr),primKey:Cr[wr+Dr]};cr.call(Lr,Lr.value,Lr)!==!1&&(Lr.value==null?_r.push(Cr[wr+Dr]):pr||$t(vr(Nr),vr(Lr.value))===0?(Rr.push(Lr.value),pr&&Pr.push(Cr[wr+Dr])):(_r.push(Cr[wr+Dr]),Tr.push(Lr.value)))}const kr=Bt(lr)&&lr.limit===1/0&&(typeof ar!="function"||ar===Wt)&&{index:lr.index,range:lr.range};return Promise.resolve(Tr.length>0&&fr.mutate({trans:ur,type:"add",values:Tr}).then(Dr=>{for(let Nr in Dr.failures)_r.splice(parseInt(Nr),1);xr(Tr.length,Dr)})).then(()=>(Rr.length>0||kr&&typeof ar=="object")&&fr.mutate({trans:ur,type:"put",keys:Pr,values:Rr,criteria:kr,changeSpec:typeof ar!="function"&&ar}).then(Dr=>xr(Rr.length,Dr))).then(()=>(_r.length>0||kr&&ar===Wt)&&fr.mutate({trans:ur,type:"delete",keys:_r,criteria:kr}).then(Dr=>xr(_r.length,Dr))).then(()=>Cr.length>wr+Er&&Sr(wr+gr))})};return Sr(0).then(()=>{if(mr.length>0)throw new z("Error modifying one or more objects",mr,br,yr);return Cr.length})})})}delete(){var ar=this._ctx,lr=ar.range;return Bt(ar)&&(ar.isPrimKey&&!kt||lr.type===3)?this._write(ur=>{const{primaryKey:cr}=ar.table.core.schema,hr=lr;return ar.table.core.count({trans:ur,query:{index:cr,range:hr}}).then(dr=>ar.table.core.mutate({trans:ur,type:"deleteRange",range:hr}).then(({failures:fr,lastResult:pr,results:vr,numFailures:gr})=>{if(gr)throw new z("Could not delete some values",Object.keys(fr).map(mr=>fr[mr]),dr-gr);return dr-gr}))}):this.modify(Wt)}}const Wt=(or,ar)=>ar.value=null;function Yt(or,ar){return or<ar?-1:or===ar?0:1}function zt(or,ar){return or>ar?-1:or===ar?0:1}function Gt(or,ar,lr){var ur=or instanceof en?new or.Collection(or):or;return ur._ctx.error=lr?new lr(ar):new TypeError(ar),ur}function Ht(or){return new or.Collection(or,()=>Zt("")).limit(0)}function Qt(or,ar,lr,ur,cr,hr){for(var dr=Math.min(or.length,ur.length),fr=-1,pr=0;pr<dr;++pr){var vr=ar[pr];if(vr!==ur[pr])return cr(or[pr],lr[pr])<0?or.substr(0,pr)+lr[pr]+lr.substr(pr+1):cr(or[pr],ur[pr])<0?or.substr(0,pr)+ur[pr]+lr.substr(pr+1):fr>=0?or.substr(0,fr)+ar[fr]+lr.substr(fr+1):null;cr(or[pr],vr)<0&&(fr=pr)}return dr<ur.length&&hr==="next"?or+lr.substr(or.length):dr<or.length&&hr==="prev"?or.substr(0,lr.length):fr<0?null:or.substr(0,fr)+ur[fr]+lr.substr(fr+1)}function Xt(or,ar,lr,ur){var cr,hr,dr,fr,pr,vr,gr,mr=lr.length;if(!lr.every(Cr=>typeof Cr=="string"))return Gt(or,bt);function br(Cr){cr=function(wr){return wr==="next"?Er=>Er.toUpperCase():Er=>Er.toLowerCase()}(Cr),hr=function(wr){return wr==="next"?Er=>Er.toLowerCase():Er=>Er.toUpperCase()}(Cr),dr=Cr==="next"?Yt:zt;var Sr=lr.map(function(wr){return{lower:hr(wr),upper:cr(wr)}}).sort(function(wr,Er){return dr(wr.lower,Er.lower)});fr=Sr.map(function(wr){return wr.upper}),pr=Sr.map(function(wr){return wr.lower}),vr=Cr,gr=Cr==="next"?"":ur}br("next");var yr=new or.Collection(or,()=>Jt(fr[0],pr[mr-1]+ur));yr._ondirectionchange=function(Cr){br(Cr)};var xr=0;return yr._addAlgorithm(function(Cr,Sr,wr){var Er=Cr.key;if(typeof Er!="string")return!1;var Ar=hr(Er);if(ar(Ar,pr,xr))return!0;for(var Tr=null,Rr=xr;Rr<mr;++Rr){var Pr=Qt(Er,Ar,fr[Rr],pr[Rr],dr,vr);Pr===null&&Tr===null?xr=Rr+1:(Tr===null||dr(Tr,Pr)>0)&&(Tr=Pr)}return Sr(Tr!==null?function(){Cr.continue(Tr+gr)}:wr),!1}),yr}function Jt(or,ar,lr,ur){return{type:2,lower:or,upper:ar,lowerOpen:lr,upperOpen:ur}}function Zt(or){return{type:1,lower:or,upper:or}}class en{get Collection(){return this._ctx.table.db.Collection}between(ar,lr,ur,cr){ur=ur!==!1,cr=cr===!0;try{return this._cmp(ar,lr)>0||this._cmp(ar,lr)===0&&(ur||cr)&&(!ur||!cr)?Ht(this):new this.Collection(this,()=>Jt(ar,lr,!ur,!cr))}catch{return Gt(this,gt)}}equals(ar){return ar==null?Gt(this,gt):new this.Collection(this,()=>Zt(ar))}above(ar){return ar==null?Gt(this,gt):new this.Collection(this,()=>Jt(ar,void 0,!0))}aboveOrEqual(ar){return ar==null?Gt(this,gt):new this.Collection(this,()=>Jt(ar,void 0,!1))}below(ar){return ar==null?Gt(this,gt):new this.Collection(this,()=>Jt(void 0,ar,!1,!0))}belowOrEqual(ar){return ar==null?Gt(this,gt):new this.Collection(this,()=>Jt(void 0,ar))}startsWith(ar){return typeof ar!="string"?Gt(this,bt):this.between(ar,ar+mt,!0,!0)}startsWithIgnoreCase(ar){return ar===""?this.startsWith(ar):Xt(this,(lr,ur)=>lr.indexOf(ur[0])===0,[ar],mt)}equalsIgnoreCase(ar){return Xt(this,(lr,ur)=>lr===ur[0],[ar],"")}anyOfIgnoreCase(){var ar=B.apply(I,arguments);return ar.length===0?Ht(this):Xt(this,(lr,ur)=>ur.indexOf(lr)!==-1,ar,"")}startsWithAnyOfIgnoreCase(){var ar=B.apply(I,arguments);return ar.length===0?Ht(this):Xt(this,(lr,ur)=>ur.some(cr=>lr.indexOf(cr)===0),ar,mt)}anyOf(){const ar=B.apply(I,arguments);let lr=this._cmp;try{ar.sort(lr)}catch{return Gt(this,gt)}if(ar.length===0)return Ht(this);const ur=new this.Collection(this,()=>Jt(ar[0],ar[ar.length-1]));ur._ondirectionchange=hr=>{lr=hr==="next"?this._ascending:this._descending,ar.sort(lr)};let cr=0;return ur._addAlgorithm((hr,dr,fr)=>{const pr=hr.key;for(;lr(pr,ar[cr])>0;)if(++cr,cr===ar.length)return dr(fr),!1;return lr(pr,ar[cr])===0||(dr(()=>{hr.continue(ar[cr])}),!1)}),ur}notEqual(ar){return this.inAnyRange([[vt,ar],[ar,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const ar=B.apply(I,arguments);if(ar.length===0)return new this.Collection(this);try{ar.sort(this._ascending)}catch{return Gt(this,gt)}const lr=ar.reduce((ur,cr)=>ur?ur.concat([[ur[ur.length-1][1],cr]]):[[vt,cr]],null);return lr.push([ar[ar.length-1],this.db._maxKey]),this.inAnyRange(lr,{includeLowers:!1,includeUppers:!1})}inAnyRange(ar,lr){const ur=this._cmp,cr=this._ascending,hr=this._descending,dr=this._min,fr=this._max;if(ar.length===0)return Ht(this);if(!ar.every(Er=>Er[0]!==void 0&&Er[1]!==void 0&&cr(Er[0],Er[1])<=0))return Gt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",X.InvalidArgument);const pr=!lr||lr.includeLowers!==!1,vr=lr&&lr.includeUppers===!0;let gr,mr=cr;function br(Er,Ar){return mr(Er[0],Ar[0])}try{gr=ar.reduce(function(Er,Ar){let Tr=0,Rr=Er.length;for(;Tr<Rr;++Tr){const Pr=Er[Tr];if(ur(Ar[0],Pr[1])<0&&ur(Ar[1],Pr[0])>0){Pr[0]=dr(Pr[0],Ar[0]),Pr[1]=fr(Pr[1],Ar[1]);break}}return Tr===Rr&&Er.push(Ar),Er},[]),gr.sort(br)}catch{return Gt(this,gt)}let yr=0;const xr=vr?Er=>cr(Er,gr[yr][1])>0:Er=>cr(Er,gr[yr][1])>=0,Cr=pr?Er=>hr(Er,gr[yr][0])>0:Er=>hr(Er,gr[yr][0])>=0;let Sr=xr;const wr=new this.Collection(this,()=>Jt(gr[0][0],gr[gr.length-1][1],!pr,!vr));return wr._ondirectionchange=Er=>{Er==="next"?(Sr=xr,mr=cr):(Sr=Cr,mr=hr),gr.sort(br)},wr._addAlgorithm((Er,Ar,Tr)=>{for(var Rr=Er.key;Sr(Rr);)if(++yr,yr===gr.length)return Ar(Tr),!1;return!!function(Pr){return!xr(Pr)&&!Cr(Pr)}(Rr)||(this._cmp(Rr,gr[yr][1])===0||this._cmp(Rr,gr[yr][0])===0||Ar(()=>{mr===cr?Er.continue(gr[yr][0]):Er.continue(gr[yr][1])}),!1)}),wr}startsWithAnyOf(){const ar=B.apply(I,arguments);return ar.every(lr=>typeof lr=="string")?ar.length===0?Ht(this):this.inAnyRange(ar.map(lr=>[lr,lr+mt])):Gt(this,"startsWithAnyOf() only works with strings")}}function tn(or){return Ye(function(ar){return nn(ar),or(ar.target.error),!1})}function nn(or){or.stopPropagation&&or.stopPropagation(),or.preventDefault&&or.preventDefault()}const rn="storagemutated",sn="x-storagemutated-1",on=Dt(null,rn);class an{_lock(){return m(!Oe.global),++this._reculock,this._reculock!==1||Oe.global||(Oe.lockOwnerFor=this),this}_unlock(){if(m(!Oe.global),--this._reculock==0)for(Oe.global||(Oe.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var ar=this._blockedFuncs.shift();try{at(ar[1],ar[0])}catch{}}return this}_locked(){return this._reculock&&Oe.lockOwnerFor!==this}create(ar){if(!this.mode)return this;const lr=this.db.idbdb,ur=this.db._state.dbOpenError;if(m(!this.idbtrans),!ar&&!lr)switch(ur&&ur.name){case"DatabaseClosedError":throw new X.DatabaseClosed(ur);case"MissingAPIError":throw new X.MissingAPI(ur.message,ur);default:throw new X.OpenFailed(ur)}if(!this.active)throw new X.TransactionInactive;return m(this._completion._state===null),(ar=this.idbtrans=ar||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):lr.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ye(cr=>{nn(cr),this._reject(ar.error)}),ar.onabort=Ye(cr=>{nn(cr),this.active&&this._reject(new X.Abort(ar.error)),this.active=!1,this.on("abort").fire(cr)}),ar.oncomplete=Ye(()=>{this.active=!1,this._resolve(),"mutatedParts"in ar&&on.storagemutated.fire(ar.mutatedParts)}),this}_promise(ar,lr,ur){if(ar==="readwrite"&&this.mode!=="readwrite")return ft(new X.ReadOnly("Transaction is readonly"));if(!this.active)return ft(new X.TransactionInactive);if(this._locked())return new je((hr,dr)=>{this._blockedFuncs.push([()=>{this._promise(ar,lr,ur).then(hr,dr)},Oe])});if(ur)return Ze(()=>{var hr=new je((dr,fr)=>{this._lock();const pr=lr(dr,fr,this);pr&&pr.then&&pr.then(dr,fr)});return hr.finally(()=>this._unlock()),hr._lib=!0,hr});var cr=new je((hr,dr)=>{var fr=lr(hr,dr,this);fr&&fr.then&&fr.then(hr,dr)});return cr._lib=!0,cr}_root(){return this.parent?this.parent._root():this}waitFor(ar){var lr=this._root();const ur=je.resolve(ar);if(lr._waitingFor)lr._waitingFor=lr._waitingFor.then(()=>ur);else{lr._waitingFor=ur,lr._waitingQueue=[];var cr=lr.idbtrans.objectStore(lr.storeNames[0]);(function dr(){for(++lr._spinCount;lr._waitingQueue.length;)lr._waitingQueue.shift()();lr._waitingFor&&(cr.get(-1/0).onsuccess=dr)})()}var hr=lr._waitingFor;return new je((dr,fr)=>{ur.then(pr=>lr._waitingQueue.push(Ye(dr.bind(null,pr))),pr=>lr._waitingQueue.push(Ye(fr.bind(null,pr)))).finally(()=>{lr._waitingFor===hr&&(lr._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new X.Abort))}table(ar){const lr=this._memoizedTables||(this._memoizedTables={});if(o(lr,ar))return lr[ar];const ur=this.schema[ar];if(!ur)throw new X.NotFound("Table "+ar+" not part of transaction");const cr=new this.db.Table(ar,ur,this);return cr.core=this.db.core.table(ar),lr[ar]=cr,cr}}function un(or,ar,lr,ur,cr,hr,dr){return{name:or,keyPath:ar,unique:lr,multi:ur,auto:cr,compound:hr,src:(lr&&!dr?"&":"")+(ur?"*":"")+(cr?"++":"")+ln(ar)}}function ln(or){return typeof or=="string"?or:or?"["+[].join.call(or,"+")+"]":""}function cn(or,ar,lr){return{name:or,primKey:ar,indexes:lr,mappedClass:null,idxByName:g(lr,ur=>[ur.name,ur])}}let hn=or=>{try{return or.only([[]]),hn=()=>[[]],[[]]}catch{return hn=()=>mt,mt}};function dn(or){return or==null?()=>{}:typeof or=="string"?function(ar){return ar.split(".").length===1?ur=>ur[ar]:ur=>b(ur,ar)}(or):ar=>b(ar,or)}function fn$7(or){return[].slice.call(or)}let pn=0;function yn(or){return or==null?":id":typeof or=="string"?or:`[${or.join("+")}]`}function mn(or,ar,lr){function ur(pr){if(pr.type===3)return null;if(pr.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:vr,upper:gr,lowerOpen:mr,upperOpen:br}=pr;return vr===void 0?gr===void 0?null:ar.upperBound(gr,!!br):gr===void 0?ar.lowerBound(vr,!!mr):ar.bound(vr,gr,!!mr,!!br)}const{schema:cr,hasGetAll:hr}=function(pr,vr){const gr=fn$7(pr.objectStoreNames);return{schema:{name:pr.name,tables:gr.map(mr=>vr.objectStore(mr)).map(mr=>{const{keyPath:br,autoIncrement:yr}=mr,xr=n(br),Cr=br==null,Sr={},wr={name:mr.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Cr,compound:xr,keyPath:br,autoIncrement:yr,unique:!0,extractKey:dn(br)},indexes:fn$7(mr.indexNames).map(Er=>mr.index(Er)).map(Er=>{const{name:Ar,unique:Tr,multiEntry:Rr,keyPath:Pr}=Er,_r={name:Ar,compound:n(Pr),keyPath:Pr,unique:Tr,multiEntry:Rr,extractKey:dn(Pr)};return Sr[yn(Pr)]=_r,_r}),getIndexByKeyPath:Er=>Sr[yn(Er)]};return Sr[":id"]=wr.primaryKey,br!=null&&(Sr[yn(br)]=wr.primaryKey),wr})},hasGetAll:gr.length>0&&"getAll"in vr.objectStore(gr[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(or,lr),dr=cr.tables.map(pr=>function(vr){const gr=vr.name;return{name:gr,schema:vr,mutate:function({trans:mr,type:br,keys:yr,values:xr,range:Cr}){return new Promise((Sr,wr)=>{Sr=Ye(Sr);const Er=mr.objectStore(gr),Ar=Er.keyPath==null,Tr=br==="put"||br==="add";if(!Tr&&br!=="delete"&&br!=="deleteRange")throw new Error("Invalid operation type: "+br);const{length:Rr}=yr||xr||{length:1};if(yr&&xr&&yr.length!==xr.length)throw new Error("Given keys array must have same length as given values array.");if(Rr===0)return Sr({numFailures:0,failures:{},results:[],lastResult:void 0});let Pr;const _r=[],kr=[];let Dr=0;const Nr=Or=>{++Dr,nn(Or)};if(br==="deleteRange"){if(Cr.type===4)return Sr({numFailures:Dr,failures:kr,results:[],lastResult:void 0});Cr.type===3?_r.push(Pr=Er.clear()):_r.push(Pr=Er.delete(ur(Cr)))}else{const[Or,Ir]=Tr?Ar?[xr,yr]:[xr,null]:[yr,null];if(Tr)for(let Mr=0;Mr<Rr;++Mr)_r.push(Pr=Ir&&Ir[Mr]!==void 0?Er[br](Or[Mr],Ir[Mr]):Er[br](Or[Mr])),Pr.onerror=Nr;else for(let Mr=0;Mr<Rr;++Mr)_r.push(Pr=Er[br](Or[Mr])),Pr.onerror=Nr}const Lr=Or=>{const Ir=Or.target.result;_r.forEach((Mr,$r)=>Mr.error!=null&&(kr[$r]=Mr.error)),Sr({numFailures:Dr,failures:kr,results:br==="delete"?yr:_r.map(Mr=>Mr.result),lastResult:Ir})};Pr.onerror=Or=>{Nr(Or),Lr(Or)},Pr.onsuccess=Lr})},getMany:({trans:mr,keys:br})=>new Promise((yr,xr)=>{yr=Ye(yr);const Cr=mr.objectStore(gr),Sr=br.length,wr=new Array(Sr);let Er,Ar=0,Tr=0;const Rr=_r=>{const kr=_r.target;wr[kr._pos]=kr.result,++Tr===Ar&&yr(wr)},Pr=tn(xr);for(let _r=0;_r<Sr;++_r)br[_r]!=null&&(Er=Cr.get(br[_r]),Er._pos=_r,Er.onsuccess=Rr,Er.onerror=Pr,++Ar);Ar===0&&yr(wr)}),get:({trans:mr,key:br})=>new Promise((yr,xr)=>{yr=Ye(yr);const Cr=mr.objectStore(gr).get(br);Cr.onsuccess=Sr=>yr(Sr.target.result),Cr.onerror=tn(xr)}),query:function(mr){return br=>new Promise((yr,xr)=>{yr=Ye(yr);const{trans:Cr,values:Sr,limit:wr,query:Er}=br,Ar=wr===1/0?void 0:wr,{index:Tr,range:Rr}=Er,Pr=Cr.objectStore(gr),_r=Tr.isPrimaryKey?Pr:Pr.index(Tr.name),kr=ur(Rr);if(wr===0)return yr({result:[]});if(mr){const Dr=Sr?_r.getAll(kr,Ar):_r.getAllKeys(kr,Ar);Dr.onsuccess=Nr=>yr({result:Nr.target.result}),Dr.onerror=tn(xr)}else{let Dr=0;const Nr=Sr||!("openKeyCursor"in _r)?_r.openCursor(kr):_r.openKeyCursor(kr),Lr=[];Nr.onsuccess=Or=>{const Ir=Nr.result;return Ir?(Lr.push(Sr?Ir.value:Ir.primaryKey),++Dr===wr?yr({result:Lr}):void Ir.continue()):yr({result:Lr})},Nr.onerror=tn(xr)}})}(hr),openCursor:function({trans:mr,values:br,query:yr,reverse:xr,unique:Cr}){return new Promise((Sr,wr)=>{Sr=Ye(Sr);const{index:Er,range:Ar}=yr,Tr=mr.objectStore(gr),Rr=Er.isPrimaryKey?Tr:Tr.index(Er.name),Pr=xr?Cr?"prevunique":"prev":Cr?"nextunique":"next",_r=br||!("openKeyCursor"in Rr)?Rr.openCursor(ur(Ar),Pr):Rr.openKeyCursor(ur(Ar),Pr);_r.onerror=tn(wr),_r.onsuccess=Ye(kr=>{const Dr=_r.result;if(!Dr)return void Sr(null);Dr.___id=++pn,Dr.done=!1;const Nr=Dr.continue.bind(Dr);let Lr=Dr.continuePrimaryKey;Lr&&(Lr=Lr.bind(Dr));const Or=Dr.advance.bind(Dr),Ir=()=>{throw new Error("Cursor not stopped")};Dr.trans=mr,Dr.stop=Dr.continue=Dr.continuePrimaryKey=Dr.advance=()=>{throw new Error("Cursor not started")},Dr.fail=Ye(wr),Dr.next=function(){let Mr=1;return this.start(()=>Mr--?this.continue():this.stop()).then(()=>this)},Dr.start=Mr=>{const $r=new Promise((Fr,zr)=>{Fr=Ye(Fr),_r.onerror=tn(zr),Dr.fail=zr,Dr.stop=Hr=>{Dr.stop=Dr.continue=Dr.continuePrimaryKey=Dr.advance=Ir,Fr(Hr)}}),jr=()=>{if(_r.result)try{Mr()}catch(Fr){Dr.fail(Fr)}else Dr.done=!0,Dr.start=()=>{throw new Error("Cursor behind last entry")},Dr.stop()};return _r.onsuccess=Ye(Fr=>{_r.onsuccess=jr,jr()}),Dr.continue=Nr,Dr.continuePrimaryKey=Lr,Dr.advance=Or,jr(),$r},Sr(Dr)},wr)})},count({query:mr,trans:br}){const{index:yr,range:xr}=mr;return new Promise((Cr,Sr)=>{const wr=br.objectStore(gr),Er=yr.isPrimaryKey?wr:wr.index(yr.name),Ar=ur(xr),Tr=Ar?Er.count(Ar):Er.count();Tr.onsuccess=Ye(Rr=>Cr(Rr.target.result)),Tr.onerror=tn(Sr)})}}}(pr)),fr={};return dr.forEach(pr=>fr[pr.name]=pr),{stack:"dbcore",transaction:or.transaction.bind(or),table(pr){if(!fr[pr])throw new Error(`Table '${pr}' not found`);return fr[pr]},MIN_KEY:-1/0,MAX_KEY:hn(ar),schema:cr}}function vn({_novip:or},ar){const lr=ar.db,ur=function(cr,hr,{IDBKeyRange:dr,indexedDB:fr},pr){return{dbcore:function(gr,mr){return mr.reduce((br,{create:yr})=>({...br,...yr(br)}),gr)}(mn(hr,dr,pr),cr.dbcore)}}(or._middlewares,lr,or._deps,ar);or.core=ur.dbcore,or.tables.forEach(cr=>{const hr=cr.name;or.core.schema.tables.some(dr=>dr.name===hr)&&(cr.core=or.core.table(hr),or[hr]instanceof or.Table&&(or[hr].core=cr.core))})}function gn({_novip:or},ar,lr,ur){lr.forEach(cr=>{const hr=ur[cr];ar.forEach(dr=>{const fr=d(dr,cr);(!fr||"value"in fr&&fr.value===void 0)&&(dr===or.Transaction.prototype||dr instanceof or.Transaction?l(dr,cr,{get(){return this.table(cr)},set(pr){u(this,cr,{value:pr,writable:!0,configurable:!0,enumerable:!0})}}):dr[cr]=new or.Table(cr,hr))})})}function bn({_novip:or},ar){ar.forEach(lr=>{for(let ur in lr)lr[ur]instanceof or.Table&&delete lr[ur]})}function _n(or,ar){return or._cfg.version-ar._cfg.version}function wn(or,ar,lr,ur){const cr=or._dbSchema,hr=or._createTransaction("readwrite",or._storeNames,cr);hr.create(lr),hr._completion.catch(ur);const dr=hr._reject.bind(hr),fr=Oe.transless||Oe;Ze(()=>{Oe.trans=hr,Oe.transless=fr,ar===0?(t(cr).forEach(pr=>{kn(lr,pr,cr[pr].primKey,cr[pr].indexes)}),vn(or,lr),je.follow(()=>or.on.populate.fire(hr)).catch(dr)):function({_novip:pr},vr,gr,mr){const br=[],yr=pr._versions;let xr=pr._dbSchema=Pn(pr,pr.idbdb,mr),Cr=!1;const Sr=yr.filter(Er=>Er._cfg.version>=vr);function wr(){return br.length?je.resolve(br.shift()(gr.idbtrans)).then(wr):je.resolve()}return Sr.forEach(Er=>{br.push(()=>{const Ar=xr,Tr=Er._cfg.dbschema;Kn(pr,Ar,mr),Kn(pr,Tr,mr),xr=pr._dbSchema=Tr;const Rr=xn(Ar,Tr);Rr.add.forEach(_r=>{kn(mr,_r[0],_r[1].primKey,_r[1].indexes)}),Rr.change.forEach(_r=>{if(_r.recreate)throw new X.Upgrade("Not yet support for changing primary key");{const kr=mr.objectStore(_r.name);_r.add.forEach(Dr=>En(kr,Dr)),_r.change.forEach(Dr=>{kr.deleteIndex(Dr.name),En(kr,Dr)}),_r.del.forEach(Dr=>kr.deleteIndex(Dr))}});const Pr=Er._cfg.contentUpgrade;if(Pr&&Er._cfg.version>vr){vn(pr,mr),gr._memoizedTables={},Cr=!0;let _r=w(Tr);Rr.del.forEach(Lr=>{_r[Lr]=Ar[Lr]}),bn(pr,[pr.Transaction.prototype]),gn(pr,[pr.Transaction.prototype],t(_r),_r),gr.schema=_r;const kr=T(Pr);let Dr;kr&&et();const Nr=je.follow(()=>{if(Dr=Pr(gr),Dr&&kr){var Lr=tt.bind(null,null);Dr.then(Lr,Lr)}});return Dr&&typeof Dr.then=="function"?je.resolve(Dr):Nr.then(()=>Dr)}}),br.push(Ar=>{(!Cr||!xt)&&function(Tr,Rr){[].slice.call(Rr.db.objectStoreNames).forEach(Pr=>Tr[Pr]==null&&Rr.db.deleteObjectStore(Pr))}(Er._cfg.dbschema,Ar),bn(pr,[pr.Transaction.prototype]),gn(pr,[pr.Transaction.prototype],pr._storeNames,pr._dbSchema),gr.schema=pr._dbSchema})}),wr().then(()=>{var Er,Ar;Ar=mr,t(Er=xr).forEach(Tr=>{Ar.db.objectStoreNames.contains(Tr)||kn(Ar,Tr,Er[Tr].primKey,Er[Tr].indexes)})})}(or,ar,hr,lr).catch(dr)})}function xn(or,ar){const lr={del:[],add:[],change:[]};let ur;for(ur in or)ar[ur]||lr.del.push(ur);for(ur in ar){const cr=or[ur],hr=ar[ur];if(cr){const dr={name:ur,def:hr,recreate:!1,del:[],add:[],change:[]};if(""+(cr.primKey.keyPath||"")!=""+(hr.primKey.keyPath||"")||cr.primKey.auto!==hr.primKey.auto&&!wt)dr.recreate=!0,lr.change.push(dr);else{const fr=cr.idxByName,pr=hr.idxByName;let vr;for(vr in fr)pr[vr]||dr.del.push(vr);for(vr in pr){const gr=fr[vr],mr=pr[vr];gr?gr.src!==mr.src&&dr.change.push(mr):dr.add.push(mr)}(dr.del.length>0||dr.add.length>0||dr.change.length>0)&&lr.change.push(dr)}}else lr.add.push([ur,hr])}return lr}function kn(or,ar,lr,ur){const cr=or.db.createObjectStore(ar,lr.keyPath?{keyPath:lr.keyPath,autoIncrement:lr.auto}:{autoIncrement:lr.auto});return ur.forEach(hr=>En(cr,hr)),cr}function En(or,ar){or.createIndex(ar.name,ar.keyPath,{unique:ar.unique,multiEntry:ar.multi})}function Pn(or,ar,lr){const ur={};return p$1(ar.objectStoreNames,0).forEach(cr=>{const hr=lr.objectStore(cr);let dr=hr.keyPath;const fr=un(ln(dr),dr||"",!1,!1,!!hr.autoIncrement,dr&&typeof dr!="string",!0),pr=[];for(let gr=0;gr<hr.indexNames.length;++gr){const mr=hr.index(hr.indexNames[gr]);dr=mr.keyPath;var vr=un(mr.name,dr,!!mr.unique,!!mr.multiEntry,!1,dr&&typeof dr!="string",!1);pr.push(vr)}ur[cr]=cn(cr,fr,pr)}),ur}function Kn({_novip:or},ar,lr){const ur=lr.db.objectStoreNames;for(let cr=0;cr<ur.length;++cr){const hr=ur[cr],dr=lr.objectStore(hr);or._hasGetAll="getAll"in dr;for(let fr=0;fr<dr.indexNames.length;++fr){const pr=dr.indexNames[fr],vr=dr.index(pr).keyPath,gr=typeof vr=="string"?vr:"["+p$1(vr).join("+")+"]";if(ar[hr]){const mr=ar[hr].idxByName[gr];mr&&(mr.name=pr,delete ar[hr].idxByName[gr],ar[hr].idxByName[pr]=mr)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&e.WorkerGlobalScope&&e instanceof e.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(or._hasGetAll=!1)}class On{_parseStoresSpec(ar,lr){t(ar).forEach(ur=>{if(ar[ur]!==null){var cr=ar[ur].split(",").map((dr,fr)=>{const pr=(dr=dr.trim()).replace(/([&*]|\+\+)/g,""),vr=/^\[/.test(pr)?pr.match(/^\[(.*)\]$/)[1].split("+"):pr;return un(pr,vr||null,/\&/.test(dr),/\*/.test(dr),/\+\+/.test(dr),n(vr),fr===0)}),hr=cr.shift();if(hr.multi)throw new X.Schema("Primary key cannot be multi-valued");cr.forEach(dr=>{if(dr.auto)throw new X.Schema("Only primary key can be marked as autoIncrement (++)");if(!dr.keyPath)throw new X.Schema("Index must have a name and cannot be an empty string")}),lr[ur]=cn(ur,hr,cr)}})}stores(ar){const lr=this.db;this._cfg.storesSource=this._cfg.storesSource?r(this._cfg.storesSource,ar):ar;const ur=lr._versions,cr={};let hr={};return ur.forEach(dr=>{r(cr,dr._cfg.storesSource),hr=dr._cfg.dbschema={},dr._parseStoresSpec(cr,hr)}),lr._dbSchema=hr,bn(lr,[lr._allTables,lr,lr.Transaction.prototype]),gn(lr,[lr._allTables,lr,lr.Transaction.prototype,this._cfg.tables],t(hr),hr),lr._storeNames=t(hr),this}upgrade(ar){return this._cfg.contentUpgrade=ue(this._cfg.contentUpgrade||ee,ar),this}}function Sn(or,ar){let lr=or._dbNamesDB;return lr||(lr=or._dbNamesDB=new Xn(Pt,{addons:[],indexedDB:or,IDBKeyRange:ar}),lr.version(1).stores({dbnames:"name"})),lr.table("dbnames")}function An(or){return or&&typeof or.databases=="function"}function Cn(or){return Ze(function(){return Oe.letThrough=!0,or()})}function jn(){var or;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(ar){var lr=function(){return indexedDB.databases().finally(ar)};or=setInterval(lr,100),lr()}).finally(function(){return clearInterval(or)}):Promise.resolve()}function Dn(or){const ar=or._state,{indexedDB:lr}=or._deps;if(ar.isBeingOpened||or.idbdb)return ar.dbReadyPromise.then(()=>ar.dbOpenError?ft(ar.dbOpenError):or);R&&(ar.openCanceller._stackHolder=q()),ar.isBeingOpened=!0,ar.dbOpenError=null,ar.openComplete=!1;const ur=ar.openCanceller;function cr(){if(ar.openCanceller!==ur)throw new X.DatabaseClosed("db.open() was cancelled")}let hr=ar.dbReadyResolve,dr=null,fr=!1;const pr=()=>new je((vr,gr)=>{if(cr(),!lr)throw new X.MissingAPI;const mr=or.name,br=ar.autoSchema?lr.open(mr):lr.open(mr,Math.round(10*or.verno));if(!br)throw new X.MissingAPI;br.onerror=tn(gr),br.onblocked=Ye(or._fireOnBlocked),br.onupgradeneeded=Ye(yr=>{if(dr=br.transaction,ar.autoSchema&&!or._options.allowEmptyDB){br.onerror=nn,dr.abort(),br.result.close();const Cr=lr.deleteDatabase(mr);Cr.onsuccess=Cr.onerror=Ye(()=>{gr(new X.NoSuchDatabase(`Database ${mr} doesnt exist`))})}else{dr.onerror=tn(gr);var xr=yr.oldVersion>Math.pow(2,62)?0:yr.oldVersion;fr=xr<1,or._novip.idbdb=br.result,wn(or,xr/10,dr,gr)}},gr),br.onsuccess=Ye(()=>{dr=null;const yr=or._novip.idbdb=br.result,xr=p$1(yr.objectStoreNames);if(xr.length>0)try{const Sr=yr.transaction((Cr=xr).length===1?Cr[0]:Cr,"readonly");ar.autoSchema?function({_novip:wr},Er,Ar){wr.verno=Er.version/10;const Tr=wr._dbSchema=Pn(0,Er,Ar);wr._storeNames=p$1(Er.objectStoreNames,0),gn(wr,[wr._allTables],t(Tr),Tr)}(or,yr,Sr):(Kn(or,or._dbSchema,Sr),function(wr,Er){const Ar=xn(Pn(0,wr.idbdb,Er),wr._dbSchema);return!(Ar.add.length||Ar.change.some(Tr=>Tr.add.length||Tr.change.length))}(or,Sr)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),vn(or,Sr)}catch{}var Cr;_t.push(or),yr.onversionchange=Ye(Sr=>{ar.vcFired=!0,or.on("versionchange").fire(Sr)}),yr.onclose=Ye(Sr=>{or.on("close").fire(Sr)}),fr&&function({indexedDB:Sr,IDBKeyRange:wr},Er){!An(Sr)&&Er!==Pt&&Sn(Sr,wr).put({name:Er}).catch(ee)}(or._deps,mr),vr()},gr)}).catch(vr=>vr&&vr.name==="UnknownError"&&ar.PR1398_maxLoop>0?(ar.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),pr()):je.reject(vr));return je.race([ur,(typeof navigator>"u"?je.resolve():jn()).then(pr)]).then(()=>(cr(),ar.onReadyBeingFired=[],je.resolve(Cn(()=>or.on.ready.fire(or.vip))).then(function vr(){if(ar.onReadyBeingFired.length>0){let gr=ar.onReadyBeingFired.reduce(ue,ee);return ar.onReadyBeingFired=[],je.resolve(Cn(()=>gr(or.vip))).then(vr)}}))).finally(()=>{ar.onReadyBeingFired=null,ar.isBeingOpened=!1}).then(()=>or).catch(vr=>{ar.dbOpenError=vr;try{dr&&dr.abort()}catch{}return ur===ar.openCanceller&&or._close(),ft(vr)}).finally(()=>{ar.openComplete=!0,hr()})}function In(or){var ar=hr=>or.next(hr),lr=cr(ar),ur=cr(hr=>or.throw(hr));function cr(hr){return dr=>{var fr=hr(dr),pr=fr.value;return fr.done?pr:pr&&typeof pr.then=="function"?pr.then(lr,ur):n(pr)?Promise.all(pr).then(lr,ur):lr(pr)}}return cr(ar)()}function Bn(or,ar,lr){var ur=arguments.length;if(ur<2)throw new X.InvalidArgument("Too few arguments");for(var cr=new Array(ur-1);--ur;)cr[ur-1]=arguments[ur];return lr=cr.pop(),[or,k(cr),lr]}function Tn(or,ar,lr,ur,cr){return je.resolve().then(()=>{const hr=Oe.transless||Oe,dr=or._createTransaction(ar,lr,or._dbSchema,ur),fr={trans:dr,transless:hr};if(ur)dr.idbtrans=ur.idbtrans;else try{dr.create(),or._state.PR1398_maxLoop=3}catch(mr){return mr.name===H.InvalidState&&or.isOpen()&&--or._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),or._close(),or.open().then(()=>Tn(or,ar,lr,null,cr))):ft(mr)}const pr=T(cr);let vr;pr&&et();const gr=je.follow(()=>{if(vr=cr.call(dr,dr),vr)if(pr){var mr=tt.bind(null,null);vr.then(mr,mr)}else typeof vr.next=="function"&&typeof vr.throw=="function"&&(vr=In(vr))},fr);return(vr&&typeof vr.then=="function"?je.resolve(vr).then(mr=>dr.active?mr:ft(new X.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):gr.then(()=>vr)).then(mr=>(ur&&dr._resolve(),dr._completion.then(()=>mr))).catch(mr=>(dr._reject(mr),ft(mr)))})}function Rn(or,ar,lr){const ur=n(or)?or.slice():[or];for(let cr=0;cr<lr;++cr)ur.push(ar);return ur}const Fn={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(or){return{...or,table(ar){const lr=or.table(ar),{schema:ur}=lr,cr={},hr=[];function dr(gr,mr,br){const yr=yn(gr),xr=cr[yr]=cr[yr]||[],Cr=gr==null?0:typeof gr=="string"?1:gr.length,Sr=mr>0,wr={...br,isVirtual:Sr,keyTail:mr,keyLength:Cr,extractKey:dn(gr),unique:!Sr&&br.unique};return xr.push(wr),wr.isPrimaryKey||hr.push(wr),Cr>1&&dr(Cr===2?gr[0]:gr.slice(0,Cr-1),mr+1,br),xr.sort((Er,Ar)=>Er.keyTail-Ar.keyTail),wr}const fr=dr(ur.primaryKey.keyPath,0,ur.primaryKey);cr[":id"]=[fr];for(const gr of ur.indexes)dr(gr.keyPath,0,gr);function pr(gr){const mr=gr.query.index;return mr.isVirtual?{...gr,query:{index:mr,range:(br=gr.query.range,yr=mr.keyTail,{type:br.type===1?2:br.type,lower:Rn(br.lower,br.lowerOpen?or.MAX_KEY:or.MIN_KEY,yr),lowerOpen:!0,upper:Rn(br.upper,br.upperOpen?or.MIN_KEY:or.MAX_KEY,yr),upperOpen:!0})}}:gr;var br,yr}return{...lr,schema:{...ur,primaryKey:fr,indexes:hr,getIndexByKeyPath:function(gr){const mr=cr[yn(gr)];return mr&&mr[0]}},count:gr=>lr.count(pr(gr)),query:gr=>lr.query(pr(gr)),openCursor(gr){const{keyTail:mr,isVirtual:br,keyLength:yr}=gr.query.index;return br?lr.openCursor(pr(gr)).then(xr=>xr&&function(Cr){return Object.create(Cr,{continue:{value:function(wr){wr!=null?Cr.continue(Rn(wr,gr.reverse?or.MAX_KEY:or.MIN_KEY,mr)):gr.unique?Cr.continue(Cr.key.slice(0,yr).concat(gr.reverse?or.MIN_KEY:or.MAX_KEY,mr)):Cr.continue()}},continuePrimaryKey:{value(wr,Er){Cr.continuePrimaryKey(Rn(wr,or.MAX_KEY,mr),Er)}},primaryKey:{get:()=>Cr.primaryKey},key:{get(){const wr=Cr.key;return yr===1?wr[0]:wr.slice(0,yr)}},value:{get:()=>Cr.value}})}(xr)):lr.openCursor(gr)}}}}}};function Mn(or,ar,lr,ur){return lr=lr||{},ur=ur||"",t(or).forEach(cr=>{if(o(ar,cr)){var hr=or[cr],dr=ar[cr];if(typeof hr=="object"&&typeof dr=="object"&&hr&&dr){const fr=C(hr);fr!==C(dr)?lr[ur+cr]=ar[cr]:fr==="Object"?Mn(hr,dr,lr,ur+cr+"."):hr!==dr&&(lr[ur+cr]=ar[cr])}else hr!==dr&&(lr[ur+cr]=ar[cr])}else lr[ur+cr]=void 0}),t(ar).forEach(cr=>{o(or,cr)||(lr[ur+cr]=ar[cr])}),lr}const Nn={stack:"dbcore",name:"HooksMiddleware",level:2,create:or=>({...or,table(ar){const lr=or.table(ar),{primaryKey:ur}=lr.schema;return{...lr,mutate(hr){const dr=Oe.trans,{deleting:fr,creating:pr,updating:vr}=dr.table(ar).hook;switch(hr.type){case"add":if(pr.fire===ee)break;return dr._promise("readwrite",()=>gr(hr),!0);case"put":if(pr.fire===ee&&vr.fire===ee)break;return dr._promise("readwrite",()=>gr(hr),!0);case"delete":if(fr.fire===ee)break;return dr._promise("readwrite",()=>gr(hr),!0);case"deleteRange":if(fr.fire===ee)break;return dr._promise("readwrite",()=>function(br){return mr(br.trans,br.range,1e4)}(hr),!0)}return lr.mutate(hr);function gr(br){const yr=Oe.trans,xr=br.keys||function(Cr,Sr){return Sr.type==="delete"?Sr.keys:Sr.keys||Sr.values.map(Cr.extractKey)}(ur,br);if(!xr)throw new Error("Keys missing");return(br=br.type==="add"||br.type==="put"?{...br,keys:xr}:{...br}).type!=="delete"&&(br.values=[...br.values]),br.keys&&(br.keys=[...br.keys]),function(Cr,Sr,wr){return Sr.type==="add"?Promise.resolve([]):Cr.getMany({trans:Sr.trans,keys:wr,cache:"immutable"})}(lr,br,xr).then(Cr=>{const Sr=xr.map((wr,Er)=>{const Ar=Cr[Er],Tr={onerror:null,onsuccess:null};if(br.type==="delete")fr.fire.call(Tr,wr,Ar,yr);else if(br.type==="add"||Ar===void 0){const Rr=pr.fire.call(Tr,wr,br.values[Er],yr);wr==null&&Rr!=null&&(wr=Rr,br.keys[Er]=wr,ur.outbound||_(br.values[Er],ur.keyPath,wr))}else{const Rr=Mn(Ar,br.values[Er]),Pr=vr.fire.call(Tr,Rr,wr,Ar,yr);if(Pr){const _r=br.values[Er];Object.keys(Pr).forEach(kr=>{o(_r,kr)?_r[kr]=Pr[kr]:_(_r,kr,Pr[kr])})}}return Tr});return lr.mutate(br).then(({failures:wr,results:Er,numFailures:Ar,lastResult:Tr})=>{for(let Rr=0;Rr<xr.length;++Rr){const Pr=Er?Er[Rr]:xr[Rr],_r=Sr[Rr];Pr==null?_r.onerror&&_r.onerror(wr[Rr]):_r.onsuccess&&_r.onsuccess(br.type==="put"&&Cr[Rr]?br.values[Rr]:Pr)}return{failures:wr,results:Er,numFailures:Ar,lastResult:Tr}}).catch(wr=>(Sr.forEach(Er=>Er.onerror&&Er.onerror(wr)),Promise.reject(wr)))})}function mr(br,yr,xr){return lr.query({trans:br,values:!1,query:{index:ur,range:yr},limit:xr}).then(({result:Cr})=>gr({type:"delete",keys:Cr,trans:br}).then(Sr=>Sr.numFailures>0?Promise.reject(Sr.failures[0]):Cr.length<xr?{failures:[],numFailures:0,lastResult:void 0}:mr(br,{...yr,lower:Cr[Cr.length-1],lowerOpen:!0},xr)))}}}}})};function qn(or,ar,lr){try{if(!ar||ar.keys.length<or.length)return null;const ur=[];for(let cr=0,hr=0;cr<ar.keys.length&&hr<or.length;++cr)$t(ar.keys[cr],or[hr])===0&&(ur.push(lr?O(ar.values[cr]):ar.values[cr]),++hr);return ur.length===or.length?ur:null}catch{return null}}const $n={stack:"dbcore",level:-1,create:or=>({table:ar=>{const lr=or.table(ar);return{...lr,getMany:ur=>{if(!ur.cache)return lr.getMany(ur);const cr=qn(ur.keys,ur.trans._cache,ur.cache==="clone");return cr?je.resolve(cr):lr.getMany(ur).then(hr=>(ur.trans._cache={keys:ur.keys,values:ur.cache==="clone"?O(hr):hr},hr))},mutate:ur=>(ur.type!=="add"&&(ur.trans._cache=null),lr.mutate(ur))}}})};function Un(or){return!("from"in or)}const Ln=function(or,ar){if(!this){const lr=new Ln;return or&&"d"in or&&r(lr,or),lr}r(this,arguments.length?{d:1,from:or,to:arguments.length>1?ar:or}:{d:0})};function Vn(or,ar,lr){const ur=$t(ar,lr);if(isNaN(ur))return;if(ur>0)throw RangeError();if(Un(or))return r(or,{from:ar,to:lr,d:1});const cr=or.l,hr=or.r;if($t(lr,or.from)<0)return cr?Vn(cr,ar,lr):or.l={from:ar,to:lr,d:1,l:null,r:null},Gn(or);if($t(ar,or.to)>0)return hr?Vn(hr,ar,lr):or.r={from:ar,to:lr,d:1,l:null,r:null},Gn(or);$t(ar,or.from)<0&&(or.from=ar,or.l=null,or.d=hr?hr.d+1:1),$t(lr,or.to)>0&&(or.to=lr,or.r=null,or.d=or.l?or.l.d+1:1);const dr=!or.r;cr&&!or.l&&Wn(or,cr),hr&&dr&&Wn(or,hr)}function Wn(or,ar){Un(ar)||function lr(ur,{from:cr,to:hr,l:dr,r:fr}){Vn(ur,cr,hr),dr&&lr(ur,dr),fr&&lr(ur,fr)}(or,ar)}function Yn(or,ar){const lr=zn(ar);let ur=lr.next();if(ur.done)return!1;let cr=ur.value;const hr=zn(or);let dr=hr.next(cr.from),fr=dr.value;for(;!ur.done&&!dr.done;){if($t(fr.from,cr.to)<=0&&$t(fr.to,cr.from)>=0)return!0;$t(cr.from,fr.from)<0?cr=(ur=lr.next(fr.from)).value:fr=(dr=hr.next(cr.from)).value}return!1}function zn(or){let ar=Un(or)?null:{s:0,n:or};return{next(lr){const ur=arguments.length>0;for(;ar;)switch(ar.s){case 0:if(ar.s=1,ur)for(;ar.n.l&&$t(lr,ar.n.from)<0;)ar={up:ar,n:ar.n.l,s:1};else for(;ar.n.l;)ar={up:ar,n:ar.n.l,s:1};case 1:if(ar.s=2,!ur||$t(lr,ar.n.to)<=0)return{value:ar.n,done:!1};case 2:if(ar.n.r){ar.s=3,ar={up:ar,n:ar.n.r,s:0};continue}case 3:ar=ar.up}return{done:!0}}}}function Gn(or){var ar,lr;const ur=(((ar=or.r)===null||ar===void 0?void 0:ar.d)||0)-(((lr=or.l)===null||lr===void 0?void 0:lr.d)||0),cr=ur>1?"r":ur<-1?"l":"";if(cr){const hr=cr==="r"?"l":"r",dr={...or},fr=or[cr];or.from=fr.from,or.to=fr.to,or[cr]=fr[cr],dr[cr]=fr[hr],or[hr]=dr,dr.d=Hn(dr)}or.d=Hn(or)}function Hn({r:or,l:ar}){return(or?ar?Math.max(or.d,ar.d):or.d:ar?ar.d:0)+1}a(Ln.prototype,{add(or){return Wn(this,or),this},addKey(or){return Vn(this,or,or),this},addKeys(or){return or.forEach(ar=>Vn(this,ar,ar)),this},[j](){return zn(this)}});const Qn={stack:"dbcore",level:0,create:or=>{const ar=or.schema.name,lr=new Ln(or.MIN_KEY,or.MAX_KEY);return{...or,table:ur=>{const cr=or.table(ur),{schema:hr}=cr,{primaryKey:dr}=hr,{extractKey:fr,outbound:pr}=dr,vr={...cr,mutate:br=>{const yr=br.trans,xr=yr.mutatedParts||(yr.mutatedParts={}),Cr=Pr=>{const _r=`idb://${ar}/${ur}/${Pr}`;return xr[_r]||(xr[_r]=new Ln)},Sr=Cr(""),wr=Cr(":dels"),{type:Er}=br;let[Ar,Tr]=br.type==="deleteRange"?[br.range]:br.type==="delete"?[br.keys]:br.values.length<50?[[],br.values]:[];const Rr=br.trans._cache;return cr.mutate(br).then(Pr=>{if(n(Ar)){Er!=="delete"&&(Ar=Pr.results),Sr.addKeys(Ar);const _r=qn(Ar,Rr);_r||Er==="add"||wr.addKeys(Ar),(_r||Tr)&&function(kr,Dr,Nr,Lr){function Or(Ir){const Mr=kr(Ir.name||"");function $r(Fr){return Fr!=null?Ir.extractKey(Fr):null}const jr=Fr=>Ir.multiEntry&&n(Fr)?Fr.forEach(zr=>Mr.addKey(zr)):Mr.addKey(Fr);(Nr||Lr).forEach((Fr,zr)=>{const Hr=Nr&&$r(Nr[zr]),Wr=Lr&&$r(Lr[zr]);$t(Hr,Wr)!==0&&(Hr!=null&&jr(Hr),Wr!=null&&jr(Wr))})}Dr.indexes.forEach(Or)}(Cr,hr,_r,Tr)}else if(Ar){const _r={from:Ar.lower,to:Ar.upper};wr.add(_r),Sr.add(_r)}else Sr.add(lr),wr.add(lr),hr.indexes.forEach(_r=>Cr(_r.name).add(lr));return Pr})}},gr=({query:{index:br,range:yr}})=>{var xr,Cr;return[br,new Ln((xr=yr.lower)!==null&&xr!==void 0?xr:or.MIN_KEY,(Cr=yr.upper)!==null&&Cr!==void 0?Cr:or.MAX_KEY)]},mr={get:br=>[dr,new Ln(br.key)],getMany:br=>[dr,new Ln().addKeys(br.keys)],count:gr,query:gr,openCursor:gr};return t(mr).forEach(br=>{vr[br]=function(yr){const{subscr:xr}=Oe;if(xr){const Cr=Tr=>{const Rr=`idb://${ar}/${ur}/${Tr}`;return xr[Rr]||(xr[Rr]=new Ln)},Sr=Cr(""),wr=Cr(":dels"),[Er,Ar]=mr[br](yr);if(Cr(Er.name||"").add(Ar),!Er.isPrimaryKey){if(br!=="count"){const Tr=br==="query"&&pr&&yr.values&&cr.query({...yr,values:!1});return cr[br].apply(this,arguments).then(Rr=>{if(br==="query"){if(pr&&yr.values)return Tr.then(({result:_r})=>(Sr.addKeys(_r),Rr));const Pr=yr.values?Rr.result.map(fr):Rr.result;yr.values?Sr.addKeys(Pr):wr.addKeys(Pr)}else if(br==="openCursor"){const Pr=Rr,_r=yr.values;return Pr&&Object.create(Pr,{key:{get:()=>(wr.addKey(Pr.primaryKey),Pr.key)},primaryKey:{get(){const kr=Pr.primaryKey;return wr.addKey(kr),kr}},value:{get:()=>(_r&&Sr.addKey(Pr.primaryKey),Pr.value)}})}return Rr})}wr.add(lr)}}return cr[br].apply(this,arguments)}}),vr}}}};class Xn{constructor(ar,lr){this._middlewares={},this.verno=0;const ur=Xn.dependencies;this._options=lr={addons:Xn.addons,autoOpen:!0,indexedDB:ur.indexedDB,IDBKeyRange:ur.IDBKeyRange,...lr},this._deps={indexedDB:lr.indexedDB,IDBKeyRange:lr.IDBKeyRange};const{addons:cr}=lr;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const hr={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ee,dbReadyPromise:null,cancelOpen:ee,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var dr;hr.dbReadyPromise=new je(fr=>{hr.dbReadyResolve=fr}),hr.openCanceller=new je((fr,pr)=>{hr.cancelOpen=pr}),this._state=hr,this.name=ar,this.on=Dt(this,"populate","blocked","versionchange","close",{ready:[ue,ee]}),this.on.ready.subscribe=y$1(this.on.ready.subscribe,fr=>(pr,vr)=>{Xn.vip(()=>{const gr=this._state;if(gr.openComplete)gr.dbOpenError||je.resolve().then(pr),vr&&fr(pr);else if(gr.onReadyBeingFired)gr.onReadyBeingFired.push(pr),vr&&fr(pr);else{fr(pr);const mr=this;vr||fr(function br(){mr.on.ready.unsubscribe(pr),mr.on.ready.unsubscribe(br)})}})}),this.Collection=(dr=this,It(Vt.prototype,function(fr,pr){this.db=dr;let vr=At,gr=null;if(pr)try{vr=pr()}catch(xr){gr=xr}const mr=fr._ctx,br=mr.table,yr=br.hook.reading.fire;this._ctx={table:br,index:mr.index,isPrimKey:!mr.index||br.schema.primKey.keyPath&&mr.index===br.schema.primKey.name,range:vr,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:gr,or:mr.or,valueMapper:yr!==te?yr:null}})),this.Table=function(fr){return It(jt.prototype,function(pr,vr,gr){this.db=fr,this._tx=gr,this.name=pr,this.schema=vr,this.hook=fr._allTables[pr]?fr._allTables[pr].hook:Dt(null,{creating:[se,ee],reading:[ne,te],updating:[oe,ee],deleting:[ie,ee]})})}(this),this.Transaction=function(fr){return It(an.prototype,function(pr,vr,gr,mr,br){this.db=fr,this.mode=pr,this.storeNames=vr,this.schema=gr,this.chromeTransactionDurability=mr,this.idbtrans=null,this.on=Dt(this,"complete","error","abort"),this.parent=br||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new je((yr,xr)=>{this._resolve=yr,this._reject=xr}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},yr=>{var xr=this.active;return this.active=!1,this.on.error.fire(yr),this.parent?this.parent._reject(yr):xr&&this.idbtrans&&this.idbtrans.abort(),ft(yr)})})}(this),this.Version=function(fr){return It(On.prototype,function(pr){this.db=fr,this._cfg={version:pr,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(fr){return It(en.prototype,function(pr,vr,gr){this.db=fr,this._ctx={table:pr,index:vr===":id"?null:vr,or:gr};const mr=fr._deps.indexedDB;if(!mr)throw new X.MissingAPI;this._cmp=this._ascending=mr.cmp.bind(mr),this._descending=(br,yr)=>mr.cmp(yr,br),this._max=(br,yr)=>mr.cmp(br,yr)>0?br:yr,this._min=(br,yr)=>mr.cmp(br,yr)<0?br:yr,this._IDBKeyRange=fr._deps.IDBKeyRange})}(this),this.on("versionchange",fr=>{fr.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",fr=>{!fr.newVersion||fr.newVersion<fr.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${fr.oldVersion/10}`)}),this._maxKey=hn(lr.IDBKeyRange),this._createTransaction=(fr,pr,vr,gr)=>new this.Transaction(fr,pr,vr,this._options.chromeTransactionDurability,gr),this._fireOnBlocked=fr=>{this.on("blocked").fire(fr),_t.filter(pr=>pr.name===this.name&&pr!==this&&!pr._state.vcFired).map(pr=>pr.on("versionchange").fire(fr))},this.use(Fn),this.use(Nn),this.use(Qn),this.use($n),this.vip=Object.create(this,{_vip:{value:!0}}),cr.forEach(fr=>fr(this))}version(ar){if(isNaN(ar)||ar<.1)throw new X.Type("Given version is not a positive number");if(ar=Math.round(10*ar)/10,this.idbdb||this._state.isBeingOpened)throw new X.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,ar);const lr=this._versions;var ur=lr.filter(cr=>cr._cfg.version===ar)[0];return ur||(ur=new this.Version(ar),lr.push(ur),lr.sort(_n),ur.stores({}),this._state.autoSchema=!1,ur)}_whenReady(ar){return this.idbdb&&(this._state.openComplete||Oe.letThrough||this._vip)?ar():new je((lr,ur)=>{if(this._state.openComplete)return ur(new X.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void ur(new X.DatabaseClosed);this.open().catch(ee)}this._state.dbReadyPromise.then(lr,ur)}).then(ar)}use({stack:ar,create:lr,level:ur,name:cr}){cr&&this.unuse({stack:ar,name:cr});const hr=this._middlewares[ar]||(this._middlewares[ar]=[]);return hr.push({stack:ar,create:lr,level:ur??10,name:cr}),hr.sort((dr,fr)=>dr.level-fr.level),this}unuse({stack:ar,name:lr,create:ur}){return ar&&this._middlewares[ar]&&(this._middlewares[ar]=this._middlewares[ar].filter(cr=>ur?cr.create!==ur:!!lr&&cr.name!==lr)),this}open(){return Dn(this)}_close(){const ar=this._state,lr=_t.indexOf(this);if(lr>=0&&_t.splice(lr,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}ar.dbReadyPromise=new je(ur=>{ar.dbReadyResolve=ur}),ar.openCanceller=new je((ur,cr)=>{ar.cancelOpen=cr})}close(){this._close();const ar=this._state;this._options.autoOpen=!1,ar.dbOpenError=new X.DatabaseClosed,ar.isBeingOpened&&ar.cancelOpen(ar.dbOpenError)}delete(){const ar=arguments.length>0,lr=this._state;return new je((ur,cr)=>{const hr=()=>{this.close();var dr=this._deps.indexedDB.deleteDatabase(this.name);dr.onsuccess=Ye(()=>{(function({indexedDB:fr,IDBKeyRange:pr},vr){!An(fr)&&vr!==Pt&&Sn(fr,pr).delete(vr).catch(ee)})(this._deps,this.name),ur()}),dr.onerror=tn(cr),dr.onblocked=this._fireOnBlocked};if(ar)throw new X.InvalidArgument("Arguments not allowed in db.delete()");lr.isBeingOpened?lr.dbReadyPromise.then(hr):hr()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const ar=this._state.dbOpenError;return ar&&ar.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return t(this._allTables).map(ar=>this._allTables[ar])}transaction(){const ar=Bn.apply(this,arguments);return this._transaction.apply(this,ar)}_transaction(ar,lr,ur){let cr=Oe.trans;cr&&cr.db===this&&ar.indexOf("!")===-1||(cr=null);const hr=ar.indexOf("?")!==-1;let dr,fr;ar=ar.replace("!","").replace("?","");try{if(fr=lr.map(vr=>{var gr=vr instanceof this.Table?vr.name:vr;if(typeof gr!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return gr}),ar=="r"||ar===Kt)dr=Kt;else{if(ar!="rw"&&ar!=Ot)throw new X.InvalidArgument("Invalid transaction mode: "+ar);dr=Ot}if(cr){if(cr.mode===Kt&&dr===Ot){if(!hr)throw new X.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");cr=null}cr&&fr.forEach(vr=>{if(cr&&cr.storeNames.indexOf(vr)===-1){if(!hr)throw new X.SubTransaction("Table "+vr+" not included in parent transaction.");cr=null}}),hr&&cr&&!cr.active&&(cr=null)}}catch(vr){return cr?cr._promise(null,(gr,mr)=>{mr(vr)}):ft(vr)}const pr=Tn.bind(null,this,dr,fr,cr,ur);return cr?cr._promise(dr,pr,"lock"):Oe.trans?at(Oe.transless,()=>this._whenReady(pr)):this._whenReady(pr)}table(ar){if(!o(this._allTables,ar))throw new X.InvalidTable(`Table ${ar} does not exist`);return this._allTables[ar]}}const Jn=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Zn{constructor(ar){this._subscribe=ar}subscribe(ar,lr,ur){return this._subscribe(ar&&typeof ar!="function"?ar:{next:ar,error:lr,complete:ur})}[Jn](){return this}}function er(or,ar){return t(ar).forEach(lr=>{Wn(or[lr]||(or[lr]=new Ln),ar[lr])}),or}function tr(or){let ar,lr=!1;const ur=new Zn(cr=>{const hr=T(or);let dr=!1,fr={},pr={};const vr={get closed(){return dr},unsubscribe:()=>{dr=!0,on.storagemutated.unsubscribe(yr)}};cr.start&&cr.start(vr);let gr=!1,mr=!1;function br(){return t(pr).some(Cr=>fr[Cr]&&Yn(fr[Cr],pr[Cr]))}const yr=Cr=>{er(fr,Cr),br()&&xr()},xr=()=>{if(gr||dr)return;fr={};const Cr={},Sr=function(wr){hr&&et();const Er=()=>Ze(or,{subscr:wr,trans:null}),Ar=Oe.trans?at(Oe.transless,Er):Er();return hr&&Ar.then(tt,tt),Ar}(Cr);mr||(on(rn,yr),mr=!0),gr=!0,Promise.resolve(Sr).then(wr=>{lr=!0,ar=wr,gr=!1,dr||(br()?xr():(fr={},pr=Cr,cr.next&&cr.next(wr)))},wr=>{gr=!1,lr=!1,cr.error&&cr.error(wr),vr.unsubscribe()})};return xr(),vr});return ur.hasValue=()=>lr,ur.getValue=()=>ar,ur}let nr;try{nr={indexedDB:e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB,IDBKeyRange:e.IDBKeyRange||e.webkitIDBKeyRange}}catch{nr={indexedDB:null,IDBKeyRange:null}}const rr=Xn;function sr(or){let ar=ir;try{ir=!0,on.storagemutated.fire(or)}finally{ir=ar}}a(rr,{...Z,delete:or=>new rr(or,{addons:[]}).delete(),exists:or=>new rr(or,{addons:[]}).open().then(ar=>(ar.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(or){try{return function({indexedDB:ar,IDBKeyRange:lr}){return An(ar)?Promise.resolve(ar.databases()).then(ur=>ur.map(cr=>cr.name).filter(cr=>cr!==Pt)):Sn(ar,lr).toCollection().primaryKeys()}(rr.dependencies).then(or)}catch{return ft(new X.MissingAPI)}},defineClass:()=>function(or){r(this,or)},ignoreTransaction:or=>Oe.trans?at(Oe.transless,or):or(),vip:Cn,async:function(or){return function(){try{var ar=In(or.apply(this,arguments));return ar&&typeof ar.then=="function"?ar:je.resolve(ar)}catch(lr){return ft(lr)}}},spawn:function(or,ar,lr){try{var ur=In(or.apply(lr,ar||[]));return ur&&typeof ur.then=="function"?ur:je.resolve(ur)}catch(cr){return ft(cr)}},currentTransaction:{get:()=>Oe.trans||null},waitFor:function(or,ar){const lr=je.resolve(typeof or=="function"?rr.ignoreTransaction(or):or).timeout(ar||6e4);return Oe.trans?Oe.trans.waitFor(lr):lr},Promise:je,debug:{get:()=>R,set:or=>{F(or,or==="dexie"?()=>!0:Et)}},derive:c,extend:r,props:a,override:y$1,Events:Dt,on,liveQuery:tr,extendObservabilitySet:er,getByKeyPath:b,setByKeyPath:_,delByKeyPath:function(or,ar){typeof ar=="string"?_(or,ar,void 0):"length"in ar&&[].map.call(ar,function(lr){_(or,lr,void 0)})},shallowClone:w,deepClone:O,getObjectDiff:Mn,cmp:$t,asap:v,minKey:vt,addons:[],connections:_t,errnames:H,dependencies:nr,semVer:yt,version:yt.split(".").map(or=>parseInt(or)).reduce((or,ar,lr)=>or+ar/Math.pow(10,2*lr))}),rr.maxKey=hn(rr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(on(rn,or=>{if(!ir){let ar;wt?(ar=document.createEvent("CustomEvent"),ar.initCustomEvent(sn,!0,!0,or)):ar=new CustomEvent(sn,{detail:or}),ir=!0,dispatchEvent(ar),ir=!1}}),addEventListener(sn,({detail:or})=>{ir||sr(or)}));let ir=!1;if(typeof BroadcastChannel<"u"){const or=new BroadcastChannel(sn);typeof or.unref=="function"&&or.unref(),on(rn,ar=>{ir||or.postMessage(ar)}),or.onmessage=ar=>{ar.data&&sr(ar.data)}}else if(typeof self<"u"&&typeof navigator<"u"){on(rn,ar=>{try{ir||(typeof localStorage<"u"&&localStorage.setItem(sn,JSON.stringify({trig:Math.random(),changedParts:ar})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(lr=>lr.postMessage({type:sn,changedParts:ar})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",ar=>{if(ar.key===sn){const lr=JSON.parse(ar.newValue);lr&&sr(lr.changedParts)}});const or=self.document&&navigator.serviceWorker;or&&or.addEventListener("message",function({data:ar}){ar&&ar.type===sn&&sr(ar.changedParts)})}je.rejectionMapper=function(or,ar){if(!or||or instanceof W||or instanceof TypeError||or instanceof SyntaxError||!or.name||!J[or.name])return or;var lr=new J[or.name](ar||or.message,or);return"stack"in or&&l(lr,"stack",{get:function(){return this.inner.stack}}),lr},F(R,Et);class BookCharacterDB extends Xn{constructor(){super("BookCharacterDatabase");Zs(this,"books");Zs(this,"characters");Zs(this,"settings");this.version(1).stores({books:"id, fileName",characters:"id, bookId",settings:"id"}),this.on("ready",()=>(console&&console.log&&console.log("Database ready"),Promise.resolve()))}}const db=new BookCharacterDB;function commonjsRequire(or){throw new Error('Could not dynamically require "'+or+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(ar,lr){module.exports=ar.pdfjsLib=lr()})(globalThis,()=>(()=>{var __webpack_modules__=[,(or,ar)=>{var ds;Object.defineProperty(ar,"__esModule",{value:!0}),ar.VerbosityLevel=ar.Util=ar.UnknownErrorException=ar.UnexpectedResponseException=ar.TextRenderingMode=ar.RenderingIntentFlag=ar.PromiseCapability=ar.PermissionFlag=ar.PasswordResponses=ar.PasswordException=ar.PageActionEventType=ar.OPS=ar.MissingPDFException=ar.MAX_IMAGE_SIZE_TO_CACHE=ar.LINE_FACTOR=ar.LINE_DESCENT_FACTOR=ar.InvalidPDFException=ar.ImageKind=ar.IDENTITY_MATRIX=ar.FormatError=ar.FeatureTest=ar.FONT_IDENTITY_MATRIX=ar.DocumentActionEventType=ar.CMapCompressionType=ar.BaseException=ar.BASELINE_FACTOR=ar.AnnotationType=ar.AnnotationReplyType=ar.AnnotationPrefix=ar.AnnotationMode=ar.AnnotationFlag=ar.AnnotationFieldFlag=ar.AnnotationEditorType=ar.AnnotationEditorPrefix=ar.AnnotationEditorParamsType=ar.AnnotationBorderStyleType=ar.AnnotationActionEventType=ar.AbortException=void 0,ar.assert=Hr,ar.bytesToString=ba,ar.createValidAbsoluteUrl=Yr,ar.getModificationDate=Os,ar.getUuid=us,ar.getVerbosityLevel=$r,ar.info=jr,ar.isArrayBuffer=fs,ar.isArrayEqual=Is,ar.isNodeJS=void 0,ar.normalizeUnicode=Ns,ar.objectFromMap=ys,ar.objectSize=ls,ar.setVerbosityLevel=Mr,ar.shadow=qr,ar.string32=os,ar.stringToBytes=_i,ar.stringToPDFString=vs,ar.stringToUTF8String=bs,ar.unreachable=zr,ar.utf8StringToString=xs,ar.warn=Fr;const lr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");ar.isNodeJS=lr;const ur=[1,0,0,1,0,0];ar.IDENTITY_MATRIX=ur;const cr=[.001,0,0,.001,0,0];ar.FONT_IDENTITY_MATRIX=cr;const hr=1e7;ar.MAX_IMAGE_SIZE_TO_CACHE=hr;const dr=1.35;ar.LINE_FACTOR=dr;const fr=.35;ar.LINE_DESCENT_FACTOR=fr;const pr=fr/dr;ar.BASELINE_FACTOR=pr;const vr={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};ar.RenderingIntentFlag=vr;const gr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};ar.AnnotationMode=gr;const mr="pdfjs_internal_editor_";ar.AnnotationEditorPrefix=mr;const br={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};ar.AnnotationEditorType=br;const yr={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};ar.AnnotationEditorParamsType=yr;const xr={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};ar.PermissionFlag=xr;const Cr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};ar.TextRenderingMode=Cr;const Sr={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};ar.ImageKind=Sr;const wr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};ar.AnnotationType=wr;const Er={GROUP:"Group",REPLY:"R"};ar.AnnotationReplyType=Er;const Ar={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};ar.AnnotationFlag=Ar;const Tr={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};ar.AnnotationFieldFlag=Tr;const Rr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};ar.AnnotationBorderStyleType=Rr;const Pr={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};ar.AnnotationActionEventType=Pr;const _r={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};ar.DocumentActionEventType=_r;const kr={O:"PageOpen",C:"PageClose"};ar.PageActionEventType=kr;const Dr={ERRORS:0,WARNINGS:1,INFOS:5};ar.VerbosityLevel=Dr;const Nr={NONE:0,BINARY:1};ar.CMapCompressionType=Nr;const Lr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};ar.OPS=Lr;const Or={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};ar.PasswordResponses=Or;let Ir=Dr.WARNINGS;function Mr(is){Number.isInteger(is)&&(Ir=is)}function $r(){return Ir}function jr(is){Ir>=Dr.INFOS&&console.log(`Info: ${is}`)}function Fr(is){Ir>=Dr.WARNINGS&&console.log(`Warning: ${is}`)}function zr(is){throw new Error(is)}function Hr(is,_a){is||zr(_a)}function Wr(is){switch(is==null?void 0:is.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Yr(is,_a=null,rs=null){if(!is)return null;try{if(rs&&typeof is=="string"){if(rs.addDefaultProtocol&&is.startsWith("www.")){const Es=is.match(/\./g);(Es==null?void 0:Es.length)>=2&&(is=`http://${is}`)}if(rs.tryConvertEncoding)try{is=bs(is)}catch{}}const Cs=_a?new URL(is,_a):new URL(is);if(Wr(Cs))return Cs}catch{}return null}function qr(is,_a,rs,Cs=!1){return Object.defineProperty(is,_a,{value:rs,enumerable:!Cs,configurable:!0,writable:!1}),rs}const Br=function(){function _a(rs,Cs){this.constructor===_a&&zr("Cannot initialize BaseException."),this.message=rs,this.name=Cs}return _a.prototype=new Error,_a.constructor=_a,_a}();ar.BaseException=Br;class Ur extends Br{constructor(_a,rs){super(_a,"PasswordException"),this.code=rs}}ar.PasswordException=Ur;class Vr extends Br{constructor(_a,rs){super(_a,"UnknownErrorException"),this.details=rs}}ar.UnknownErrorException=Vr;class Xr extends Br{constructor(_a){super(_a,"InvalidPDFException")}}ar.InvalidPDFException=Xr;class Zr extends Br{constructor(_a){super(_a,"MissingPDFException")}}ar.MissingPDFException=Zr;class Jr extends Br{constructor(_a,rs){super(_a,"UnexpectedResponseException"),this.status=rs}}ar.UnexpectedResponseException=Jr;class Qr extends Br{constructor(_a){super(_a,"FormatError")}}ar.FormatError=Qr;class ga extends Br{constructor(_a){super(_a,"AbortException")}}ar.AbortException=ga;function ba(is){(typeof is!="object"||(is==null?void 0:is.length)===void 0)&&zr("Invalid argument for bytesToString");const _a=is.length,rs=8192;if(_a<rs)return String.fromCharCode.apply(null,is);const Cs=[];for(let Es=0;Es<_a;Es+=rs){const Rs=Math.min(Es+rs,_a),xa=is.subarray(Es,Rs);Cs.push(String.fromCharCode.apply(null,xa))}return Cs.join("")}function _i(is){typeof is!="string"&&zr("Invalid argument for stringToBytes");const _a=is.length,rs=new Uint8Array(_a);for(let Cs=0;Cs<_a;++Cs)rs[Cs]=is.charCodeAt(Cs)&255;return rs}function os(is){return String.fromCharCode(is>>24&255,is>>16&255,is>>8&255,is&255)}function ls(is){return Object.keys(is).length}function ys(is){const _a=Object.create(null);for(const[rs,Cs]of is)_a[rs]=Cs;return _a}function ns(){const is=new Uint8Array(4);return is[0]=1,new Uint32Array(is.buffer,0,1)[0]===1}function as(){try{return new Function(""),!0}catch{return!1}}class Kr{static get isLittleEndian(){return qr(this,"isLittleEndian",ns())}static get isEvalSupported(){return qr(this,"isEvalSupported",as())}static get isOffscreenCanvasSupported(){return qr(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?qr(this,"platform",{isWin:!1,isMac:!1}):qr(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){var _a,rs;return qr(this,"isCSSRoundSupported",(rs=(_a=globalThis.CSS)==null?void 0:_a.supports)==null?void 0:rs.call(_a,"width: round(1.5px, 1px)"))}}ar.FeatureTest=Kr;const $a=[...Array(256).keys()].map(is=>is.toString(16).padStart(2,"0"));class ss{static makeHexColor(_a,rs,Cs){return`#${$a[_a]}${$a[rs]}${$a[Cs]}`}static scaleMinMax(_a,rs){let Cs;_a[0]?(_a[0]<0&&(Cs=rs[0],rs[0]=rs[1],rs[1]=Cs),rs[0]*=_a[0],rs[1]*=_a[0],_a[3]<0&&(Cs=rs[2],rs[2]=rs[3],rs[3]=Cs),rs[2]*=_a[3],rs[3]*=_a[3]):(Cs=rs[0],rs[0]=rs[2],rs[2]=Cs,Cs=rs[1],rs[1]=rs[3],rs[3]=Cs,_a[1]<0&&(Cs=rs[2],rs[2]=rs[3],rs[3]=Cs),rs[2]*=_a[1],rs[3]*=_a[1],_a[2]<0&&(Cs=rs[0],rs[0]=rs[1],rs[1]=Cs),rs[0]*=_a[2],rs[1]*=_a[2]),rs[0]+=_a[4],rs[1]+=_a[4],rs[2]+=_a[5],rs[3]+=_a[5]}static transform(_a,rs){return[_a[0]*rs[0]+_a[2]*rs[1],_a[1]*rs[0]+_a[3]*rs[1],_a[0]*rs[2]+_a[2]*rs[3],_a[1]*rs[2]+_a[3]*rs[3],_a[0]*rs[4]+_a[2]*rs[5]+_a[4],_a[1]*rs[4]+_a[3]*rs[5]+_a[5]]}static applyTransform(_a,rs){const Cs=_a[0]*rs[0]+_a[1]*rs[2]+rs[4],Es=_a[0]*rs[1]+_a[1]*rs[3]+rs[5];return[Cs,Es]}static applyInverseTransform(_a,rs){const Cs=rs[0]*rs[3]-rs[1]*rs[2],Es=(_a[0]*rs[3]-_a[1]*rs[2]+rs[2]*rs[5]-rs[4]*rs[3])/Cs,Rs=(-_a[0]*rs[1]+_a[1]*rs[0]+rs[4]*rs[1]-rs[5]*rs[0])/Cs;return[Es,Rs]}static getAxialAlignedBoundingBox(_a,rs){const Cs=this.applyTransform(_a,rs),Es=this.applyTransform(_a.slice(2,4),rs),Rs=this.applyTransform([_a[0],_a[3]],rs),xa=this.applyTransform([_a[2],_a[1]],rs);return[Math.min(Cs[0],Es[0],Rs[0],xa[0]),Math.min(Cs[1],Es[1],Rs[1],xa[1]),Math.max(Cs[0],Es[0],Rs[0],xa[0]),Math.max(Cs[1],Es[1],Rs[1],xa[1])]}static inverseTransform(_a){const rs=_a[0]*_a[3]-_a[1]*_a[2];return[_a[3]/rs,-_a[1]/rs,-_a[2]/rs,_a[0]/rs,(_a[2]*_a[5]-_a[4]*_a[3])/rs,(_a[4]*_a[1]-_a[5]*_a[0])/rs]}static singularValueDecompose2dScale(_a){const rs=[_a[0],_a[2],_a[1],_a[3]],Cs=_a[0]*rs[0]+_a[1]*rs[2],Es=_a[0]*rs[1]+_a[1]*rs[3],Rs=_a[2]*rs[0]+_a[3]*rs[2],xa=_a[2]*rs[1]+_a[3]*rs[3],ps=(Cs+xa)/2,Ps=Math.sqrt((Cs+xa)**2-4*(Cs*xa-Rs*Es))/2,Ms=ps+Ps||1,Ls=ps-Ps||1;return[Math.sqrt(Ms),Math.sqrt(Ls)]}static normalizeRect(_a){const rs=_a.slice(0);return _a[0]>_a[2]&&(rs[0]=_a[2],rs[2]=_a[0]),_a[1]>_a[3]&&(rs[1]=_a[3],rs[3]=_a[1]),rs}static intersect(_a,rs){const Cs=Math.max(Math.min(_a[0],_a[2]),Math.min(rs[0],rs[2])),Es=Math.min(Math.max(_a[0],_a[2]),Math.max(rs[0],rs[2]));if(Cs>Es)return null;const Rs=Math.max(Math.min(_a[1],_a[3]),Math.min(rs[1],rs[3])),xa=Math.min(Math.max(_a[1],_a[3]),Math.max(rs[1],rs[3]));return Rs>xa?null:[Cs,Rs,Es,xa]}static bezierBoundingBox(_a,rs,Cs,Es,Rs,xa,ps,Ps){const Ms=[],Ls=[[],[]];let Ds,es,ts,cs,gs,Ss,As,ks;for(let qs=0;qs<2;++qs){if(qs===0?(es=6*_a-12*Cs+6*Rs,Ds=-3*_a+9*Cs-9*Rs+3*ps,ts=3*Cs-3*_a):(es=6*rs-12*Es+6*xa,Ds=-3*rs+9*Es-9*xa+3*Ps,ts=3*Es-3*rs),Math.abs(Ds)<1e-12){if(Math.abs(es)<1e-12)continue;cs=-ts/es,0<cs&&cs<1&&Ms.push(cs);continue}As=es*es-4*ts*Ds,ks=Math.sqrt(As),!(As<0)&&(gs=(-es+ks)/(2*Ds),0<gs&&gs<1&&Ms.push(gs),Ss=(-es-ks)/(2*Ds),0<Ss&&Ss<1&&Ms.push(Ss))}let js=Ms.length,zs;const Fs=js;for(;js--;)cs=Ms[js],zs=1-cs,Ls[0][js]=zs*zs*zs*_a+3*zs*zs*cs*Cs+3*zs*cs*cs*Rs+cs*cs*cs*ps,Ls[1][js]=zs*zs*zs*rs+3*zs*zs*cs*Es+3*zs*cs*cs*xa+cs*cs*cs*Ps;return Ls[0][Fs]=_a,Ls[1][Fs]=rs,Ls[0][Fs+1]=ps,Ls[1][Fs+1]=Ps,Ls[0].length=Ls[1].length=Fs+2,[Math.min(...Ls[0]),Math.min(...Ls[1]),Math.max(...Ls[0]),Math.max(...Ls[1])]}}ar.Util=ss;const hs=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function vs(is){if(is[0]>=""){let rs;if(is[0]===""&&is[1]===""?rs="utf-16be":is[0]===""&&is[1]===""?rs="utf-16le":is[0]===""&&is[1]===""&&is[2]===""&&(rs="utf-8"),rs)try{const Cs=new TextDecoder(rs,{fatal:!0}),Es=_i(is);return Cs.decode(Es)}catch(Cs){Fr(`stringToPDFString: "${Cs}".`)}}const _a=[];for(let rs=0,Cs=is.length;rs<Cs;rs++){const Es=hs[is.charCodeAt(rs)];_a.push(Es?String.fromCharCode(Es):is.charAt(rs))}return _a.join("")}function bs(is){return decodeURIComponent(escape(is))}function xs(is){return unescape(encodeURIComponent(is))}function fs(is){return typeof is=="object"&&(is==null?void 0:is.byteLength)!==void 0}function Is(is,_a){if(is.length!==_a.length)return!1;for(let rs=0,Cs=is.length;rs<Cs;rs++)if(is[rs]!==_a[rs])return!1;return!0}function Os(is=new Date){return[is.getUTCFullYear().toString(),(is.getUTCMonth()+1).toString().padStart(2,"0"),is.getUTCDate().toString().padStart(2,"0"),is.getUTCHours().toString().padStart(2,"0"),is.getUTCMinutes().toString().padStart(2,"0"),is.getUTCSeconds().toString().padStart(2,"0")].join("")}class Us{constructor(){Ts(this,ds,!1);this.promise=new Promise((_a,rs)=>{this.resolve=Cs=>{_s(this,ds,!0),_a(Cs)},this.reject=Cs=>{_s(this,ds,!0),rs(Cs)}})}get settled(){return Gr(this,ds)}}ds=new WeakMap,ar.PromiseCapability=Us;let $s=null,Bs=null;function Ns(is){return $s||($s=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Bs=new Map([["","t"]])),is.replaceAll($s,(_a,rs,Cs)=>rs?rs.normalize("NFKC"):Bs.get(Cs))}function us(){if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.randomUUID)=="function")return crypto.randomUUID();const is=new Uint8Array(32);if(typeof crypto<"u"&&typeof(crypto==null?void 0:crypto.getRandomValues)=="function")crypto.getRandomValues(is);else for(let _a=0;_a<32;_a++)is[_a]=Math.floor(Math.random()*255);return ba(is)}const na="pdfjs_internal_id_";ar.AnnotationPrefix=na},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var or,lr,ur,cr,go,No,fr,pr,vr,gr,mr,br,yr,xr,Cr,Oo,wr,Er,Ko,Tr,Rr;Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(_r){if(typeof _r=="string"||_r instanceof URL?_r={url:_r}:(0,_util.isArrayBuffer)(_r)&&(_r={data:_r}),typeof _r!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!_r.url&&!_r.data&&!_r.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const kr=new PDFDocumentLoadingTask,{docId:Dr}=kr,Nr=_r.url?getUrlProp(_r.url):null,Lr=_r.data?getDataProp(_r.data):null,Or=_r.httpHeaders||null,Ir=_r.withCredentials===!0,Mr=_r.password??null,$r=_r.range instanceof PDFDataRangeTransport?_r.range:null,jr=Number.isInteger(_r.rangeChunkSize)&&_r.rangeChunkSize>0?_r.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Fr=_r.worker instanceof PDFWorker?_r.worker:null;const zr=_r.verbosity,Hr=typeof _r.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(_r.docBaseUrl)?_r.docBaseUrl:null,Wr=typeof _r.cMapUrl=="string"?_r.cMapUrl:null,Yr=_r.cMapPacked!==!1,qr=_r.CMapReaderFactory||DefaultCMapReaderFactory,Br=typeof _r.standardFontDataUrl=="string"?_r.standardFontDataUrl:null,Ur=_r.StandardFontDataFactory||DefaultStandardFontDataFactory,Vr=_r.stopAtErrors!==!0,Xr=Number.isInteger(_r.maxImageSize)&&_r.maxImageSize>-1?_r.maxImageSize:-1,Zr=_r.isEvalSupported!==!1,Jr=typeof _r.isOffscreenCanvasSupported=="boolean"?_r.isOffscreenCanvasSupported:!_util.isNodeJS,Qr=Number.isInteger(_r.canvasMaxAreaInBytes)?_r.canvasMaxAreaInBytes:-1,ga=typeof _r.disableFontFace=="boolean"?_r.disableFontFace:_util.isNodeJS,ba=_r.fontExtraProperties===!0,_i=_r.enableXfa===!0,os=_r.ownerDocument||globalThis.document,ls=_r.disableRange===!0,ys=_r.disableStream===!0,ns=_r.disableAutoFetch===!0,as=_r.pdfBug===!0,Kr=$r?$r.length:_r.length??NaN,$a=typeof _r.useSystemFonts=="boolean"?_r.useSystemFonts:!_util.isNodeJS&&!ga,ss=typeof _r.useWorkerFetch=="boolean"?_r.useWorkerFetch:qr===_display_utils.DOMCMapReaderFactory&&Ur===_display_utils.DOMStandardFontDataFactory&&Wr&&Br&&(0,_display_utils.isValidFetchUrl)(Wr,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(Br,document.baseURI),hs=_r.canvasFactory||new DefaultCanvasFactory({ownerDocument:os}),vs=_r.filterFactory||new DefaultFilterFactory({docId:Dr,ownerDocument:os}),bs=null;(0,_util.setVerbosityLevel)(zr);const xs={canvasFactory:hs,filterFactory:vs};if(ss||(xs.cMapReaderFactory=new qr({baseUrl:Wr,isCompressed:Yr}),xs.standardFontDataFactory=new Ur({baseUrl:Br})),!Fr){const Os={verbosity:zr,port:_worker_options.GlobalWorkerOptions.workerPort};Fr=Os.port?PDFWorker.fromPort(Os):new PDFWorker(Os),kr._worker=Fr}const fs={docId:Dr,apiVersion:"3.11.174",data:Lr,password:Mr,disableAutoFetch:ns,rangeChunkSize:jr,length:Kr,docBaseUrl:Hr,enableXfa:_i,evaluatorOptions:{maxImageSize:Xr,disableFontFace:ga,ignoreErrors:Vr,isEvalSupported:Zr,isOffscreenCanvasSupported:Jr,canvasMaxAreaInBytes:Qr,fontExtraProperties:ba,useSystemFonts:$a,cMapUrl:ss?Wr:null,standardFontDataUrl:ss?Br:null}},Is={ignoreErrors:Vr,isEvalSupported:Zr,disableFontFace:ga,fontExtraProperties:ba,enableXfa:_i,ownerDocument:os,disableAutoFetch:ns,pdfBug:as,styleElement:bs};return Fr.promise.then(function(){if(kr.destroyed)throw new Error("Loading aborted");const Os=_fetchDocument(Fr,fs),Us=new Promise(function($s){let Bs;$r?Bs=new _transport_stream.PDFDataTransportStream({length:Kr,initialData:$r.initialData,progressiveDone:$r.progressiveDone,contentDispositionFilename:$r.contentDispositionFilename,disableRange:ls,disableStream:ys},$r):Lr||(Bs=(us=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(us):(0,_display_utils.isValidFetchUrl)(us.url)?new _displayFetch_stream.PDFFetchStream(us):new _displayNetwork.PDFNetworkStream(us))({url:Nr,length:Kr,httpHeaders:Or,withCredentials:Ir,rangeChunkSize:jr,disableRange:ls,disableStream:ys})),$s(Bs)});return Promise.all([Os,Us]).then(function([$s,Bs]){if(kr.destroyed)throw new Error("Loading aborted");const Ns=new _message_handler.MessageHandler(Dr,$s,Fr.port),us=new WorkerTransport(Ns,kr,Bs,Is,xs);kr._transport=us,Ns.send("Ready",null)})}).catch(kr._capability.reject),kr}async function _fetchDocument(_r,kr){if(_r.destroyed)throw new Error("Worker was destroyed");const Dr=await _r.messageHandler.sendWithPromise("GetDocRequest",kr,kr.data?[kr.data.buffer]:null);if(_r.destroyed)throw new Error("Worker was destroyed");return Dr}function getUrlProp(_r){if(_r instanceof URL)return _r.href;try{return new URL(_r,window.location).href}catch{if(_util.isNodeJS&&typeof _r=="string")return _r}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(_r){if(_util.isNodeJS&&typeof Buffer<"u"&&_r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(_r instanceof Uint8Array&&_r.byteLength===_r.buffer.byteLength)return _r;if(typeof _r=="string")return(0,_util.stringToBytes)(_r);if(typeof _r=="object"&&!isNaN(_r==null?void 0:_r.length)||(0,_util.isArrayBuffer)(_r))return new Uint8Array(_r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const ar=class ar{constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${So(ar,or)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var kr,Dr,Nr;this.destroyed=!0;try{(kr=this._worker)!=null&&kr.port&&(this._worker._pendingDestroy=!0),await((Dr=this._transport)==null?void 0:Dr.destroy())}catch(Lr){throw(Nr=this._worker)!=null&&Nr.port&&delete this._worker._pendingDestroy,Lr}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};or=new WeakMap,Ts(ar,or,0);let PDFDocumentLoadingTask=ar;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(kr,Dr,Nr=!1,Lr=null){this.length=kr,this.initialData=Dr,this.progressiveDone=Nr,this.contentDispositionFilename=Lr,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(kr){this._rangeListeners.push(kr)}addProgressListener(kr){this._progressListeners.push(kr)}addProgressiveReadListener(kr){this._progressiveReadListeners.push(kr)}addProgressiveDoneListener(kr){this._progressiveDoneListeners.push(kr)}onDataRange(kr,Dr){for(const Nr of this._rangeListeners)Nr(kr,Dr)}onDataProgress(kr,Dr){this._readyCapability.promise.then(()=>{for(const Nr of this._progressListeners)Nr(kr,Dr)})}onDataProgressiveRead(kr){this._readyCapability.promise.then(()=>{for(const Dr of this._progressiveReadListeners)Dr(kr)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const kr of this._progressiveDoneListeners)kr()})}transportReady(){this._readyCapability.resolve()}requestDataRange(kr,Dr){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(kr,Dr){this._pdfInfo=kr,this._transport=Dr,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(Nr=>{if(!Nr)return Nr;const Lr=[];for(const Or in Nr)Lr.push(...Nr[Or]);return Lr}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(kr){return this._transport.getPage(kr)}getPageIndex(kr){return this._transport.getPageIndex(kr)}getDestinations(){return this._transport.getDestinations()}getDestination(kr){return this._transport.getDestination(kr)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(kr=!1){return this._transport.startCleanup(kr||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(kr,Dr,Nr,Lr=!1){Ts(this,cr);Ts(this,lr,null);Ts(this,ur,!1);this._pageIndex=kr,this._pageInfo=Dr,this._transport=Nr,this._stats=Lr?new _display_utils.StatTimer:null,this._pdfBug=Lr,this.commonObjs=Nr.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:kr,rotation:Dr=this.rotate,offsetX:Nr=0,offsetY:Lr=0,dontFlip:Or=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:kr,rotation:Dr,offsetX:Nr,offsetY:Lr,dontFlip:Or})}getAnnotations({intent:kr="display"}={}){const Dr=this._transport.getRenderingIntent(kr);return this._transport.getAnnotations(this._pageIndex,Dr.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var kr;return((kr=this._transport._htmlForXfa)==null?void 0:kr.children[this._pageIndex])||null}render({canvasContext:kr,viewport:Dr,intent:Nr="display",annotationMode:Lr=_util.AnnotationMode.ENABLE,transform:Or=null,background:Ir=null,optionalContentConfigPromise:Mr=null,annotationCanvasMap:$r=null,pageColors:jr=null,printAnnotationStorage:Fr=null}){var Ur,Vr;(Ur=this._stats)==null||Ur.time("Overall");const zr=this._transport.getRenderingIntent(Nr,Lr,Fr);_s(this,ur,!1),ws(this,cr,No).call(this),Mr||(Mr=this._transport.getOptionalContentConfig());let Hr=this._intentStates.get(zr.cacheKey);Hr||(Hr=Object.create(null),this._intentStates.set(zr.cacheKey,Hr)),Hr.streamReaderCancelTimeout&&(clearTimeout(Hr.streamReaderCancelTimeout),Hr.streamReaderCancelTimeout=null);const Wr=!!(zr.renderingIntent&_util.RenderingIntentFlag.PRINT);Hr.displayReadyCapability||(Hr.displayReadyCapability=new _util.PromiseCapability,Hr.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(Vr=this._stats)==null||Vr.time("Page Request"),this._pumpOperatorList(zr));const Yr=Xr=>{var Zr,Jr;Hr.renderTasks.delete(qr),(this._maybeCleanupAfterRender||Wr)&&_s(this,ur,!0),ws(this,cr,go).call(this,!Wr),Xr?(qr.capability.reject(Xr),this._abortOperatorList({intentState:Hr,reason:Xr instanceof Error?Xr:new Error(Xr)})):qr.capability.resolve(),(Zr=this._stats)==null||Zr.timeEnd("Rendering"),(Jr=this._stats)==null||Jr.timeEnd("Overall")},qr=new InternalRenderTask({callback:Yr,params:{canvasContext:kr,viewport:Dr,transform:Or,background:Ir},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:$r,operatorList:Hr.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Wr,pdfBug:this._pdfBug,pageColors:jr});(Hr.renderTasks||(Hr.renderTasks=new Set)).add(qr);const Br=qr.task;return Promise.all([Hr.displayReadyCapability.promise,Mr]).then(([Xr,Zr])=>{var Jr;if(this.destroyed){Yr();return}(Jr=this._stats)==null||Jr.time("Rendering"),qr.initializeGraphics({transparency:Xr,optionalContentConfig:Zr}),qr.operatorListChanged()}).catch(Yr),Br}getOperatorList({intent:kr="display",annotationMode:Dr=_util.AnnotationMode.ENABLE,printAnnotationStorage:Nr=null}={}){var $r;function Lr(){Ir.operatorList.lastChunk&&(Ir.opListReadCapability.resolve(Ir.operatorList),Ir.renderTasks.delete(Mr))}const Or=this._transport.getRenderingIntent(kr,Dr,Nr,!0);let Ir=this._intentStates.get(Or.cacheKey);Ir||(Ir=Object.create(null),this._intentStates.set(Or.cacheKey,Ir));let Mr;return Ir.opListReadCapability||(Mr=Object.create(null),Mr.operatorListChanged=Lr,Ir.opListReadCapability=new _util.PromiseCapability,(Ir.renderTasks||(Ir.renderTasks=new Set)).add(Mr),Ir.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},($r=this._stats)==null||$r.time("Page Request"),this._pumpOperatorList(Or)),Ir.opListReadCapability.promise}streamTextContent({includeMarkedContent:kr=!1,disableNormalization:Dr=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:kr===!0,disableNormalization:Dr===!0},{highWaterMark:100,size(Lr){return Lr.items.length}})}getTextContent(kr={}){if(this._transport._htmlForXfa)return this.getXfa().then(Nr=>_xfa_text.XfaText.textContent(Nr));const Dr=this.streamTextContent(kr);return new Promise(function(Nr,Lr){function Or(){Ir.read().then(function({value:$r,done:jr}){if(jr){Nr(Mr);return}Object.assign(Mr.styles,$r.styles),Mr.items.push(...$r.items),Or()},Lr)}const Ir=Dr.getReader(),Mr={items:[],styles:Object.create(null)};Or()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const kr=[];for(const Dr of this._intentStates.values())if(this._abortOperatorList({intentState:Dr,reason:new Error("Page was destroyed."),force:!0}),!Dr.opListReadCapability)for(const Nr of Dr.renderTasks)kr.push(Nr.completed),Nr.cancel();return this.objs.clear(),_s(this,ur,!1),ws(this,cr,No).call(this),Promise.all(kr)}cleanup(kr=!1){_s(this,ur,!0);const Dr=ws(this,cr,go).call(this,!1);return kr&&Dr&&this._stats&&(this._stats=new _display_utils.StatTimer),Dr}_startRenderPage(kr,Dr){var Lr,Or;const Nr=this._intentStates.get(Dr);Nr&&((Lr=this._stats)==null||Lr.timeEnd("Page Request"),(Or=Nr.displayReadyCapability)==null||Or.resolve(kr))}_renderPageChunk(kr,Dr){for(let Nr=0,Lr=kr.length;Nr<Lr;Nr++)Dr.operatorList.fnArray.push(kr.fnArray[Nr]),Dr.operatorList.argsArray.push(kr.argsArray[Nr]);Dr.operatorList.lastChunk=kr.lastChunk,Dr.operatorList.separateAnnots=kr.separateAnnots;for(const Nr of Dr.renderTasks)Nr.operatorListChanged();kr.lastChunk&&ws(this,cr,go).call(this,!0)}_pumpOperatorList({renderingIntent:kr,cacheKey:Dr,annotationStorageSerializable:Nr}){const{map:Lr,transfers:Or}=Nr,Mr=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:kr,cacheKey:Dr,annotationStorage:Lr},Or).getReader(),$r=this._intentStates.get(Dr);$r.streamReader=Mr;const jr=()=>{Mr.read().then(({value:Fr,done:zr})=>{if(zr){$r.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Fr,$r),jr())},Fr=>{if($r.streamReader=null,!this._transport.destroyed){if($r.operatorList){$r.operatorList.lastChunk=!0;for(const zr of $r.renderTasks)zr.operatorListChanged();ws(this,cr,go).call(this,!0)}if($r.displayReadyCapability)$r.displayReadyCapability.reject(Fr);else if($r.opListReadCapability)$r.opListReadCapability.reject(Fr);else throw Fr}})};jr()}_abortOperatorList({intentState:kr,reason:Dr,force:Nr=!1}){if(kr.streamReader){if(kr.streamReaderCancelTimeout&&(clearTimeout(kr.streamReaderCancelTimeout),kr.streamReaderCancelTimeout=null),!Nr){if(kr.renderTasks.size>0)return;if(Dr instanceof _display_utils.RenderingCancelledException){let Lr=RENDERING_CANCELLED_TIMEOUT;Dr.extraDelay>0&&Dr.extraDelay<1e3&&(Lr+=Dr.extraDelay),kr.streamReaderCancelTimeout=setTimeout(()=>{kr.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:kr,reason:Dr,force:!0})},Lr);return}}if(kr.streamReader.cancel(new _util.AbortException(Dr.message)).catch(()=>{}),kr.streamReader=null,!this._transport.destroyed){for(const[Lr,Or]of this._intentStates)if(Or===kr){this._intentStates.delete(Lr);break}this.cleanup()}}}get stats(){return this._stats}}lr=new WeakMap,ur=new WeakMap,cr=new WeakSet,go=function(kr=!1){if(ws(this,cr,No).call(this),!Gr(this,ur)||this.destroyed)return!1;if(kr)return _s(this,lr,setTimeout(()=>{_s(this,lr,null),ws(this,cr,go).call(this,!1)},DELAYED_CLEANUP_TIMEOUT)),!1;for(const{renderTasks:Dr,operatorList:Nr}of this._intentStates.values())if(Dr.size>0||!Nr.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_s(this,ur,!1),!0},No=function(){Gr(this,lr)&&(clearTimeout(Gr(this,lr)),_s(this,lr,null))},exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){Ts(this,fr,new Set);Ts(this,pr,Promise.resolve())}postMessage(kr,Dr){const Nr={data:structuredClone(kr,Dr?{transfer:Dr}:null)};Gr(this,pr).then(()=>{for(const Lr of Gr(this,fr))Lr.call(this,Nr)})}addEventListener(kr,Dr){Gr(this,fr).add(Dr)}removeEventListener(kr,Dr){Gr(this,fr).delete(Dr)}terminate(){Gr(this,fr).clear()}}fr=new WeakMap,pr=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const _r=(vr=document==null?void 0:document.currentScript)==null?void 0:vr.src;_r&&(PDFWorkerUtil.fallbackWorkerSrc=_r.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(_r,kr){let Dr;try{if(Dr=new URL(_r),!Dr.origin||Dr.origin==="null")return!1}catch{return!1}const Nr=new URL(kr,Dr);return Dr.origin===Nr.origin},PDFWorkerUtil.createCDNWrapper=function(_r){const kr=`importScripts("${_r}");`;return URL.createObjectURL(new Blob([kr]))}}const _PDFWorker=class _PDFWorker{constructor({name:_r=null,port:kr=null,verbosity:Dr=(0,_util.getVerbosityLevel)()}={}){var Nr;if(this.name=_r,this.destroyed=!1,this.verbosity=Dr,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,kr){if((Nr=Gr(_PDFWorker,gr))!=null&&Nr.has(kr))throw new Error("Cannot use more than one PDFWorker per port.");(Gr(_PDFWorker,gr)||_s(_PDFWorker,gr,new WeakMap)).set(kr,this),this._initializeFromPort(kr);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(_r){this._port=_r,this._messageHandler=new _message_handler.MessageHandler("main","worker",_r),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:_r}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,_r)||(_r=PDFWorkerUtil.createCDNWrapper(new URL(_r,window.location).href));const kr=new Worker(_r),Dr=new _message_handler.MessageHandler("main","worker",kr),Nr=()=>{kr.removeEventListener("error",Lr),Dr.destroy(),kr.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Lr=()=>{this._webWorker||Nr()};kr.addEventListener("error",Lr),Dr.on("test",Ir=>{if(kr.removeEventListener("error",Lr),this.destroyed){Nr();return}Ir?(this._messageHandler=Dr,this._port=kr,this._webWorker=kr,this._readyCapability.resolve(),Dr.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),Dr.destroy(),kr.terminate())}),Dr.on("ready",Ir=>{if(kr.removeEventListener("error",Lr),this.destroyed){Nr();return}try{Or()}catch{this._setupFakeWorker()}});const Or=()=>{const Ir=new Uint8Array;Dr.send("test",Ir,[Ir.buffer])};Or();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(_r=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const kr=new LoopbackPort;this._port=kr;const Dr=`fake${PDFWorkerUtil.fakeWorkerId++}`,Nr=new _message_handler.MessageHandler(Dr+"_worker",Dr,kr);_r.setup(Nr,kr);const Lr=new _message_handler.MessageHandler(Dr,Dr+"_worker",kr);this._messageHandler=Lr,this._readyCapability.resolve(),Lr.send("configure",{verbosity:this.verbosity})}).catch(_r=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${_r.message}".`))})}destroy(){var _r;this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),(_r=Gr(_PDFWorker,gr))==null||_r.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(_r){var Dr;if(!(_r!=null&&_r.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const kr=(Dr=Gr(this,gr))==null?void 0:Dr.get(_r.port);if(kr){if(kr._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return kr}return new _PDFWorker(_r)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var _r;try{return((_r=globalThis.pdfjsWorker)==null?void 0:_r.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};gr=new WeakMap,Ts(_PDFWorker,gr);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(kr,Dr,Nr,Lr,Or){Ts(this,Cr);Ts(this,mr,new Map);Ts(this,br,new Map);Ts(this,yr,new Map);Ts(this,xr,null);this.messageHandler=kr,this.loadingTask=Dr,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:Lr.ownerDocument,styleElement:Lr.styleElement}),this._params=Lr,this.canvasFactory=Or.canvasFactory,this.filterFactory=Or.filterFactory,this.cMapReaderFactory=Or.cMapReaderFactory,this.standardFontDataFactory=Or.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=Nr,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(kr,Dr=_util.AnnotationMode.ENABLE,Nr=null,Lr=!1){let Or=_util.RenderingIntentFlag.DISPLAY,Ir=_annotation_storage.SerializableEmpty;switch(kr){case"any":Or=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Or=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${kr}`)}switch(Dr){case _util.AnnotationMode.DISABLE:Or+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Or+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Or+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,Ir=(Or&_util.RenderingIntentFlag.PRINT&&Nr instanceof _annotation_storage.PrintAnnotationStorage?Nr:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${Dr}`)}return Lr&&(Or+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Or,cacheKey:`${Or}_${Ir.hash}`,annotationStorageSerializable:Ir}}destroy(){var Nr;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,(Nr=Gr(this,xr))==null||Nr.reject(new Error("Worker was destroyed during onPassword callback"));const kr=[];for(const Lr of Gr(this,br).values())kr.push(Lr._destroy());Gr(this,br).clear(),Gr(this,yr).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const Dr=this.messageHandler.sendWithPromise("Terminate",null);return kr.push(Dr),Promise.all(kr).then(()=>{var Lr;this.commonObjs.clear(),this.fontLoader.clear(),Gr(this,mr).clear(),this.filterFactory.destroy(),(Lr=this._networkStream)==null||Lr.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:kr,loadingTask:Dr}=this;kr.on("GetReader",(Nr,Lr)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Or=>{this._lastProgress={loaded:Or.loaded,total:Or.total}},Lr.onPull=()=>{this._fullReader.read().then(function({value:Or,done:Ir}){if(Ir){Lr.close();return}(0,_util.assert)(Or instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Lr.enqueue(new Uint8Array(Or),1,[Or])}).catch(Or=>{Lr.error(Or)})},Lr.onCancel=Or=>{this._fullReader.cancel(Or),Lr.ready.catch(Ir=>{if(!this.destroyed)throw Ir})}}),kr.on("ReaderHeadersReady",Nr=>{const Lr=new _util.PromiseCapability,Or=this._fullReader;return Or.headersReady.then(()=>{var Ir;(!Or.isStreamingSupported||!Or.isRangeSupported)&&(this._lastProgress&&((Ir=Dr.onProgress)==null||Ir.call(Dr,this._lastProgress)),Or.onProgress=Mr=>{var $r;($r=Dr.onProgress)==null||$r.call(Dr,{loaded:Mr.loaded,total:Mr.total})}),Lr.resolve({isStreamingSupported:Or.isStreamingSupported,isRangeSupported:Or.isRangeSupported,contentLength:Or.contentLength})},Lr.reject),Lr.promise}),kr.on("GetRangeReader",(Nr,Lr)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Or=this._networkStream.getRangeReader(Nr.begin,Nr.end);if(!Or){Lr.close();return}Lr.onPull=()=>{Or.read().then(function({value:Ir,done:Mr}){if(Mr){Lr.close();return}(0,_util.assert)(Ir instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Lr.enqueue(new Uint8Array(Ir),1,[Ir])}).catch(Ir=>{Lr.error(Ir)})},Lr.onCancel=Ir=>{Or.cancel(Ir),Lr.ready.catch(Mr=>{if(!this.destroyed)throw Mr})}}),kr.on("GetDoc",({pdfInfo:Nr})=>{this._numPages=Nr.numPages,this._htmlForXfa=Nr.htmlForXfa,delete Nr.htmlForXfa,Dr._capability.resolve(new PDFDocumentProxy(Nr,this))}),kr.on("DocException",function(Nr){let Lr;switch(Nr.name){case"PasswordException":Lr=new _util.PasswordException(Nr.message,Nr.code);break;case"InvalidPDFException":Lr=new _util.InvalidPDFException(Nr.message);break;case"MissingPDFException":Lr=new _util.MissingPDFException(Nr.message);break;case"UnexpectedResponseException":Lr=new _util.UnexpectedResponseException(Nr.message,Nr.status);break;case"UnknownErrorException":Lr=new _util.UnknownErrorException(Nr.message,Nr.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}Dr._capability.reject(Lr)}),kr.on("PasswordRequest",Nr=>{if(_s(this,xr,new _util.PromiseCapability),Dr.onPassword){const Lr=Or=>{Or instanceof Error?Gr(this,xr).reject(Or):Gr(this,xr).resolve({password:Or})};try{Dr.onPassword(Lr,Nr.code)}catch(Or){Gr(this,xr).reject(Or)}}else Gr(this,xr).reject(new _util.PasswordException(Nr.message,Nr.code));return Gr(this,xr).promise}),kr.on("DataLoaded",Nr=>{var Lr;(Lr=Dr.onProgress)==null||Lr.call(Dr,{loaded:Nr.length,total:Nr.length}),this.downloadInfoCapability.resolve(Nr)}),kr.on("StartRenderPage",Nr=>{if(this.destroyed)return;Gr(this,br).get(Nr.pageIndex)._startRenderPage(Nr.transparency,Nr.cacheKey)}),kr.on("commonobj",([Nr,Lr,Or])=>{var Ir;if(!this.destroyed&&!this.commonObjs.has(Nr))switch(Lr){case"Font":const Mr=this._params;if("error"in Or){const Fr=Or.error;(0,_util.warn)(`Error during font loading: ${Fr}`),this.commonObjs.resolve(Nr,Fr);break}const $r=Mr.pdfBug&&((Ir=globalThis.FontInspector)!=null&&Ir.enabled)?(Fr,zr)=>globalThis.FontInspector.fontAdded(Fr,zr):null,jr=new _font_loader.FontFaceObject(Or,{isEvalSupported:Mr.isEvalSupported,disableFontFace:Mr.disableFontFace,ignoreErrors:Mr.ignoreErrors,inspectFont:$r});this.fontLoader.bind(jr).catch(Fr=>kr.sendWithPromise("FontFallback",{id:Nr})).finally(()=>{!Mr.fontExtraProperties&&jr.data&&(jr.data=null),this.commonObjs.resolve(Nr,jr)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(Nr,Or);break;default:throw new Error(`Got unknown common object type ${Lr}`)}}),kr.on("obj",([Nr,Lr,Or,Ir])=>{var $r;if(this.destroyed)return;const Mr=Gr(this,br).get(Lr);if(!Mr.objs.has(Nr))switch(Or){case"Image":if(Mr.objs.resolve(Nr,Ir),Ir){let jr;if(Ir.bitmap){const{width:Fr,height:zr}=Ir;jr=Fr*zr*4}else jr=(($r=Ir.data)==null?void 0:$r.length)||0;jr>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Mr._maybeCleanupAfterRender=!0)}break;case"Pattern":Mr.objs.resolve(Nr,Ir);break;default:throw new Error(`Got unknown object type ${Or}`)}}),kr.on("DocProgress",Nr=>{var Lr;this.destroyed||(Lr=Dr.onProgress)==null||Lr.call(Dr,{loaded:Nr.loaded,total:Nr.total})}),kr.on("FetchBuiltInCMap",Nr=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(Nr):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),kr.on("FetchStandardFontData",Nr=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(Nr):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var Nr;this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:kr,transfers:Dr}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:kr,filename:((Nr=this._fullReader)==null?void 0:Nr.filename)??null},Dr).finally(()=>{this.annotationStorage.resetModified()})}getPage(kr){if(!Number.isInteger(kr)||kr<=0||kr>this._numPages)return Promise.reject(new Error("Invalid page request."));const Dr=kr-1,Nr=Gr(this,yr).get(Dr);if(Nr)return Nr;const Lr=this.messageHandler.sendWithPromise("GetPage",{pageIndex:Dr}).then(Or=>{if(this.destroyed)throw new Error("Transport destroyed");const Ir=new PDFPageProxy(Dr,Or,this,this._params.pdfBug);return Gr(this,br).set(Dr,Ir),Ir});return Gr(this,yr).set(Dr,Lr),Lr}getPageIndex(kr){return typeof kr!="object"||kr===null||!Number.isInteger(kr.num)||kr.num<0||!Number.isInteger(kr.gen)||kr.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:kr.num,gen:kr.gen})}getAnnotations(kr,Dr){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:kr,intent:Dr})}getFieldObjects(){return ws(this,Cr,Oo).call(this,"GetFieldObjects")}hasJSActions(){return ws(this,Cr,Oo).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(kr){return typeof kr!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:kr})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return ws(this,Cr,Oo).call(this,"GetDocJSActions")}getPageJSActions(kr){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:kr})}getStructTree(kr){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:kr})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(kr=>new _optional_content_config.OptionalContentConfig(kr))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const kr="GetMetadata",Dr=Gr(this,mr).get(kr);if(Dr)return Dr;const Nr=this.messageHandler.sendWithPromise(kr,null).then(Lr=>{var Or,Ir;return{info:Lr[0],metadata:Lr[1]?new _metadata.Metadata(Lr[1]):null,contentDispositionFilename:((Or=this._fullReader)==null?void 0:Or.filename)??null,contentLength:((Ir=this._fullReader)==null?void 0:Ir.contentLength)??null}});return Gr(this,mr).set(kr,Nr),Nr}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(kr=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const Dr of Gr(this,br).values())if(!Dr.cleanup())throw new Error(`startCleanup: Page ${Dr.pageNumber} is currently rendering.`);this.commonObjs.clear(),kr||this.fontLoader.clear(),Gr(this,mr).clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:kr,enableXfa:Dr}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:kr,enableXfa:Dr})}}mr=new WeakMap,br=new WeakMap,yr=new WeakMap,xr=new WeakMap,Cr=new WeakSet,Oo=function(kr,Dr=null){const Nr=Gr(this,mr).get(kr);if(Nr)return Nr;const Lr=this.messageHandler.sendWithPromise(kr,Dr);return Gr(this,mr).set(kr,Lr),Lr};class PDFObjects{constructor(){Ts(this,Er);Ts(this,wr,Object.create(null))}get(kr,Dr=null){if(Dr){const Lr=ws(this,Er,Ko).call(this,kr);return Lr.capability.promise.then(()=>Dr(Lr.data)),null}const Nr=Gr(this,wr)[kr];if(!(Nr!=null&&Nr.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${kr}.`);return Nr.data}has(kr){const Dr=Gr(this,wr)[kr];return(Dr==null?void 0:Dr.capability.settled)||!1}resolve(kr,Dr=null){const Nr=ws(this,Er,Ko).call(this,kr);Nr.data=Dr,Nr.capability.resolve()}clear(){var kr;for(const Dr in Gr(this,wr)){const{data:Nr}=Gr(this,wr)[Dr];(kr=Nr==null?void 0:Nr.bitmap)==null||kr.close()}_s(this,wr,Object.create(null))}}wr=new WeakMap,Er=new WeakSet,Ko=function(kr){var Dr;return(Dr=Gr(this,wr))[kr]||(Dr[kr]={capability:new _util.PromiseCapability,data:null})};class RenderTask{constructor(kr){Ts(this,Tr,null);_s(this,Tr,kr),this.onContinue=null}get promise(){return Gr(this,Tr).capability.promise}cancel(kr=0){Gr(this,Tr).cancel(null,kr)}get separateAnnots(){const{separateAnnots:kr}=Gr(this,Tr).operatorList;if(!kr)return!1;const{annotationCanvasMap:Dr}=Gr(this,Tr);return kr.form||kr.canvas&&(Dr==null?void 0:Dr.size)>0}}Tr=new WeakMap,exports.RenderTask=RenderTask;const Pr=class Pr{constructor({callback:kr,params:Dr,objs:Nr,commonObjs:Lr,annotationCanvasMap:Or,operatorList:Ir,pageIndex:Mr,canvasFactory:$r,filterFactory:jr,useRequestAnimationFrame:Fr=!1,pdfBug:zr=!1,pageColors:Hr=null}){this.callback=kr,this.params=Dr,this.objs=Nr,this.commonObjs=Lr,this.annotationCanvasMap=Or,this.operatorListIdx=null,this.operatorList=Ir,this._pageIndex=Mr,this.canvasFactory=$r,this.filterFactory=jr,this._pdfBug=zr,this.pageColors=Hr,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Fr===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=Dr.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:kr=!1,optionalContentConfig:Dr}){var Mr,$r;if(this.cancelled)return;if(this._canvas){if(Gr(Pr,Rr).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Gr(Pr,Rr).add(this._canvas)}this._pdfBug&&((Mr=globalThis.StepperManager)!=null&&Mr.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:Nr,viewport:Lr,transform:Or,background:Ir}=this.params;this.gfx=new _canvas.CanvasGraphics(Nr,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:Dr},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Or,viewport:Lr,transparency:kr,background:Ir}),this.operatorListIdx=0,this.graphicsReady=!0,($r=this.graphicsReadyCallback)==null||$r.call(this)}cancel(kr=null,Dr=0){var Nr;this.running=!1,this.cancelled=!0,(Nr=this.gfx)==null||Nr.endDrawing(),Gr(Pr,Rr).delete(this._canvas),this.callback(kr||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,Dr))}operatorListChanged(){var kr;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(kr=this.stepper)==null||kr.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Gr(Pr,Rr).delete(this._canvas),this.callback())))}};Rr=new WeakMap,Ts(Pr,Rr,new WeakSet);let InternalRenderTask=Pr;const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build},(or,ar,lr)=>{var vr,gr,mr,eu,yr;Object.defineProperty(ar,"__esModule",{value:!0}),ar.SerializableEmpty=ar.PrintAnnotationStorage=ar.AnnotationStorage=void 0;var ur=lr(1),cr=lr(4),hr=lr(8);const dr=Object.freeze({map:null,hash:"",transfers:void 0});ar.SerializableEmpty=dr;class fr{constructor(){Ts(this,mr);Ts(this,vr,!1);Ts(this,gr,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(Cr,Sr){const wr=Gr(this,gr).get(Cr);return wr===void 0?Sr:Object.assign(Sr,wr)}getRawValue(Cr){return Gr(this,gr).get(Cr)}remove(Cr){if(Gr(this,gr).delete(Cr),Gr(this,gr).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const Sr of Gr(this,gr).values())if(Sr instanceof cr.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(Cr,Sr){const wr=Gr(this,gr).get(Cr);let Er=!1;if(wr!==void 0)for(const[Ar,Tr]of Object.entries(Sr))wr[Ar]!==Tr&&(Er=!0,wr[Ar]=Tr);else Er=!0,Gr(this,gr).set(Cr,Sr);Er&&ws(this,mr,eu).call(this),Sr instanceof cr.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(Sr.constructor._type)}has(Cr){return Gr(this,gr).has(Cr)}getAll(){return Gr(this,gr).size>0?(0,ur.objectFromMap)(Gr(this,gr)):null}setAll(Cr){for(const[Sr,wr]of Object.entries(Cr))this.setValue(Sr,wr)}get size(){return Gr(this,gr).size}resetModified(){Gr(this,vr)&&(_s(this,vr,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new pr(this)}get serializable(){if(Gr(this,gr).size===0)return dr;const Cr=new Map,Sr=new hr.MurmurHash3_64,wr=[],Er=Object.create(null);let Ar=!1;for(const[Tr,Rr]of Gr(this,gr)){const Pr=Rr instanceof cr.AnnotationEditor?Rr.serialize(!1,Er):Rr;Pr&&(Cr.set(Tr,Pr),Sr.update(`${Tr}:${JSON.stringify(Pr)}`),Ar||(Ar=!!Pr.bitmap))}if(Ar)for(const Tr of Cr.values())Tr.bitmap&&wr.push(Tr.bitmap);return Cr.size>0?{map:Cr,hash:Sr.hexdigest(),transfers:wr}:dr}}vr=new WeakMap,gr=new WeakMap,mr=new WeakSet,eu=function(){Gr(this,vr)||(_s(this,vr,!0),typeof this.onSetModified=="function"&&this.onSetModified())},ar.AnnotationStorage=fr;class pr extends fr{constructor(Sr){super();Ts(this,yr);const{map:wr,hash:Er,transfers:Ar}=Sr.serializable,Tr=structuredClone(wr,Ar?{transfer:Ar}:null);_s(this,yr,{map:Tr,hash:Er,transfers:Ar})}get print(){(0,ur.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return Gr(this,yr)}}yr=new WeakMap,ar.PrintAnnotationStorage=pr},(or,ar,lr)=>{var pr,vr,gr,mr,br,yr,xr,Cr,Sr,wr,Er,Ar,Tr,Rr,Pr,Qo,Zo,Dr,Jo,yl,tu,ru,nu,xl,au;Object.defineProperty(ar,"__esModule",{value:!0}),ar.AnnotationEditor=void 0;var ur=lr(5),cr=lr(1),hr=lr(6);const Fr=class Fr{constructor(Hr){Ts(this,Pr);Ts(this,pr,"");Ts(this,vr,!1);Ts(this,gr,null);Ts(this,mr,null);Ts(this,br,null);Ts(this,yr,!1);Ts(this,xr,null);Ts(this,Cr,this.focusin.bind(this));Ts(this,Sr,this.focusout.bind(this));Ts(this,wr,!1);Ts(this,Er,!1);Ts(this,Ar,!1);Zs(this,"_initialOptions",Object.create(null));Zs(this,"_uiManager",null);Zs(this,"_focusEventsAllowed",!0);Zs(this,"_l10nPromise",null);Ts(this,Tr,!1);Ts(this,Rr,Fr._zIndex++);this.constructor===Fr&&(0,cr.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Hr.parent,this.id=Hr.id,this.width=this.height=null,this.pageIndex=Hr.parent.pageIndex,this.name=Hr.name,this.div=null,this._uiManager=Hr.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Hr.isCentered,this._structTreeParentId=null;const{rotation:Wr,rawDims:{pageWidth:Yr,pageHeight:qr,pageX:Br,pageY:Ur}}=this.parent.viewport;this.rotation=Wr,this.pageRotation=(360+Wr-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[Yr,qr],this.pageTranslation=[Br,Ur];const[Vr,Xr]=this.parentDimensions;this.x=Hr.x/Vr,this.y=Hr.y/Xr,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,cr.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Hr){const Wr=new fr({id:Hr.parent.getNextId(),parent:Hr.parent,uiManager:Hr._uiManager});Wr.annotationElementId=Hr.annotationElementId,Wr.deleted=!0,Wr._uiManager.addToAnnotationStorage(Wr)}static initialize(Hr,Wr=null){if(Fr._l10nPromise||(Fr._l10nPromise=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(qr=>[qr,Hr.get(qr)]))),Wr!=null&&Wr.strings)for(const qr of Wr.strings)Fr._l10nPromise.set(qr,Hr.get(qr));if(Fr._borderLineWidth!==-1)return;const Yr=getComputedStyle(document.documentElement);Fr._borderLineWidth=parseFloat(Yr.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Hr,Wr){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Hr){return!1}static paste(Hr,Wr){(0,cr.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return Gr(this,Tr)}set _isDraggable(Hr){var Wr;_s(this,Tr,Hr),(Wr=this.div)==null||Wr.classList.toggle("draggable",Hr)}center(){const[Hr,Wr]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Wr/(Hr*2),this.y+=this.width*Hr/(Wr*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Wr/(Hr*2),this.y-=this.width*Hr/(Wr*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Hr){this._uiManager.addCommands(Hr)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=Gr(this,Rr)}setParent(Hr){Hr!==null&&(this.pageIndex=Hr.pageIndex,this.pageDimensions=Hr.pageDimensions),this.parent=Hr}focusin(Hr){this._focusEventsAllowed&&(Gr(this,wr)?_s(this,wr,!1):this.parent.setSelected(this))}focusout(Hr){var Yr;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const Wr=Hr.relatedTarget;Wr!=null&&Wr.closest(`#${this.id}`)||(Hr.preventDefault(),(Yr=this.parent)!=null&&Yr.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Hr,Wr,Yr,qr){const[Br,Ur]=this.parentDimensions;[Yr,qr]=this.screenToPageTranslation(Yr,qr),this.x=(Hr+Yr)/Br,this.y=(Wr+qr)/Ur,this.fixAndSetPosition()}translate(Hr,Wr){ws(this,Pr,Qo).call(this,this.parentDimensions,Hr,Wr)}translateInPage(Hr,Wr){ws(this,Pr,Qo).call(this,this.pageDimensions,Hr,Wr),this.div.scrollIntoView({block:"nearest"})}drag(Hr,Wr){const[Yr,qr]=this.parentDimensions;if(this.x+=Hr/Yr,this.y+=Wr/qr,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:Zr,y:Jr}=this.div.getBoundingClientRect();this.parent.findNewParent(this,Zr,Jr)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:Br,y:Ur}=this;const[Vr,Xr]=ws(this,Pr,Zo).call(this);Br+=Vr,Ur+=Xr,this.div.style.left=`${(100*Br).toFixed(2)}%`,this.div.style.top=`${(100*Ur).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}fixAndSetPosition(){const[Hr,Wr]=this.pageDimensions;let{x:Yr,y:qr,width:Br,height:Ur}=this;switch(Br*=Hr,Ur*=Wr,Yr*=Hr,qr*=Wr,this.rotation){case 0:Yr=Math.max(0,Math.min(Hr-Br,Yr)),qr=Math.max(0,Math.min(Wr-Ur,qr));break;case 90:Yr=Math.max(0,Math.min(Hr-Ur,Yr)),qr=Math.min(Wr,Math.max(Br,qr));break;case 180:Yr=Math.min(Hr,Math.max(Br,Yr)),qr=Math.min(Wr,Math.max(Ur,qr));break;case 270:Yr=Math.min(Hr,Math.max(Ur,Yr)),qr=Math.max(0,Math.min(Wr-Br,qr));break}this.x=Yr/=Hr,this.y=qr/=Wr;const[Vr,Xr]=ws(this,Pr,Zo).call(this);Yr+=Vr,qr+=Xr;const{style:Zr}=this.div;Zr.left=`${(100*Yr).toFixed(2)}%`,Zr.top=`${(100*qr).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(Hr,Wr){var Yr;return ws(Yr=Fr,Dr,Jo).call(Yr,Hr,Wr,this.parentRotation)}pageTranslationToScreen(Hr,Wr){var Yr;return ws(Yr=Fr,Dr,Jo).call(Yr,Hr,Wr,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Hr,pageDimensions:[Wr,Yr]}=this,qr=Wr*Hr,Br=Yr*Hr;return cr.FeatureTest.isCSSRoundSupported?[Math.round(qr),Math.round(Br)]:[qr,Br]}setDims(Hr,Wr){var Br;const[Yr,qr]=this.parentDimensions;this.div.style.width=`${(100*Hr/Yr).toFixed(2)}%`,Gr(this,yr)||(this.div.style.height=`${(100*Wr/qr).toFixed(2)}%`),(Br=Gr(this,gr))==null||Br.classList.toggle("small",Hr<Fr.SMALL_EDITOR_SIZE||Wr<Fr.SMALL_EDITOR_SIZE)}fixDims(){const{style:Hr}=this.div,{height:Wr,width:Yr}=Hr,qr=Yr.endsWith("%"),Br=!Gr(this,yr)&&Wr.endsWith("%");if(qr&&Br)return;const[Ur,Vr]=this.parentDimensions;qr||(Hr.width=`${(100*parseFloat(Yr)/Ur).toFixed(2)}%`),!Gr(this,yr)&&!Br&&(Hr.height=`${(100*parseFloat(Wr)/Vr).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}async addAltTextButton(){if(Gr(this,gr))return;const Hr=_s(this,gr,document.createElement("button"));Hr.className="altText";const Wr=await Fr._l10nPromise.get("editor_alt_text_button_label");Hr.textContent=Wr,Hr.setAttribute("aria-label",Wr),Hr.tabIndex="0",Hr.addEventListener("contextmenu",hr.noContextMenu),Hr.addEventListener("pointerdown",Yr=>Yr.stopPropagation()),Hr.addEventListener("click",Yr=>{Yr.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),Hr.addEventListener("keydown",Yr=>{Yr.target===Hr&&Yr.key==="Enter"&&(Yr.preventDefault(),this._uiManager.editAltText(this))}),ws(this,Pr,xl).call(this),this.div.append(Hr),Fr.SMALL_EDITOR_SIZE||(Fr.SMALL_EDITOR_SIZE=Math.min(128,Math.round(Hr.getBoundingClientRect().width*1.4)))}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:Gr(this,pr),decorative:Gr(this,vr)}}set altTextData({altText:Hr,decorative:Wr}){Gr(this,pr)===Hr&&Gr(this,vr)===Wr||(_s(this,pr,Hr),_s(this,vr,Wr),ws(this,Pr,xl).call(this))}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",Gr(this,Cr)),this.div.addEventListener("focusout",Gr(this,Sr));const[Hr,Wr]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Wr/Hr).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Hr/Wr).toFixed(2)}%`);const[Yr,qr]=this.getInitialTranslation();return this.translate(Yr,qr),(0,ur.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Hr){const{isMac:Wr}=cr.FeatureTest.platform;if(Hr.button!==0||Hr.ctrlKey&&Wr){Hr.preventDefault();return}_s(this,wr,!0),ws(this,Pr,au).call(this,Hr)}moveInDOM(){var Hr;(Hr=this.parent)==null||Hr.moveEditorInDOM(this)}_setParentAndPosition(Hr,Wr,Yr){Hr.changeParent(this),this.x=Wr,this.y=Yr,this.fixAndSetPosition()}getRect(Hr,Wr){const Yr=this.parentScale,[qr,Br]=this.pageDimensions,[Ur,Vr]=this.pageTranslation,Xr=Hr/Yr,Zr=Wr/Yr,Jr=this.x*qr,Qr=this.y*Br,ga=this.width*qr,ba=this.height*Br;switch(this.rotation){case 0:return[Jr+Xr+Ur,Br-Qr-Zr-ba+Vr,Jr+Xr+ga+Ur,Br-Qr-Zr+Vr];case 90:return[Jr+Zr+Ur,Br-Qr+Xr+Vr,Jr+Zr+ba+Ur,Br-Qr+Xr+ga+Vr];case 180:return[Jr-Xr-ga+Ur,Br-Qr+Zr+Vr,Jr-Xr+Ur,Br-Qr+Zr+ba+Vr];case 270:return[Jr-Zr-ba+Ur,Br-Qr-Xr-ga+Vr,Jr-Zr+Ur,Br-Qr-Xr+Vr];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Hr,Wr){const[Yr,qr,Br,Ur]=Hr,Vr=Br-Yr,Xr=Ur-qr;switch(this.rotation){case 0:return[Yr,Wr-Ur,Vr,Xr];case 90:return[Yr,Wr-qr,Xr,Vr];case 180:return[Br,Wr-qr,Vr,Xr];case 270:return[Br,Wr-Ur,Xr,Vr];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){_s(this,Ar,!0)}disableEditMode(){_s(this,Ar,!1)}isInEditMode(){return Gr(this,Ar)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var Hr,Wr;(Hr=this.div)==null||Hr.addEventListener("focusin",Gr(this,Cr)),(Wr=this.div)==null||Wr.addEventListener("focusout",Gr(this,Sr))}serialize(Hr=!1,Wr=null){(0,cr.unreachable)("An editor must be serializable")}static deserialize(Hr,Wr,Yr){const qr=new this.prototype.constructor({parent:Wr,id:Wr.getNextId(),uiManager:Yr});qr.rotation=Hr.rotation;const[Br,Ur]=qr.pageDimensions,[Vr,Xr,Zr,Jr]=qr.getRectInCurrentCoords(Hr.rect,Ur);return qr.x=Vr/Br,qr.y=Xr/Ur,qr.width=Zr/Br,qr.height=Jr/Ur,qr}remove(){var Hr;this.div.removeEventListener("focusin",Gr(this,Cr)),this.div.removeEventListener("focusout",Gr(this,Sr)),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),(Hr=Gr(this,gr))==null||Hr.remove(),_s(this,gr,null),_s(this,mr,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(ws(this,Pr,tu).call(this),Gr(this,xr).classList.remove("hidden"))}select(){var Hr;this.makeResizable(),(Hr=this.div)==null||Hr.classList.add("selectedEditor")}unselect(){var Hr,Wr,Yr;(Hr=Gr(this,xr))==null||Hr.classList.add("hidden"),(Wr=this.div)==null||Wr.classList.remove("selectedEditor"),(Yr=this.div)!=null&&Yr.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(Hr,Wr){}disableEditing(){Gr(this,gr)&&(Gr(this,gr).hidden=!0)}enableEditing(){Gr(this,gr)&&(Gr(this,gr).hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return Gr(this,Er)}set isEditing(Hr){_s(this,Er,Hr),this.parent&&(Hr?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Hr,Wr){_s(this,yr,!0);const Yr=Hr/Wr,{style:qr}=this.div;qr.aspectRatio=Yr,qr.height="auto"}static get MIN_SIZE(){return 16}};pr=new WeakMap,vr=new WeakMap,gr=new WeakMap,mr=new WeakMap,br=new WeakMap,yr=new WeakMap,xr=new WeakMap,Cr=new WeakMap,Sr=new WeakMap,wr=new WeakMap,Er=new WeakMap,Ar=new WeakMap,Tr=new WeakMap,Rr=new WeakMap,Pr=new WeakSet,Qo=function([Hr,Wr],Yr,qr){[Yr,qr]=this.screenToPageTranslation(Yr,qr),this.x+=Yr/Hr,this.y+=qr/Wr,this.fixAndSetPosition()},Zo=function(){const[Hr,Wr]=this.parentDimensions,{_borderLineWidth:Yr}=Fr,qr=Yr/Hr,Br=Yr/Wr;switch(this.rotation){case 90:return[-qr,Br];case 180:return[qr,Br];case 270:return[qr,-Br];default:return[-qr,-Br]}},Dr=new WeakSet,Jo=function(Hr,Wr,Yr){switch(Yr){case 90:return[Wr,-Hr];case 180:return[-Hr,-Wr];case 270:return[-Wr,Hr];default:return[Hr,Wr]}},yl=function(Hr){switch(Hr){case 90:{const[Wr,Yr]=this.pageDimensions;return[0,-Wr/Yr,Yr/Wr,0]}case 180:return[-1,0,0,-1];case 270:{const[Wr,Yr]=this.pageDimensions;return[0,Wr/Yr,-Yr/Wr,0]}default:return[1,0,0,1]}},tu=function(){if(Gr(this,xr))return;_s(this,xr,document.createElement("div")),Gr(this,xr).classList.add("resizers");const Hr=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||Hr.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Wr of Hr){const Yr=document.createElement("div");Gr(this,xr).append(Yr),Yr.classList.add("resizer",Wr),Yr.addEventListener("pointerdown",ws(this,Pr,ru).bind(this,Wr)),Yr.addEventListener("contextmenu",hr.noContextMenu)}this.div.prepend(Gr(this,xr))},ru=function(Hr,Wr){Wr.preventDefault();const{isMac:Yr}=cr.FeatureTest.platform;if(Wr.button!==0||Wr.ctrlKey&&Yr)return;const qr=ws(this,Pr,nu).bind(this,Hr),Br=this._isDraggable;this._isDraggable=!1;const Ur={passive:!0,capture:!0};window.addEventListener("pointermove",qr,Ur);const Vr=this.x,Xr=this.y,Zr=this.width,Jr=this.height,Qr=this.parent.div.style.cursor,ga=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Wr.target).cursor;const ba=()=>{this._isDraggable=Br,window.removeEventListener("pointerup",ba),window.removeEventListener("blur",ba),window.removeEventListener("pointermove",qr,Ur),this.parent.div.style.cursor=Qr,this.div.style.cursor=ga;const _i=this.x,os=this.y,ls=this.width,ys=this.height;_i===Vr&&os===Xr&&ls===Zr&&ys===Jr||this.addCommands({cmd:()=>{this.width=ls,this.height=ys,this.x=_i,this.y=os;const[ns,as]=this.parentDimensions;this.setDims(ns*ls,as*ys),this.fixAndSetPosition()},undo:()=>{this.width=Zr,this.height=Jr,this.x=Vr,this.y=Xr;const[ns,as]=this.parentDimensions;this.setDims(ns*Zr,as*Jr),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ba),window.addEventListener("blur",ba)},nu=function(Hr,Wr){const[Yr,qr]=this.parentDimensions,Br=this.x,Ur=this.y,Vr=this.width,Xr=this.height,Zr=Fr.MIN_SIZE/Yr,Jr=Fr.MIN_SIZE/qr,Qr=Ns=>Math.round(Ns*1e4)/1e4,ga=ws(this,Pr,yl).call(this,this.rotation),ba=(Ns,us)=>[ga[0]*Ns+ga[2]*us,ga[1]*Ns+ga[3]*us],_i=ws(this,Pr,yl).call(this,360-this.rotation),os=(Ns,us)=>[_i[0]*Ns+_i[2]*us,_i[1]*Ns+_i[3]*us];let ls,ys,ns=!1,as=!1;switch(Hr){case"topLeft":ns=!0,ls=(Ns,us)=>[0,0],ys=(Ns,us)=>[Ns,us];break;case"topMiddle":ls=(Ns,us)=>[Ns/2,0],ys=(Ns,us)=>[Ns/2,us];break;case"topRight":ns=!0,ls=(Ns,us)=>[Ns,0],ys=(Ns,us)=>[0,us];break;case"middleRight":as=!0,ls=(Ns,us)=>[Ns,us/2],ys=(Ns,us)=>[0,us/2];break;case"bottomRight":ns=!0,ls=(Ns,us)=>[Ns,us],ys=(Ns,us)=>[0,0];break;case"bottomMiddle":ls=(Ns,us)=>[Ns/2,us],ys=(Ns,us)=>[Ns/2,0];break;case"bottomLeft":ns=!0,ls=(Ns,us)=>[0,us],ys=(Ns,us)=>[Ns,0];break;case"middleLeft":as=!0,ls=(Ns,us)=>[0,us/2],ys=(Ns,us)=>[Ns,us/2];break}const Kr=ls(Vr,Xr),$a=ys(Vr,Xr);let ss=ba(...$a);const hs=Qr(Br+ss[0]),vs=Qr(Ur+ss[1]);let bs=1,xs=1,[fs,Is]=this.screenToPageTranslation(Wr.movementX,Wr.movementY);if([fs,Is]=os(fs/Yr,Is/qr),ns){const Ns=Math.hypot(Vr,Xr);bs=xs=Math.max(Math.min(Math.hypot($a[0]-Kr[0]-fs,$a[1]-Kr[1]-Is)/Ns,1/Vr,1/Xr),Zr/Vr,Jr/Xr)}else as?bs=Math.max(Zr,Math.min(1,Math.abs($a[0]-Kr[0]-fs)))/Vr:xs=Math.max(Jr,Math.min(1,Math.abs($a[1]-Kr[1]-Is)))/Xr;const Os=Qr(Vr*bs),Us=Qr(Xr*xs);ss=ba(...ys(Os,Us));const $s=hs-ss[0],Bs=vs-ss[1];this.width=Os,this.height=Us,this.x=$s,this.y=Bs,this.setDims(Yr*Os,qr*Us),this.fixAndSetPosition()},xl=async function(){var Yr;const Hr=Gr(this,gr);if(!Hr)return;if(!Gr(this,pr)&&!Gr(this,vr)){Hr.classList.remove("done"),(Yr=Gr(this,mr))==null||Yr.remove();return}Fr._l10nPromise.get("editor_alt_text_edit_button_label").then(qr=>{Hr.setAttribute("aria-label",qr)});let Wr=Gr(this,mr);if(!Wr){_s(this,mr,Wr=document.createElement("span")),Wr.className="tooltip",Wr.setAttribute("role","tooltip");const qr=Wr.id=`alt-text-tooltip-${this.id}`;Hr.setAttribute("aria-describedby",qr);const Br=100;Hr.addEventListener("mouseenter",()=>{_s(this,br,setTimeout(()=>{_s(this,br,null),Gr(this,mr).classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},Br))}),Hr.addEventListener("mouseleave",()=>{var Ur;clearTimeout(Gr(this,br)),_s(this,br,null),(Ur=Gr(this,mr))==null||Ur.classList.remove("show")})}Hr.classList.add("done"),Wr.innerText=Gr(this,vr)?await Fr._l10nPromise.get("editor_alt_text_decorative_tooltip"):Gr(this,pr),Wr.parentNode||Hr.append(Wr)},au=function(Hr){if(!this._isDraggable)return;const Wr=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let Yr,qr;Wr&&(Yr={passive:!0,capture:!0},qr=Ur=>{const[Vr,Xr]=this.screenToPageTranslation(Ur.movementX,Ur.movementY);this._uiManager.dragSelectedEditors(Vr,Xr)},window.addEventListener("pointermove",qr,Yr));const Br=()=>{if(window.removeEventListener("pointerup",Br),window.removeEventListener("blur",Br),Wr&&window.removeEventListener("pointermove",qr,Yr),_s(this,wr,!1),!this._uiManager.endDragSession()){const{isMac:Ur}=cr.FeatureTest.platform;Hr.ctrlKey&&!Ur||Hr.shiftKey||Hr.metaKey&&Ur?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",Br),window.addEventListener("blur",Br)},Ts(Fr,Dr),Zs(Fr,"_borderLineWidth",-1),Zs(Fr,"_colorManager",new ur.ColorManager),Zs(Fr,"_zIndex",1),Zs(Fr,"SMALL_EDITOR_SIZE",0);let dr=Fr;ar.AnnotationEditor=dr;class fr extends dr{constructor(Hr){super(Hr),this.annotationElementId=Hr.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}},(or,ar,lr)=>{var yr,xr,Cr,Sr,wr,wl,Tr,Rr,Pr,_r,kr,iu,Lr,Or,Ir,Mr,$r,jr,Fr,zr,Hr,Wr,Yr,qr,Br,Ur,Vr,Xr,Zr,Jr,Qr,ga,ba,_i,os,ls,ys,ns,as,Kr,$a,ss,hs,vs,bs,xs,fs,su,El,Cl,Io,Sl,Al,oo,Ao,ou,lu,Tl,To,_l;Object.defineProperty(ar,"__esModule",{value:!0}),ar.KeyboardManager=ar.CommandManager=ar.ColorManager=ar.AnnotationEditorUIManager=void 0,ar.bindEvents=hr,ar.opacityToHex=dr;var ur=lr(1),cr=lr(6);function hr(Rs,xa,ps){for(const Ps of ps)xa.addEventListener(Ps,Rs[Ps].bind(Rs))}function dr(Rs){return Math.round(Math.min(255,Math.max(1,255*Rs))).toString(16).padStart(2,"0")}class fr{constructor(){Ts(this,yr,0)}getId(){return`${ur.AnnotationEditorPrefix}${So(this,yr)._++}`}}yr=new WeakMap;const Ar=class Ar{constructor(){Ts(this,wr);Ts(this,xr,(0,ur.getUuid)());Ts(this,Cr,0);Ts(this,Sr,null)}static get _isSVGFittingCanvas(){const xa='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',Ps=new OffscreenCanvas(1,3).getContext("2d"),Ms=new Image;Ms.src=xa;const Ls=Ms.decode().then(()=>(Ps.drawImage(Ms,0,0,1,1,0,0,1,3),new Uint32Array(Ps.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,ur.shadow)(this,"_isSVGFittingCanvas",Ls)}async getFromFile(xa){const{lastModified:ps,name:Ps,size:Ms,type:Ls}=xa;return ws(this,wr,wl).call(this,`${ps}_${Ps}_${Ms}_${Ls}`,xa)}async getFromUrl(xa){return ws(this,wr,wl).call(this,xa,xa)}async getFromId(xa){Gr(this,Sr)||_s(this,Sr,new Map);const ps=Gr(this,Sr).get(xa);return ps?ps.bitmap?(ps.refCounter+=1,ps):ps.file?this.getFromFile(ps.file):this.getFromUrl(ps.url):null}getSvgUrl(xa){const ps=Gr(this,Sr).get(xa);return ps!=null&&ps.isSvg?ps.svgUrl:null}deleteId(xa){Gr(this,Sr)||_s(this,Sr,new Map);const ps=Gr(this,Sr).get(xa);ps&&(ps.refCounter-=1,ps.refCounter===0&&(ps.bitmap=null))}isValidId(xa){return xa.startsWith(`image_${Gr(this,xr)}_`)}};xr=new WeakMap,Cr=new WeakMap,Sr=new WeakMap,wr=new WeakSet,wl=async function(xa,ps){Gr(this,Sr)||_s(this,Sr,new Map);let Ps=Gr(this,Sr).get(xa);if(Ps===null)return null;if(Ps!=null&&Ps.bitmap)return Ps.refCounter+=1,Ps;try{Ps||(Ps={bitmap:null,id:`image_${Gr(this,xr)}_${So(this,Cr)._++}`,refCounter:0,isSvg:!1});let Ms;if(typeof ps=="string"){Ps.url=ps;const Ls=await fetch(ps);if(!Ls.ok)throw new Error(Ls.statusText);Ms=await Ls.blob()}else Ms=Ps.file=ps;if(Ms.type==="image/svg+xml"){const Ls=Ar._isSVGFittingCanvas,Ds=new FileReader,es=new Image,ts=new Promise((cs,gs)=>{es.onload=()=>{Ps.bitmap=es,Ps.isSvg=!0,cs()},Ds.onload=async()=>{const Ss=Ps.svgUrl=Ds.result;es.src=await Ls?`${Ss}#svgView(preserveAspectRatio(none))`:Ss},es.onerror=Ds.onerror=gs});Ds.readAsDataURL(Ms),await ts}else Ps.bitmap=await createImageBitmap(Ms);Ps.refCounter=1}catch(Ms){console.error(Ms),Ps=null}return Gr(this,Sr).set(xa,Ps),Ps&&Gr(this,Sr).set(Ps.id,Ps),Ps};let pr=Ar;class vr{constructor(xa=128){Ts(this,Tr,[]);Ts(this,Rr,!1);Ts(this,Pr);Ts(this,_r,-1);_s(this,Pr,xa)}add({cmd:xa,undo:ps,mustExec:Ps,type:Ms=NaN,overwriteIfSameType:Ls=!1,keepUndo:Ds=!1}){if(Ps&&xa(),Gr(this,Rr))return;const es={cmd:xa,undo:ps,type:Ms};if(Gr(this,_r)===-1){Gr(this,Tr).length>0&&(Gr(this,Tr).length=0),_s(this,_r,0),Gr(this,Tr).push(es);return}if(Ls&&Gr(this,Tr)[Gr(this,_r)].type===Ms){Ds&&(es.undo=Gr(this,Tr)[Gr(this,_r)].undo),Gr(this,Tr)[Gr(this,_r)]=es;return}const ts=Gr(this,_r)+1;ts===Gr(this,Pr)?Gr(this,Tr).splice(0,1):(_s(this,_r,ts),ts<Gr(this,Tr).length&&Gr(this,Tr).splice(ts)),Gr(this,Tr).push(es)}undo(){Gr(this,_r)!==-1&&(_s(this,Rr,!0),Gr(this,Tr)[Gr(this,_r)].undo(),_s(this,Rr,!1),_s(this,_r,Gr(this,_r)-1))}redo(){Gr(this,_r)<Gr(this,Tr).length-1&&(_s(this,_r,Gr(this,_r)+1),_s(this,Rr,!0),Gr(this,Tr)[Gr(this,_r)].cmd(),_s(this,Rr,!1))}hasSomethingToUndo(){return Gr(this,_r)!==-1}hasSomethingToRedo(){return Gr(this,_r)<Gr(this,Tr).length-1}destroy(){_s(this,Tr,null)}}Tr=new WeakMap,Rr=new WeakMap,Pr=new WeakMap,_r=new WeakMap,ar.CommandManager=vr;class gr{constructor(xa){Ts(this,kr);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:ps}=ur.FeatureTest.platform;for(const[Ps,Ms,Ls={}]of xa)for(const Ds of Ps){const es=Ds.startsWith("mac+");ps&&es?(this.callbacks.set(Ds.slice(4),{callback:Ms,options:Ls}),this.allKeys.add(Ds.split("+").at(-1))):!ps&&!es&&(this.callbacks.set(Ds,{callback:Ms,options:Ls}),this.allKeys.add(Ds.split("+").at(-1)))}}exec(xa,ps){if(!this.allKeys.has(ps.key))return;const Ps=this.callbacks.get(ws(this,kr,iu).call(this,ps));if(!Ps)return;const{callback:Ms,options:{bubbles:Ls=!1,args:Ds=[],checker:es=null}}=Ps;es&&!es(xa,ps)||(Ms.bind(xa,...Ds)(),Ls||(ps.stopPropagation(),ps.preventDefault()))}}kr=new WeakSet,iu=function(xa){xa.altKey&&this.buffer.push("alt"),xa.ctrlKey&&this.buffer.push("ctrl"),xa.metaKey&&this.buffer.push("meta"),xa.shiftKey&&this.buffer.push("shift"),this.buffer.push(xa.key);const ps=this.buffer.join("+");return this.buffer.length=0,ps},ar.KeyboardManager=gr;const Nr=class Nr{get _colors(){const xa=new Map([["CanvasText",null],["Canvas",null]]);return(0,cr.getColorValues)(xa),(0,ur.shadow)(this,"_colors",xa)}convert(xa){const ps=(0,cr.getRGB)(xa);if(!window.matchMedia("(forced-colors: active)").matches)return ps;for(const[Ps,Ms]of this._colors)if(Ms.every((Ls,Ds)=>Ls===ps[Ds]))return Nr._colorsMapping.get(Ps);return ps}getHexCode(xa){const ps=this._colors.get(xa);return ps?ur.Util.makeHexColor(...ps):xa}};Zs(Nr,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let mr=Nr;ar.ColorManager=mr;const Es=class Es{constructor(xa,ps,Ps,Ms,Ls,Ds){Ts(this,fs);Ts(this,Lr,null);Ts(this,Or,new Map);Ts(this,Ir,new Map);Ts(this,Mr,null);Ts(this,$r,null);Ts(this,jr,new vr);Ts(this,Fr,0);Ts(this,zr,new Set);Ts(this,Hr,null);Ts(this,Wr,null);Ts(this,Yr,new Set);Ts(this,qr,null);Ts(this,Br,new fr);Ts(this,Ur,!1);Ts(this,Vr,!1);Ts(this,Xr,null);Ts(this,Zr,ur.AnnotationEditorType.NONE);Ts(this,Jr,new Set);Ts(this,Qr,null);Ts(this,ga,this.blur.bind(this));Ts(this,ba,this.focus.bind(this));Ts(this,_i,this.copy.bind(this));Ts(this,os,this.cut.bind(this));Ts(this,ls,this.paste.bind(this));Ts(this,ys,this.keydown.bind(this));Ts(this,ns,this.onEditingAction.bind(this));Ts(this,as,this.onPageChanging.bind(this));Ts(this,Kr,this.onScaleChanging.bind(this));Ts(this,$a,this.onRotationChanging.bind(this));Ts(this,ss,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});Ts(this,hs,[0,0]);Ts(this,vs,null);Ts(this,bs,null);Ts(this,xs,null);_s(this,bs,xa),_s(this,xs,ps),_s(this,Mr,Ps),this._eventBus=Ms,this._eventBus._on("editingaction",Gr(this,ns)),this._eventBus._on("pagechanging",Gr(this,as)),this._eventBus._on("scalechanging",Gr(this,Kr)),this._eventBus._on("rotationchanging",Gr(this,$a)),_s(this,$r,Ls.annotationStorage),_s(this,qr,Ls.filterFactory),_s(this,Qr,Ds),this.viewParameters={realScale:cr.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}static get _keyboardManager(){const xa=Es.prototype,ps=Ls=>{const{activeElement:Ds}=document;return Ds&&Gr(Ls,bs).contains(Ds)&&Ls.hasSomethingToControl()},Ps=this.TRANSLATE_SMALL,Ms=this.TRANSLATE_BIG;return(0,ur.shadow)(this,"_keyboardManager",new gr([[["ctrl+a","mac+meta+a"],xa.selectAll],[["ctrl+z","mac+meta+z"],xa.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],xa.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],xa.delete],[["Escape","mac+Escape"],xa.unselectAll],[["ArrowLeft","mac+ArrowLeft"],xa.translateSelectedEditors,{args:[-Ps,0],checker:ps}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],xa.translateSelectedEditors,{args:[-Ms,0],checker:ps}],[["ArrowRight","mac+ArrowRight"],xa.translateSelectedEditors,{args:[Ps,0],checker:ps}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],xa.translateSelectedEditors,{args:[Ms,0],checker:ps}],[["ArrowUp","mac+ArrowUp"],xa.translateSelectedEditors,{args:[0,-Ps],checker:ps}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],xa.translateSelectedEditors,{args:[0,-Ms],checker:ps}],[["ArrowDown","mac+ArrowDown"],xa.translateSelectedEditors,{args:[0,Ps],checker:ps}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],xa.translateSelectedEditors,{args:[0,Ms],checker:ps}]]))}destroy(){ws(this,fs,Io).call(this),ws(this,fs,El).call(this),this._eventBus._off("editingaction",Gr(this,ns)),this._eventBus._off("pagechanging",Gr(this,as)),this._eventBus._off("scalechanging",Gr(this,Kr)),this._eventBus._off("rotationchanging",Gr(this,$a));for(const xa of Gr(this,Ir).values())xa.destroy();Gr(this,Ir).clear(),Gr(this,Or).clear(),Gr(this,Yr).clear(),_s(this,Lr,null),Gr(this,Jr).clear(),Gr(this,jr).destroy(),Gr(this,Mr).destroy()}get hcmFilter(){return(0,ur.shadow)(this,"hcmFilter",Gr(this,Qr)?Gr(this,qr).addHCMFilter(Gr(this,Qr).foreground,Gr(this,Qr).background):"none")}get direction(){return(0,ur.shadow)(this,"direction",getComputedStyle(Gr(this,bs)).direction)}editAltText(xa){var ps;(ps=Gr(this,Mr))==null||ps.editAltText(this,xa)}onPageChanging({pageNumber:xa}){_s(this,Fr,xa-1)}focusMainContainer(){Gr(this,bs).focus()}findParent(xa,ps){for(const Ps of Gr(this,Ir).values()){const{x:Ms,y:Ls,width:Ds,height:es}=Ps.div.getBoundingClientRect();if(xa>=Ms&&xa<=Ms+Ds&&ps>=Ls&&ps<=Ls+es)return Ps}return null}disableUserSelect(xa=!1){Gr(this,xs).classList.toggle("noUserSelect",xa)}addShouldRescale(xa){Gr(this,Yr).add(xa)}removeShouldRescale(xa){Gr(this,Yr).delete(xa)}onScaleChanging({scale:xa}){this.commitOrRemove(),this.viewParameters.realScale=xa*cr.PixelsPerInch.PDF_TO_CSS_UNITS;for(const ps of Gr(this,Yr))ps.onScaleChanging()}onRotationChanging({pagesRotation:xa}){this.commitOrRemove(),this.viewParameters.rotation=xa}addToAnnotationStorage(xa){!xa.isEmpty()&&Gr(this,$r)&&!Gr(this,$r).has(xa.id)&&Gr(this,$r).setValue(xa.id,xa)}blur(){if(!this.hasSelection)return;const{activeElement:xa}=document;for(const ps of Gr(this,Jr))if(ps.div.contains(xa)){_s(this,Xr,[ps,xa]),ps._focusEventsAllowed=!1;break}}focus(){if(!Gr(this,Xr))return;const[xa,ps]=Gr(this,Xr);_s(this,Xr,null),ps.addEventListener("focusin",()=>{xa._focusEventsAllowed=!0},{once:!0}),ps.focus()}addEditListeners(){ws(this,fs,Cl).call(this),ws(this,fs,Sl).call(this)}removeEditListeners(){ws(this,fs,Io).call(this),ws(this,fs,Al).call(this)}copy(xa){var Ps;if(xa.preventDefault(),(Ps=Gr(this,Lr))==null||Ps.commitOrRemove(),!this.hasSelection)return;const ps=[];for(const Ms of Gr(this,Jr)){const Ls=Ms.serialize(!0);Ls&&ps.push(Ls)}ps.length!==0&&xa.clipboardData.setData("application/pdfjs",JSON.stringify(ps))}cut(xa){this.copy(xa),this.delete()}paste(xa){xa.preventDefault();const{clipboardData:ps}=xa;for(const Ls of ps.items)for(const Ds of Gr(this,Wr))if(Ds.isHandlingMimeForPasting(Ls.type)){Ds.paste(Ls,this.currentLayer);return}let Ps=ps.getData("application/pdfjs");if(!Ps)return;try{Ps=JSON.parse(Ps)}catch(Ls){(0,ur.warn)(`paste: "${Ls.message}".`);return}if(!Array.isArray(Ps))return;this.unselectAll();const Ms=this.currentLayer;try{const Ls=[];for(const ts of Ps){const cs=Ms.deserialize(ts);if(!cs)return;Ls.push(cs)}const Ds=()=>{for(const ts of Ls)ws(this,fs,Tl).call(this,ts);ws(this,fs,_l).call(this,Ls)},es=()=>{for(const ts of Ls)ts.remove()};this.addCommands({cmd:Ds,undo:es,mustExec:!0})}catch(Ls){(0,ur.warn)(`paste: "${Ls.message}".`)}}keydown(xa){var ps;(ps=this.getActive())!=null&&ps.shouldGetKeyboardEvents()||Es._keyboardManager.exec(this,xa)}onEditingAction(xa){["undo","redo","delete","selectAll"].includes(xa.name)&&this[xa.name]()}setEditingState(xa){xa?(ws(this,fs,su).call(this),ws(this,fs,Cl).call(this),ws(this,fs,Sl).call(this),ws(this,fs,oo).call(this,{isEditing:Gr(this,Zr)!==ur.AnnotationEditorType.NONE,isEmpty:ws(this,fs,To).call(this),hasSomethingToUndo:Gr(this,jr).hasSomethingToUndo(),hasSomethingToRedo:Gr(this,jr).hasSomethingToRedo(),hasSelectedEditor:!1})):(ws(this,fs,El).call(this),ws(this,fs,Io).call(this),ws(this,fs,Al).call(this),ws(this,fs,oo).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(xa){if(!Gr(this,Wr)){_s(this,Wr,xa);for(const ps of Gr(this,Wr))ws(this,fs,Ao).call(this,ps.defaultPropertiesToUpdate)}}getId(){return Gr(this,Br).getId()}get currentLayer(){return Gr(this,Ir).get(Gr(this,Fr))}getLayer(xa){return Gr(this,Ir).get(xa)}get currentPageIndex(){return Gr(this,Fr)}addLayer(xa){Gr(this,Ir).set(xa.pageIndex,xa),Gr(this,Ur)?xa.enable():xa.disable()}removeLayer(xa){Gr(this,Ir).delete(xa.pageIndex)}updateMode(xa,ps=null){if(Gr(this,Zr)!==xa){if(_s(this,Zr,xa),xa===ur.AnnotationEditorType.NONE){this.setEditingState(!1),ws(this,fs,lu).call(this);return}this.setEditingState(!0),ws(this,fs,ou).call(this),this.unselectAll();for(const Ps of Gr(this,Ir).values())Ps.updateMode(xa);if(ps){for(const Ps of Gr(this,Or).values())if(Ps.annotationElementId===ps){this.setSelected(Ps),Ps.enterInEditMode();break}}}}updateToolbar(xa){xa!==Gr(this,Zr)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:xa})}updateParams(xa,ps){if(Gr(this,Wr)){if(xa===ur.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(xa);return}for(const Ps of Gr(this,Jr))Ps.updateParams(xa,ps);for(const Ps of Gr(this,Wr))Ps.updateDefaultParams(xa,ps)}}enableWaiting(xa=!1){if(Gr(this,Vr)!==xa){_s(this,Vr,xa);for(const ps of Gr(this,Ir).values())xa?ps.disableClick():ps.enableClick(),ps.div.classList.toggle("waiting",xa)}}getEditors(xa){const ps=[];for(const Ps of Gr(this,Or).values())Ps.pageIndex===xa&&ps.push(Ps);return ps}getEditor(xa){return Gr(this,Or).get(xa)}addEditor(xa){Gr(this,Or).set(xa.id,xa)}removeEditor(xa){var ps;Gr(this,Or).delete(xa.id),this.unselect(xa),(!xa.annotationElementId||!Gr(this,zr).has(xa.annotationElementId))&&((ps=Gr(this,$r))==null||ps.remove(xa.id))}addDeletedAnnotationElement(xa){Gr(this,zr).add(xa.annotationElementId),xa.deleted=!0}isDeletedAnnotationElement(xa){return Gr(this,zr).has(xa)}removeDeletedAnnotationElement(xa){Gr(this,zr).delete(xa.annotationElementId),xa.deleted=!1}setActiveEditor(xa){Gr(this,Lr)!==xa&&(_s(this,Lr,xa),xa&&ws(this,fs,Ao).call(this,xa.propertiesToUpdate))}toggleSelected(xa){if(Gr(this,Jr).has(xa)){Gr(this,Jr).delete(xa),xa.unselect(),ws(this,fs,oo).call(this,{hasSelectedEditor:this.hasSelection});return}Gr(this,Jr).add(xa),xa.select(),ws(this,fs,Ao).call(this,xa.propertiesToUpdate),ws(this,fs,oo).call(this,{hasSelectedEditor:!0})}setSelected(xa){for(const ps of Gr(this,Jr))ps!==xa&&ps.unselect();Gr(this,Jr).clear(),Gr(this,Jr).add(xa),xa.select(),ws(this,fs,Ao).call(this,xa.propertiesToUpdate),ws(this,fs,oo).call(this,{hasSelectedEditor:!0})}isSelected(xa){return Gr(this,Jr).has(xa)}unselect(xa){xa.unselect(),Gr(this,Jr).delete(xa),ws(this,fs,oo).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return Gr(this,Jr).size!==0}undo(){Gr(this,jr).undo(),ws(this,fs,oo).call(this,{hasSomethingToUndo:Gr(this,jr).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:ws(this,fs,To).call(this)})}redo(){Gr(this,jr).redo(),ws(this,fs,oo).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:Gr(this,jr).hasSomethingToRedo(),isEmpty:ws(this,fs,To).call(this)})}addCommands(xa){Gr(this,jr).add(xa),ws(this,fs,oo).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:ws(this,fs,To).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const xa=[...Gr(this,Jr)],ps=()=>{for(const Ms of xa)Ms.remove()},Ps=()=>{for(const Ms of xa)ws(this,fs,Tl).call(this,Ms)};this.addCommands({cmd:ps,undo:Ps,mustExec:!0})}commitOrRemove(){var xa;(xa=Gr(this,Lr))==null||xa.commitOrRemove()}hasSomethingToControl(){return Gr(this,Lr)||this.hasSelection}selectAll(){for(const xa of Gr(this,Jr))xa.commit();ws(this,fs,_l).call(this,Gr(this,Or).values())}unselectAll(){if(Gr(this,Lr)){Gr(this,Lr).commitOrRemove();return}if(this.hasSelection){for(const xa of Gr(this,Jr))xa.unselect();Gr(this,Jr).clear(),ws(this,fs,oo).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(xa,ps,Ps=!1){if(Ps||this.commitOrRemove(),!this.hasSelection)return;Gr(this,hs)[0]+=xa,Gr(this,hs)[1]+=ps;const[Ms,Ls]=Gr(this,hs),Ds=[...Gr(this,Jr)],es=1e3;Gr(this,vs)&&clearTimeout(Gr(this,vs)),_s(this,vs,setTimeout(()=>{_s(this,vs,null),Gr(this,hs)[0]=Gr(this,hs)[1]=0,this.addCommands({cmd:()=>{for(const ts of Ds)Gr(this,Or).has(ts.id)&&ts.translateInPage(Ms,Ls)},undo:()=>{for(const ts of Ds)Gr(this,Or).has(ts.id)&&ts.translateInPage(-Ms,-Ls)},mustExec:!1})},es));for(const ts of Ds)ts.translateInPage(xa,ps)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_s(this,Hr,new Map);for(const xa of Gr(this,Jr))Gr(this,Hr).set(xa,{savedX:xa.x,savedY:xa.y,savedPageIndex:xa.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!Gr(this,Hr))return!1;this.disableUserSelect(!1);const xa=Gr(this,Hr);_s(this,Hr,null);let ps=!1;for(const[{x:Ms,y:Ls,pageIndex:Ds},es]of xa)es.newX=Ms,es.newY=Ls,es.newPageIndex=Ds,ps||(ps=Ms!==es.savedX||Ls!==es.savedY||Ds!==es.savedPageIndex);if(!ps)return!1;const Ps=(Ms,Ls,Ds,es)=>{if(Gr(this,Or).has(Ms.id)){const ts=Gr(this,Ir).get(es);ts?Ms._setParentAndPosition(ts,Ls,Ds):(Ms.pageIndex=es,Ms.x=Ls,Ms.y=Ds)}};return this.addCommands({cmd:()=>{for(const[Ms,{newX:Ls,newY:Ds,newPageIndex:es}]of xa)Ps(Ms,Ls,Ds,es)},undo:()=>{for(const[Ms,{savedX:Ls,savedY:Ds,savedPageIndex:es}]of xa)Ps(Ms,Ls,Ds,es)},mustExec:!0}),!0}dragSelectedEditors(xa,ps){if(Gr(this,Hr))for(const Ps of Gr(this,Hr).keys())Ps.drag(xa,ps)}rebuild(xa){if(xa.parent===null){const ps=this.getLayer(xa.pageIndex);ps?(ps.changeParent(xa),ps.addOrRebuild(xa)):(this.addEditor(xa),this.addToAnnotationStorage(xa),xa.rebuild())}else xa.parent.addOrRebuild(xa)}isActive(xa){return Gr(this,Lr)===xa}getActive(){return Gr(this,Lr)}getMode(){return Gr(this,Zr)}get imageManager(){return(0,ur.shadow)(this,"imageManager",new pr)}};Lr=new WeakMap,Or=new WeakMap,Ir=new WeakMap,Mr=new WeakMap,$r=new WeakMap,jr=new WeakMap,Fr=new WeakMap,zr=new WeakMap,Hr=new WeakMap,Wr=new WeakMap,Yr=new WeakMap,qr=new WeakMap,Br=new WeakMap,Ur=new WeakMap,Vr=new WeakMap,Xr=new WeakMap,Zr=new WeakMap,Jr=new WeakMap,Qr=new WeakMap,ga=new WeakMap,ba=new WeakMap,_i=new WeakMap,os=new WeakMap,ls=new WeakMap,ys=new WeakMap,ns=new WeakMap,as=new WeakMap,Kr=new WeakMap,$a=new WeakMap,ss=new WeakMap,hs=new WeakMap,vs=new WeakMap,bs=new WeakMap,xs=new WeakMap,fs=new WeakSet,su=function(){window.addEventListener("focus",Gr(this,ba)),window.addEventListener("blur",Gr(this,ga))},El=function(){window.removeEventListener("focus",Gr(this,ba)),window.removeEventListener("blur",Gr(this,ga))},Cl=function(){window.addEventListener("keydown",Gr(this,ys),{capture:!0})},Io=function(){window.removeEventListener("keydown",Gr(this,ys),{capture:!0})},Sl=function(){document.addEventListener("copy",Gr(this,_i)),document.addEventListener("cut",Gr(this,os)),document.addEventListener("paste",Gr(this,ls))},Al=function(){document.removeEventListener("copy",Gr(this,_i)),document.removeEventListener("cut",Gr(this,os)),document.removeEventListener("paste",Gr(this,ls))},oo=function(xa){Object.entries(xa).some(([Ps,Ms])=>Gr(this,ss)[Ps]!==Ms)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(Gr(this,ss),xa)})},Ao=function(xa){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:xa})},ou=function(){if(!Gr(this,Ur)){_s(this,Ur,!0);for(const xa of Gr(this,Ir).values())xa.enable()}},lu=function(){if(this.unselectAll(),Gr(this,Ur)){_s(this,Ur,!1);for(const xa of Gr(this,Ir).values())xa.disable()}},Tl=function(xa){const ps=Gr(this,Ir).get(xa.pageIndex);ps?ps.addOrRebuild(xa):this.addEditor(xa)},To=function(){if(Gr(this,Or).size===0)return!0;if(Gr(this,Or).size===1)for(const xa of Gr(this,Or).values())return xa.isEmpty();return!1},_l=function(xa){Gr(this,Jr).clear();for(const ps of xa)ps.isEmpty()||(Gr(this,Jr).add(ps),ps.select());ws(this,fs,oo).call(this,{hasSelectedEditor:!0})},Zs(Es,"TRANSLATE_SMALL",1),Zs(Es,"TRANSLATE_BIG",10);let br=Es;ar.AnnotationEditorUIManager=br},(or,ar,lr)=>{var Fr,zr,Hr,Wr,Yr,qr,Br,Ur,Vr,Xr,Zr,Jr,mo,yo,Rl,Fo,$o,_o,Ro;Object.defineProperty(ar,"__esModule",{value:!0}),ar.StatTimer=ar.RenderingCancelledException=ar.PixelsPerInch=ar.PageViewport=ar.PDFDateString=ar.DOMStandardFontDataFactory=ar.DOMSVGFactory=ar.DOMFilterFactory=ar.DOMCanvasFactory=ar.DOMCMapReaderFactory=void 0,ar.deprecated=_r,ar.getColorValues=Or,ar.getCurrentTransform=Ir,ar.getCurrentTransformInverse=Mr,ar.getFilenameFromUrl=wr,ar.getPdfFilenameFromUrl=Er,ar.getRGB=Lr,ar.getXfaPageViewport=Nr,ar.isDataScheme=Cr,ar.isPdfFile=Sr,ar.isValidFetchUrl=Tr,ar.loadScript=Pr,ar.noContextMenu=Rr,ar.setLayerDimensions=$r;var ur=lr(7),cr=lr(1);const hr="http://www.w3.org/2000/svg",jr=class jr{};Zs(jr,"CSS",96),Zs(jr,"PDF",72),Zs(jr,"PDF_TO_CSS_UNITS",jr.CSS/jr.PDF);let dr=jr;ar.PixelsPerInch=dr;class fr extends ur.BaseFilterFactory{constructor({docId:Kr,ownerDocument:$a=globalThis.document}={}){super();Ts(this,Jr);Ts(this,Fr);Ts(this,zr);Ts(this,Hr);Ts(this,Wr);Ts(this,Yr);Ts(this,qr);Ts(this,Br);Ts(this,Ur);Ts(this,Vr);Ts(this,Xr);Ts(this,Zr,0);_s(this,Hr,Kr),_s(this,Wr,$a)}addFilter(Kr){if(!Kr)return"none";let $a=Gr(this,Jr,mo).get(Kr);if($a)return $a;let ss,hs,vs,bs;if(Kr.length===1){const Os=Kr[0],Us=new Array(256);for(let $s=0;$s<256;$s++)Us[$s]=Os[$s]/255;bs=ss=hs=vs=Us.join(",")}else{const[Os,Us,$s]=Kr,Bs=new Array(256),Ns=new Array(256),us=new Array(256);for(let na=0;na<256;na++)Bs[na]=Os[na]/255,Ns[na]=Us[na]/255,us[na]=$s[na]/255;ss=Bs.join(","),hs=Ns.join(","),vs=us.join(","),bs=`${ss}${hs}${vs}`}if($a=Gr(this,Jr,mo).get(bs),$a)return Gr(this,Jr,mo).set(Kr,$a),$a;const xs=`g_${Gr(this,Hr)}_transfer_map_${So(this,Zr)._++}`,fs=`url(#${xs})`;Gr(this,Jr,mo).set(Kr,fs),Gr(this,Jr,mo).set(bs,fs);const Is=ws(this,Jr,Fo).call(this,xs);return ws(this,Jr,_o).call(this,ss,hs,vs,Is),fs}addHCMFilter(Kr,$a){var Us;const ss=`${Kr}-${$a}`;if(Gr(this,qr)===ss)return Gr(this,Br);if(_s(this,qr,ss),_s(this,Br,"none"),(Us=Gr(this,Yr))==null||Us.remove(),!Kr||!$a)return Gr(this,Br);const hs=ws(this,Jr,Ro).call(this,Kr);Kr=cr.Util.makeHexColor(...hs);const vs=ws(this,Jr,Ro).call(this,$a);if($a=cr.Util.makeHexColor(...vs),Gr(this,Jr,yo).style.color="",Kr==="#000000"&&$a==="#ffffff"||Kr===$a)return Gr(this,Br);const bs=new Array(256);for(let $s=0;$s<=255;$s++){const Bs=$s/255;bs[$s]=Bs<=.03928?Bs/12.92:((Bs+.055)/1.055)**2.4}const xs=bs.join(","),fs=`g_${Gr(this,Hr)}_hcm_filter`,Is=_s(this,Ur,ws(this,Jr,Fo).call(this,fs));ws(this,Jr,_o).call(this,xs,xs,xs,Is),ws(this,Jr,Rl).call(this,Is);const Os=($s,Bs)=>{const Ns=hs[$s]/255,us=vs[$s]/255,na=new Array(Bs+1);for(let ds=0;ds<=Bs;ds++)na[ds]=Ns+ds/Bs*(us-Ns);return na.join(",")};return ws(this,Jr,_o).call(this,Os(0,5),Os(1,5),Os(2,5),Is),_s(this,Br,`url(#${fs})`),Gr(this,Br)}addHighlightHCMFilter(Kr,$a,ss,hs){var us;const vs=`${Kr}-${$a}-${ss}-${hs}`;if(Gr(this,Vr)===vs)return Gr(this,Xr);if(_s(this,Vr,vs),_s(this,Xr,"none"),(us=Gr(this,Ur))==null||us.remove(),!Kr||!$a)return Gr(this,Xr);const[bs,xs]=[Kr,$a].map(ws(this,Jr,Ro).bind(this));let fs=Math.round(.2126*bs[0]+.7152*bs[1]+.0722*bs[2]),Is=Math.round(.2126*xs[0]+.7152*xs[1]+.0722*xs[2]),[Os,Us]=[ss,hs].map(ws(this,Jr,Ro).bind(this));Is<fs&&([fs,Is,Os,Us]=[Is,fs,Us,Os]),Gr(this,Jr,yo).style.color="";const $s=(na,ds,is)=>{const _a=new Array(256),rs=(Is-fs)/is,Cs=na/255,Es=(ds-na)/(255*is);let Rs=0;for(let xa=0;xa<=is;xa++){const ps=Math.round(fs+xa*rs),Ps=Cs+xa*Es;for(let Ms=Rs;Ms<=ps;Ms++)_a[Ms]=Ps;Rs=ps+1}for(let xa=Rs;xa<256;xa++)_a[xa]=_a[Rs-1];return _a.join(",")},Bs=`g_${Gr(this,Hr)}_hcm_highlight_filter`,Ns=_s(this,Ur,ws(this,Jr,Fo).call(this,Bs));return ws(this,Jr,Rl).call(this,Ns),ws(this,Jr,_o).call(this,$s(Os[0],Us[0],5),$s(Os[1],Us[1],5),$s(Os[2],Us[2],5),Ns),_s(this,Xr,`url(#${Bs})`),Gr(this,Xr)}destroy(Kr=!1){Kr&&(Gr(this,Br)||Gr(this,Xr))||(Gr(this,zr)&&(Gr(this,zr).parentNode.parentNode.remove(),_s(this,zr,null)),Gr(this,Fr)&&(Gr(this,Fr).clear(),_s(this,Fr,null)),_s(this,Zr,0))}}Fr=new WeakMap,zr=new WeakMap,Hr=new WeakMap,Wr=new WeakMap,Yr=new WeakMap,qr=new WeakMap,Br=new WeakMap,Ur=new WeakMap,Vr=new WeakMap,Xr=new WeakMap,Zr=new WeakMap,Jr=new WeakSet,mo=function(){return Gr(this,Fr)||_s(this,Fr,new Map)},yo=function(){if(!Gr(this,zr)){const Kr=Gr(this,Wr).createElement("div"),{style:$a}=Kr;$a.visibility="hidden",$a.contain="strict",$a.width=$a.height=0,$a.position="absolute",$a.top=$a.left=0,$a.zIndex=-1;const ss=Gr(this,Wr).createElementNS(hr,"svg");ss.setAttribute("width",0),ss.setAttribute("height",0),_s(this,zr,Gr(this,Wr).createElementNS(hr,"defs")),Kr.append(ss),ss.append(Gr(this,zr)),Gr(this,Wr).body.append(Kr)}return Gr(this,zr)},Rl=function(Kr){const $a=Gr(this,Wr).createElementNS(hr,"feColorMatrix");$a.setAttribute("type","matrix"),$a.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Kr.append($a)},Fo=function(Kr){const $a=Gr(this,Wr).createElementNS(hr,"filter");return $a.setAttribute("color-interpolation-filters","sRGB"),$a.setAttribute("id",Kr),Gr(this,Jr,yo).append($a),$a},$o=function(Kr,$a,ss){const hs=Gr(this,Wr).createElementNS(hr,$a);hs.setAttribute("type","discrete"),hs.setAttribute("tableValues",ss),Kr.append(hs)},_o=function(Kr,$a,ss,hs){const vs=Gr(this,Wr).createElementNS(hr,"feComponentTransfer");hs.append(vs),ws(this,Jr,$o).call(this,vs,"feFuncR",Kr),ws(this,Jr,$o).call(this,vs,"feFuncG",$a),ws(this,Jr,$o).call(this,vs,"feFuncB",ss)},Ro=function(Kr){return Gr(this,Jr,yo).style.color=Kr,Lr(getComputedStyle(Gr(this,Jr,yo)).getPropertyValue("color"))},ar.DOMFilterFactory=fr;class pr extends ur.BaseCanvasFactory{constructor({ownerDocument:as=globalThis.document}={}){super(),this._document=as}_createCanvas(as,Kr){const $a=this._document.createElement("canvas");return $a.width=as,$a.height=Kr,$a}}ar.DOMCanvasFactory=pr;async function vr(ns,as=!1){if(Tr(ns,document.baseURI)){const Kr=await fetch(ns);if(!Kr.ok)throw new Error(Kr.statusText);return as?new Uint8Array(await Kr.arrayBuffer()):(0,cr.stringToBytes)(await Kr.text())}return new Promise((Kr,$a)=>{const ss=new XMLHttpRequest;ss.open("GET",ns,!0),as&&(ss.responseType="arraybuffer"),ss.onreadystatechange=()=>{if(ss.readyState===XMLHttpRequest.DONE){if(ss.status===200||ss.status===0){let hs;if(as&&ss.response?hs=new Uint8Array(ss.response):!as&&ss.responseText&&(hs=(0,cr.stringToBytes)(ss.responseText)),hs){Kr(hs);return}}$a(new Error(ss.statusText))}},ss.send(null)})}class gr extends ur.BaseCMapReaderFactory{_fetchData(as,Kr){return vr(as,this.isCompressed).then($a=>({cMapData:$a,compressionType:Kr}))}}ar.DOMCMapReaderFactory=gr;class mr extends ur.BaseStandardFontDataFactory{_fetchData(as){return vr(as,!0)}}ar.DOMStandardFontDataFactory=mr;class br extends ur.BaseSVGFactory{_createSVG(as){return document.createElementNS(hr,as)}}ar.DOMSVGFactory=br;class yr{constructor({viewBox:as,scale:Kr,rotation:$a,offsetX:ss=0,offsetY:hs=0,dontFlip:vs=!1}){this.viewBox=as,this.scale=Kr,this.rotation=$a,this.offsetX=ss,this.offsetY=hs;const bs=(as[2]+as[0])/2,xs=(as[3]+as[1])/2;let fs,Is,Os,Us;switch($a%=360,$a<0&&($a+=360),$a){case 180:fs=-1,Is=0,Os=0,Us=1;break;case 90:fs=0,Is=1,Os=1,Us=0;break;case 270:fs=0,Is=-1,Os=-1,Us=0;break;case 0:fs=1,Is=0,Os=0,Us=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}vs&&(Os=-Os,Us=-Us);let $s,Bs,Ns,us;fs===0?($s=Math.abs(xs-as[1])*Kr+ss,Bs=Math.abs(bs-as[0])*Kr+hs,Ns=(as[3]-as[1])*Kr,us=(as[2]-as[0])*Kr):($s=Math.abs(bs-as[0])*Kr+ss,Bs=Math.abs(xs-as[1])*Kr+hs,Ns=(as[2]-as[0])*Kr,us=(as[3]-as[1])*Kr),this.transform=[fs*Kr,Is*Kr,Os*Kr,Us*Kr,$s-fs*Kr*bs-Os*Kr*xs,Bs-Is*Kr*bs-Us*Kr*xs],this.width=Ns,this.height=us}get rawDims(){const{viewBox:as}=this;return(0,cr.shadow)(this,"rawDims",{pageWidth:as[2]-as[0],pageHeight:as[3]-as[1],pageX:as[0],pageY:as[1]})}clone({scale:as=this.scale,rotation:Kr=this.rotation,offsetX:$a=this.offsetX,offsetY:ss=this.offsetY,dontFlip:hs=!1}={}){return new yr({viewBox:this.viewBox.slice(),scale:as,rotation:Kr,offsetX:$a,offsetY:ss,dontFlip:hs})}convertToViewportPoint(as,Kr){return cr.Util.applyTransform([as,Kr],this.transform)}convertToViewportRectangle(as){const Kr=cr.Util.applyTransform([as[0],as[1]],this.transform),$a=cr.Util.applyTransform([as[2],as[3]],this.transform);return[Kr[0],Kr[1],$a[0],$a[1]]}convertToPdfPoint(as,Kr){return cr.Util.applyInverseTransform([as,Kr],this.transform)}}ar.PageViewport=yr;class xr extends cr.BaseException{constructor(as,Kr=0){super(as,"RenderingCancelledException"),this.extraDelay=Kr}}ar.RenderingCancelledException=xr;function Cr(ns){const as=ns.length;let Kr=0;for(;Kr<as&&ns[Kr].trim()==="";)Kr++;return ns.substring(Kr,Kr+5).toLowerCase()==="data:"}function Sr(ns){return typeof ns=="string"&&/\.pdf$/i.test(ns)}function wr(ns,as=!1){return as||([ns]=ns.split(/[#?]/,1)),ns.substring(ns.lastIndexOf("/")+1)}function Er(ns,as="document.pdf"){if(typeof ns!="string")return as;if(Cr(ns))return(0,cr.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),as;const Kr=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,$a=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ss=Kr.exec(ns);let hs=$a.exec(ss[1])||$a.exec(ss[2])||$a.exec(ss[3]);if(hs&&(hs=hs[0],hs.includes("%")))try{hs=$a.exec(decodeURIComponent(hs))[0]}catch{}return hs||as}class Ar{constructor(){Zs(this,"started",Object.create(null));Zs(this,"times",[])}time(as){as in this.started&&(0,cr.warn)(`Timer is already running for ${as}`),this.started[as]=Date.now()}timeEnd(as){as in this.started||(0,cr.warn)(`Timer has not been started for ${as}`),this.times.push({name:as,start:this.started[as],end:Date.now()}),delete this.started[as]}toString(){const as=[];let Kr=0;for(const{name:$a}of this.times)Kr=Math.max($a.length,Kr);for(const{name:$a,start:ss,end:hs}of this.times)as.push(`${$a.padEnd(Kr)} ${hs-ss}ms
`);return as.join("")}}ar.StatTimer=Ar;function Tr(ns,as){try{const{protocol:Kr}=as?new URL(ns,as):new URL(ns);return Kr==="http:"||Kr==="https:"}catch{return!1}}function Rr(ns){ns.preventDefault()}function Pr(ns,as=!1){return new Promise((Kr,$a)=>{const ss=document.createElement("script");ss.src=ns,ss.onload=function(hs){as&&ss.remove(),Kr(hs)},ss.onerror=function(){$a(new Error(`Cannot load script at: ${ss.src}`))},(document.head||document.documentElement).append(ss)})}function _r(ns){console.log("Deprecated API usage: "+ns)}let kr;class Dr{static toDateObject(as){if(!as||typeof as!="string")return null;kr||(kr=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const Kr=kr.exec(as);if(!Kr)return null;const $a=parseInt(Kr[1],10);let ss=parseInt(Kr[2],10);ss=ss>=1&&ss<=12?ss-1:0;let hs=parseInt(Kr[3],10);hs=hs>=1&&hs<=31?hs:1;let vs=parseInt(Kr[4],10);vs=vs>=0&&vs<=23?vs:0;let bs=parseInt(Kr[5],10);bs=bs>=0&&bs<=59?bs:0;let xs=parseInt(Kr[6],10);xs=xs>=0&&xs<=59?xs:0;const fs=Kr[7]||"Z";let Is=parseInt(Kr[8],10);Is=Is>=0&&Is<=23?Is:0;let Os=parseInt(Kr[9],10)||0;return Os=Os>=0&&Os<=59?Os:0,fs==="-"?(vs+=Is,bs+=Os):fs==="+"&&(vs-=Is,bs-=Os),new Date(Date.UTC($a,ss,hs,vs,bs,xs))}}ar.PDFDateString=Dr;function Nr(ns,{scale:as=1,rotation:Kr=0}){const{width:$a,height:ss}=ns.attributes.style,hs=[0,0,parseInt($a),parseInt(ss)];return new yr({viewBox:hs,scale:as,rotation:Kr})}function Lr(ns){if(ns.startsWith("#")){const as=parseInt(ns.slice(1),16);return[(as&16711680)>>16,(as&65280)>>8,as&255]}return ns.startsWith("rgb(")?ns.slice(4,-1).split(",").map(as=>parseInt(as)):ns.startsWith("rgba(")?ns.slice(5,-1).split(",").map(as=>parseInt(as)).slice(0,3):((0,cr.warn)(`Not a valid color format: "${ns}"`),[0,0,0])}function Or(ns){const as=document.createElement("span");as.style.visibility="hidden",document.body.append(as);for(const Kr of ns.keys()){as.style.color=Kr;const $a=window.getComputedStyle(as).color;ns.set(Kr,Lr($a))}as.remove()}function Ir(ns){const{a:as,b:Kr,c:$a,d:ss,e:hs,f:vs}=ns.getTransform();return[as,Kr,$a,ss,hs,vs]}function Mr(ns){const{a:as,b:Kr,c:$a,d:ss,e:hs,f:vs}=ns.getTransform().invertSelf();return[as,Kr,$a,ss,hs,vs]}function $r(ns,as,Kr=!1,$a=!0){if(as instanceof yr){const{pageWidth:ss,pageHeight:hs}=as.rawDims,{style:vs}=ns,bs=cr.FeatureTest.isCSSRoundSupported,xs=`var(--scale-factor) * ${ss}px`,fs=`var(--scale-factor) * ${hs}px`,Is=bs?`round(${xs}, 1px)`:`calc(${xs})`,Os=bs?`round(${fs}, 1px)`:`calc(${fs})`;!Kr||as.rotation%180===0?(vs.width=Is,vs.height=Os):(vs.width=Os,vs.height=Is)}$a&&ns.setAttribute("data-main-rotation",as.rotation)}},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.BaseStandardFontDataFactory=ar.BaseSVGFactory=ar.BaseFilterFactory=ar.BaseCanvasFactory=ar.BaseCMapReaderFactory=void 0;var ur=lr(1);class cr{constructor(){this.constructor===cr&&(0,ur.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(gr){return"none"}addHCMFilter(gr,mr){return"none"}addHighlightHCMFilter(gr,mr,br,yr){return"none"}destroy(gr=!1){}}ar.BaseFilterFactory=cr;class hr{constructor(){this.constructor===hr&&(0,ur.unreachable)("Cannot initialize BaseCanvasFactory.")}create(gr,mr){if(gr<=0||mr<=0)throw new Error("Invalid canvas size");const br=this._createCanvas(gr,mr);return{canvas:br,context:br.getContext("2d")}}reset(gr,mr,br){if(!gr.canvas)throw new Error("Canvas is not specified");if(mr<=0||br<=0)throw new Error("Invalid canvas size");gr.canvas.width=mr,gr.canvas.height=br}destroy(gr){if(!gr.canvas)throw new Error("Canvas is not specified");gr.canvas.width=0,gr.canvas.height=0,gr.canvas=null,gr.context=null}_createCanvas(gr,mr){(0,ur.unreachable)("Abstract method `_createCanvas` called.")}}ar.BaseCanvasFactory=hr;class dr{constructor({baseUrl:gr=null,isCompressed:mr=!0}){this.constructor===dr&&(0,ur.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=gr,this.isCompressed=mr}async fetch({name:gr}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!gr)throw new Error("CMap name must be specified.");const mr=this.baseUrl+gr+(this.isCompressed?".bcmap":""),br=this.isCompressed?ur.CMapCompressionType.BINARY:ur.CMapCompressionType.NONE;return this._fetchData(mr,br).catch(yr=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${mr}`)})}_fetchData(gr,mr){(0,ur.unreachable)("Abstract method `_fetchData` called.")}}ar.BaseCMapReaderFactory=dr;class fr{constructor({baseUrl:gr=null}){this.constructor===fr&&(0,ur.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=gr}async fetch({filename:gr}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!gr)throw new Error("Font filename must be specified.");const mr=`${this.baseUrl}${gr}`;return this._fetchData(mr).catch(br=>{throw new Error(`Unable to load font data at: ${mr}`)})}_fetchData(gr){(0,ur.unreachable)("Abstract method `_fetchData` called.")}}ar.BaseStandardFontDataFactory=fr;class pr{constructor(){this.constructor===pr&&(0,ur.unreachable)("Cannot initialize BaseSVGFactory.")}create(gr,mr,br=!1){if(gr<=0||mr<=0)throw new Error("Invalid SVG dimensions");const yr=this._createSVG("svg:svg");return yr.setAttribute("version","1.1"),br||(yr.setAttribute("width",`${gr}px`),yr.setAttribute("height",`${mr}px`)),yr.setAttribute("preserveAspectRatio","none"),yr.setAttribute("viewBox",`0 0 ${gr} ${mr}`),yr}createElement(gr){if(typeof gr!="string")throw new Error("Invalid SVG element type");return this._createSVG(gr)}_createSVG(gr){(0,ur.unreachable)("Abstract method `_createSVG` called.")}}ar.BaseSVGFactory=pr},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.MurmurHash3_64=void 0;var ur=lr(1);const cr=3285377520,hr=4294901760,dr=65535;class fr{constructor(vr){this.h1=vr?vr&4294967295:cr,this.h2=vr?vr&4294967295:cr}update(vr){let gr,mr;if(typeof vr=="string"){gr=new Uint8Array(vr.length*2),mr=0;for(let _r=0,kr=vr.length;_r<kr;_r++){const Dr=vr.charCodeAt(_r);Dr<=255?gr[mr++]=Dr:(gr[mr++]=Dr>>>8,gr[mr++]=Dr&255)}}else if((0,ur.isArrayBuffer)(vr))gr=vr.slice(),mr=gr.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const br=mr>>2,yr=mr-br*4,xr=new Uint32Array(gr.buffer,0,br);let Cr=0,Sr=0,wr=this.h1,Er=this.h2;const Ar=3432918353,Tr=461845907,Rr=Ar&dr,Pr=Tr&dr;for(let _r=0;_r<br;_r++)_r&1?(Cr=xr[_r],Cr=Cr*Ar&hr|Cr*Rr&dr,Cr=Cr<<15|Cr>>>17,Cr=Cr*Tr&hr|Cr*Pr&dr,wr^=Cr,wr=wr<<13|wr>>>19,wr=wr*5+3864292196):(Sr=xr[_r],Sr=Sr*Ar&hr|Sr*Rr&dr,Sr=Sr<<15|Sr>>>17,Sr=Sr*Tr&hr|Sr*Pr&dr,Er^=Sr,Er=Er<<13|Er>>>19,Er=Er*5+3864292196);switch(Cr=0,yr){case 3:Cr^=gr[br*4+2]<<16;case 2:Cr^=gr[br*4+1]<<8;case 1:Cr^=gr[br*4],Cr=Cr*Ar&hr|Cr*Rr&dr,Cr=Cr<<15|Cr>>>17,Cr=Cr*Tr&hr|Cr*Pr&dr,br&1?wr^=Cr:Er^=Cr}this.h1=wr,this.h2=Er}hexdigest(){let vr=this.h1,gr=this.h2;return vr^=gr>>>1,vr=vr*3981806797&hr|vr*36045&dr,gr=gr*4283543511&hr|((gr<<16|vr>>>16)*2950163797&hr)>>>16,vr^=gr>>>1,vr=vr*444984403&hr|vr*60499&dr,gr=gr*3301882366&hr|((gr<<16|vr>>>16)*3120437893&hr)>>>16,vr^=gr>>>1,(vr>>>0).toString(16).padStart(8,"0")+(gr>>>0).toString(16).padStart(8,"0")}}ar.MurmurHash3_64=fr},(or,ar,lr)=>{var dr;Object.defineProperty(ar,"__esModule",{value:!0}),ar.FontLoader=ar.FontFaceObject=void 0;var ur=lr(1);class cr{constructor({ownerDocument:pr=globalThis.document,styleElement:vr=null}){Ts(this,dr,new Set);this._document=pr,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(pr){this.nativeFontFaces.add(pr),this._document.fonts.add(pr)}removeNativeFontFace(pr){this.nativeFontFaces.delete(pr),this._document.fonts.delete(pr)}insertRule(pr){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const vr=this.styleElement.sheet;vr.insertRule(pr,vr.cssRules.length)}clear(){for(const pr of this.nativeFontFaces)this._document.fonts.delete(pr);this.nativeFontFaces.clear(),Gr(this,dr).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(pr){if(!(!pr||Gr(this,dr).has(pr.loadedName))){if((0,ur.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:vr,src:gr,style:mr}=pr,br=new FontFace(vr,gr,mr);this.addNativeFontFace(br);try{await br.load(),Gr(this,dr).add(vr)}catch{(0,ur.warn)(`Cannot load system font: ${pr.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(br)}return}(0,ur.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(pr){if(pr.attached||pr.missingFile&&!pr.systemFontInfo)return;if(pr.attached=!0,pr.systemFontInfo){await this.loadSystemFont(pr.systemFontInfo);return}if(this.isFontLoadingAPISupported){const gr=pr.createNativeFontFace();if(gr){this.addNativeFontFace(gr);try{await gr.loaded}catch(mr){throw(0,ur.warn)(`Failed to load font '${gr.family}': '${mr}'.`),pr.disableFontFace=!0,mr}}return}const vr=pr.createFontFaceRule();if(vr){if(this.insertRule(vr),this.isSyncFontLoadingSupported)return;await new Promise(gr=>{const mr=this._queueLoadingCallback(gr);this._prepareFontLoadEvent(pr,mr)})}}get isFontLoadingAPISupported(){var vr;const pr=!!((vr=this._document)!=null&&vr.fonts);return(0,ur.shadow)(this,"isFontLoadingAPISupported",pr)}get isSyncFontLoadingSupported(){let pr=!1;return(ur.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(pr=!0),(0,ur.shadow)(this,"isSyncFontLoadingSupported",pr)}_queueLoadingCallback(pr){function vr(){for((0,ur.assert)(!mr.done,"completeRequest() cannot be called twice."),mr.done=!0;gr.length>0&&gr[0].done;){const br=gr.shift();setTimeout(br.callback,0)}}const{loadingRequests:gr}=this,mr={done:!1,complete:vr,callback:pr};return gr.push(mr),mr}get _loadTestFont(){const pr=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,ur.shadow)(this,"_loadTestFont",pr)}_prepareFontLoadEvent(pr,vr){function gr(Lr,Or){return Lr.charCodeAt(Or)<<24|Lr.charCodeAt(Or+1)<<16|Lr.charCodeAt(Or+2)<<8|Lr.charCodeAt(Or+3)&255}function mr(Lr,Or,Ir,Mr){const $r=Lr.substring(0,Or),jr=Lr.substring(Or+Ir);return $r+Mr+jr}let br,yr;const xr=this._document.createElement("canvas");xr.width=1,xr.height=1;const Cr=xr.getContext("2d");let Sr=0;function wr(Lr,Or){if(++Sr>30){(0,ur.warn)("Load test font never loaded."),Or();return}if(Cr.font="30px "+Lr,Cr.fillText(".",0,20),Cr.getImageData(0,0,1,1).data[3]>0){Or();return}setTimeout(wr.bind(null,Lr,Or))}const Er=`lt${Date.now()}${this.loadTestFontId++}`;let Ar=this._loadTestFont;Ar=mr(Ar,976,Er.length,Er);const Rr=16,Pr=1482184792;let _r=gr(Ar,Rr);for(br=0,yr=Er.length-3;br<yr;br+=4)_r=_r-Pr+gr(Er,br)|0;br<Er.length&&(_r=_r-Pr+gr(Er+"XXX",br)|0),Ar=mr(Ar,Rr,4,(0,ur.string32)(_r));const kr=`url(data:font/opentype;base64,${btoa(Ar)});`,Dr=`@font-face {font-family:"${Er}";src:${kr}}`;this.insertRule(Dr);const Nr=this._document.createElement("div");Nr.style.visibility="hidden",Nr.style.width=Nr.style.height="10px",Nr.style.position="absolute",Nr.style.top=Nr.style.left="0px";for(const Lr of[pr.loadedName,Er]){const Or=this._document.createElement("span");Or.textContent="Hi",Or.style.fontFamily=Lr,Nr.append(Or)}this._document.body.append(Nr),wr(Er,()=>{Nr.remove(),vr.complete()})}}dr=new WeakMap,ar.FontLoader=cr;class hr{constructor(pr,{isEvalSupported:vr=!0,disableFontFace:gr=!1,ignoreErrors:mr=!1,inspectFont:br=null}){this.compiledGlyphs=Object.create(null);for(const yr in pr)this[yr]=pr[yr];this.isEvalSupported=vr!==!1,this.disableFontFace=gr===!0,this.ignoreErrors=mr===!0,this._inspectFont=br}createNativeFontFace(){var vr;if(!this.data||this.disableFontFace)return null;let pr;if(!this.cssFontInfo)pr=new FontFace(this.loadedName,this.data,{});else{const gr={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(gr.style=`oblique ${this.cssFontInfo.italicAngle}deg`),pr=new FontFace(this.cssFontInfo.fontFamily,this.data,gr)}return(vr=this._inspectFont)==null||vr.call(this,this),pr}createFontFaceRule(){var mr;if(!this.data||this.disableFontFace)return null;const pr=(0,ur.bytesToString)(this.data),vr=`url(data:${this.mimetype};base64,${btoa(pr)});`;let gr;if(!this.cssFontInfo)gr=`@font-face {font-family:"${this.loadedName}";src:${vr}}`;else{let br=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(br+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),gr=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${br}src:${vr}}`}return(mr=this._inspectFont)==null||mr.call(this,this,vr),gr}getPathGenerator(pr,vr){if(this.compiledGlyphs[vr]!==void 0)return this.compiledGlyphs[vr];let gr;try{gr=pr.get(this.loadedName+"_path_"+vr)}catch(mr){if(!this.ignoreErrors)throw mr;return(0,ur.warn)(`getPathGenerator - ignoring character: "${mr}".`),this.compiledGlyphs[vr]=function(br,yr){}}if(this.isEvalSupported&&ur.FeatureTest.isEvalSupported){const mr=[];for(const br of gr){const yr=br.args!==void 0?br.args.join(","):"";mr.push("c.",br.cmd,"(",yr,`);
`)}return this.compiledGlyphs[vr]=new Function("c","size",mr.join(""))}return this.compiledGlyphs[vr]=function(mr,br){for(const yr of gr)yr.cmd==="scale"&&(yr.args=[br,-br]),mr[yr.cmd].apply(mr,yr.args)}}}ar.FontFaceObject=hr},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.NodeStandardFontDataFactory=ar.NodeFilterFactory=ar.NodeCanvasFactory=ar.NodeCMapReaderFactory=void 0;var ur=lr(7);lr(1);const cr=function(vr){return new Promise((gr,mr)=>{require$$5.readFile(vr,(yr,xr)=>{if(yr||!xr){mr(new Error(yr));return}gr(new Uint8Array(xr))})})};class hr extends ur.BaseFilterFactory{}ar.NodeFilterFactory=hr;class dr extends ur.BaseCanvasFactory{_createCanvas(gr,mr){return require$$5.createCanvas(gr,mr)}}ar.NodeCanvasFactory=dr;class fr extends ur.BaseCMapReaderFactory{_fetchData(gr,mr){return cr(gr).then(br=>({cMapData:br,compressionType:mr}))}}ar.NodeCMapReaderFactory=fr;class pr extends ur.BaseStandardFontDataFactory{_fetchData(gr){return cr(gr)}}ar.NodeStandardFontDataFactory=pr},(or,ar,lr)=>{var zr,Pl,Dl;Object.defineProperty(ar,"__esModule",{value:!0}),ar.CanvasGraphics=void 0;var ur=lr(1),cr=lr(6),hr=lr(12),dr=lr(13);const fr=16,pr=100,vr=4096,gr=15,mr=10,br=1e3,yr=16;function xr(qr,Br){if(qr._removeMirroring)throw new Error("Context is already forwarding operations.");qr.__originalSave=qr.save,qr.__originalRestore=qr.restore,qr.__originalRotate=qr.rotate,qr.__originalScale=qr.scale,qr.__originalTranslate=qr.translate,qr.__originalTransform=qr.transform,qr.__originalSetTransform=qr.setTransform,qr.__originalResetTransform=qr.resetTransform,qr.__originalClip=qr.clip,qr.__originalMoveTo=qr.moveTo,qr.__originalLineTo=qr.lineTo,qr.__originalBezierCurveTo=qr.bezierCurveTo,qr.__originalRect=qr.rect,qr.__originalClosePath=qr.closePath,qr.__originalBeginPath=qr.beginPath,qr._removeMirroring=()=>{qr.save=qr.__originalSave,qr.restore=qr.__originalRestore,qr.rotate=qr.__originalRotate,qr.scale=qr.__originalScale,qr.translate=qr.__originalTranslate,qr.transform=qr.__originalTransform,qr.setTransform=qr.__originalSetTransform,qr.resetTransform=qr.__originalResetTransform,qr.clip=qr.__originalClip,qr.moveTo=qr.__originalMoveTo,qr.lineTo=qr.__originalLineTo,qr.bezierCurveTo=qr.__originalBezierCurveTo,qr.rect=qr.__originalRect,qr.closePath=qr.__originalClosePath,qr.beginPath=qr.__originalBeginPath,delete qr._removeMirroring},qr.save=function(){Br.save(),this.__originalSave()},qr.restore=function(){Br.restore(),this.__originalRestore()},qr.translate=function(Vr,Xr){Br.translate(Vr,Xr),this.__originalTranslate(Vr,Xr)},qr.scale=function(Vr,Xr){Br.scale(Vr,Xr),this.__originalScale(Vr,Xr)},qr.transform=function(Vr,Xr,Zr,Jr,Qr,ga){Br.transform(Vr,Xr,Zr,Jr,Qr,ga),this.__originalTransform(Vr,Xr,Zr,Jr,Qr,ga)},qr.setTransform=function(Vr,Xr,Zr,Jr,Qr,ga){Br.setTransform(Vr,Xr,Zr,Jr,Qr,ga),this.__originalSetTransform(Vr,Xr,Zr,Jr,Qr,ga)},qr.resetTransform=function(){Br.resetTransform(),this.__originalResetTransform()},qr.rotate=function(Vr){Br.rotate(Vr),this.__originalRotate(Vr)},qr.clip=function(Vr){Br.clip(Vr),this.__originalClip(Vr)},qr.moveTo=function(Ur,Vr){Br.moveTo(Ur,Vr),this.__originalMoveTo(Ur,Vr)},qr.lineTo=function(Ur,Vr){Br.lineTo(Ur,Vr),this.__originalLineTo(Ur,Vr)},qr.bezierCurveTo=function(Ur,Vr,Xr,Zr,Jr,Qr){Br.bezierCurveTo(Ur,Vr,Xr,Zr,Jr,Qr),this.__originalBezierCurveTo(Ur,Vr,Xr,Zr,Jr,Qr)},qr.rect=function(Ur,Vr,Xr,Zr){Br.rect(Ur,Vr,Xr,Zr),this.__originalRect(Ur,Vr,Xr,Zr)},qr.closePath=function(){Br.closePath(),this.__originalClosePath()},qr.beginPath=function(){Br.beginPath(),this.__originalBeginPath()}}class Cr{constructor(Br){this.canvasFactory=Br,this.cache=Object.create(null)}getCanvas(Br,Ur,Vr){let Xr;return this.cache[Br]!==void 0?(Xr=this.cache[Br],this.canvasFactory.reset(Xr,Ur,Vr)):(Xr=this.canvasFactory.create(Ur,Vr),this.cache[Br]=Xr),Xr}delete(Br){delete this.cache[Br]}clear(){for(const Br in this.cache){const Ur=this.cache[Br];this.canvasFactory.destroy(Ur),delete this.cache[Br]}}}function Sr(qr,Br,Ur,Vr,Xr,Zr,Jr,Qr,ga,ba){const[_i,os,ls,ys,ns,as]=(0,cr.getCurrentTransform)(qr);if(os===0&&ls===0){const ss=Jr*_i+ns,hs=Math.round(ss),vs=Qr*ys+as,bs=Math.round(vs),xs=(Jr+ga)*_i+ns,fs=Math.abs(Math.round(xs)-hs)||1,Is=(Qr+ba)*ys+as,Os=Math.abs(Math.round(Is)-bs)||1;return qr.setTransform(Math.sign(_i),0,0,Math.sign(ys),hs,bs),qr.drawImage(Br,Ur,Vr,Xr,Zr,0,0,fs,Os),qr.setTransform(_i,os,ls,ys,ns,as),[fs,Os]}if(_i===0&&ys===0){const ss=Qr*ls+ns,hs=Math.round(ss),vs=Jr*os+as,bs=Math.round(vs),xs=(Qr+ba)*ls+ns,fs=Math.abs(Math.round(xs)-hs)||1,Is=(Jr+ga)*os+as,Os=Math.abs(Math.round(Is)-bs)||1;return qr.setTransform(0,Math.sign(os),Math.sign(ls),0,hs,bs),qr.drawImage(Br,Ur,Vr,Xr,Zr,0,0,Os,fs),qr.setTransform(_i,os,ls,ys,ns,as),[Os,fs]}qr.drawImage(Br,Ur,Vr,Xr,Zr,Jr,Qr,ga,ba);const Kr=Math.hypot(_i,os),$a=Math.hypot(ls,ys);return[Kr*ga,$a*ba]}function wr(qr){const{width:Br,height:Ur}=qr;if(Br>br||Ur>br)return null;const Vr=1e3,Xr=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),Zr=Br+1;let Jr=new Uint8Array(Zr*(Ur+1)),Qr,ga,ba;const _i=Br+7&-8;let os=new Uint8Array(_i*Ur),ls=0;for(const $a of qr.data){let ss=128;for(;ss>0;)os[ls++]=$a&ss?0:255,ss>>=1}let ys=0;for(ls=0,os[ls]!==0&&(Jr[0]=1,++ys),ga=1;ga<Br;ga++)os[ls]!==os[ls+1]&&(Jr[ga]=os[ls]?2:1,++ys),ls++;for(os[ls]!==0&&(Jr[ga]=2,++ys),Qr=1;Qr<Ur;Qr++){ls=Qr*_i,ba=Qr*Zr,os[ls-_i]!==os[ls]&&(Jr[ba]=os[ls]?1:8,++ys);let $a=(os[ls]?4:0)+(os[ls-_i]?8:0);for(ga=1;ga<Br;ga++)$a=($a>>2)+(os[ls+1]?4:0)+(os[ls-_i+1]?8:0),Xr[$a]&&(Jr[ba+ga]=Xr[$a],++ys),ls++;if(os[ls-_i]!==os[ls]&&(Jr[ba+ga]=os[ls]?2:4,++ys),ys>Vr)return null}for(ls=_i*(Ur-1),ba=Qr*Zr,os[ls]!==0&&(Jr[ba]=8,++ys),ga=1;ga<Br;ga++)os[ls]!==os[ls+1]&&(Jr[ba+ga]=os[ls]?4:8,++ys),ls++;if(os[ls]!==0&&(Jr[ba+ga]=4,++ys),ys>Vr)return null;const ns=new Int32Array([0,Zr,-1,0,-Zr,0,0,0,1]),as=new Path2D;for(Qr=0;ys&&Qr<=Ur;Qr++){let $a=Qr*Zr;const ss=$a+Br;for(;$a<ss&&!Jr[$a];)$a++;if($a===ss)continue;as.moveTo($a%Zr,Qr);const hs=$a;let vs=Jr[$a];do{const bs=ns[vs];do $a+=bs;while(!Jr[$a]);const xs=Jr[$a];xs!==5&&xs!==10?(vs=xs,Jr[$a]=0):(vs=xs&51*vs>>4,Jr[$a]&=vs>>2|vs<<2),as.lineTo($a%Zr,$a/Zr|0),Jr[$a]||--ys}while(hs!==$a);--Qr}return os=null,Jr=null,function($a){$a.save(),$a.scale(1/Br,-1/Ur),$a.translate(0,-Ur),$a.fill(as),$a.beginPath(),$a.restore()}}class Er{constructor(Br,Ur){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=ur.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=ur.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=ur.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,Br,Ur])}clone(){const Br=Object.create(this);return Br.clipBox=this.clipBox.slice(),Br}setCurrentPoint(Br,Ur){this.x=Br,this.y=Ur}updatePathMinMax(Br,Ur,Vr){[Ur,Vr]=ur.Util.applyTransform([Ur,Vr],Br),this.minX=Math.min(this.minX,Ur),this.minY=Math.min(this.minY,Vr),this.maxX=Math.max(this.maxX,Ur),this.maxY=Math.max(this.maxY,Vr)}updateRectMinMax(Br,Ur){const Vr=ur.Util.applyTransform(Ur,Br),Xr=ur.Util.applyTransform(Ur.slice(2),Br);this.minX=Math.min(this.minX,Vr[0],Xr[0]),this.minY=Math.min(this.minY,Vr[1],Xr[1]),this.maxX=Math.max(this.maxX,Vr[0],Xr[0]),this.maxY=Math.max(this.maxY,Vr[1],Xr[1])}updateScalingPathMinMax(Br,Ur){ur.Util.scaleMinMax(Br,Ur),this.minX=Math.min(this.minX,Ur[0]),this.maxX=Math.max(this.maxX,Ur[1]),this.minY=Math.min(this.minY,Ur[2]),this.maxY=Math.max(this.maxY,Ur[3])}updateCurvePathMinMax(Br,Ur,Vr,Xr,Zr,Jr,Qr,ga,ba,_i){const os=ur.Util.bezierBoundingBox(Ur,Vr,Xr,Zr,Jr,Qr,ga,ba);if(_i){_i[0]=Math.min(_i[0],os[0],os[2]),_i[1]=Math.max(_i[1],os[0],os[2]),_i[2]=Math.min(_i[2],os[1],os[3]),_i[3]=Math.max(_i[3],os[1],os[3]);return}this.updateRectMinMax(Br,os)}getPathBoundingBox(Br=hr.PathType.FILL,Ur=null){const Vr=[this.minX,this.minY,this.maxX,this.maxY];if(Br===hr.PathType.STROKE){Ur||(0,ur.unreachable)("Stroke bounding box must include transform.");const Xr=ur.Util.singularValueDecompose2dScale(Ur),Zr=Xr[0]*this.lineWidth/2,Jr=Xr[1]*this.lineWidth/2;Vr[0]-=Zr,Vr[1]-=Jr,Vr[2]+=Zr,Vr[3]+=Jr}return Vr}updateClipFromPath(){const Br=ur.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(Br||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(Br){this.clipBox=Br,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(Br=hr.PathType.FILL,Ur=null){return ur.Util.intersect(this.clipBox,this.getPathBoundingBox(Br,Ur))}}function Ar(qr,Br){if(typeof ImageData<"u"&&Br instanceof ImageData){qr.putImageData(Br,0,0);return}const Ur=Br.height,Vr=Br.width,Xr=Ur%yr,Zr=(Ur-Xr)/yr,Jr=Xr===0?Zr:Zr+1,Qr=qr.createImageData(Vr,yr);let ga=0,ba;const _i=Br.data,os=Qr.data;let ls,ys,ns,as;if(Br.kind===ur.ImageKind.GRAYSCALE_1BPP){const Kr=_i.byteLength,$a=new Uint32Array(os.buffer,0,os.byteLength>>2),ss=$a.length,hs=Vr+7>>3,vs=4294967295,bs=ur.FeatureTest.isLittleEndian?4278190080:255;for(ls=0;ls<Jr;ls++){for(ns=ls<Zr?yr:Xr,ba=0,ys=0;ys<ns;ys++){const xs=Kr-ga;let fs=0;const Is=xs>hs?Vr:xs*8-7,Os=Is&-8;let Us=0,$s=0;for(;fs<Os;fs+=8)$s=_i[ga++],$a[ba++]=$s&128?vs:bs,$a[ba++]=$s&64?vs:bs,$a[ba++]=$s&32?vs:bs,$a[ba++]=$s&16?vs:bs,$a[ba++]=$s&8?vs:bs,$a[ba++]=$s&4?vs:bs,$a[ba++]=$s&2?vs:bs,$a[ba++]=$s&1?vs:bs;for(;fs<Is;fs++)Us===0&&($s=_i[ga++],Us=128),$a[ba++]=$s&Us?vs:bs,Us>>=1}for(;ba<ss;)$a[ba++]=0;qr.putImageData(Qr,0,ls*yr)}}else if(Br.kind===ur.ImageKind.RGBA_32BPP){for(ys=0,as=Vr*yr*4,ls=0;ls<Zr;ls++)os.set(_i.subarray(ga,ga+as)),ga+=as,qr.putImageData(Qr,0,ys),ys+=yr;ls<Jr&&(as=Vr*Xr*4,os.set(_i.subarray(ga,ga+as)),qr.putImageData(Qr,0,ys))}else if(Br.kind===ur.ImageKind.RGB_24BPP)for(ns=yr,as=Vr*ns,ls=0;ls<Jr;ls++){for(ls>=Zr&&(ns=Xr,as=Vr*ns),ba=0,ys=as;ys--;)os[ba++]=_i[ga++],os[ba++]=_i[ga++],os[ba++]=_i[ga++],os[ba++]=255;qr.putImageData(Qr,0,ls*yr)}else throw new Error(`bad image kind: ${Br.kind}`)}function Tr(qr,Br){if(Br.bitmap){qr.drawImage(Br.bitmap,0,0);return}const Ur=Br.height,Vr=Br.width,Xr=Ur%yr,Zr=(Ur-Xr)/yr,Jr=Xr===0?Zr:Zr+1,Qr=qr.createImageData(Vr,yr);let ga=0;const ba=Br.data,_i=Qr.data;for(let os=0;os<Jr;os++){const ls=os<Zr?yr:Xr;({srcPos:ga}=(0,dr.convertBlackAndWhiteToRGBA)({src:ba,srcPos:ga,dest:_i,width:Vr,height:ls,nonBlackColor:0})),qr.putImageData(Qr,0,os*yr)}}function Rr(qr,Br){const Ur=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const Vr of Ur)qr[Vr]!==void 0&&(Br[Vr]=qr[Vr]);qr.setLineDash!==void 0&&(Br.setLineDash(qr.getLineDash()),Br.lineDashOffset=qr.lineDashOffset)}function Pr(qr){if(qr.strokeStyle=qr.fillStyle="#000000",qr.fillRule="nonzero",qr.globalAlpha=1,qr.lineWidth=1,qr.lineCap="butt",qr.lineJoin="miter",qr.miterLimit=10,qr.globalCompositeOperation="source-over",qr.font="10px sans-serif",qr.setLineDash!==void 0&&(qr.setLineDash([]),qr.lineDashOffset=0),!ur.isNodeJS){const{filter:Br}=qr;Br!=="none"&&Br!==""&&(qr.filter="none")}}function _r(qr,Br,Ur,Vr){const Xr=qr.length;for(let Zr=3;Zr<Xr;Zr+=4){const Jr=qr[Zr];if(Jr===0)qr[Zr-3]=Br,qr[Zr-2]=Ur,qr[Zr-1]=Vr;else if(Jr<255){const Qr=255-Jr;qr[Zr-3]=qr[Zr-3]*Jr+Br*Qr>>8,qr[Zr-2]=qr[Zr-2]*Jr+Ur*Qr>>8,qr[Zr-1]=qr[Zr-1]*Jr+Vr*Qr>>8}}}function kr(qr,Br,Ur){const Vr=qr.length,Xr=1/255;for(let Zr=3;Zr<Vr;Zr+=4){const Jr=Ur?Ur[qr[Zr]]:qr[Zr];Br[Zr]=Br[Zr]*Jr*Xr|0}}function Dr(qr,Br,Ur){const Vr=qr.length;for(let Xr=3;Xr<Vr;Xr+=4){const Zr=qr[Xr-3]*77+qr[Xr-2]*152+qr[Xr-1]*28;Br[Xr]=Ur?Br[Xr]*Ur[Zr>>8]>>8:Br[Xr]*Zr>>16}}function Nr(qr,Br,Ur,Vr,Xr,Zr,Jr,Qr,ga,ba,_i){const os=!!Zr,ls=os?Zr[0]:0,ys=os?Zr[1]:0,ns=os?Zr[2]:0,as=Xr==="Luminosity"?Dr:kr,$a=Math.min(Vr,Math.ceil(1048576/Ur));for(let ss=0;ss<Vr;ss+=$a){const hs=Math.min($a,Vr-ss),vs=qr.getImageData(Qr-ba,ss+(ga-_i),Ur,hs),bs=Br.getImageData(Qr,ss+ga,Ur,hs);os&&_r(vs.data,ls,ys,ns),as(vs.data,bs.data,Jr),Br.putImageData(bs,Qr,ss+ga)}}function Lr(qr,Br,Ur,Vr){const Xr=Vr[0],Zr=Vr[1],Jr=Vr[2]-Xr,Qr=Vr[3]-Zr;Jr===0||Qr===0||(Nr(Br.context,Ur,Jr,Qr,Br.subtype,Br.backdrop,Br.transferMap,Xr,Zr,Br.offsetX,Br.offsetY),qr.save(),qr.globalAlpha=1,qr.globalCompositeOperation="source-over",qr.setTransform(1,0,0,1,0,0),qr.drawImage(Ur.canvas,0,0),qr.restore())}function Or(qr,Br){const Ur=ur.Util.singularValueDecompose2dScale(qr);Ur[0]=Math.fround(Ur[0]),Ur[1]=Math.fround(Ur[1]);const Vr=Math.fround((globalThis.devicePixelRatio||1)*cr.PixelsPerInch.PDF_TO_CSS_UNITS);return Br!==void 0?Br:Ur[0]<=Vr||Ur[1]<=Vr}const Ir=["butt","round","square"],Mr=["miter","round","bevel"],$r={},jr={},Yr=class Yr{constructor(Br,Ur,Vr,Xr,Zr,{optionalContentConfig:Jr,markedContentStack:Qr=null},ga,ba){Ts(this,zr);this.ctx=Br,this.current=new Er(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=Ur,this.objs=Vr,this.canvasFactory=Xr,this.filterFactory=Zr,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=Qr||[],this.optionalContentConfig=Jr,this.cachedCanvases=new Cr(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=ga,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=ba,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(Br,Ur=null){return typeof Br=="string"?Br.startsWith("g_")?this.commonObjs.get(Br):this.objs.get(Br):Ur}beginDrawing({transform:Br,viewport:Ur,transparency:Vr=!1,background:Xr=null}){const Zr=this.ctx.canvas.width,Jr=this.ctx.canvas.height,Qr=this.ctx.fillStyle;if(this.ctx.fillStyle=Xr||"#ffffff",this.ctx.fillRect(0,0,Zr,Jr),this.ctx.fillStyle=Qr,Vr){const ga=this.cachedCanvases.getCanvas("transparent",Zr,Jr);this.compositeCtx=this.ctx,this.transparentCanvas=ga.canvas,this.ctx=ga.context,this.ctx.save(),this.ctx.transform(...(0,cr.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),Pr(this.ctx),Br&&(this.ctx.transform(...Br),this.outputScaleX=Br[0],this.outputScaleY=Br[0]),this.ctx.transform(...Ur.transform),this.viewportScale=Ur.scale,this.baseTransform=(0,cr.getCurrentTransform)(this.ctx)}executeOperatorList(Br,Ur,Vr,Xr){const Zr=Br.argsArray,Jr=Br.fnArray;let Qr=Ur||0;const ga=Zr.length;if(ga===Qr)return Qr;const ba=ga-Qr>mr&&typeof Vr=="function",_i=ba?Date.now()+gr:0;let os=0;const ls=this.commonObjs,ys=this.objs;let ns;for(;;){if(Xr!==void 0&&Qr===Xr.nextBreakPoint)return Xr.breakIt(Qr,Vr),Qr;if(ns=Jr[Qr],ns!==ur.OPS.dependency)this[ns].apply(this,Zr[Qr]);else for(const as of Zr[Qr]){const Kr=as.startsWith("g_")?ls:ys;if(!Kr.has(as))return Kr.get(as,Vr),Qr}if(Qr++,Qr===ga)return Qr;if(ba&&++os>mr){if(Date.now()>_i)return Vr(),Qr;os=0}}}endDrawing(){ws(this,zr,Pl).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const Br of this._cachedBitmapsMap.values()){for(const Ur of Br.values())typeof HTMLCanvasElement<"u"&&Ur instanceof HTMLCanvasElement&&(Ur.width=Ur.height=0);Br.clear()}this._cachedBitmapsMap.clear(),ws(this,zr,Dl).call(this)}_scaleImage(Br,Ur){const Vr=Br.width,Xr=Br.height;let Zr=Math.max(Math.hypot(Ur[0],Ur[1]),1),Jr=Math.max(Math.hypot(Ur[2],Ur[3]),1),Qr=Vr,ga=Xr,ba="prescale1",_i,os;for(;Zr>2&&Qr>1||Jr>2&&ga>1;){let ls=Qr,ys=ga;Zr>2&&Qr>1&&(ls=Qr>=16384?Math.floor(Qr/2)-1||1:Math.ceil(Qr/2),Zr/=Qr/ls),Jr>2&&ga>1&&(ys=ga>=16384?Math.floor(ga/2)-1||1:Math.ceil(ga)/2,Jr/=ga/ys),_i=this.cachedCanvases.getCanvas(ba,ls,ys),os=_i.context,os.clearRect(0,0,ls,ys),os.drawImage(Br,0,0,Qr,ga,0,0,ls,ys),Br=_i.canvas,Qr=ls,ga=ys,ba=ba==="prescale1"?"prescale2":"prescale1"}return{img:Br,paintWidth:Qr,paintHeight:ga}}_createMaskCanvas(Br){const Ur=this.ctx,{width:Vr,height:Xr}=Br,Zr=this.current.fillColor,Jr=this.current.patternFill,Qr=(0,cr.getCurrentTransform)(Ur);let ga,ba,_i,os;if((Br.bitmap||Br.data)&&Br.count>1){const fs=Br.bitmap||Br.data.buffer;ba=JSON.stringify(Jr?Qr:[Qr.slice(0,4),Zr]),ga=this._cachedBitmapsMap.get(fs),ga||(ga=new Map,this._cachedBitmapsMap.set(fs,ga));const Is=ga.get(ba);if(Is&&!Jr){const Os=Math.round(Math.min(Qr[0],Qr[2])+Qr[4]),Us=Math.round(Math.min(Qr[1],Qr[3])+Qr[5]);return{canvas:Is,offsetX:Os,offsetY:Us}}_i=Is}_i||(os=this.cachedCanvases.getCanvas("maskCanvas",Vr,Xr),Tr(os.context,Br));let ls=ur.Util.transform(Qr,[1/Vr,0,0,-1/Xr,0,0]);ls=ur.Util.transform(ls,[1,0,0,1,0,-Xr]);const ys=ur.Util.applyTransform([0,0],ls),ns=ur.Util.applyTransform([Vr,Xr],ls),as=ur.Util.normalizeRect([ys[0],ys[1],ns[0],ns[1]]),Kr=Math.round(as[2]-as[0])||1,$a=Math.round(as[3]-as[1])||1,ss=this.cachedCanvases.getCanvas("fillCanvas",Kr,$a),hs=ss.context,vs=Math.min(ys[0],ns[0]),bs=Math.min(ys[1],ns[1]);hs.translate(-vs,-bs),hs.transform(...ls),_i||(_i=this._scaleImage(os.canvas,(0,cr.getCurrentTransformInverse)(hs)),_i=_i.img,ga&&Jr&&ga.set(ba,_i)),hs.imageSmoothingEnabled=Or((0,cr.getCurrentTransform)(hs),Br.interpolate),Sr(hs,_i,0,0,_i.width,_i.height,0,0,Vr,Xr),hs.globalCompositeOperation="source-in";const xs=ur.Util.transform((0,cr.getCurrentTransformInverse)(hs),[1,0,0,1,-vs,-bs]);return hs.fillStyle=Jr?Zr.getPattern(Ur,this,xs,hr.PathType.FILL):Zr,hs.fillRect(0,0,Vr,Xr),ga&&!Jr&&(this.cachedCanvases.delete("fillCanvas"),ga.set(ba,ss.canvas)),{canvas:ss.canvas,offsetX:Math.round(vs),offsetY:Math.round(bs)}}setLineWidth(Br){Br!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=Br,this.ctx.lineWidth=Br}setLineCap(Br){this.ctx.lineCap=Ir[Br]}setLineJoin(Br){this.ctx.lineJoin=Mr[Br]}setMiterLimit(Br){this.ctx.miterLimit=Br}setDash(Br,Ur){const Vr=this.ctx;Vr.setLineDash!==void 0&&(Vr.setLineDash(Br),Vr.lineDashOffset=Ur)}setRenderingIntent(Br){}setFlatness(Br){}setGState(Br){for(const[Ur,Vr]of Br)switch(Ur){case"LW":this.setLineWidth(Vr);break;case"LC":this.setLineCap(Vr);break;case"LJ":this.setLineJoin(Vr);break;case"ML":this.setMiterLimit(Vr);break;case"D":this.setDash(Vr[0],Vr[1]);break;case"RI":this.setRenderingIntent(Vr);break;case"FL":this.setFlatness(Vr);break;case"Font":this.setFont(Vr[0],Vr[1]);break;case"CA":this.current.strokeAlpha=Vr;break;case"ca":this.current.fillAlpha=Vr,this.ctx.globalAlpha=Vr;break;case"BM":this.ctx.globalCompositeOperation=Vr;break;case"SMask":this.current.activeSMask=Vr?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(Vr);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const Br=this.inSMaskMode;this.current.activeSMask&&!Br?this.beginSMaskMode():!this.current.activeSMask&&Br&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const Br=this.ctx.canvas.width,Ur=this.ctx.canvas.height,Vr="smaskGroupAt"+this.groupLevel,Xr=this.cachedCanvases.getCanvas(Vr,Br,Ur);this.suspendedCtx=this.ctx,this.ctx=Xr.context;const Zr=this.ctx;Zr.setTransform(...(0,cr.getCurrentTransform)(this.suspendedCtx)),Rr(this.suspendedCtx,Zr),xr(Zr,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Rr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(Br){if(!this.current.activeSMask)return;Br?(Br[0]=Math.floor(Br[0]),Br[1]=Math.floor(Br[1]),Br[2]=Math.ceil(Br[2]),Br[3]=Math.ceil(Br[3])):Br=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const Ur=this.current.activeSMask,Vr=this.suspendedCtx;Lr(Vr,Ur,this.ctx,Br),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(Rr(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const Br=this.current;this.stateStack.push(Br),this.current=Br.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),Rr(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(Br,Ur,Vr,Xr,Zr,Jr){this.ctx.transform(Br,Ur,Vr,Xr,Zr,Jr),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(Br,Ur,Vr){const Xr=this.ctx,Zr=this.current;let Jr=Zr.x,Qr=Zr.y,ga,ba;const _i=(0,cr.getCurrentTransform)(Xr),os=_i[0]===0&&_i[3]===0||_i[1]===0&&_i[2]===0,ls=os?Vr.slice(0):null;for(let ys=0,ns=0,as=Br.length;ys<as;ys++)switch(Br[ys]|0){case ur.OPS.rectangle:Jr=Ur[ns++],Qr=Ur[ns++];const Kr=Ur[ns++],$a=Ur[ns++],ss=Jr+Kr,hs=Qr+$a;Xr.moveTo(Jr,Qr),Kr===0||$a===0?Xr.lineTo(ss,hs):(Xr.lineTo(ss,Qr),Xr.lineTo(ss,hs),Xr.lineTo(Jr,hs)),os||Zr.updateRectMinMax(_i,[Jr,Qr,ss,hs]),Xr.closePath();break;case ur.OPS.moveTo:Jr=Ur[ns++],Qr=Ur[ns++],Xr.moveTo(Jr,Qr),os||Zr.updatePathMinMax(_i,Jr,Qr);break;case ur.OPS.lineTo:Jr=Ur[ns++],Qr=Ur[ns++],Xr.lineTo(Jr,Qr),os||Zr.updatePathMinMax(_i,Jr,Qr);break;case ur.OPS.curveTo:ga=Jr,ba=Qr,Jr=Ur[ns+4],Qr=Ur[ns+5],Xr.bezierCurveTo(Ur[ns],Ur[ns+1],Ur[ns+2],Ur[ns+3],Jr,Qr),Zr.updateCurvePathMinMax(_i,ga,ba,Ur[ns],Ur[ns+1],Ur[ns+2],Ur[ns+3],Jr,Qr,ls),ns+=6;break;case ur.OPS.curveTo2:ga=Jr,ba=Qr,Xr.bezierCurveTo(Jr,Qr,Ur[ns],Ur[ns+1],Ur[ns+2],Ur[ns+3]),Zr.updateCurvePathMinMax(_i,ga,ba,Jr,Qr,Ur[ns],Ur[ns+1],Ur[ns+2],Ur[ns+3],ls),Jr=Ur[ns+2],Qr=Ur[ns+3],ns+=4;break;case ur.OPS.curveTo3:ga=Jr,ba=Qr,Jr=Ur[ns+2],Qr=Ur[ns+3],Xr.bezierCurveTo(Ur[ns],Ur[ns+1],Jr,Qr,Jr,Qr),Zr.updateCurvePathMinMax(_i,ga,ba,Ur[ns],Ur[ns+1],Jr,Qr,Jr,Qr,ls),ns+=4;break;case ur.OPS.closePath:Xr.closePath();break}os&&Zr.updateScalingPathMinMax(_i,ls),Zr.setCurrentPoint(Jr,Qr)}closePath(){this.ctx.closePath()}stroke(Br=!0){const Ur=this.ctx,Vr=this.current.strokeColor;Ur.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof Vr=="object"&&(Vr!=null&&Vr.getPattern)?(Ur.save(),Ur.strokeStyle=Vr.getPattern(Ur,this,(0,cr.getCurrentTransformInverse)(Ur),hr.PathType.STROKE),this.rescaleAndStroke(!1),Ur.restore()):this.rescaleAndStroke(!0)),Br&&this.consumePath(this.current.getClippedPathBoundingBox()),Ur.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(Br=!0){const Ur=this.ctx,Vr=this.current.fillColor,Xr=this.current.patternFill;let Zr=!1;Xr&&(Ur.save(),Ur.fillStyle=Vr.getPattern(Ur,this,(0,cr.getCurrentTransformInverse)(Ur),hr.PathType.FILL),Zr=!0);const Jr=this.current.getClippedPathBoundingBox();this.contentVisible&&Jr!==null&&(this.pendingEOFill?(Ur.fill("evenodd"),this.pendingEOFill=!1):Ur.fill()),Zr&&Ur.restore(),Br&&this.consumePath(Jr)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=$r}eoClip(){this.pendingClip=jr}beginText(){this.current.textMatrix=ur.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const Br=this.pendingTextPaths,Ur=this.ctx;if(Br===void 0){Ur.beginPath();return}Ur.save(),Ur.beginPath();for(const Vr of Br)Ur.setTransform(...Vr.transform),Ur.translate(Vr.x,Vr.y),Vr.addToPath(Ur,Vr.fontSize);Ur.restore(),Ur.clip(),Ur.beginPath(),delete this.pendingTextPaths}setCharSpacing(Br){this.current.charSpacing=Br}setWordSpacing(Br){this.current.wordSpacing=Br}setHScale(Br){this.current.textHScale=Br/100}setLeading(Br){this.current.leading=-Br}setFont(Br,Ur){var _i;const Vr=this.commonObjs.get(Br),Xr=this.current;if(!Vr)throw new Error(`Can't find font for ${Br}`);if(Xr.fontMatrix=Vr.fontMatrix||ur.FONT_IDENTITY_MATRIX,(Xr.fontMatrix[0]===0||Xr.fontMatrix[3]===0)&&(0,ur.warn)("Invalid font matrix for font "+Br),Ur<0?(Ur=-Ur,Xr.fontDirection=-1):Xr.fontDirection=1,this.current.font=Vr,this.current.fontSize=Ur,Vr.isType3Font)return;const Zr=Vr.loadedName||"sans-serif",Jr=((_i=Vr.systemFontInfo)==null?void 0:_i.css)||`"${Zr}", ${Vr.fallbackName}`;let Qr="normal";Vr.black?Qr="900":Vr.bold&&(Qr="bold");const ga=Vr.italic?"italic":"normal";let ba=Ur;Ur<fr?ba=fr:Ur>pr&&(ba=pr),this.current.fontSizeScale=Ur/ba,this.ctx.font=`${ga} ${Qr} ${ba}px ${Jr}`}setTextRenderingMode(Br){this.current.textRenderingMode=Br}setTextRise(Br){this.current.textRise=Br}moveText(Br,Ur){this.current.x=this.current.lineX+=Br,this.current.y=this.current.lineY+=Ur}setLeadingMoveText(Br,Ur){this.setLeading(-Ur),this.moveText(Br,Ur)}setTextMatrix(Br,Ur,Vr,Xr,Zr,Jr){this.current.textMatrix=[Br,Ur,Vr,Xr,Zr,Jr],this.current.textMatrixScale=Math.hypot(Br,Ur),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(Br,Ur,Vr,Xr){const Zr=this.ctx,Jr=this.current,Qr=Jr.font,ga=Jr.textRenderingMode,ba=Jr.fontSize/Jr.fontSizeScale,_i=ga&ur.TextRenderingMode.FILL_STROKE_MASK,os=!!(ga&ur.TextRenderingMode.ADD_TO_PATH_FLAG),ls=Jr.patternFill&&!Qr.missingFile;let ys;(Qr.disableFontFace||os||ls)&&(ys=Qr.getPathGenerator(this.commonObjs,Br)),Qr.disableFontFace||ls?(Zr.save(),Zr.translate(Ur,Vr),Zr.beginPath(),ys(Zr,ba),Xr&&Zr.setTransform(...Xr),(_i===ur.TextRenderingMode.FILL||_i===ur.TextRenderingMode.FILL_STROKE)&&Zr.fill(),(_i===ur.TextRenderingMode.STROKE||_i===ur.TextRenderingMode.FILL_STROKE)&&Zr.stroke(),Zr.restore()):((_i===ur.TextRenderingMode.FILL||_i===ur.TextRenderingMode.FILL_STROKE)&&Zr.fillText(Br,Ur,Vr),(_i===ur.TextRenderingMode.STROKE||_i===ur.TextRenderingMode.FILL_STROKE)&&Zr.strokeText(Br,Ur,Vr)),os&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,cr.getCurrentTransform)(Zr),x:Ur,y:Vr,fontSize:ba,addToPath:ys})}get isFontSubpixelAAEnabled(){const{context:Br}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);Br.scale(1.5,1),Br.fillText("I",0,10);const Ur=Br.getImageData(0,0,10,10).data;let Vr=!1;for(let Xr=3;Xr<Ur.length;Xr+=4)if(Ur[Xr]>0&&Ur[Xr]<255){Vr=!0;break}return(0,ur.shadow)(this,"isFontSubpixelAAEnabled",Vr)}showText(Br){const Ur=this.current,Vr=Ur.font;if(Vr.isType3Font)return this.showType3Text(Br);const Xr=Ur.fontSize;if(Xr===0)return;const Zr=this.ctx,Jr=Ur.fontSizeScale,Qr=Ur.charSpacing,ga=Ur.wordSpacing,ba=Ur.fontDirection,_i=Ur.textHScale*ba,os=Br.length,ls=Vr.vertical,ys=ls?1:-1,ns=Vr.defaultVMetrics,as=Xr*Ur.fontMatrix[0],Kr=Ur.textRenderingMode===ur.TextRenderingMode.FILL&&!Vr.disableFontFace&&!Ur.patternFill;Zr.save(),Zr.transform(...Ur.textMatrix),Zr.translate(Ur.x,Ur.y+Ur.textRise),ba>0?Zr.scale(_i,-1):Zr.scale(_i,1);let $a;if(Ur.patternFill){Zr.save();const xs=Ur.fillColor.getPattern(Zr,this,(0,cr.getCurrentTransformInverse)(Zr),hr.PathType.FILL);$a=(0,cr.getCurrentTransform)(Zr),Zr.restore(),Zr.fillStyle=xs}let ss=Ur.lineWidth;const hs=Ur.textMatrixScale;if(hs===0||ss===0){const xs=Ur.textRenderingMode&ur.TextRenderingMode.FILL_STROKE_MASK;(xs===ur.TextRenderingMode.STROKE||xs===ur.TextRenderingMode.FILL_STROKE)&&(ss=this.getSinglePixelWidth())}else ss/=hs;if(Jr!==1&&(Zr.scale(Jr,Jr),ss/=Jr),Zr.lineWidth=ss,Vr.isInvalidPDFjsFont){const xs=[];let fs=0;for(const Is of Br)xs.push(Is.unicode),fs+=Is.width;Zr.fillText(xs.join(""),0,0),Ur.x+=fs*as*_i,Zr.restore(),this.compose();return}let vs=0,bs;for(bs=0;bs<os;++bs){const xs=Br[bs];if(typeof xs=="number"){vs+=ys*xs*Xr/1e3;continue}let fs=!1;const Is=(xs.isSpace?ga:0)+Qr,Os=xs.fontChar,Us=xs.accent;let $s,Bs,Ns=xs.width;if(ls){const na=xs.vmetric||ns,ds=-(xs.vmetric?na[1]:Ns*.5)*as,is=na[2]*as;Ns=na?-na[0]:Ns,$s=ds/Jr,Bs=(vs+is)/Jr}else $s=vs/Jr,Bs=0;if(Vr.remeasure&&Ns>0){const na=Zr.measureText(Os).width*1e3/Xr*Jr;if(Ns<na&&this.isFontSubpixelAAEnabled){const ds=Ns/na;fs=!0,Zr.save(),Zr.scale(ds,1),$s/=ds}else Ns!==na&&($s+=(Ns-na)/2e3*Xr/Jr)}if(this.contentVisible&&(xs.isInFont||Vr.missingFile)){if(Kr&&!Us)Zr.fillText(Os,$s,Bs);else if(this.paintChar(Os,$s,Bs,$a),Us){const na=$s+Xr*Us.offset.x/Jr,ds=Bs-Xr*Us.offset.y/Jr;this.paintChar(Us.fontChar,na,ds,$a)}}const us=ls?Ns*as-Is*ba:Ns*as+Is*ba;vs+=us,fs&&Zr.restore()}ls?Ur.y-=vs:Ur.x+=vs*_i,Zr.restore(),this.compose()}showType3Text(Br){const Ur=this.ctx,Vr=this.current,Xr=Vr.font,Zr=Vr.fontSize,Jr=Vr.fontDirection,Qr=Xr.vertical?1:-1,ga=Vr.charSpacing,ba=Vr.wordSpacing,_i=Vr.textHScale*Jr,os=Vr.fontMatrix||ur.FONT_IDENTITY_MATRIX,ls=Br.length,ys=Vr.textRenderingMode===ur.TextRenderingMode.INVISIBLE;let ns,as,Kr,$a;if(!(ys||Zr===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,Ur.save(),Ur.transform(...Vr.textMatrix),Ur.translate(Vr.x,Vr.y),Ur.scale(_i,Jr),ns=0;ns<ls;++ns){if(as=Br[ns],typeof as=="number"){$a=Qr*as*Zr/1e3,this.ctx.translate($a,0),Vr.x+=$a*_i;continue}const ss=(as.isSpace?ba:0)+ga,hs=Xr.charProcOperatorList[as.operatorListId];if(!hs){(0,ur.warn)(`Type3 character "${as.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=as,this.save(),Ur.scale(Zr,Zr),Ur.transform(...os),this.executeOperatorList(hs),this.restore()),Kr=ur.Util.applyTransform([as.width,0],os)[0]*Zr+ss,Ur.translate(Kr,0),Vr.x+=Kr*_i}Ur.restore(),this.processingType3=null}}setCharWidth(Br,Ur){}setCharWidthAndBounds(Br,Ur,Vr,Xr,Zr,Jr){this.ctx.rect(Vr,Xr,Zr-Vr,Jr-Xr),this.ctx.clip(),this.endPath()}getColorN_Pattern(Br){let Ur;if(Br[0]==="TilingPattern"){const Vr=Br[1],Xr=this.baseTransform||(0,cr.getCurrentTransform)(this.ctx),Zr={createCanvasGraphics:Jr=>new Yr(Jr,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};Ur=new hr.TilingPattern(Br,Vr,this.ctx,Zr,Xr)}else Ur=this._getPattern(Br[1],Br[2]);return Ur}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(Br,Ur,Vr){const Xr=ur.Util.makeHexColor(Br,Ur,Vr);this.ctx.strokeStyle=Xr,this.current.strokeColor=Xr}setFillRGBColor(Br,Ur,Vr){const Xr=ur.Util.makeHexColor(Br,Ur,Vr);this.ctx.fillStyle=Xr,this.current.fillColor=Xr,this.current.patternFill=!1}_getPattern(Br,Ur=null){let Vr;return this.cachedPatterns.has(Br)?Vr=this.cachedPatterns.get(Br):(Vr=(0,hr.getShadingPattern)(this.getObject(Br)),this.cachedPatterns.set(Br,Vr)),Ur&&(Vr.matrix=Ur),Vr}shadingFill(Br){if(!this.contentVisible)return;const Ur=this.ctx;this.save();const Vr=this._getPattern(Br);Ur.fillStyle=Vr.getPattern(Ur,this,(0,cr.getCurrentTransformInverse)(Ur),hr.PathType.SHADING);const Xr=(0,cr.getCurrentTransformInverse)(Ur);if(Xr){const{width:Zr,height:Jr}=Ur.canvas,[Qr,ga,ba,_i]=ur.Util.getAxialAlignedBoundingBox([0,0,Zr,Jr],Xr);this.ctx.fillRect(Qr,ga,ba-Qr,_i-ga)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,ur.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,ur.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(Br,Ur){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(Br)&&Br.length===6&&this.transform(...Br),this.baseTransform=(0,cr.getCurrentTransform)(this.ctx),Ur)){const Vr=Ur[2]-Ur[0],Xr=Ur[3]-Ur[1];this.ctx.rect(Ur[0],Ur[1],Vr,Xr),this.current.updateRectMinMax((0,cr.getCurrentTransform)(this.ctx),Ur),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(Br){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const Ur=this.ctx;Br.isolated||(0,ur.info)("TODO: Support non-isolated groups."),Br.knockout&&(0,ur.warn)("Knockout groups not supported.");const Vr=(0,cr.getCurrentTransform)(Ur);if(Br.matrix&&Ur.transform(...Br.matrix),!Br.bbox)throw new Error("Bounding box is required.");let Xr=ur.Util.getAxialAlignedBoundingBox(Br.bbox,(0,cr.getCurrentTransform)(Ur));const Zr=[0,0,Ur.canvas.width,Ur.canvas.height];Xr=ur.Util.intersect(Xr,Zr)||[0,0,0,0];const Jr=Math.floor(Xr[0]),Qr=Math.floor(Xr[1]);let ga=Math.max(Math.ceil(Xr[2])-Jr,1),ba=Math.max(Math.ceil(Xr[3])-Qr,1),_i=1,os=1;ga>vr&&(_i=ga/vr,ga=vr),ba>vr&&(os=ba/vr,ba=vr),this.current.startNewPathAndClipBox([0,0,ga,ba]);let ls="groupAt"+this.groupLevel;Br.smask&&(ls+="_smask_"+this.smaskCounter++%2);const ys=this.cachedCanvases.getCanvas(ls,ga,ba),ns=ys.context;ns.scale(1/_i,1/os),ns.translate(-Jr,-Qr),ns.transform(...Vr),Br.smask?this.smaskStack.push({canvas:ys.canvas,context:ns,offsetX:Jr,offsetY:Qr,scaleX:_i,scaleY:os,subtype:Br.smask.subtype,backdrop:Br.smask.backdrop,transferMap:Br.smask.transferMap||null,startTransformInverse:null}):(Ur.setTransform(1,0,0,1,0,0),Ur.translate(Jr,Qr),Ur.scale(_i,os),Ur.save()),Rr(Ur,ns),this.ctx=ns,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(Ur),this.groupLevel++}endGroup(Br){if(!this.contentVisible)return;this.groupLevel--;const Ur=this.ctx,Vr=this.groupStack.pop();if(this.ctx=Vr,this.ctx.imageSmoothingEnabled=!1,Br.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Xr=(0,cr.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Xr);const Zr=ur.Util.getAxialAlignedBoundingBox([0,0,Ur.canvas.width,Ur.canvas.height],Xr);this.ctx.drawImage(Ur.canvas,0,0),this.ctx.restore(),this.compose(Zr)}}beginAnnotation(Br,Ur,Vr,Xr,Zr){if(ws(this,zr,Pl).call(this),Pr(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(Ur)&&Ur.length===4){const Jr=Ur[2]-Ur[0],Qr=Ur[3]-Ur[1];if(Zr&&this.annotationCanvasMap){Vr=Vr.slice(),Vr[4]-=Ur[0],Vr[5]-=Ur[1],Ur=Ur.slice(),Ur[0]=Ur[1]=0,Ur[2]=Jr,Ur[3]=Qr;const[ga,ba]=ur.Util.singularValueDecompose2dScale((0,cr.getCurrentTransform)(this.ctx)),{viewportScale:_i}=this,os=Math.ceil(Jr*this.outputScaleX*_i),ls=Math.ceil(Qr*this.outputScaleY*_i);this.annotationCanvas=this.canvasFactory.create(os,ls);const{canvas:ys,context:ns}=this.annotationCanvas;this.annotationCanvasMap.set(Br,ys),this.annotationCanvas.savedCtx=this.ctx,this.ctx=ns,this.ctx.save(),this.ctx.setTransform(ga,0,0,-ba,0,Qr*ba),Pr(this.ctx)}else Pr(this.ctx),this.ctx.rect(Ur[0],Ur[1],Jr,Qr),this.ctx.clip(),this.endPath()}this.current=new Er(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...Vr),this.transform(...Xr)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),ws(this,zr,Dl).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(Br){if(!this.contentVisible)return;const Ur=Br.count;Br=this.getObject(Br.data,Br),Br.count=Ur;const Vr=this.ctx,Xr=this.processingType3;if(Xr&&(Xr.compiled===void 0&&(Xr.compiled=wr(Br)),Xr.compiled)){Xr.compiled(Vr);return}const Zr=this._createMaskCanvas(Br),Jr=Zr.canvas;Vr.save(),Vr.setTransform(1,0,0,1,0,0),Vr.drawImage(Jr,Zr.offsetX,Zr.offsetY),Vr.restore(),this.compose()}paintImageMaskXObjectRepeat(Br,Ur,Vr=0,Xr=0,Zr,Jr){if(!this.contentVisible)return;Br=this.getObject(Br.data,Br);const Qr=this.ctx;Qr.save();const ga=(0,cr.getCurrentTransform)(Qr);Qr.transform(Ur,Vr,Xr,Zr,0,0);const ba=this._createMaskCanvas(Br);Qr.setTransform(1,0,0,1,ba.offsetX-ga[4],ba.offsetY-ga[5]);for(let _i=0,os=Jr.length;_i<os;_i+=2){const ls=ur.Util.transform(ga,[Ur,Vr,Xr,Zr,Jr[_i],Jr[_i+1]]),[ys,ns]=ur.Util.applyTransform([0,0],ls);Qr.drawImage(ba.canvas,ys,ns)}Qr.restore(),this.compose()}paintImageMaskXObjectGroup(Br){if(!this.contentVisible)return;const Ur=this.ctx,Vr=this.current.fillColor,Xr=this.current.patternFill;for(const Zr of Br){const{data:Jr,width:Qr,height:ga,transform:ba}=Zr,_i=this.cachedCanvases.getCanvas("maskCanvas",Qr,ga),os=_i.context;os.save();const ls=this.getObject(Jr,Zr);Tr(os,ls),os.globalCompositeOperation="source-in",os.fillStyle=Xr?Vr.getPattern(os,this,(0,cr.getCurrentTransformInverse)(Ur),hr.PathType.FILL):Vr,os.fillRect(0,0,Qr,ga),os.restore(),Ur.save(),Ur.transform(...ba),Ur.scale(1,-1),Sr(Ur,_i.canvas,0,0,Qr,ga,0,-1,1,1),Ur.restore()}this.compose()}paintImageXObject(Br){if(!this.contentVisible)return;const Ur=this.getObject(Br);if(!Ur){(0,ur.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(Ur)}paintImageXObjectRepeat(Br,Ur,Vr,Xr){if(!this.contentVisible)return;const Zr=this.getObject(Br);if(!Zr){(0,ur.warn)("Dependent image isn't ready yet");return}const Jr=Zr.width,Qr=Zr.height,ga=[];for(let ba=0,_i=Xr.length;ba<_i;ba+=2)ga.push({transform:[Ur,0,0,Vr,Xr[ba],Xr[ba+1]],x:0,y:0,w:Jr,h:Qr});this.paintInlineImageXObjectGroup(Zr,ga)}applyTransferMapsToCanvas(Br){return this.current.transferMaps!=="none"&&(Br.filter=this.current.transferMaps,Br.drawImage(Br.canvas,0,0),Br.filter="none"),Br.canvas}applyTransferMapsToBitmap(Br){if(this.current.transferMaps==="none")return Br.bitmap;const{bitmap:Ur,width:Vr,height:Xr}=Br,Zr=this.cachedCanvases.getCanvas("inlineImage",Vr,Xr),Jr=Zr.context;return Jr.filter=this.current.transferMaps,Jr.drawImage(Ur,0,0),Jr.filter="none",Zr.canvas}paintInlineImageXObject(Br){if(!this.contentVisible)return;const Ur=Br.width,Vr=Br.height,Xr=this.ctx;if(this.save(),!ur.isNodeJS){const{filter:Qr}=Xr;Qr!=="none"&&Qr!==""&&(Xr.filter="none")}Xr.scale(1/Ur,-1/Vr);let Zr;if(Br.bitmap)Zr=this.applyTransferMapsToBitmap(Br);else if(typeof HTMLElement=="function"&&Br instanceof HTMLElement||!Br.data)Zr=Br;else{const ga=this.cachedCanvases.getCanvas("inlineImage",Ur,Vr).context;Ar(ga,Br),Zr=this.applyTransferMapsToCanvas(ga)}const Jr=this._scaleImage(Zr,(0,cr.getCurrentTransformInverse)(Xr));Xr.imageSmoothingEnabled=Or((0,cr.getCurrentTransform)(Xr),Br.interpolate),Sr(Xr,Jr.img,0,0,Jr.paintWidth,Jr.paintHeight,0,-Vr,Ur,Vr),this.compose(),this.restore()}paintInlineImageXObjectGroup(Br,Ur){if(!this.contentVisible)return;const Vr=this.ctx;let Xr;if(Br.bitmap)Xr=Br.bitmap;else{const Zr=Br.width,Jr=Br.height,ga=this.cachedCanvases.getCanvas("inlineImage",Zr,Jr).context;Ar(ga,Br),Xr=this.applyTransferMapsToCanvas(ga)}for(const Zr of Ur)Vr.save(),Vr.transform(...Zr.transform),Vr.scale(1,-1),Sr(Vr,Xr,Zr.x,Zr.y,Zr.w,Zr.h,0,-1,1,1),Vr.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(Br){}markPointProps(Br,Ur){}beginMarkedContent(Br){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(Br,Ur){Br==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(Ur)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(Br){const Ur=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(Br);const Vr=this.ctx;this.pendingClip&&(Ur||(this.pendingClip===jr?Vr.clip("evenodd"):Vr.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),Vr.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const Br=(0,cr.getCurrentTransform)(this.ctx);if(Br[1]===0&&Br[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(Br[0]),Math.abs(Br[3]));else{const Ur=Math.abs(Br[0]*Br[3]-Br[2]*Br[1]),Vr=Math.hypot(Br[0],Br[2]),Xr=Math.hypot(Br[1],Br[3]);this._cachedGetSinglePixelWidth=Math.max(Vr,Xr)/Ur}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:Br}=this.current,{a:Ur,b:Vr,c:Xr,d:Zr}=this.ctx.getTransform();let Jr,Qr;if(Vr===0&&Xr===0){const ga=Math.abs(Ur),ba=Math.abs(Zr);if(ga===ba)if(Br===0)Jr=Qr=1/ga;else{const _i=ga*Br;Jr=Qr=_i<1?1/_i:1}else if(Br===0)Jr=1/ga,Qr=1/ba;else{const _i=ga*Br,os=ba*Br;Jr=_i<1?1/_i:1,Qr=os<1?1/os:1}}else{const ga=Math.abs(Ur*Zr-Vr*Xr),ba=Math.hypot(Ur,Vr),_i=Math.hypot(Xr,Zr);if(Br===0)Jr=_i/ga,Qr=ba/ga;else{const os=Br*ga;Jr=_i>os?_i/os:1,Qr=ba>os?ba/os:1}}this._cachedScaleForStroking[0]=Jr,this._cachedScaleForStroking[1]=Qr}return this._cachedScaleForStroking}rescaleAndStroke(Br){const{ctx:Ur}=this,{lineWidth:Vr}=this.current,[Xr,Zr]=this.getScaleForStroking();if(Ur.lineWidth=Vr||1,Xr===1&&Zr===1){Ur.stroke();return}const Jr=Ur.getLineDash();if(Br&&Ur.save(),Ur.scale(Xr,Zr),Jr.length>0){const Qr=Math.max(Xr,Zr);Ur.setLineDash(Jr.map(ga=>ga/Qr)),Ur.lineDashOffset/=Qr}Ur.stroke(),Br&&Ur.restore()}isContentVisible(){for(let Br=this.markedContentStack.length-1;Br>=0;Br--)if(!this.markedContentStack[Br].visible)return!1;return!0}};zr=new WeakSet,Pl=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},Dl=function(){if(this.pageColors){const Br=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(Br!=="none"){const Ur=this.ctx.filter;this.ctx.filter=Br,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=Ur}}};let Fr=Yr;ar.CanvasGraphics=Fr;for(const qr in ur.OPS)Fr.prototype[qr]!==void 0&&(Fr.prototype[ur.OPS[qr]]=Fr.prototype[qr])},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.TilingPattern=ar.PathType=void 0,ar.getShadingPattern=yr;var ur=lr(1),cr=lr(6);const hr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};ar.PathType=hr;function dr(wr,Er){if(!Er)return;const Ar=Er[2]-Er[0],Tr=Er[3]-Er[1],Rr=new Path2D;Rr.rect(Er[0],Er[1],Ar,Tr),wr.clip(Rr)}class fr{constructor(){this.constructor===fr&&(0,ur.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,ur.unreachable)("Abstract method `getPattern` called.")}}class pr extends fr{constructor(Er){super(),this._type=Er[1],this._bbox=Er[2],this._colorStops=Er[3],this._p0=Er[4],this._p1=Er[5],this._r0=Er[6],this._r1=Er[7],this.matrix=null}_createGradient(Er){let Ar;this._type==="axial"?Ar=Er.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(Ar=Er.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const Tr of this._colorStops)Ar.addColorStop(Tr[0],Tr[1]);return Ar}getPattern(Er,Ar,Tr,Rr){let Pr;if(Rr===hr.STROKE||Rr===hr.FILL){const _r=Ar.current.getClippedPathBoundingBox(Rr,(0,cr.getCurrentTransform)(Er))||[0,0,0,0],kr=Math.ceil(_r[2]-_r[0])||1,Dr=Math.ceil(_r[3]-_r[1])||1,Nr=Ar.cachedCanvases.getCanvas("pattern",kr,Dr,!0),Lr=Nr.context;Lr.clearRect(0,0,Lr.canvas.width,Lr.canvas.height),Lr.beginPath(),Lr.rect(0,0,Lr.canvas.width,Lr.canvas.height),Lr.translate(-_r[0],-_r[1]),Tr=ur.Util.transform(Tr,[1,0,0,1,_r[0],_r[1]]),Lr.transform(...Ar.baseTransform),this.matrix&&Lr.transform(...this.matrix),dr(Lr,this._bbox),Lr.fillStyle=this._createGradient(Lr),Lr.fill(),Pr=Er.createPattern(Nr.canvas,"no-repeat");const Or=new DOMMatrix(Tr);Pr.setTransform(Or)}else dr(Er,this._bbox),Pr=this._createGradient(Er);return Pr}}function vr(wr,Er,Ar,Tr,Rr,Pr,_r,kr){const Dr=Er.coords,Nr=Er.colors,Lr=wr.data,Or=wr.width*4;let Ir;Dr[Ar+1]>Dr[Tr+1]&&(Ir=Ar,Ar=Tr,Tr=Ir,Ir=Pr,Pr=_r,_r=Ir),Dr[Tr+1]>Dr[Rr+1]&&(Ir=Tr,Tr=Rr,Rr=Ir,Ir=_r,_r=kr,kr=Ir),Dr[Ar+1]>Dr[Tr+1]&&(Ir=Ar,Ar=Tr,Tr=Ir,Ir=Pr,Pr=_r,_r=Ir);const Mr=(Dr[Ar]+Er.offsetX)*Er.scaleX,$r=(Dr[Ar+1]+Er.offsetY)*Er.scaleY,jr=(Dr[Tr]+Er.offsetX)*Er.scaleX,Fr=(Dr[Tr+1]+Er.offsetY)*Er.scaleY,zr=(Dr[Rr]+Er.offsetX)*Er.scaleX,Hr=(Dr[Rr+1]+Er.offsetY)*Er.scaleY;if($r>=Hr)return;const Wr=Nr[Pr],Yr=Nr[Pr+1],qr=Nr[Pr+2],Br=Nr[_r],Ur=Nr[_r+1],Vr=Nr[_r+2],Xr=Nr[kr],Zr=Nr[kr+1],Jr=Nr[kr+2],Qr=Math.round($r),ga=Math.round(Hr);let ba,_i,os,ls,ys,ns,as,Kr;for(let $a=Qr;$a<=ga;$a++){if($a<Fr){const xs=$a<$r?0:($r-$a)/($r-Fr);ba=Mr-(Mr-jr)*xs,_i=Wr-(Wr-Br)*xs,os=Yr-(Yr-Ur)*xs,ls=qr-(qr-Vr)*xs}else{let xs;$a>Hr?xs=1:Fr===Hr?xs=0:xs=(Fr-$a)/(Fr-Hr),ba=jr-(jr-zr)*xs,_i=Br-(Br-Xr)*xs,os=Ur-(Ur-Zr)*xs,ls=Vr-(Vr-Jr)*xs}let ss;$a<$r?ss=0:$a>Hr?ss=1:ss=($r-$a)/($r-Hr),ys=Mr-(Mr-zr)*ss,ns=Wr-(Wr-Xr)*ss,as=Yr-(Yr-Zr)*ss,Kr=qr-(qr-Jr)*ss;const hs=Math.round(Math.min(ba,ys)),vs=Math.round(Math.max(ba,ys));let bs=Or*$a+hs*4;for(let xs=hs;xs<=vs;xs++)ss=(ba-xs)/(ba-ys),ss<0?ss=0:ss>1&&(ss=1),Lr[bs++]=_i-(_i-ns)*ss|0,Lr[bs++]=os-(os-as)*ss|0,Lr[bs++]=ls-(ls-Kr)*ss|0,Lr[bs++]=255}}function gr(wr,Er,Ar){const Tr=Er.coords,Rr=Er.colors;let Pr,_r;switch(Er.type){case"lattice":const kr=Er.verticesPerRow,Dr=Math.floor(Tr.length/kr)-1,Nr=kr-1;for(Pr=0;Pr<Dr;Pr++){let Lr=Pr*kr;for(let Or=0;Or<Nr;Or++,Lr++)vr(wr,Ar,Tr[Lr],Tr[Lr+1],Tr[Lr+kr],Rr[Lr],Rr[Lr+1],Rr[Lr+kr]),vr(wr,Ar,Tr[Lr+kr+1],Tr[Lr+1],Tr[Lr+kr],Rr[Lr+kr+1],Rr[Lr+1],Rr[Lr+kr])}break;case"triangles":for(Pr=0,_r=Tr.length;Pr<_r;Pr+=3)vr(wr,Ar,Tr[Pr],Tr[Pr+1],Tr[Pr+2],Rr[Pr],Rr[Pr+1],Rr[Pr+2]);break;default:throw new Error("illegal figure")}}class mr extends fr{constructor(Er){super(),this._coords=Er[2],this._colors=Er[3],this._figures=Er[4],this._bounds=Er[5],this._bbox=Er[7],this._background=Er[8],this.matrix=null}_createMeshCanvas(Er,Ar,Tr){const kr=Math.floor(this._bounds[0]),Dr=Math.floor(this._bounds[1]),Nr=Math.ceil(this._bounds[2])-kr,Lr=Math.ceil(this._bounds[3])-Dr,Or=Math.min(Math.ceil(Math.abs(Nr*Er[0]*1.1)),3e3),Ir=Math.min(Math.ceil(Math.abs(Lr*Er[1]*1.1)),3e3),Mr=Nr/Or,$r=Lr/Ir,jr={coords:this._coords,colors:this._colors,offsetX:-kr,offsetY:-Dr,scaleX:1/Mr,scaleY:1/$r},Fr=Or+2*2,zr=Ir+2*2,Hr=Tr.getCanvas("mesh",Fr,zr,!1),Wr=Hr.context,Yr=Wr.createImageData(Or,Ir);if(Ar){const Br=Yr.data;for(let Ur=0,Vr=Br.length;Ur<Vr;Ur+=4)Br[Ur]=Ar[0],Br[Ur+1]=Ar[1],Br[Ur+2]=Ar[2],Br[Ur+3]=255}for(const Br of this._figures)gr(Yr,Br,jr);return Wr.putImageData(Yr,2,2),{canvas:Hr.canvas,offsetX:kr-2*Mr,offsetY:Dr-2*$r,scaleX:Mr,scaleY:$r}}getPattern(Er,Ar,Tr,Rr){dr(Er,this._bbox);let Pr;if(Rr===hr.SHADING)Pr=ur.Util.singularValueDecompose2dScale((0,cr.getCurrentTransform)(Er));else if(Pr=ur.Util.singularValueDecompose2dScale(Ar.baseTransform),this.matrix){const kr=ur.Util.singularValueDecompose2dScale(this.matrix);Pr=[Pr[0]*kr[0],Pr[1]*kr[1]]}const _r=this._createMeshCanvas(Pr,Rr===hr.SHADING?null:this._background,Ar.cachedCanvases);return Rr!==hr.SHADING&&(Er.setTransform(...Ar.baseTransform),this.matrix&&Er.transform(...this.matrix)),Er.translate(_r.offsetX,_r.offsetY),Er.scale(_r.scaleX,_r.scaleY),Er.createPattern(_r.canvas,"no-repeat")}}class br extends fr{getPattern(){return"hotpink"}}function yr(wr){switch(wr[0]){case"RadialAxial":return new pr(wr);case"Mesh":return new mr(wr);case"Dummy":return new br}throw new Error(`Unknown IR type: ${wr[0]}`)}const xr={COLORED:1,UNCOLORED:2},Sr=class Sr{constructor(Er,Ar,Tr,Rr,Pr){this.operatorList=Er[2],this.matrix=Er[3]||[1,0,0,1,0,0],this.bbox=Er[4],this.xstep=Er[5],this.ystep=Er[6],this.paintType=Er[7],this.tilingType=Er[8],this.color=Ar,this.ctx=Tr,this.canvasGraphicsFactory=Rr,this.baseTransform=Pr}createPatternCanvas(Er){const Ar=this.operatorList,Tr=this.bbox,Rr=this.xstep,Pr=this.ystep,_r=this.paintType,kr=this.tilingType,Dr=this.color,Nr=this.canvasGraphicsFactory;(0,ur.info)("TilingType: "+kr);const Lr=Tr[0],Or=Tr[1],Ir=Tr[2],Mr=Tr[3],$r=ur.Util.singularValueDecompose2dScale(this.matrix),jr=ur.Util.singularValueDecompose2dScale(this.baseTransform),Fr=[$r[0]*jr[0],$r[1]*jr[1]],zr=this.getSizeAndScale(Rr,this.ctx.canvas.width,Fr[0]),Hr=this.getSizeAndScale(Pr,this.ctx.canvas.height,Fr[1]),Wr=Er.cachedCanvases.getCanvas("pattern",zr.size,Hr.size,!0),Yr=Wr.context,qr=Nr.createCanvasGraphics(Yr);qr.groupLevel=Er.groupLevel,this.setFillAndStrokeStyleToContext(qr,_r,Dr);let Br=Lr,Ur=Or,Vr=Ir,Xr=Mr;return Lr<0&&(Br=0,Vr+=Math.abs(Lr)),Or<0&&(Ur=0,Xr+=Math.abs(Or)),Yr.translate(-(zr.scale*Br),-(Hr.scale*Ur)),qr.transform(zr.scale,0,0,Hr.scale,0,0),Yr.save(),this.clipBbox(qr,Br,Ur,Vr,Xr),qr.baseTransform=(0,cr.getCurrentTransform)(qr.ctx),qr.executeOperatorList(Ar),qr.endDrawing(),{canvas:Wr.canvas,scaleX:zr.scale,scaleY:Hr.scale,offsetX:Br,offsetY:Ur}}getSizeAndScale(Er,Ar,Tr){Er=Math.abs(Er);const Rr=Math.max(Sr.MAX_PATTERN_SIZE,Ar);let Pr=Math.ceil(Er*Tr);return Pr>=Rr?Pr=Rr:Tr=Pr/Er,{scale:Tr,size:Pr}}clipBbox(Er,Ar,Tr,Rr,Pr){const _r=Rr-Ar,kr=Pr-Tr;Er.ctx.rect(Ar,Tr,_r,kr),Er.current.updateRectMinMax((0,cr.getCurrentTransform)(Er.ctx),[Ar,Tr,Rr,Pr]),Er.clip(),Er.endPath()}setFillAndStrokeStyleToContext(Er,Ar,Tr){const Rr=Er.ctx,Pr=Er.current;switch(Ar){case xr.COLORED:const _r=this.ctx;Rr.fillStyle=_r.fillStyle,Rr.strokeStyle=_r.strokeStyle,Pr.fillColor=_r.fillStyle,Pr.strokeColor=_r.strokeStyle;break;case xr.UNCOLORED:const kr=ur.Util.makeHexColor(Tr[0],Tr[1],Tr[2]);Rr.fillStyle=kr,Rr.strokeStyle=kr,Pr.fillColor=kr,Pr.strokeColor=kr;break;default:throw new ur.FormatError(`Unsupported paint type: ${Ar}`)}}getPattern(Er,Ar,Tr,Rr){let Pr=Tr;Rr!==hr.SHADING&&(Pr=ur.Util.transform(Pr,Ar.baseTransform),this.matrix&&(Pr=ur.Util.transform(Pr,this.matrix)));const _r=this.createPatternCanvas(Ar);let kr=new DOMMatrix(Pr);kr=kr.translate(_r.offsetX,_r.offsetY),kr=kr.scale(1/_r.scaleX,1/_r.scaleY);const Dr=Er.createPattern(_r.canvas,"repeat");return Dr.setTransform(kr),Dr}};Zs(Sr,"MAX_PATTERN_SIZE",3e3);let Cr=Sr;ar.TilingPattern=Cr},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.convertBlackAndWhiteToRGBA=hr,ar.convertToRGBA=cr,ar.grayToRGBA=fr;var ur=lr(1);function cr(pr){switch(pr.kind){case ur.ImageKind.GRAYSCALE_1BPP:return hr(pr);case ur.ImageKind.RGB_24BPP:return dr(pr)}return null}function hr({src:pr,srcPos:vr=0,dest:gr,width:mr,height:br,nonBlackColor:yr=4294967295,inverseDecode:xr=!1}){const Cr=ur.FeatureTest.isLittleEndian?4278190080:255,[Sr,wr]=xr?[yr,Cr]:[Cr,yr],Er=mr>>3,Ar=mr&7,Tr=pr.length;gr=new Uint32Array(gr.buffer);let Rr=0;for(let Pr=0;Pr<br;Pr++){for(const kr=vr+Er;vr<kr;vr++){const Dr=vr<Tr?pr[vr]:255;gr[Rr++]=Dr&128?wr:Sr,gr[Rr++]=Dr&64?wr:Sr,gr[Rr++]=Dr&32?wr:Sr,gr[Rr++]=Dr&16?wr:Sr,gr[Rr++]=Dr&8?wr:Sr,gr[Rr++]=Dr&4?wr:Sr,gr[Rr++]=Dr&2?wr:Sr,gr[Rr++]=Dr&1?wr:Sr}if(Ar===0)continue;const _r=vr<Tr?pr[vr++]:255;for(let kr=0;kr<Ar;kr++)gr[Rr++]=_r&1<<7-kr?wr:Sr}return{srcPos:vr,destPos:Rr}}function dr({src:pr,srcPos:vr=0,dest:gr,destPos:mr=0,width:br,height:yr}){let xr=0;const Cr=pr.length>>2,Sr=new Uint32Array(pr.buffer,vr,Cr);if(ur.FeatureTest.isLittleEndian){for(;xr<Cr-2;xr+=3,mr+=4){const wr=Sr[xr],Er=Sr[xr+1],Ar=Sr[xr+2];gr[mr]=wr|4278190080,gr[mr+1]=wr>>>24|Er<<8|4278190080,gr[mr+2]=Er>>>16|Ar<<16|4278190080,gr[mr+3]=Ar>>>8|4278190080}for(let wr=xr*4,Er=pr.length;wr<Er;wr+=3)gr[mr++]=pr[wr]|pr[wr+1]<<8|pr[wr+2]<<16|4278190080}else{for(;xr<Cr-2;xr+=3,mr+=4){const wr=Sr[xr],Er=Sr[xr+1],Ar=Sr[xr+2];gr[mr]=wr|255,gr[mr+1]=wr<<24|Er>>>8|255,gr[mr+2]=Er<<16|Ar>>>16|255,gr[mr+3]=Ar<<8|255}for(let wr=xr*4,Er=pr.length;wr<Er;wr+=3)gr[mr++]=pr[wr]<<24|pr[wr+1]<<16|pr[wr+2]<<8|255}return{srcPos:vr,destPos:mr}}function fr(pr,vr){if(ur.FeatureTest.isLittleEndian)for(let gr=0,mr=pr.length;gr<mr;gr++)vr[gr]=pr[gr]*65793|4278190080;else for(let gr=0,mr=pr.length;gr<mr;gr++)vr[gr]=pr[gr]*16843008|255}},(or,ar)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.GlobalWorkerOptions=void 0;const lr=Object.create(null);ar.GlobalWorkerOptions=lr,lr.workerPort=null,lr.workerSrc=""},(or,ar,lr)=>{var pr,uu,cu,Bo;Object.defineProperty(ar,"__esModule",{value:!0}),ar.MessageHandler=void 0;var ur=lr(1);const cr={DATA:1,ERROR:2},hr={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function dr(br){switch(br instanceof Error||typeof br=="object"&&br!==null||(0,ur.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),br.name){case"AbortException":return new ur.AbortException(br.message);case"MissingPDFException":return new ur.MissingPDFException(br.message);case"PasswordException":return new ur.PasswordException(br.message,br.code);case"UnexpectedResponseException":return new ur.UnexpectedResponseException(br.message,br.status);case"UnknownErrorException":return new ur.UnknownErrorException(br.message,br.details);default:return new ur.UnknownErrorException(br.message,br.toString())}}class fr{constructor(yr,xr,Cr){Ts(this,pr);this.sourceName=yr,this.targetName=xr,this.comObj=Cr,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=Sr=>{const wr=Sr.data;if(wr.targetName!==this.sourceName)return;if(wr.stream){ws(this,pr,cu).call(this,wr);return}if(wr.callback){const Ar=wr.callbackId,Tr=this.callbackCapabilities[Ar];if(!Tr)throw new Error(`Cannot resolve callback ${Ar}`);if(delete this.callbackCapabilities[Ar],wr.callback===cr.DATA)Tr.resolve(wr.data);else if(wr.callback===cr.ERROR)Tr.reject(dr(wr.reason));else throw new Error("Unexpected callback case");return}const Er=this.actionHandler[wr.action];if(!Er)throw new Error(`Unknown action from worker: ${wr.action}`);if(wr.callbackId){const Ar=this.sourceName,Tr=wr.sourceName;new Promise(function(Rr){Rr(Er(wr.data))}).then(function(Rr){Cr.postMessage({sourceName:Ar,targetName:Tr,callback:cr.DATA,callbackId:wr.callbackId,data:Rr})},function(Rr){Cr.postMessage({sourceName:Ar,targetName:Tr,callback:cr.ERROR,callbackId:wr.callbackId,reason:dr(Rr)})});return}if(wr.streamId){ws(this,pr,uu).call(this,wr);return}Er(wr.data)},Cr.addEventListener("message",this._onComObjOnMessage)}on(yr,xr){const Cr=this.actionHandler;if(Cr[yr])throw new Error(`There is already an actionName called "${yr}"`);Cr[yr]=xr}send(yr,xr,Cr){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:yr,data:xr},Cr)}sendWithPromise(yr,xr,Cr){const Sr=this.callbackId++,wr=new ur.PromiseCapability;this.callbackCapabilities[Sr]=wr;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:yr,callbackId:Sr,data:xr},Cr)}catch(Er){wr.reject(Er)}return wr.promise}sendWithStream(yr,xr,Cr,Sr){const wr=this.streamId++,Er=this.sourceName,Ar=this.targetName,Tr=this.comObj;return new ReadableStream({start:Rr=>{const Pr=new ur.PromiseCapability;return this.streamControllers[wr]={controller:Rr,startCall:Pr,pullCall:null,cancelCall:null,isClosed:!1},Tr.postMessage({sourceName:Er,targetName:Ar,action:yr,streamId:wr,data:xr,desiredSize:Rr.desiredSize},Sr),Pr.promise},pull:Rr=>{const Pr=new ur.PromiseCapability;return this.streamControllers[wr].pullCall=Pr,Tr.postMessage({sourceName:Er,targetName:Ar,stream:hr.PULL,streamId:wr,desiredSize:Rr.desiredSize}),Pr.promise},cancel:Rr=>{(0,ur.assert)(Rr instanceof Error,"cancel must have a valid reason");const Pr=new ur.PromiseCapability;return this.streamControllers[wr].cancelCall=Pr,this.streamControllers[wr].isClosed=!0,Tr.postMessage({sourceName:Er,targetName:Ar,stream:hr.CANCEL,streamId:wr,reason:dr(Rr)}),Pr.promise}},Cr)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}pr=new WeakSet,uu=function(yr){const xr=yr.streamId,Cr=this.sourceName,Sr=yr.sourceName,wr=this.comObj,Er=this,Ar=this.actionHandler[yr.action],Tr={enqueue(Rr,Pr=1,_r){if(this.isCancelled)return;const kr=this.desiredSize;this.desiredSize-=Pr,kr>0&&this.desiredSize<=0&&(this.sinkCapability=new ur.PromiseCapability,this.ready=this.sinkCapability.promise),wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.ENQUEUE,streamId:xr,chunk:Rr},_r)},close(){this.isCancelled||(this.isCancelled=!0,wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.CLOSE,streamId:xr}),delete Er.streamSinks[xr])},error(Rr){(0,ur.assert)(Rr instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.ERROR,streamId:xr,reason:dr(Rr)}))},sinkCapability:new ur.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:yr.desiredSize,ready:null};Tr.sinkCapability.resolve(),Tr.ready=Tr.sinkCapability.promise,this.streamSinks[xr]=Tr,new Promise(function(Rr){Rr(Ar(yr.data,Tr))}).then(function(){wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.START_COMPLETE,streamId:xr,success:!0})},function(Rr){wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.START_COMPLETE,streamId:xr,reason:dr(Rr)})})},cu=function(yr){const xr=yr.streamId,Cr=this.sourceName,Sr=yr.sourceName,wr=this.comObj,Er=this.streamControllers[xr],Ar=this.streamSinks[xr];switch(yr.stream){case hr.START_COMPLETE:yr.success?Er.startCall.resolve():Er.startCall.reject(dr(yr.reason));break;case hr.PULL_COMPLETE:yr.success?Er.pullCall.resolve():Er.pullCall.reject(dr(yr.reason));break;case hr.PULL:if(!Ar){wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.PULL_COMPLETE,streamId:xr,success:!0});break}Ar.desiredSize<=0&&yr.desiredSize>0&&Ar.sinkCapability.resolve(),Ar.desiredSize=yr.desiredSize,new Promise(function(Tr){var Rr;Tr((Rr=Ar.onPull)==null?void 0:Rr.call(Ar))}).then(function(){wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.PULL_COMPLETE,streamId:xr,success:!0})},function(Tr){wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.PULL_COMPLETE,streamId:xr,reason:dr(Tr)})});break;case hr.ENQUEUE:if((0,ur.assert)(Er,"enqueue should have stream controller"),Er.isClosed)break;Er.controller.enqueue(yr.chunk);break;case hr.CLOSE:if((0,ur.assert)(Er,"close should have stream controller"),Er.isClosed)break;Er.isClosed=!0,Er.controller.close(),ws(this,pr,Bo).call(this,Er,xr);break;case hr.ERROR:(0,ur.assert)(Er,"error should have stream controller"),Er.controller.error(dr(yr.reason)),ws(this,pr,Bo).call(this,Er,xr);break;case hr.CANCEL_COMPLETE:yr.success?Er.cancelCall.resolve():Er.cancelCall.reject(dr(yr.reason)),ws(this,pr,Bo).call(this,Er,xr);break;case hr.CANCEL:if(!Ar)break;new Promise(function(Tr){var Rr;Tr((Rr=Ar.onCancel)==null?void 0:Rr.call(Ar,dr(yr.reason)))}).then(function(){wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.CANCEL_COMPLETE,streamId:xr,success:!0})},function(Tr){wr.postMessage({sourceName:Cr,targetName:Sr,stream:hr.CANCEL_COMPLETE,streamId:xr,reason:dr(Tr)})}),Ar.sinkCapability.reject(dr(yr.reason)),Ar.isCancelled=!0,delete this.streamSinks[xr];break;default:throw new Error("Unexpected stream case")}},Bo=async function(yr,xr){var Cr,Sr,wr;await Promise.allSettled([(Cr=yr.startCall)==null?void 0:Cr.promise,(Sr=yr.pullCall)==null?void 0:Sr.promise,(wr=yr.cancelCall)==null?void 0:wr.promise]),delete this.streamControllers[xr]},ar.MessageHandler=fr},(or,ar,lr)=>{var hr,dr;Object.defineProperty(ar,"__esModule",{value:!0}),ar.Metadata=void 0;var ur=lr(1);class cr{constructor({parsedData:pr,rawData:vr}){Ts(this,hr);Ts(this,dr);_s(this,hr,pr),_s(this,dr,vr)}getRaw(){return Gr(this,dr)}get(pr){return Gr(this,hr).get(pr)??null}getAll(){return(0,ur.objectFromMap)(Gr(this,hr))}has(pr){return Gr(this,hr).has(pr)}}hr=new WeakMap,dr=new WeakMap,ar.Metadata=cr},(or,ar,lr)=>{var pr,vr,gr,mr,br,yr,Ml;Object.defineProperty(ar,"__esModule",{value:!0}),ar.OptionalContentConfig=void 0;var ur=lr(1),cr=lr(8);const hr=Symbol("INTERNAL");class dr{constructor(Sr,wr){Ts(this,pr,!0);this.name=Sr,this.intent=wr}get visible(){return Gr(this,pr)}_setVisible(Sr,wr){Sr!==hr&&(0,ur.unreachable)("Internal method `_setVisible` called."),_s(this,pr,wr)}}pr=new WeakMap;class fr{constructor(Sr){Ts(this,yr);Ts(this,vr,null);Ts(this,gr,new Map);Ts(this,mr,null);Ts(this,br,null);if(this.name=null,this.creator=null,Sr!==null){this.name=Sr.name,this.creator=Sr.creator,_s(this,br,Sr.order);for(const wr of Sr.groups)Gr(this,gr).set(wr.id,new dr(wr.name,wr.intent));if(Sr.baseState==="OFF")for(const wr of Gr(this,gr).values())wr._setVisible(hr,!1);for(const wr of Sr.on)Gr(this,gr).get(wr)._setVisible(hr,!0);for(const wr of Sr.off)Gr(this,gr).get(wr)._setVisible(hr,!1);_s(this,mr,this.getHash())}}isVisible(Sr){if(Gr(this,gr).size===0)return!0;if(!Sr)return(0,ur.warn)("Optional content group not defined."),!0;if(Sr.type==="OCG")return Gr(this,gr).has(Sr.id)?Gr(this,gr).get(Sr.id).visible:((0,ur.warn)(`Optional content group not found: ${Sr.id}`),!0);if(Sr.type==="OCMD"){if(Sr.expression)return ws(this,yr,Ml).call(this,Sr.expression);if(!Sr.policy||Sr.policy==="AnyOn"){for(const wr of Sr.ids){if(!Gr(this,gr).has(wr))return(0,ur.warn)(`Optional content group not found: ${wr}`),!0;if(Gr(this,gr).get(wr).visible)return!0}return!1}else if(Sr.policy==="AllOn"){for(const wr of Sr.ids){if(!Gr(this,gr).has(wr))return(0,ur.warn)(`Optional content group not found: ${wr}`),!0;if(!Gr(this,gr).get(wr).visible)return!1}return!0}else if(Sr.policy==="AnyOff"){for(const wr of Sr.ids){if(!Gr(this,gr).has(wr))return(0,ur.warn)(`Optional content group not found: ${wr}`),!0;if(!Gr(this,gr).get(wr).visible)return!0}return!1}else if(Sr.policy==="AllOff"){for(const wr of Sr.ids){if(!Gr(this,gr).has(wr))return(0,ur.warn)(`Optional content group not found: ${wr}`),!0;if(Gr(this,gr).get(wr).visible)return!1}return!0}return(0,ur.warn)(`Unknown optional content policy ${Sr.policy}.`),!0}return(0,ur.warn)(`Unknown group type ${Sr.type}.`),!0}setVisibility(Sr,wr=!0){if(!Gr(this,gr).has(Sr)){(0,ur.warn)(`Optional content group not found: ${Sr}`);return}Gr(this,gr).get(Sr)._setVisible(hr,!!wr),_s(this,vr,null)}get hasInitialVisibility(){return Gr(this,mr)===null||this.getHash()===Gr(this,mr)}getOrder(){return Gr(this,gr).size?Gr(this,br)?Gr(this,br).slice():[...Gr(this,gr).keys()]:null}getGroups(){return Gr(this,gr).size>0?(0,ur.objectFromMap)(Gr(this,gr)):null}getGroup(Sr){return Gr(this,gr).get(Sr)||null}getHash(){if(Gr(this,vr)!==null)return Gr(this,vr);const Sr=new cr.MurmurHash3_64;for(const[wr,Er]of Gr(this,gr))Sr.update(`${wr}:${Er.visible}`);return _s(this,vr,Sr.hexdigest())}}vr=new WeakMap,gr=new WeakMap,mr=new WeakMap,br=new WeakMap,yr=new WeakSet,Ml=function(Sr){const wr=Sr.length;if(wr<2)return!0;const Er=Sr[0];for(let Ar=1;Ar<wr;Ar++){const Tr=Sr[Ar];let Rr;if(Array.isArray(Tr))Rr=ws(this,yr,Ml).call(this,Tr);else if(Gr(this,gr).has(Tr))Rr=Gr(this,gr).get(Tr).visible;else return(0,ur.warn)(`Optional content group not found: ${Tr}`),!0;switch(Er){case"And":if(!Rr)return!1;break;case"Or":if(Rr)return!0;break;case"Not":return!Rr;default:return!0}}return Er==="And"},ar.OptionalContentConfig=fr},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.PDFDataTransportStream=void 0;var ur=lr(1),cr=lr(6);class hr{constructor({length:vr,initialData:gr,progressiveDone:mr=!1,contentDispositionFilename:br=null,disableRange:yr=!1,disableStream:xr=!1},Cr){if((0,ur.assert)(Cr,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=mr,this._contentDispositionFilename=br,(gr==null?void 0:gr.length)>0){const Sr=gr instanceof Uint8Array&&gr.byteLength===gr.buffer.byteLength?gr.buffer:new Uint8Array(gr).buffer;this._queuedChunks.push(Sr)}this._pdfDataRangeTransport=Cr,this._isStreamingSupported=!xr,this._isRangeSupported=!yr,this._contentLength=vr,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((Sr,wr)=>{this._onReceiveData({begin:Sr,chunk:wr})}),this._pdfDataRangeTransport.addProgressListener((Sr,wr)=>{this._onProgress({loaded:Sr,total:wr})}),this._pdfDataRangeTransport.addProgressiveReadListener(Sr=>{this._onReceiveData({chunk:Sr})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:vr,chunk:gr}){const mr=gr instanceof Uint8Array&&gr.byteLength===gr.buffer.byteLength?gr.buffer:new Uint8Array(gr).buffer;if(vr===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(mr):this._queuedChunks.push(mr);else{const br=this._rangeReaders.some(function(yr){return yr._begin!==vr?!1:(yr._enqueue(mr),!0)});(0,ur.assert)(br,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var vr;return((vr=this._fullRequestReader)==null?void 0:vr._loaded)??0}_onProgress(vr){var gr,mr,br,yr;vr.total===void 0?(mr=(gr=this._rangeReaders[0])==null?void 0:gr.onProgress)==null||mr.call(gr,{loaded:vr.loaded}):(yr=(br=this._fullRequestReader)==null?void 0:br.onProgress)==null||yr.call(br,{loaded:vr.loaded,total:vr.total})}_onProgressiveDone(){var vr;(vr=this._fullRequestReader)==null||vr.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(vr){const gr=this._rangeReaders.indexOf(vr);gr>=0&&this._rangeReaders.splice(gr,1)}getFullReader(){(0,ur.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const vr=this._queuedChunks;return this._queuedChunks=null,new dr(this,vr,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(vr,gr){if(gr<=this._progressiveDataLength)return null;const mr=new fr(this,vr,gr);return this._pdfDataRangeTransport.requestDataRange(vr,gr),this._rangeReaders.push(mr),mr}cancelAllRequests(vr){var gr;(gr=this._fullRequestReader)==null||gr.cancel(vr);for(const mr of this._rangeReaders.slice(0))mr.cancel(vr);this._pdfDataRangeTransport.abort()}}ar.PDFDataTransportStream=hr;class dr{constructor(vr,gr,mr=!1,br=null){this._stream=vr,this._done=mr||!1,this._filename=(0,cr.isPdfFile)(br)?br:null,this._queuedChunks=gr||[],this._loaded=0;for(const yr of this._queuedChunks)this._loaded+=yr.byteLength;this._requests=[],this._headersReady=Promise.resolve(),vr._fullRequestReader=this,this.onProgress=null}_enqueue(vr){this._done||(this._requests.length>0?this._requests.shift().resolve({value:vr,done:!1}):this._queuedChunks.push(vr),this._loaded+=vr.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const vr=new ur.PromiseCapability;return this._requests.push(vr),vr.promise}cancel(vr){this._done=!0;for(const gr of this._requests)gr.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class fr{constructor(vr,gr,mr){this._stream=vr,this._begin=gr,this._end=mr,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(vr){if(!this._done){if(this._requests.length===0)this._queuedChunk=vr;else{this._requests.shift().resolve({value:vr,done:!1});for(const mr of this._requests)mr.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const gr=this._queuedChunk;return this._queuedChunk=null,{value:gr,done:!1}}if(this._done)return{value:void 0,done:!0};const vr=new ur.PromiseCapability;return this._requests.push(vr),vr.promise}cancel(vr){this._done=!0;for(const gr of this._requests)gr.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.PDFFetchStream=void 0;var ur=lr(1),cr=lr(20);function hr(mr,br,yr){return{method:"GET",headers:mr,signal:yr.signal,mode:"cors",credentials:br?"include":"same-origin",redirect:"follow"}}function dr(mr){const br=new Headers;for(const yr in mr){const xr=mr[yr];xr!==void 0&&br.append(yr,xr)}return br}function fr(mr){return mr instanceof Uint8Array?mr.buffer:mr instanceof ArrayBuffer?mr:((0,ur.warn)(`getArrayBuffer - unexpected data format: ${mr}`),new Uint8Array(mr).buffer)}class pr{constructor(br){this.source=br,this.isHttp=/^https?:/i.test(br.url),this.httpHeaders=this.isHttp&&br.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var br;return((br=this._fullRequestReader)==null?void 0:br._loaded)??0}getFullReader(){return(0,ur.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new vr(this),this._fullRequestReader}getRangeReader(br,yr){if(yr<=this._progressiveDataLength)return null;const xr=new gr(this,br,yr);return this._rangeRequestReaders.push(xr),xr}cancelAllRequests(br){var yr;(yr=this._fullRequestReader)==null||yr.cancel(br);for(const xr of this._rangeRequestReaders.slice(0))xr.cancel(br)}}ar.PDFFetchStream=pr;class vr{constructor(br){this._stream=br,this._reader=null,this._loaded=0,this._filename=null;const yr=br.source;this._withCredentials=yr.withCredentials||!1,this._contentLength=yr.length,this._headersCapability=new ur.PromiseCapability,this._disableRange=yr.disableRange||!1,this._rangeChunkSize=yr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!yr.disableStream,this._isRangeSupported=!yr.disableRange,this._headers=dr(this._stream.httpHeaders);const xr=yr.url;fetch(xr,hr(this._headers,this._withCredentials,this._abortController)).then(Cr=>{if(!(0,cr.validateResponseStatus)(Cr.status))throw(0,cr.createResponseStatusError)(Cr.status,xr);this._reader=Cr.body.getReader(),this._headersCapability.resolve();const Sr=Ar=>Cr.headers.get(Ar),{allowRangeRequests:wr,suggestedLength:Er}=(0,cr.validateRangeRequestCapabilities)({getResponseHeader:Sr,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=wr,this._contentLength=Er||this._contentLength,this._filename=(0,cr.extractFilenameFromHeader)(Sr),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new ur.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var xr;await this._headersCapability.promise;const{value:br,done:yr}=await this._reader.read();return yr?{value:br,done:yr}:(this._loaded+=br.byteLength,(xr=this.onProgress)==null||xr.call(this,{loaded:this._loaded,total:this._contentLength}),{value:fr(br),done:!1})}cancel(br){var yr;(yr=this._reader)==null||yr.cancel(br),this._abortController.abort()}}class gr{constructor(br,yr,xr){this._stream=br,this._reader=null,this._loaded=0;const Cr=br.source;this._withCredentials=Cr.withCredentials||!1,this._readCapability=new ur.PromiseCapability,this._isStreamingSupported=!Cr.disableStream,this._abortController=new AbortController,this._headers=dr(this._stream.httpHeaders),this._headers.append("Range",`bytes=${yr}-${xr-1}`);const Sr=Cr.url;fetch(Sr,hr(this._headers,this._withCredentials,this._abortController)).then(wr=>{if(!(0,cr.validateResponseStatus)(wr.status))throw(0,cr.createResponseStatusError)(wr.status,Sr);this._readCapability.resolve(),this._reader=wr.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var xr;await this._readCapability.promise;const{value:br,done:yr}=await this._reader.read();return yr?{value:br,done:yr}:(this._loaded+=br.byteLength,(xr=this.onProgress)==null||xr.call(this,{loaded:this._loaded}),{value:fr(br),done:!1})}cancel(br){var yr;(yr=this._reader)==null||yr.cancel(br),this._abortController.abort()}}},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.createResponseStatusError=pr,ar.extractFilenameFromHeader=fr,ar.validateRangeRequestCapabilities=dr,ar.validateResponseStatus=vr;var ur=lr(1),cr=lr(21),hr=lr(6);function dr({getResponseHeader:gr,isHttp:mr,rangeChunkSize:br,disableRange:yr}){const xr={allowRangeRequests:!1,suggestedLength:void 0},Cr=parseInt(gr("Content-Length"),10);return!Number.isInteger(Cr)||(xr.suggestedLength=Cr,Cr<=2*br)||yr||!mr||gr("Accept-Ranges")!=="bytes"||(gr("Content-Encoding")||"identity")!=="identity"||(xr.allowRangeRequests=!0),xr}function fr(gr){const mr=gr("Content-Disposition");if(mr){let br=(0,cr.getFilenameFromContentDispositionHeader)(mr);if(br.includes("%"))try{br=decodeURIComponent(br)}catch{}if((0,hr.isPdfFile)(br))return br}return null}function pr(gr,mr){return gr===404||gr===0&&mr.startsWith("file:")?new ur.MissingPDFException('Missing PDF "'+mr+'".'):new ur.UnexpectedResponseException(`Unexpected server response (${gr}) while retrieving PDF "${mr}".`,gr)}function vr(gr){return gr===200||gr===206}},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.getFilenameFromContentDispositionHeader=cr;var ur=lr(1);function cr(hr){let dr=!0,fr=pr("filename\\*","i").exec(hr);if(fr){fr=fr[1];let Cr=br(fr);return Cr=unescape(Cr),Cr=yr(Cr),Cr=xr(Cr),gr(Cr)}if(fr=mr(hr),fr){const Cr=xr(fr);return gr(Cr)}if(fr=pr("filename","i").exec(hr),fr){fr=fr[1];let Cr=br(fr);return Cr=xr(Cr),gr(Cr)}function pr(Cr,Sr){return new RegExp("(?:^|;)\\s*"+Cr+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',Sr)}function vr(Cr,Sr){if(Cr){if(!/^[\x00-\xFF]+$/.test(Sr))return Sr;try{const wr=new TextDecoder(Cr,{fatal:!0}),Er=(0,ur.stringToBytes)(Sr);Sr=wr.decode(Er),dr=!1}catch{}}return Sr}function gr(Cr){return dr&&/[\x80-\xff]/.test(Cr)&&(Cr=vr("utf-8",Cr),dr&&(Cr=vr("iso-8859-1",Cr))),Cr}function mr(Cr){const Sr=[];let wr;const Er=pr("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(wr=Er.exec(Cr))!==null;){let[,Tr,Rr,Pr]=wr;if(Tr=parseInt(Tr,10),Tr in Sr){if(Tr===0)break;continue}Sr[Tr]=[Rr,Pr]}const Ar=[];for(let Tr=0;Tr<Sr.length&&Tr in Sr;++Tr){let[Rr,Pr]=Sr[Tr];Pr=br(Pr),Rr&&(Pr=unescape(Pr),Tr===0&&(Pr=yr(Pr))),Ar.push(Pr)}return Ar.join("")}function br(Cr){if(Cr.startsWith('"')){const Sr=Cr.slice(1).split('\\"');for(let wr=0;wr<Sr.length;++wr){const Er=Sr[wr].indexOf('"');Er!==-1&&(Sr[wr]=Sr[wr].slice(0,Er),Sr.length=wr+1),Sr[wr]=Sr[wr].replaceAll(/\\(.)/g,"$1")}Cr=Sr.join('"')}return Cr}function yr(Cr){const Sr=Cr.indexOf("'");if(Sr===-1)return Cr;const wr=Cr.slice(0,Sr),Ar=Cr.slice(Sr+1).replace(/^[^']*'/,"");return vr(wr,Ar)}function xr(Cr){return!Cr.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(Cr)?Cr:Cr.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(Sr,wr,Er,Ar){if(Er==="q"||Er==="Q")return Ar=Ar.replaceAll("_"," "),Ar=Ar.replaceAll(/=([0-9a-fA-F]{2})/g,function(Tr,Rr){return String.fromCharCode(parseInt(Rr,16))}),vr(wr,Ar);try{Ar=atob(Ar)}catch{}return vr(wr,Ar)})}return""}},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.PDFNetworkStream=void 0;var ur=lr(1),cr=lr(20);const hr=200,dr=206;function fr(br){const yr=br.response;return typeof yr!="string"?yr:(0,ur.stringToBytes)(yr).buffer}class pr{constructor(yr,xr={}){this.url=yr,this.isHttp=/^https?:/i.test(yr),this.httpHeaders=this.isHttp&&xr.httpHeaders||Object.create(null),this.withCredentials=xr.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(yr,xr,Cr){const Sr={begin:yr,end:xr};for(const wr in Cr)Sr[wr]=Cr[wr];return this.request(Sr)}requestFull(yr){return this.request(yr)}request(yr){const xr=new XMLHttpRequest,Cr=this.currXhrId++,Sr=this.pendingRequests[Cr]={xhr:xr};xr.open("GET",this.url),xr.withCredentials=this.withCredentials;for(const wr in this.httpHeaders){const Er=this.httpHeaders[wr];Er!==void 0&&xr.setRequestHeader(wr,Er)}return this.isHttp&&"begin"in yr&&"end"in yr?(xr.setRequestHeader("Range",`bytes=${yr.begin}-${yr.end-1}`),Sr.expectedStatus=dr):Sr.expectedStatus=hr,xr.responseType="arraybuffer",yr.onError&&(xr.onerror=function(wr){yr.onError(xr.status)}),xr.onreadystatechange=this.onStateChange.bind(this,Cr),xr.onprogress=this.onProgress.bind(this,Cr),Sr.onHeadersReceived=yr.onHeadersReceived,Sr.onDone=yr.onDone,Sr.onError=yr.onError,Sr.onProgress=yr.onProgress,xr.send(null),Cr}onProgress(yr,xr){var Sr;const Cr=this.pendingRequests[yr];Cr&&((Sr=Cr.onProgress)==null||Sr.call(Cr,xr))}onStateChange(yr,xr){var Tr,Rr,Pr;const Cr=this.pendingRequests[yr];if(!Cr)return;const Sr=Cr.xhr;if(Sr.readyState>=2&&Cr.onHeadersReceived&&(Cr.onHeadersReceived(),delete Cr.onHeadersReceived),Sr.readyState!==4||!(yr in this.pendingRequests))return;if(delete this.pendingRequests[yr],Sr.status===0&&this.isHttp){(Tr=Cr.onError)==null||Tr.call(Cr,Sr.status);return}const wr=Sr.status||hr;if(!(wr===hr&&Cr.expectedStatus===dr)&&wr!==Cr.expectedStatus){(Rr=Cr.onError)==null||Rr.call(Cr,Sr.status);return}const Ar=fr(Sr);if(wr===dr){const _r=Sr.getResponseHeader("Content-Range"),kr=/bytes (\d+)-(\d+)\/(\d+)/.exec(_r);Cr.onDone({begin:parseInt(kr[1],10),chunk:Ar})}else Ar?Cr.onDone({begin:0,chunk:Ar}):(Pr=Cr.onError)==null||Pr.call(Cr,Sr.status)}getRequestXhr(yr){return this.pendingRequests[yr].xhr}isPendingRequest(yr){return yr in this.pendingRequests}abortRequest(yr){const xr=this.pendingRequests[yr].xhr;delete this.pendingRequests[yr],xr.abort()}}class vr{constructor(yr){this._source=yr,this._manager=new pr(yr.url,{httpHeaders:yr.httpHeaders,withCredentials:yr.withCredentials}),this._rangeChunkSize=yr.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(yr){const xr=this._rangeRequestReaders.indexOf(yr);xr>=0&&this._rangeRequestReaders.splice(xr,1)}getFullReader(){return(0,ur.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new gr(this._manager,this._source),this._fullRequestReader}getRangeReader(yr,xr){const Cr=new mr(this._manager,yr,xr);return Cr.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(Cr),Cr}cancelAllRequests(yr){var xr;(xr=this._fullRequestReader)==null||xr.cancel(yr);for(const Cr of this._rangeRequestReaders.slice(0))Cr.cancel(yr)}}ar.PDFNetworkStream=vr;class gr{constructor(yr,xr){this._manager=yr;const Cr={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=xr.url,this._fullRequestId=yr.requestFull(Cr),this._headersReceivedCapability=new ur.PromiseCapability,this._disableRange=xr.disableRange||!1,this._contentLength=xr.length,this._rangeChunkSize=xr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const yr=this._fullRequestId,xr=this._manager.getRequestXhr(yr),Cr=Er=>xr.getResponseHeader(Er),{allowRangeRequests:Sr,suggestedLength:wr}=(0,cr.validateRangeRequestCapabilities)({getResponseHeader:Cr,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});Sr&&(this._isRangeSupported=!0),this._contentLength=wr||this._contentLength,this._filename=(0,cr.extractFilenameFromHeader)(Cr),this._isRangeSupported&&this._manager.abortRequest(yr),this._headersReceivedCapability.resolve()}_onDone(yr){if(yr&&(this._requests.length>0?this._requests.shift().resolve({value:yr.chunk,done:!1}):this._cachedChunks.push(yr.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const xr of this._requests)xr.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(yr){this._storedError=(0,cr.createResponseStatusError)(yr,this._url),this._headersReceivedCapability.reject(this._storedError);for(const xr of this._requests)xr.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(yr){var xr;(xr=this.onProgress)==null||xr.call(this,{loaded:yr.loaded,total:yr.lengthComputable?yr.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const yr=new ur.PromiseCapability;return this._requests.push(yr),yr.promise}cancel(yr){this._done=!0,this._headersReceivedCapability.reject(yr);for(const xr of this._requests)xr.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class mr{constructor(yr,xr,Cr){this._manager=yr;const Sr={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=yr.url,this._requestId=yr.requestRange(xr,Cr,Sr),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var yr;(yr=this.onClosed)==null||yr.call(this,this)}_onDone(yr){const xr=yr.chunk;this._requests.length>0?this._requests.shift().resolve({value:xr,done:!1}):this._queuedChunk=xr,this._done=!0;for(const Cr of this._requests)Cr.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(yr){this._storedError=(0,cr.createResponseStatusError)(yr,this._url);for(const xr of this._requests)xr.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(yr){var xr;this.isStreamingSupported||(xr=this.onProgress)==null||xr.call(this,{loaded:yr.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const xr=this._queuedChunk;return this._queuedChunk=null,{value:xr,done:!1}}if(this._done)return{value:void 0,done:!0};const yr=new ur.PromiseCapability;return this._requests.push(yr),yr.promise}cancel(yr){this._done=!0;for(const xr of this._requests)xr.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.PDFNodeStream=void 0;var ur=lr(1),cr=lr(20);const hr=/^file:\/\/\/[a-zA-Z]:\//;function dr(Cr){const Sr=require$$5,wr=Sr.parse(Cr);return wr.protocol==="file:"||wr.host?wr:/^[a-z]:[/\\]/i.test(Cr)?Sr.parse(`file:///${Cr}`):(wr.host||(wr.protocol="file:"),wr)}class fr{constructor(Sr){this.source=Sr,this.url=dr(Sr.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&Sr.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var Sr;return((Sr=this._fullRequestReader)==null?void 0:Sr._loaded)??0}getFullReader(){return(0,ur.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new yr(this):new mr(this),this._fullRequestReader}getRangeReader(Sr,wr){if(wr<=this._progressiveDataLength)return null;const Er=this.isFsUrl?new xr(this,Sr,wr):new br(this,Sr,wr);return this._rangeRequestReaders.push(Er),Er}cancelAllRequests(Sr){var wr;(wr=this._fullRequestReader)==null||wr.cancel(Sr);for(const Er of this._rangeRequestReaders.slice(0))Er.cancel(Sr)}}ar.PDFNodeStream=fr;class pr{constructor(Sr){this._url=Sr.url,this._done=!1,this._storedError=null,this.onProgress=null;const wr=Sr.source;this._contentLength=wr.length,this._loaded=0,this._filename=null,this._disableRange=wr.disableRange||!1,this._rangeChunkSize=wr.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!wr.disableStream,this._isRangeSupported=!wr.disableRange,this._readableStream=null,this._readCapability=new ur.PromiseCapability,this._headersCapability=new ur.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Er;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const Sr=this._readableStream.read();return Sr===null?(this._readCapability=new ur.PromiseCapability,this.read()):(this._loaded+=Sr.length,(Er=this.onProgress)==null||Er.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(Sr).buffer,done:!1})}cancel(Sr){if(!this._readableStream){this._error(Sr);return}this._readableStream.destroy(Sr)}_error(Sr){this._storedError=Sr,this._readCapability.resolve()}_setReadableStream(Sr){this._readableStream=Sr,Sr.on("readable",()=>{this._readCapability.resolve()}),Sr.on("end",()=>{Sr.destroy(),this._done=!0,this._readCapability.resolve()}),Sr.on("error",wr=>{this._error(wr)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new ur.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class vr{constructor(Sr){this._url=Sr.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new ur.PromiseCapability;const wr=Sr.source;this._isStreamingSupported=!wr.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var Er;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const Sr=this._readableStream.read();return Sr===null?(this._readCapability=new ur.PromiseCapability,this.read()):(this._loaded+=Sr.length,(Er=this.onProgress)==null||Er.call(this,{loaded:this._loaded}),{value:new Uint8Array(Sr).buffer,done:!1})}cancel(Sr){if(!this._readableStream){this._error(Sr);return}this._readableStream.destroy(Sr)}_error(Sr){this._storedError=Sr,this._readCapability.resolve()}_setReadableStream(Sr){this._readableStream=Sr,Sr.on("readable",()=>{this._readCapability.resolve()}),Sr.on("end",()=>{Sr.destroy(),this._done=!0,this._readCapability.resolve()}),Sr.on("error",wr=>{this._error(wr)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function gr(Cr,Sr){return{protocol:Cr.protocol,auth:Cr.auth,host:Cr.hostname,port:Cr.port,path:Cr.path,method:"GET",headers:Sr}}class mr extends pr{constructor(Sr){super(Sr);const wr=Er=>{if(Er.statusCode===404){const Pr=new ur.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Pr,this._headersCapability.reject(Pr);return}this._headersCapability.resolve(),this._setReadableStream(Er);const Ar=Pr=>this._readableStream.headers[Pr.toLowerCase()],{allowRangeRequests:Tr,suggestedLength:Rr}=(0,cr.validateRangeRequestCapabilities)({getResponseHeader:Ar,isHttp:Sr.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Tr,this._contentLength=Rr||this._contentLength,this._filename=(0,cr.extractFilenameFromHeader)(Ar)};if(this._request=null,this._url.protocol==="http:"){const Er=require$$5;this._request=Er.request(gr(this._url,Sr.httpHeaders),wr)}else{const Er=require$$5;this._request=Er.request(gr(this._url,Sr.httpHeaders),wr)}this._request.on("error",Er=>{this._storedError=Er,this._headersCapability.reject(Er)}),this._request.end()}}class br extends vr{constructor(Sr,wr,Er){super(Sr),this._httpHeaders={};for(const Tr in Sr.httpHeaders){const Rr=Sr.httpHeaders[Tr];Rr!==void 0&&(this._httpHeaders[Tr]=Rr)}this._httpHeaders.Range=`bytes=${wr}-${Er-1}`;const Ar=Tr=>{if(Tr.statusCode===404){const Rr=new ur.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=Rr;return}this._setReadableStream(Tr)};if(this._request=null,this._url.protocol==="http:"){const Tr=require$$5;this._request=Tr.request(gr(this._url,this._httpHeaders),Ar)}else{const Tr=require$$5;this._request=Tr.request(gr(this._url,this._httpHeaders),Ar)}this._request.on("error",Tr=>{this._storedError=Tr}),this._request.end()}}class yr extends pr{constructor(Sr){super(Sr);let wr=decodeURIComponent(this._url.path);hr.test(this._url.href)&&(wr=wr.replace(/^\//,""));const Er=require$$5;Er.lstat(wr,(Ar,Tr)=>{if(Ar){Ar.code==="ENOENT"&&(Ar=new ur.MissingPDFException(`Missing PDF "${wr}".`)),this._storedError=Ar,this._headersCapability.reject(Ar);return}this._contentLength=Tr.size,this._setReadableStream(Er.createReadStream(wr)),this._headersCapability.resolve()})}}class xr extends vr{constructor(Sr,wr,Er){super(Sr);let Ar=decodeURIComponent(this._url.path);hr.test(this._url.href)&&(Ar=Ar.replace(/^\//,""));const Tr=require$$5;this._setReadableStream(Tr.createReadStream(Ar,{start:wr,end:Er-1}))}}},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.SVGGraphics=void 0;var ur=lr(6),cr=lr(1);const hr={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},dr="http://www.w3.org/XML/1998/namespace",fr="http://www.w3.org/1999/xlink",pr=["butt","round","square"],vr=["miter","round","bevel"],gr=function(Tr,Rr="",Pr=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!Pr)return URL.createObjectURL(new Blob([Tr],{type:Rr}));const _r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let kr=`data:${Rr};base64,`;for(let Dr=0,Nr=Tr.length;Dr<Nr;Dr+=3){const Lr=Tr[Dr]&255,Or=Tr[Dr+1]&255,Ir=Tr[Dr+2]&255,Mr=Lr>>2,$r=(Lr&3)<<4|Or>>4,jr=Dr+1<Nr?(Or&15)<<2|Ir>>6:64,Fr=Dr+2<Nr?Ir&63:64;kr+=_r[Mr]+_r[$r]+_r[jr]+_r[Fr]}return kr},mr=function(){const Tr=new Uint8Array([137,80,78,71,13,10,26,10]),Rr=12,Pr=new Int32Array(256);for(let Ir=0;Ir<256;Ir++){let Mr=Ir;for(let $r=0;$r<8;$r++)Mr=Mr&1?3988292384^Mr>>1&2147483647:Mr>>1&2147483647;Pr[Ir]=Mr}function _r(Ir,Mr,$r){let jr=-1;for(let Fr=Mr;Fr<$r;Fr++){const zr=(jr^Ir[Fr])&255,Hr=Pr[zr];jr=jr>>>8^Hr}return jr^-1}function kr(Ir,Mr,$r,jr){let Fr=jr;const zr=Mr.length;$r[Fr]=zr>>24&255,$r[Fr+1]=zr>>16&255,$r[Fr+2]=zr>>8&255,$r[Fr+3]=zr&255,Fr+=4,$r[Fr]=Ir.charCodeAt(0)&255,$r[Fr+1]=Ir.charCodeAt(1)&255,$r[Fr+2]=Ir.charCodeAt(2)&255,$r[Fr+3]=Ir.charCodeAt(3)&255,Fr+=4,$r.set(Mr,Fr),Fr+=Mr.length;const Hr=_r($r,jr+4,Fr);$r[Fr]=Hr>>24&255,$r[Fr+1]=Hr>>16&255,$r[Fr+2]=Hr>>8&255,$r[Fr+3]=Hr&255}function Dr(Ir,Mr,$r){let jr=1,Fr=0;for(let zr=Mr;zr<$r;++zr)jr=(jr+(Ir[zr]&255))%65521,Fr=(Fr+jr)%65521;return Fr<<16|jr}function Nr(Ir){if(!cr.isNodeJS)return Lr(Ir);try{const Mr=parseInt(process.versions.node)>=8?Ir:Buffer.from(Ir),$r=require$$5.deflateSync(Mr,{level:9});return $r instanceof Uint8Array?$r:new Uint8Array($r)}catch(Mr){(0,cr.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Mr)}return Lr(Ir)}function Lr(Ir){let Mr=Ir.length;const $r=65535,jr=Math.ceil(Mr/$r),Fr=new Uint8Array(2+Mr+jr*5+4);let zr=0;Fr[zr++]=120,Fr[zr++]=156;let Hr=0;for(;Mr>$r;)Fr[zr++]=0,Fr[zr++]=255,Fr[zr++]=255,Fr[zr++]=0,Fr[zr++]=0,Fr.set(Ir.subarray(Hr,Hr+$r),zr),zr+=$r,Hr+=$r,Mr-=$r;Fr[zr++]=1,Fr[zr++]=Mr&255,Fr[zr++]=Mr>>8&255,Fr[zr++]=~Mr&65535&255,Fr[zr++]=(~Mr&65535)>>8&255,Fr.set(Ir.subarray(Hr),zr),zr+=Ir.length-Hr;const Wr=Dr(Ir,0,Ir.length);return Fr[zr++]=Wr>>24&255,Fr[zr++]=Wr>>16&255,Fr[zr++]=Wr>>8&255,Fr[zr++]=Wr&255,Fr}function Or(Ir,Mr,$r,jr){const Fr=Ir.width,zr=Ir.height;let Hr,Wr,Yr;const qr=Ir.data;switch(Mr){case cr.ImageKind.GRAYSCALE_1BPP:Wr=0,Hr=1,Yr=Fr+7>>3;break;case cr.ImageKind.RGB_24BPP:Wr=2,Hr=8,Yr=Fr*3;break;case cr.ImageKind.RGBA_32BPP:Wr=6,Hr=8,Yr=Fr*4;break;default:throw new Error("invalid format")}const Br=new Uint8Array((1+Yr)*zr);let Ur=0,Vr=0;for(let ba=0;ba<zr;++ba)Br[Ur++]=0,Br.set(qr.subarray(Vr,Vr+Yr),Ur),Vr+=Yr,Ur+=Yr;if(Mr===cr.ImageKind.GRAYSCALE_1BPP&&jr){Ur=0;for(let ba=0;ba<zr;ba++){Ur++;for(let _i=0;_i<Yr;_i++)Br[Ur++]^=255}}const Xr=new Uint8Array([Fr>>24&255,Fr>>16&255,Fr>>8&255,Fr&255,zr>>24&255,zr>>16&255,zr>>8&255,zr&255,Hr,Wr,0,0,0]),Zr=Nr(Br),Jr=Tr.length+Rr*3+Xr.length+Zr.length,Qr=new Uint8Array(Jr);let ga=0;return Qr.set(Tr,ga),ga+=Tr.length,kr("IHDR",Xr,Qr,ga),ga+=Rr+Xr.length,kr("IDATA",Zr,Qr,ga),ga+=Rr+Zr.length,kr("IEND",new Uint8Array(0),Qr,ga),gr(Qr,"image/png",$r)}return function(Mr,$r,jr){const Fr=Mr.kind===void 0?cr.ImageKind.GRAYSCALE_1BPP:Mr.kind;return Or(Mr,Fr,$r,jr)}}();class br{constructor(){this.fontSizeScale=1,this.fontWeight=hr.fontWeight,this.fontSize=0,this.textMatrix=cr.IDENTITY_MATRIX,this.fontMatrix=cr.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=cr.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=hr.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(Rr,Pr){this.x=Rr,this.y=Pr}}function yr(Tr){let Rr=[];const Pr=[];for(const _r of Tr){if(_r.fn==="save"){Rr.push({fnId:92,fn:"group",items:[]}),Pr.push(Rr),Rr=Rr.at(-1).items;continue}_r.fn==="restore"?Rr=Pr.pop():Rr.push(_r)}return Rr}function xr(Tr){if(Number.isInteger(Tr))return Tr.toString();const Rr=Tr.toFixed(10);let Pr=Rr.length-1;if(Rr[Pr]!=="0")return Rr;do Pr--;while(Rr[Pr]==="0");return Rr.substring(0,Rr[Pr]==="."?Pr:Pr+1)}function Cr(Tr){if(Tr[4]===0&&Tr[5]===0){if(Tr[1]===0&&Tr[2]===0)return Tr[0]===1&&Tr[3]===1?"":`scale(${xr(Tr[0])} ${xr(Tr[3])})`;if(Tr[0]===Tr[3]&&Tr[1]===-Tr[2]){const Rr=Math.acos(Tr[0])*180/Math.PI;return`rotate(${xr(Rr)})`}}else if(Tr[0]===1&&Tr[1]===0&&Tr[2]===0&&Tr[3]===1)return`translate(${xr(Tr[4])} ${xr(Tr[5])})`;return`matrix(${xr(Tr[0])} ${xr(Tr[1])} ${xr(Tr[2])} ${xr(Tr[3])} ${xr(Tr[4])} ${xr(Tr[5])})`}let Sr=0,wr=0,Er=0;class Ar{constructor(Rr,Pr,_r=!1){(0,ur.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new ur.DOMSVGFactory,this.current=new br,this.transformMatrix=cr.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=Rr,this.objs=Pr,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!_r,this._operatorIdMapping=[];for(const kr in cr.OPS)this._operatorIdMapping[cr.OPS[kr]]=kr}getObject(Rr,Pr=null){return typeof Rr=="string"?Rr.startsWith("g_")?this.commonObjs.get(Rr):this.objs.get(Rr):Pr}save(){this.transformStack.push(this.transformMatrix);const Rr=this.current;this.extraStack.push(Rr),this.current=Rr.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(Rr){this.save(),this.executeOpTree(Rr),this.restore()}loadDependencies(Rr){const Pr=Rr.fnArray,_r=Rr.argsArray;for(let kr=0,Dr=Pr.length;kr<Dr;kr++)if(Pr[kr]===cr.OPS.dependency)for(const Nr of _r[kr]){const Lr=Nr.startsWith("g_")?this.commonObjs:this.objs,Or=new Promise(Ir=>{Lr.get(Nr,Ir)});this.current.dependencies.push(Or)}return Promise.all(this.current.dependencies)}transform(Rr,Pr,_r,kr,Dr,Nr){const Lr=[Rr,Pr,_r,kr,Dr,Nr];this.transformMatrix=cr.Util.transform(this.transformMatrix,Lr),this.tgrp=null}getSVG(Rr,Pr){this.viewport=Pr;const _r=this._initialize(Pr);return this.loadDependencies(Rr).then(()=>(this.transformMatrix=cr.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(Rr)),_r))}convertOpList(Rr){const Pr=this._operatorIdMapping,_r=Rr.argsArray,kr=Rr.fnArray,Dr=[];for(let Nr=0,Lr=kr.length;Nr<Lr;Nr++){const Or=kr[Nr];Dr.push({fnId:Or,fn:Pr[Or],args:_r[Nr]})}return yr(Dr)}executeOpTree(Rr){for(const Pr of Rr){const _r=Pr.fn,kr=Pr.fnId,Dr=Pr.args;switch(kr|0){case cr.OPS.beginText:this.beginText();break;case cr.OPS.dependency:break;case cr.OPS.setLeading:this.setLeading(Dr);break;case cr.OPS.setLeadingMoveText:this.setLeadingMoveText(Dr[0],Dr[1]);break;case cr.OPS.setFont:this.setFont(Dr);break;case cr.OPS.showText:this.showText(Dr[0]);break;case cr.OPS.showSpacedText:this.showText(Dr[0]);break;case cr.OPS.endText:this.endText();break;case cr.OPS.moveText:this.moveText(Dr[0],Dr[1]);break;case cr.OPS.setCharSpacing:this.setCharSpacing(Dr[0]);break;case cr.OPS.setWordSpacing:this.setWordSpacing(Dr[0]);break;case cr.OPS.setHScale:this.setHScale(Dr[0]);break;case cr.OPS.setTextMatrix:this.setTextMatrix(Dr[0],Dr[1],Dr[2],Dr[3],Dr[4],Dr[5]);break;case cr.OPS.setTextRise:this.setTextRise(Dr[0]);break;case cr.OPS.setTextRenderingMode:this.setTextRenderingMode(Dr[0]);break;case cr.OPS.setLineWidth:this.setLineWidth(Dr[0]);break;case cr.OPS.setLineJoin:this.setLineJoin(Dr[0]);break;case cr.OPS.setLineCap:this.setLineCap(Dr[0]);break;case cr.OPS.setMiterLimit:this.setMiterLimit(Dr[0]);break;case cr.OPS.setFillRGBColor:this.setFillRGBColor(Dr[0],Dr[1],Dr[2]);break;case cr.OPS.setStrokeRGBColor:this.setStrokeRGBColor(Dr[0],Dr[1],Dr[2]);break;case cr.OPS.setStrokeColorN:this.setStrokeColorN(Dr);break;case cr.OPS.setFillColorN:this.setFillColorN(Dr);break;case cr.OPS.shadingFill:this.shadingFill(Dr[0]);break;case cr.OPS.setDash:this.setDash(Dr[0],Dr[1]);break;case cr.OPS.setRenderingIntent:this.setRenderingIntent(Dr[0]);break;case cr.OPS.setFlatness:this.setFlatness(Dr[0]);break;case cr.OPS.setGState:this.setGState(Dr[0]);break;case cr.OPS.fill:this.fill();break;case cr.OPS.eoFill:this.eoFill();break;case cr.OPS.stroke:this.stroke();break;case cr.OPS.fillStroke:this.fillStroke();break;case cr.OPS.eoFillStroke:this.eoFillStroke();break;case cr.OPS.clip:this.clip("nonzero");break;case cr.OPS.eoClip:this.clip("evenodd");break;case cr.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case cr.OPS.paintImageXObject:this.paintImageXObject(Dr[0]);break;case cr.OPS.paintInlineImageXObject:this.paintInlineImageXObject(Dr[0]);break;case cr.OPS.paintImageMaskXObject:this.paintImageMaskXObject(Dr[0]);break;case cr.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(Dr[0],Dr[1]);break;case cr.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case cr.OPS.closePath:this.closePath();break;case cr.OPS.closeStroke:this.closeStroke();break;case cr.OPS.closeFillStroke:this.closeFillStroke();break;case cr.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case cr.OPS.nextLine:this.nextLine();break;case cr.OPS.transform:this.transform(Dr[0],Dr[1],Dr[2],Dr[3],Dr[4],Dr[5]);break;case cr.OPS.constructPath:this.constructPath(Dr[0],Dr[1]);break;case cr.OPS.endPath:this.endPath();break;case 92:this.group(Pr.items);break;default:(0,cr.warn)(`Unimplemented operator ${_r}`);break}}}setWordSpacing(Rr){this.current.wordSpacing=Rr}setCharSpacing(Rr){this.current.charSpacing=Rr}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(Rr,Pr,_r,kr,Dr,Nr){const Lr=this.current;Lr.textMatrix=Lr.lineMatrix=[Rr,Pr,_r,kr,Dr,Nr],Lr.textMatrixScale=Math.hypot(Rr,Pr),Lr.x=Lr.lineX=0,Lr.y=Lr.lineY=0,Lr.xcoords=[],Lr.ycoords=[],Lr.tspan=this.svgFactory.createElement("svg:tspan"),Lr.tspan.setAttributeNS(null,"font-family",Lr.fontFamily),Lr.tspan.setAttributeNS(null,"font-size",`${xr(Lr.fontSize)}px`),Lr.tspan.setAttributeNS(null,"y",xr(-Lr.y)),Lr.txtElement=this.svgFactory.createElement("svg:text"),Lr.txtElement.append(Lr.tspan)}beginText(){const Rr=this.current;Rr.x=Rr.lineX=0,Rr.y=Rr.lineY=0,Rr.textMatrix=cr.IDENTITY_MATRIX,Rr.lineMatrix=cr.IDENTITY_MATRIX,Rr.textMatrixScale=1,Rr.tspan=this.svgFactory.createElement("svg:tspan"),Rr.txtElement=this.svgFactory.createElement("svg:text"),Rr.txtgrp=this.svgFactory.createElement("svg:g"),Rr.xcoords=[],Rr.ycoords=[]}moveText(Rr,Pr){const _r=this.current;_r.x=_r.lineX+=Rr,_r.y=_r.lineY+=Pr,_r.xcoords=[],_r.ycoords=[],_r.tspan=this.svgFactory.createElement("svg:tspan"),_r.tspan.setAttributeNS(null,"font-family",_r.fontFamily),_r.tspan.setAttributeNS(null,"font-size",`${xr(_r.fontSize)}px`),_r.tspan.setAttributeNS(null,"y",xr(-_r.y))}showText(Rr){const Pr=this.current,_r=Pr.font,kr=Pr.fontSize;if(kr===0)return;const Dr=Pr.fontSizeScale,Nr=Pr.charSpacing,Lr=Pr.wordSpacing,Or=Pr.fontDirection,Ir=Pr.textHScale*Or,Mr=_r.vertical,$r=Mr?1:-1,jr=_r.defaultVMetrics,Fr=kr*Pr.fontMatrix[0];let zr=0;for(const Yr of Rr){if(Yr===null){zr+=Or*Lr;continue}else if(typeof Yr=="number"){zr+=$r*Yr*kr/1e3;continue}const qr=(Yr.isSpace?Lr:0)+Nr,Br=Yr.fontChar;let Ur,Vr,Xr=Yr.width;if(Mr){let Jr;const Qr=Yr.vmetric||jr;Jr=Yr.vmetric?Qr[1]:Xr*.5,Jr=-Jr*Fr;const ga=Qr[2]*Fr;Xr=Qr?-Qr[0]:Xr,Ur=Jr/Dr,Vr=(zr+ga)/Dr}else Ur=zr/Dr,Vr=0;(Yr.isInFont||_r.missingFile)&&(Pr.xcoords.push(Pr.x+Ur),Mr&&Pr.ycoords.push(-Pr.y+Vr),Pr.tspan.textContent+=Br);const Zr=Mr?Xr*Fr-qr*Or:Xr*Fr+qr*Or;zr+=Zr}Pr.tspan.setAttributeNS(null,"x",Pr.xcoords.map(xr).join(" ")),Mr?Pr.tspan.setAttributeNS(null,"y",Pr.ycoords.map(xr).join(" ")):Pr.tspan.setAttributeNS(null,"y",xr(-Pr.y)),Mr?Pr.y-=zr:Pr.x+=zr*Ir,Pr.tspan.setAttributeNS(null,"font-family",Pr.fontFamily),Pr.tspan.setAttributeNS(null,"font-size",`${xr(Pr.fontSize)}px`),Pr.fontStyle!==hr.fontStyle&&Pr.tspan.setAttributeNS(null,"font-style",Pr.fontStyle),Pr.fontWeight!==hr.fontWeight&&Pr.tspan.setAttributeNS(null,"font-weight",Pr.fontWeight);const Hr=Pr.textRenderingMode&cr.TextRenderingMode.FILL_STROKE_MASK;if(Hr===cr.TextRenderingMode.FILL||Hr===cr.TextRenderingMode.FILL_STROKE?(Pr.fillColor!==hr.fillColor&&Pr.tspan.setAttributeNS(null,"fill",Pr.fillColor),Pr.fillAlpha<1&&Pr.tspan.setAttributeNS(null,"fill-opacity",Pr.fillAlpha)):Pr.textRenderingMode===cr.TextRenderingMode.ADD_TO_PATH?Pr.tspan.setAttributeNS(null,"fill","transparent"):Pr.tspan.setAttributeNS(null,"fill","none"),Hr===cr.TextRenderingMode.STROKE||Hr===cr.TextRenderingMode.FILL_STROKE){const Yr=1/(Pr.textMatrixScale||1);this._setStrokeAttributes(Pr.tspan,Yr)}let Wr=Pr.textMatrix;Pr.textRise!==0&&(Wr=Wr.slice(),Wr[5]+=Pr.textRise),Pr.txtElement.setAttributeNS(null,"transform",`${Cr(Wr)} scale(${xr(Ir)}, -1)`),Pr.txtElement.setAttributeNS(dr,"xml:space","preserve"),Pr.txtElement.append(Pr.tspan),Pr.txtgrp.append(Pr.txtElement),this._ensureTransformGroup().append(Pr.txtElement)}setLeadingMoveText(Rr,Pr){this.setLeading(-Pr),this.moveText(Rr,Pr)}addFontStyle(Rr){if(!Rr.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const Pr=gr(Rr.data,Rr.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${Rr.loadedName}"; src: url(${Pr}); }
`}setFont(Rr){const Pr=this.current,_r=this.commonObjs.get(Rr[0]);let kr=Rr[1];Pr.font=_r,this.embedFonts&&!_r.missingFile&&!this.embeddedFonts[_r.loadedName]&&(this.addFontStyle(_r),this.embeddedFonts[_r.loadedName]=_r),Pr.fontMatrix=_r.fontMatrix||cr.FONT_IDENTITY_MATRIX;let Dr="normal";_r.black?Dr="900":_r.bold&&(Dr="bold");const Nr=_r.italic?"italic":"normal";kr<0?(kr=-kr,Pr.fontDirection=-1):Pr.fontDirection=1,Pr.fontSize=kr,Pr.fontFamily=_r.loadedName,Pr.fontWeight=Dr,Pr.fontStyle=Nr,Pr.tspan=this.svgFactory.createElement("svg:tspan"),Pr.tspan.setAttributeNS(null,"y",xr(-Pr.y)),Pr.xcoords=[],Pr.ycoords=[]}endText(){var Pr;const Rr=this.current;Rr.textRenderingMode&cr.TextRenderingMode.ADD_TO_PATH_FLAG&&((Pr=Rr.txtElement)!=null&&Pr.hasChildNodes())&&(Rr.element=Rr.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(Rr){Rr>0&&(this.current.lineWidth=Rr)}setLineCap(Rr){this.current.lineCap=pr[Rr]}setLineJoin(Rr){this.current.lineJoin=vr[Rr]}setMiterLimit(Rr){this.current.miterLimit=Rr}setStrokeAlpha(Rr){this.current.strokeAlpha=Rr}setStrokeRGBColor(Rr,Pr,_r){this.current.strokeColor=cr.Util.makeHexColor(Rr,Pr,_r)}setFillAlpha(Rr){this.current.fillAlpha=Rr}setFillRGBColor(Rr,Pr,_r){this.current.fillColor=cr.Util.makeHexColor(Rr,Pr,_r),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(Rr){this.current.strokeColor=this._makeColorN_Pattern(Rr)}setFillColorN(Rr){this.current.fillColor=this._makeColorN_Pattern(Rr)}shadingFill(Rr){const{width:Pr,height:_r}=this.viewport,kr=cr.Util.inverseTransform(this.transformMatrix),[Dr,Nr,Lr,Or]=cr.Util.getAxialAlignedBoundingBox([0,0,Pr,_r],kr),Ir=this.svgFactory.createElement("svg:rect");Ir.setAttributeNS(null,"x",Dr),Ir.setAttributeNS(null,"y",Nr),Ir.setAttributeNS(null,"width",Lr-Dr),Ir.setAttributeNS(null,"height",Or-Nr),Ir.setAttributeNS(null,"fill",this._makeShadingPattern(Rr)),this.current.fillAlpha<1&&Ir.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Ir)}_makeColorN_Pattern(Rr){return Rr[0]==="TilingPattern"?this._makeTilingPattern(Rr):this._makeShadingPattern(Rr)}_makeTilingPattern(Rr){const Pr=Rr[1],_r=Rr[2],kr=Rr[3]||cr.IDENTITY_MATRIX,[Dr,Nr,Lr,Or]=Rr[4],Ir=Rr[5],Mr=Rr[6],$r=Rr[7],jr=`shading${Er++}`,[Fr,zr,Hr,Wr]=cr.Util.normalizeRect([...cr.Util.applyTransform([Dr,Nr],kr),...cr.Util.applyTransform([Lr,Or],kr)]),[Yr,qr]=cr.Util.singularValueDecompose2dScale(kr),Br=Ir*Yr,Ur=Mr*qr,Vr=this.svgFactory.createElement("svg:pattern");Vr.setAttributeNS(null,"id",jr),Vr.setAttributeNS(null,"patternUnits","userSpaceOnUse"),Vr.setAttributeNS(null,"width",Br),Vr.setAttributeNS(null,"height",Ur),Vr.setAttributeNS(null,"x",`${Fr}`),Vr.setAttributeNS(null,"y",`${zr}`);const Xr=this.svg,Zr=this.transformMatrix,Jr=this.current.fillColor,Qr=this.current.strokeColor,ga=this.svgFactory.create(Hr-Fr,Wr-zr);if(this.svg=ga,this.transformMatrix=kr,$r===2){const ba=cr.Util.makeHexColor(...Pr);this.current.fillColor=ba,this.current.strokeColor=ba}return this.executeOpTree(this.convertOpList(_r)),this.svg=Xr,this.transformMatrix=Zr,this.current.fillColor=Jr,this.current.strokeColor=Qr,Vr.append(ga.childNodes[0]),this.defs.append(Vr),`url(#${jr})`}_makeShadingPattern(Rr){switch(typeof Rr=="string"&&(Rr=this.objs.get(Rr)),Rr[0]){case"RadialAxial":const Pr=`shading${Er++}`,_r=Rr[3];let kr;switch(Rr[1]){case"axial":const Dr=Rr[4],Nr=Rr[5];kr=this.svgFactory.createElement("svg:linearGradient"),kr.setAttributeNS(null,"id",Pr),kr.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),kr.setAttributeNS(null,"x1",Dr[0]),kr.setAttributeNS(null,"y1",Dr[1]),kr.setAttributeNS(null,"x2",Nr[0]),kr.setAttributeNS(null,"y2",Nr[1]);break;case"radial":const Lr=Rr[4],Or=Rr[5],Ir=Rr[6],Mr=Rr[7];kr=this.svgFactory.createElement("svg:radialGradient"),kr.setAttributeNS(null,"id",Pr),kr.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),kr.setAttributeNS(null,"cx",Or[0]),kr.setAttributeNS(null,"cy",Or[1]),kr.setAttributeNS(null,"r",Mr),kr.setAttributeNS(null,"fx",Lr[0]),kr.setAttributeNS(null,"fy",Lr[1]),kr.setAttributeNS(null,"fr",Ir);break;default:throw new Error(`Unknown RadialAxial type: ${Rr[1]}`)}for(const Dr of _r){const Nr=this.svgFactory.createElement("svg:stop");Nr.setAttributeNS(null,"offset",Dr[0]),Nr.setAttributeNS(null,"stop-color",Dr[1]),kr.append(Nr)}return this.defs.append(kr),`url(#${Pr})`;case"Mesh":return(0,cr.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${Rr[0]}`)}}setDash(Rr,Pr){this.current.dashArray=Rr,this.current.dashPhase=Pr}constructPath(Rr,Pr){const _r=this.current;let kr=_r.x,Dr=_r.y,Nr=[],Lr=0;for(const Or of Rr)switch(Or|0){case cr.OPS.rectangle:kr=Pr[Lr++],Dr=Pr[Lr++];const Ir=Pr[Lr++],Mr=Pr[Lr++],$r=kr+Ir,jr=Dr+Mr;Nr.push("M",xr(kr),xr(Dr),"L",xr($r),xr(Dr),"L",xr($r),xr(jr),"L",xr(kr),xr(jr),"Z");break;case cr.OPS.moveTo:kr=Pr[Lr++],Dr=Pr[Lr++],Nr.push("M",xr(kr),xr(Dr));break;case cr.OPS.lineTo:kr=Pr[Lr++],Dr=Pr[Lr++],Nr.push("L",xr(kr),xr(Dr));break;case cr.OPS.curveTo:kr=Pr[Lr+4],Dr=Pr[Lr+5],Nr.push("C",xr(Pr[Lr]),xr(Pr[Lr+1]),xr(Pr[Lr+2]),xr(Pr[Lr+3]),xr(kr),xr(Dr)),Lr+=6;break;case cr.OPS.curveTo2:Nr.push("C",xr(kr),xr(Dr),xr(Pr[Lr]),xr(Pr[Lr+1]),xr(Pr[Lr+2]),xr(Pr[Lr+3])),kr=Pr[Lr+2],Dr=Pr[Lr+3],Lr+=4;break;case cr.OPS.curveTo3:kr=Pr[Lr+2],Dr=Pr[Lr+3],Nr.push("C",xr(Pr[Lr]),xr(Pr[Lr+1]),xr(kr),xr(Dr),xr(kr),xr(Dr)),Lr+=4;break;case cr.OPS.closePath:Nr.push("Z");break}Nr=Nr.join(" "),_r.path&&Rr.length>0&&Rr[0]!==cr.OPS.rectangle&&Rr[0]!==cr.OPS.moveTo?Nr=_r.path.getAttributeNS(null,"d")+Nr:(_r.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(_r.path)),_r.path.setAttributeNS(null,"d",Nr),_r.path.setAttributeNS(null,"fill","none"),_r.element=_r.path,_r.setCurrentPoint(kr,Dr)}endPath(){const Rr=this.current;if(Rr.path=null,!this.pendingClip)return;if(!Rr.element){this.pendingClip=null;return}const Pr=`clippath${Sr++}`,_r=this.svgFactory.createElement("svg:clipPath");_r.setAttributeNS(null,"id",Pr),_r.setAttributeNS(null,"transform",Cr(this.transformMatrix));const kr=Rr.element.cloneNode(!0);if(this.pendingClip==="evenodd"?kr.setAttributeNS(null,"clip-rule","evenodd"):kr.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,_r.append(kr),this.defs.append(_r),Rr.activeClipUrl){Rr.clipGroup=null;for(const Dr of this.extraStack)Dr.clipGroup=null;_r.setAttributeNS(null,"clip-path",Rr.activeClipUrl)}Rr.activeClipUrl=`url(#${Pr})`,this.tgrp=null}clip(Rr){this.pendingClip=Rr}closePath(){const Rr=this.current;if(Rr.path){const Pr=`${Rr.path.getAttributeNS(null,"d")}Z`;Rr.path.setAttributeNS(null,"d",Pr)}}setLeading(Rr){this.current.leading=-Rr}setTextRise(Rr){this.current.textRise=Rr}setTextRenderingMode(Rr){this.current.textRenderingMode=Rr}setHScale(Rr){this.current.textHScale=Rr/100}setRenderingIntent(Rr){}setFlatness(Rr){}setGState(Rr){for(const[Pr,_r]of Rr)switch(Pr){case"LW":this.setLineWidth(_r);break;case"LC":this.setLineCap(_r);break;case"LJ":this.setLineJoin(_r);break;case"ML":this.setMiterLimit(_r);break;case"D":this.setDash(_r[0],_r[1]);break;case"RI":this.setRenderingIntent(_r);break;case"FL":this.setFlatness(_r);break;case"Font":this.setFont(_r);break;case"CA":this.setStrokeAlpha(_r);break;case"ca":this.setFillAlpha(_r);break;default:(0,cr.warn)(`Unimplemented graphic state operator ${Pr}`);break}}fill(){const Rr=this.current;Rr.element&&(Rr.element.setAttributeNS(null,"fill",Rr.fillColor),Rr.element.setAttributeNS(null,"fill-opacity",Rr.fillAlpha),this.endPath())}stroke(){const Rr=this.current;Rr.element&&(this._setStrokeAttributes(Rr.element),Rr.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(Rr,Pr=1){const _r=this.current;let kr=_r.dashArray;Pr!==1&&kr.length>0&&(kr=kr.map(function(Dr){return Pr*Dr})),Rr.setAttributeNS(null,"stroke",_r.strokeColor),Rr.setAttributeNS(null,"stroke-opacity",_r.strokeAlpha),Rr.setAttributeNS(null,"stroke-miterlimit",xr(_r.miterLimit)),Rr.setAttributeNS(null,"stroke-linecap",_r.lineCap),Rr.setAttributeNS(null,"stroke-linejoin",_r.lineJoin),Rr.setAttributeNS(null,"stroke-width",xr(Pr*_r.lineWidth)+"px"),Rr.setAttributeNS(null,"stroke-dasharray",kr.map(xr).join(" ")),Rr.setAttributeNS(null,"stroke-dashoffset",xr(Pr*_r.dashPhase)+"px")}eoFill(){var Rr;(Rr=this.current.element)==null||Rr.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var Rr;(Rr=this.current.element)==null||Rr.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const Rr=this.svgFactory.createElement("svg:rect");Rr.setAttributeNS(null,"x","0"),Rr.setAttributeNS(null,"y","0"),Rr.setAttributeNS(null,"width","1px"),Rr.setAttributeNS(null,"height","1px"),Rr.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(Rr)}paintImageXObject(Rr){const Pr=this.getObject(Rr);if(!Pr){(0,cr.warn)(`Dependent image with object ID ${Rr} is not ready yet`);return}this.paintInlineImageXObject(Pr)}paintInlineImageXObject(Rr,Pr){const _r=Rr.width,kr=Rr.height,Dr=mr(Rr,this.forceDataSchema,!!Pr),Nr=this.svgFactory.createElement("svg:rect");Nr.setAttributeNS(null,"x","0"),Nr.setAttributeNS(null,"y","0"),Nr.setAttributeNS(null,"width",xr(_r)),Nr.setAttributeNS(null,"height",xr(kr)),this.current.element=Nr,this.clip("nonzero");const Lr=this.svgFactory.createElement("svg:image");Lr.setAttributeNS(fr,"xlink:href",Dr),Lr.setAttributeNS(null,"x","0"),Lr.setAttributeNS(null,"y",xr(-kr)),Lr.setAttributeNS(null,"width",xr(_r)+"px"),Lr.setAttributeNS(null,"height",xr(kr)+"px"),Lr.setAttributeNS(null,"transform",`scale(${xr(1/_r)} ${xr(-1/kr)})`),Pr?Pr.append(Lr):this._ensureTransformGroup().append(Lr)}paintImageMaskXObject(Rr){const Pr=this.getObject(Rr.data,Rr);if(Pr.bitmap){(0,cr.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const _r=this.current,kr=Pr.width,Dr=Pr.height,Nr=_r.fillColor;_r.maskId=`mask${wr++}`;const Lr=this.svgFactory.createElement("svg:mask");Lr.setAttributeNS(null,"id",_r.maskId);const Or=this.svgFactory.createElement("svg:rect");Or.setAttributeNS(null,"x","0"),Or.setAttributeNS(null,"y","0"),Or.setAttributeNS(null,"width",xr(kr)),Or.setAttributeNS(null,"height",xr(Dr)),Or.setAttributeNS(null,"fill",Nr),Or.setAttributeNS(null,"mask",`url(#${_r.maskId})`),this.defs.append(Lr),this._ensureTransformGroup().append(Or),this.paintInlineImageXObject(Pr,Lr)}paintFormXObjectBegin(Rr,Pr){if(Array.isArray(Rr)&&Rr.length===6&&this.transform(Rr[0],Rr[1],Rr[2],Rr[3],Rr[4],Rr[5]),Pr){const _r=Pr[2]-Pr[0],kr=Pr[3]-Pr[1],Dr=this.svgFactory.createElement("svg:rect");Dr.setAttributeNS(null,"x",Pr[0]),Dr.setAttributeNS(null,"y",Pr[1]),Dr.setAttributeNS(null,"width",xr(_r)),Dr.setAttributeNS(null,"height",xr(kr)),this.current.element=Dr,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(Rr){const Pr=this.svgFactory.create(Rr.width,Rr.height),_r=this.svgFactory.createElement("svg:defs");Pr.append(_r),this.defs=_r;const kr=this.svgFactory.createElement("svg:g");return kr.setAttributeNS(null,"transform",Cr(Rr.transform)),Pr.append(kr),this.svg=kr,Pr}_ensureClipGroup(){if(!this.current.clipGroup){const Rr=this.svgFactory.createElement("svg:g");Rr.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(Rr),this.current.clipGroup=Rr}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",Cr(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}ar.SVGGraphics=Ar},(or,ar)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.XfaText=void 0;class lr{static textContent(cr){const hr=[],dr={items:hr,styles:Object.create(null)};function fr(pr){var mr;if(!pr)return;let vr=null;const gr=pr.name;if(gr==="#text")vr=pr.value;else if(lr.shouldBuildText(gr))(mr=pr==null?void 0:pr.attributes)!=null&&mr.textContent?vr=pr.attributes.textContent:pr.value&&(vr=pr.value);else return;if(vr!==null&&hr.push({str:vr}),!!pr.children)for(const br of pr.children)fr(br)}return fr(cr),dr}static shouldBuildText(cr){return!(cr==="textarea"||cr==="input"||cr==="option"||cr==="select")}}ar.XfaText=lr},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.TextLayerRenderTask=void 0,ar.renderTextLayer=Cr,ar.updateTextLayer=Sr;var ur=lr(1),cr=lr(6);const hr=1e5,dr=30,fr=.8,pr=new Map;function vr(wr,Er){let Ar;if(Er&&ur.FeatureTest.isOffscreenCanvasSupported)Ar=new OffscreenCanvas(wr,wr).getContext("2d",{alpha:!1});else{const Tr=document.createElement("canvas");Tr.width=Tr.height=wr,Ar=Tr.getContext("2d",{alpha:!1})}return Ar}function gr(wr,Er){const Ar=pr.get(wr);if(Ar)return Ar;const Tr=vr(dr,Er);Tr.font=`${dr}px ${wr}`;const Rr=Tr.measureText("");let Pr=Rr.fontBoundingBoxAscent,_r=Math.abs(Rr.fontBoundingBoxDescent);if(Pr){const Dr=Pr/(Pr+_r);return pr.set(wr,Dr),Tr.canvas.width=Tr.canvas.height=0,Dr}Tr.strokeStyle="red",Tr.clearRect(0,0,dr,dr),Tr.strokeText("g",0,0);let kr=Tr.getImageData(0,0,dr,dr).data;_r=0;for(let Dr=kr.length-1-3;Dr>=0;Dr-=4)if(kr[Dr]>0){_r=Math.ceil(Dr/4/dr);break}Tr.clearRect(0,0,dr,dr),Tr.strokeText("A",0,dr),kr=Tr.getImageData(0,0,dr,dr).data,Pr=0;for(let Dr=0,Nr=kr.length;Dr<Nr;Dr+=4)if(kr[Dr]>0){Pr=dr-Math.floor(Dr/4/dr);break}if(Tr.canvas.width=Tr.canvas.height=0,Pr){const Dr=Pr/(Pr+_r);return pr.set(wr,Dr),Dr}return pr.set(wr,fr),fr}function mr(wr,Er,Ar){const Tr=document.createElement("span"),Rr={angle:0,canvasWidth:0,hasText:Er.str!=="",hasEOL:Er.hasEOL,fontSize:0};wr._textDivs.push(Tr);const Pr=ur.Util.transform(wr._transform,Er.transform);let _r=Math.atan2(Pr[1],Pr[0]);const kr=Ar[Er.fontName];kr.vertical&&(_r+=Math.PI/2);const Dr=Math.hypot(Pr[2],Pr[3]),Nr=Dr*gr(kr.fontFamily,wr._isOffscreenCanvasSupported);let Lr,Or;_r===0?(Lr=Pr[4],Or=Pr[5]-Nr):(Lr=Pr[4]+Nr*Math.sin(_r),Or=Pr[5]-Nr*Math.cos(_r));const Ir="calc(var(--scale-factor)*",Mr=Tr.style;wr._container===wr._rootContainer?(Mr.left=`${(100*Lr/wr._pageWidth).toFixed(2)}%`,Mr.top=`${(100*Or/wr._pageHeight).toFixed(2)}%`):(Mr.left=`${Ir}${Lr.toFixed(2)}px)`,Mr.top=`${Ir}${Or.toFixed(2)}px)`),Mr.fontSize=`${Ir}${Dr.toFixed(2)}px)`,Mr.fontFamily=kr.fontFamily,Rr.fontSize=Dr,Tr.setAttribute("role","presentation"),Tr.textContent=Er.str,Tr.dir=Er.dir,wr._fontInspectorEnabled&&(Tr.dataset.fontName=Er.fontName),_r!==0&&(Rr.angle=_r*(180/Math.PI));let $r=!1;if(Er.str.length>1)$r=!0;else if(Er.str!==" "&&Er.transform[0]!==Er.transform[3]){const jr=Math.abs(Er.transform[0]),Fr=Math.abs(Er.transform[3]);jr!==Fr&&Math.max(jr,Fr)/Math.min(jr,Fr)>1.5&&($r=!0)}$r&&(Rr.canvasWidth=kr.vertical?Er.height:Er.width),wr._textDivProperties.set(Tr,Rr),wr._isReadableStream&&wr._layoutText(Tr)}function br(wr){const{div:Er,scale:Ar,properties:Tr,ctx:Rr,prevFontSize:Pr,prevFontFamily:_r}=wr,{style:kr}=Er;let Dr="";if(Tr.canvasWidth!==0&&Tr.hasText){const{fontFamily:Nr}=kr,{canvasWidth:Lr,fontSize:Or}=Tr;(Pr!==Or||_r!==Nr)&&(Rr.font=`${Or*Ar}px ${Nr}`,wr.prevFontSize=Or,wr.prevFontFamily=Nr);const{width:Ir}=Rr.measureText(Er.textContent);Ir>0&&(Dr=`scaleX(${Lr*Ar/Ir})`)}Tr.angle!==0&&(Dr=`rotate(${Tr.angle}deg) ${Dr}`),Dr.length>0&&(kr.transform=Dr)}function yr(wr){if(wr._canceled)return;const Er=wr._textDivs,Ar=wr._capability;if(Er.length>hr){Ar.resolve();return}if(!wr._isReadableStream)for(const Rr of Er)wr._layoutText(Rr);Ar.resolve()}class xr{constructor({textContentSource:Er,container:Ar,viewport:Tr,textDivs:Rr,textDivProperties:Pr,textContentItemsStr:_r,isOffscreenCanvasSupported:kr}){var Ir;this._textContentSource=Er,this._isReadableStream=Er instanceof ReadableStream,this._container=this._rootContainer=Ar,this._textDivs=Rr||[],this._textContentItemsStr=_r||[],this._isOffscreenCanvasSupported=kr,this._fontInspectorEnabled=!!((Ir=globalThis.FontInspector)!=null&&Ir.enabled),this._reader=null,this._textDivProperties=Pr||new WeakMap,this._canceled=!1,this._capability=new ur.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:Tr.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:vr(0,kr)};const{pageWidth:Dr,pageHeight:Nr,pageX:Lr,pageY:Or}=Tr.rawDims;this._transform=[1,0,0,-1,-Lr,Or+Nr],this._pageWidth=Dr,this._pageHeight=Nr,(0,cr.setLayerDimensions)(Ar,Tr),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new ur.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new ur.AbortException("TextLayer task cancelled."))}_processItems(Er,Ar){for(const Tr of Er){if(Tr.str===void 0){if(Tr.type==="beginMarkedContentProps"||Tr.type==="beginMarkedContent"){const Rr=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),Tr.id!==null&&this._container.setAttribute("id",`${Tr.id}`),Rr.append(this._container)}else Tr.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(Tr.str),mr(this,Tr,Ar)}}_layoutText(Er){const Ar=this._layoutTextParams.properties=this._textDivProperties.get(Er);if(this._layoutTextParams.div=Er,br(this._layoutTextParams),Ar.hasText&&this._container.append(Er),Ar.hasEOL){const Tr=document.createElement("br");Tr.setAttribute("role","presentation"),this._container.append(Tr)}}_render(){const Er=new ur.PromiseCapability;let Ar=Object.create(null);if(this._isReadableStream){const Tr=()=>{this._reader.read().then(({value:Rr,done:Pr})=>{if(Pr){Er.resolve();return}Object.assign(Ar,Rr.styles),this._processItems(Rr.items,Ar),Tr()},Er.reject)};this._reader=this._textContentSource.getReader(),Tr()}else if(this._textContentSource){const{items:Tr,styles:Rr}=this._textContentSource;this._processItems(Tr,Rr),Er.resolve()}else throw new Error('No "textContentSource" parameter specified.');Er.promise.then(()=>{Ar=null,yr(this)},this._capability.reject)}}ar.TextLayerRenderTask=xr;function Cr(wr){!wr.textContentSource&&(wr.textContent||wr.textContentStream)&&((0,cr.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),wr.textContentSource=wr.textContent||wr.textContentStream);const{container:Er,viewport:Ar}=wr,Tr=getComputedStyle(Er),Rr=Tr.getPropertyValue("visibility"),Pr=parseFloat(Tr.getPropertyValue("--scale-factor"));Rr==="visible"&&(!Pr||Math.abs(Pr-Ar.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const _r=new xr(wr);return _r._render(),_r}function Sr({container:wr,viewport:Er,textDivs:Ar,textDivProperties:Tr,isOffscreenCanvasSupported:Rr,mustRotate:Pr=!0,mustRescale:_r=!0}){if(Pr&&(0,cr.setLayerDimensions)(wr,{rotation:Er.rotation}),_r){const kr=vr(0,Rr),Nr={prevFontSize:null,prevFontFamily:null,div:null,scale:Er.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:kr};for(const Lr of Ar)Nr.properties=Tr.get(Lr),Nr.div=Lr,br(Nr)}}},(or,ar,lr)=>{var gr,mr,br,yr,xr,Cr,Sr,wr,Er,Ar,Tr,Ll,jo,Nl,Ol;Object.defineProperty(ar,"__esModule",{value:!0}),ar.AnnotationEditorLayer=void 0;var ur=lr(1),cr=lr(4),hr=lr(28),dr=lr(33),fr=lr(6),pr=lr(34);const Dr=class Dr{constructor({uiManager:Lr,pageIndex:Or,div:Ir,accessibilityManager:Mr,annotationLayer:$r,viewport:jr,l10n:Fr}){Ts(this,Tr);Ts(this,gr);Ts(this,mr,!1);Ts(this,br,null);Ts(this,yr,this.pointerup.bind(this));Ts(this,xr,this.pointerdown.bind(this));Ts(this,Cr,new Map);Ts(this,Sr,!1);Ts(this,wr,!1);Ts(this,Er,!1);Ts(this,Ar);const zr=[hr.FreeTextEditor,dr.InkEditor,pr.StampEditor];if(!Dr._initialized){Dr._initialized=!0;for(const Hr of zr)Hr.initialize(Fr)}Lr.registerEditorTypes(zr),_s(this,Ar,Lr),this.pageIndex=Or,this.div=Ir,_s(this,gr,Mr),_s(this,br,$r),this.viewport=jr,Gr(this,Ar).addLayer(this)}get isEmpty(){return Gr(this,Cr).size===0}updateToolbar(Lr){Gr(this,Ar).updateToolbar(Lr)}updateMode(Lr=Gr(this,Ar).getMode()){ws(this,Tr,Ol).call(this),Lr===ur.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),Lr!==ur.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",Lr===ur.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",Lr===ur.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",Lr===ur.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(Lr){if(!Lr&&Gr(this,Ar).getMode()!==ur.AnnotationEditorType.INK)return;if(!Lr){for(const Ir of Gr(this,Cr).values())if(Ir.isEmpty()){Ir.setInBackground();return}}ws(this,Tr,jo).call(this,{offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(Lr){Gr(this,Ar).setEditingState(Lr)}addCommands(Lr){Gr(this,Ar).addCommands(Lr)}enable(){this.div.style.pointerEvents="auto";const Lr=new Set;for(const Ir of Gr(this,Cr).values())Ir.enableEditing(),Ir.annotationElementId&&Lr.add(Ir.annotationElementId);if(!Gr(this,br))return;const Or=Gr(this,br).getEditableAnnotations();for(const Ir of Or){if(Ir.hide(),Gr(this,Ar).isDeletedAnnotationElement(Ir.data.id)||Lr.has(Ir.data.id))continue;const Mr=this.deserialize(Ir);Mr&&(this.addOrRebuild(Mr),Mr.enableEditing())}}disable(){var Or;_s(this,Er,!0),this.div.style.pointerEvents="none";const Lr=new Set;for(const Ir of Gr(this,Cr).values()){if(Ir.disableEditing(),!Ir.annotationElementId||Ir.serialize()!==null){Lr.add(Ir.annotationElementId);continue}(Or=this.getEditableAnnotation(Ir.annotationElementId))==null||Or.show(),Ir.remove()}if(Gr(this,br)){const Ir=Gr(this,br).getEditableAnnotations();for(const Mr of Ir){const{id:$r}=Mr.data;Lr.has($r)||Gr(this,Ar).isDeletedAnnotationElement($r)||Mr.show()}}ws(this,Tr,Ol).call(this),this.isEmpty&&(this.div.hidden=!0),_s(this,Er,!1)}getEditableAnnotation(Lr){var Or;return((Or=Gr(this,br))==null?void 0:Or.getEditableAnnotation(Lr))||null}setActiveEditor(Lr){Gr(this,Ar).getActive()!==Lr&&Gr(this,Ar).setActiveEditor(Lr)}enableClick(){this.div.addEventListener("pointerdown",Gr(this,xr)),this.div.addEventListener("pointerup",Gr(this,yr))}disableClick(){this.div.removeEventListener("pointerdown",Gr(this,xr)),this.div.removeEventListener("pointerup",Gr(this,yr))}attach(Lr){Gr(this,Cr).set(Lr.id,Lr);const{annotationElementId:Or}=Lr;Or&&Gr(this,Ar).isDeletedAnnotationElement(Or)&&Gr(this,Ar).removeDeletedAnnotationElement(Lr)}detach(Lr){var Or;Gr(this,Cr).delete(Lr.id),(Or=Gr(this,gr))==null||Or.removePointerInTextLayer(Lr.contentDiv),!Gr(this,Er)&&Lr.annotationElementId&&Gr(this,Ar).addDeletedAnnotationElement(Lr)}remove(Lr){this.detach(Lr),Gr(this,Ar).removeEditor(Lr),Lr.div.contains(document.activeElement)&&setTimeout(()=>{Gr(this,Ar).focusMainContainer()},0),Lr.div.remove(),Lr.isAttachedToDOM=!1,Gr(this,wr)||this.addInkEditorIfNeeded(!1)}changeParent(Lr){var Or;Lr.parent!==this&&(Lr.annotationElementId&&(Gr(this,Ar).addDeletedAnnotationElement(Lr.annotationElementId),cr.AnnotationEditor.deleteAnnotationElement(Lr),Lr.annotationElementId=null),this.attach(Lr),(Or=Lr.parent)==null||Or.detach(Lr),Lr.setParent(this),Lr.div&&Lr.isAttachedToDOM&&(Lr.div.remove(),this.div.append(Lr.div)))}add(Lr){if(this.changeParent(Lr),Gr(this,Ar).addEditor(Lr),this.attach(Lr),!Lr.isAttachedToDOM){const Or=Lr.render();this.div.append(Or),Lr.isAttachedToDOM=!0}Lr.fixAndSetPosition(),Lr.onceAdded(),Gr(this,Ar).addToAnnotationStorage(Lr)}moveEditorInDOM(Lr){var Ir;if(!Lr.isAttachedToDOM)return;const{activeElement:Or}=document;Lr.div.contains(Or)&&(Lr._focusEventsAllowed=!1,setTimeout(()=>{Lr.div.contains(document.activeElement)?Lr._focusEventsAllowed=!0:(Lr.div.addEventListener("focusin",()=>{Lr._focusEventsAllowed=!0},{once:!0}),Or.focus())},0)),Lr._structTreeParentId=(Ir=Gr(this,gr))==null?void 0:Ir.moveElementInDOM(this.div,Lr.div,Lr.contentDiv,!0)}addOrRebuild(Lr){Lr.needsToBeRebuilt()?Lr.rebuild():this.add(Lr)}addUndoableEditor(Lr){const Or=()=>Lr._uiManager.rebuild(Lr),Ir=()=>{Lr.remove()};this.addCommands({cmd:Or,undo:Ir,mustExec:!1})}getNextId(){return Gr(this,Ar).getId()}pasteEditor(Lr,Or){Gr(this,Ar).updateToolbar(Lr),Gr(this,Ar).updateMode(Lr);const{offsetX:Ir,offsetY:Mr}=ws(this,Tr,Nl).call(this),$r=this.getNextId(),jr=ws(this,Tr,Ll).call(this,{parent:this,id:$r,x:Ir,y:Mr,uiManager:Gr(this,Ar),isCentered:!0,...Or});jr&&this.add(jr)}deserialize(Lr){switch(Lr.annotationType??Lr.annotationEditorType){case ur.AnnotationEditorType.FREETEXT:return hr.FreeTextEditor.deserialize(Lr,this,Gr(this,Ar));case ur.AnnotationEditorType.INK:return dr.InkEditor.deserialize(Lr,this,Gr(this,Ar));case ur.AnnotationEditorType.STAMP:return pr.StampEditor.deserialize(Lr,this,Gr(this,Ar))}return null}addNewEditor(){ws(this,Tr,jo).call(this,ws(this,Tr,Nl).call(this),!0)}setSelected(Lr){Gr(this,Ar).setSelected(Lr)}toggleSelected(Lr){Gr(this,Ar).toggleSelected(Lr)}isSelected(Lr){return Gr(this,Ar).isSelected(Lr)}unselect(Lr){Gr(this,Ar).unselect(Lr)}pointerup(Lr){const{isMac:Or}=ur.FeatureTest.platform;if(!(Lr.button!==0||Lr.ctrlKey&&Or)&&Lr.target===this.div&&Gr(this,Sr)){if(_s(this,Sr,!1),!Gr(this,mr)){_s(this,mr,!0);return}if(Gr(this,Ar).getMode()===ur.AnnotationEditorType.STAMP){Gr(this,Ar).unselectAll();return}ws(this,Tr,jo).call(this,Lr,!1)}}pointerdown(Lr){if(Gr(this,Sr)){_s(this,Sr,!1);return}const{isMac:Or}=ur.FeatureTest.platform;if(Lr.button!==0||Lr.ctrlKey&&Or||Lr.target!==this.div)return;_s(this,Sr,!0);const Ir=Gr(this,Ar).getActive();_s(this,mr,!Ir||Ir.isEmpty())}findNewParent(Lr,Or,Ir){const Mr=Gr(this,Ar).findParent(Or,Ir);return Mr===null||Mr===this?!1:(Mr.changeParent(Lr),!0)}destroy(){var Lr,Or;((Lr=Gr(this,Ar).getActive())==null?void 0:Lr.parent)===this&&(Gr(this,Ar).commitOrRemove(),Gr(this,Ar).setActiveEditor(null));for(const Ir of Gr(this,Cr).values())(Or=Gr(this,gr))==null||Or.removePointerInTextLayer(Ir.contentDiv),Ir.setParent(null),Ir.isAttachedToDOM=!1,Ir.div.remove();this.div=null,Gr(this,Cr).clear(),Gr(this,Ar).removeLayer(this)}render({viewport:Lr}){this.viewport=Lr,(0,fr.setLayerDimensions)(this.div,Lr);for(const Or of Gr(this,Ar).getEditors(this.pageIndex))this.add(Or);this.updateMode()}update({viewport:Lr}){Gr(this,Ar).commitOrRemove(),this.viewport=Lr,(0,fr.setLayerDimensions)(this.div,{rotation:Lr.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:Lr,pageHeight:Or}=this.viewport.rawDims;return[Lr,Or]}};gr=new WeakMap,mr=new WeakMap,br=new WeakMap,yr=new WeakMap,xr=new WeakMap,Cr=new WeakMap,Sr=new WeakMap,wr=new WeakMap,Er=new WeakMap,Ar=new WeakMap,Tr=new WeakSet,Ll=function(Lr){switch(Gr(this,Ar).getMode()){case ur.AnnotationEditorType.FREETEXT:return new hr.FreeTextEditor(Lr);case ur.AnnotationEditorType.INK:return new dr.InkEditor(Lr);case ur.AnnotationEditorType.STAMP:return new pr.StampEditor(Lr)}return null},jo=function(Lr,Or){const Ir=this.getNextId(),Mr=ws(this,Tr,Ll).call(this,{parent:this,id:Ir,x:Lr.offsetX,y:Lr.offsetY,uiManager:Gr(this,Ar),isCentered:Or});return Mr&&this.add(Mr),Mr},Nl=function(){const{x:Lr,y:Or,width:Ir,height:Mr}=this.div.getBoundingClientRect(),$r=Math.max(0,Lr),jr=Math.max(0,Or),Fr=Math.min(window.innerWidth,Lr+Ir),zr=Math.min(window.innerHeight,Or+Mr),Hr=($r+Fr)/2-Lr,Wr=(jr+zr)/2-Or,[Yr,qr]=this.viewport.rotation%180===0?[Hr,Wr]:[Wr,Hr];return{offsetX:Yr,offsetY:qr}},Ol=function(){_s(this,wr,!0);for(const Lr of Gr(this,Cr).values())Lr.isEmpty()&&Lr.remove();_s(this,wr,!1)},Zs(Dr,"_initialized",!1);let vr=Dr;ar.AnnotationEditorLayer=vr},(or,ar,lr)=>{var pr,vr,gr,mr,br,yr,xr,Cr,Sr,wr,hu,du,fu,ko,Il,pu,Fl;Object.defineProperty(ar,"__esModule",{value:!0}),ar.FreeTextEditor=void 0;var ur=lr(1),cr=lr(5),hr=lr(4),dr=lr(29);const Dr=class Dr extends hr.AnnotationEditor{constructor(Or){super({...Or,name:"freeTextEditor"});Ts(this,wr);Ts(this,pr,this.editorDivBlur.bind(this));Ts(this,vr,this.editorDivFocus.bind(this));Ts(this,gr,this.editorDivInput.bind(this));Ts(this,mr,this.editorDivKeydown.bind(this));Ts(this,br);Ts(this,yr,"");Ts(this,xr,`${this.id}-editor`);Ts(this,Cr);Ts(this,Sr,null);_s(this,br,Or.color||Dr._defaultColor||hr.AnnotationEditor._defaultLineColor),_s(this,Cr,Or.fontSize||Dr._defaultFontSize)}static get _keyboardManager(){const Or=Dr.prototype,Ir=jr=>jr.isEmpty(),Mr=cr.AnnotationEditorUIManager.TRANSLATE_SMALL,$r=cr.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,ur.shadow)(this,"_keyboardManager",new cr.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Or.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Or.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Or._translateEmpty,{args:[-Mr,0],checker:Ir}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Or._translateEmpty,{args:[-$r,0],checker:Ir}],[["ArrowRight","mac+ArrowRight"],Or._translateEmpty,{args:[Mr,0],checker:Ir}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Or._translateEmpty,{args:[$r,0],checker:Ir}],[["ArrowUp","mac+ArrowUp"],Or._translateEmpty,{args:[0,-Mr],checker:Ir}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Or._translateEmpty,{args:[0,-$r],checker:Ir}],[["ArrowDown","mac+ArrowDown"],Or._translateEmpty,{args:[0,Mr],checker:Ir}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Or._translateEmpty,{args:[0,$r],checker:Ir}]]))}static initialize(Or){hr.AnnotationEditor.initialize(Or,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Ir=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Ir.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Or,Ir){switch(Or){case ur.AnnotationEditorParamsType.FREETEXT_SIZE:Dr._defaultFontSize=Ir;break;case ur.AnnotationEditorParamsType.FREETEXT_COLOR:Dr._defaultColor=Ir;break}}updateParams(Or,Ir){switch(Or){case ur.AnnotationEditorParamsType.FREETEXT_SIZE:ws(this,wr,hu).call(this,Ir);break;case ur.AnnotationEditorParamsType.FREETEXT_COLOR:ws(this,wr,du).call(this,Ir);break}}static get defaultPropertiesToUpdate(){return[[ur.AnnotationEditorParamsType.FREETEXT_SIZE,Dr._defaultFontSize],[ur.AnnotationEditorParamsType.FREETEXT_COLOR,Dr._defaultColor||hr.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[ur.AnnotationEditorParamsType.FREETEXT_SIZE,Gr(this,Cr)],[ur.AnnotationEditorParamsType.FREETEXT_COLOR,Gr(this,br)]]}_translateEmpty(Or,Ir){this._uiManager.translateSelectedEditors(Or,Ir,!0)}getInitialTranslation(){const Or=this.parentScale;return[-Dr._internalPadding*Or,-(Dr._internalPadding+Gr(this,Cr))*Or]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(ur.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",Gr(this,mr)),this.editorDiv.addEventListener("focus",Gr(this,vr)),this.editorDiv.addEventListener("blur",Gr(this,pr)),this.editorDiv.addEventListener("input",Gr(this,gr)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",Gr(this,xr)),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",Gr(this,mr)),this.editorDiv.removeEventListener("focus",Gr(this,vr)),this.editorDiv.removeEventListener("blur",Gr(this,pr)),this.editorDiv.removeEventListener("input",Gr(this,gr)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Or){this._focusEventsAllowed&&(super.focusin(Or),Or.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){var Or;if(this.width){ws(this,wr,Fl).call(this);return}this.enableEditMode(),this.editorDiv.focus(),(Or=this._initialOptions)!=null&&Or.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Or=Gr(this,yr),Ir=_s(this,yr,ws(this,wr,fu).call(this).trimEnd());if(Or===Ir)return;const Mr=$r=>{if(_s(this,yr,$r),!$r){this.remove();return}ws(this,wr,Il).call(this),this._uiManager.rebuild(this),ws(this,wr,ko).call(this)};this.addCommands({cmd:()=>{Mr(Ir)},undo:()=>{Mr(Or)},mustExec:!1}),ws(this,wr,ko).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Or){this.enterInEditMode()}keydown(Or){Or.target===this.div&&Or.key==="Enter"&&(this.enterInEditMode(),Or.preventDefault())}editorDivKeydown(Or){Dr._keyboardManager.exec(this,Or)}editorDivFocus(Or){this.isEditing=!0}editorDivBlur(Or){this.isEditing=!1}editorDivInput(Or){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Or,Ir;this.width&&(Or=this.x,Ir=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",Gr(this,xr)),this.enableEditing(),hr.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then($r=>{var jr;return(jr=this.editorDiv)==null?void 0:jr.setAttribute("aria-label",$r)}),hr.AnnotationEditor._l10nPromise.get("free_text2_default_content").then($r=>{var jr;return(jr=this.editorDiv)==null?void 0:jr.setAttribute("default-content",$r)}),this.editorDiv.contentEditable=!0;const{style:Mr}=this.editorDiv;if(Mr.fontSize=`calc(${Gr(this,Cr)}px * var(--scale-factor))`,Mr.color=Gr(this,br),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,cr.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[$r,jr]=this.parentDimensions;if(this.annotationElementId){const{position:Fr}=Gr(this,Sr);let[zr,Hr]=this.getInitialTranslation();[zr,Hr]=this.pageTranslationToScreen(zr,Hr);const[Wr,Yr]=this.pageDimensions,[qr,Br]=this.pageTranslation;let Ur,Vr;switch(this.rotation){case 0:Ur=Or+(Fr[0]-qr)/Wr,Vr=Ir+this.height-(Fr[1]-Br)/Yr;break;case 90:Ur=Or+(Fr[0]-qr)/Wr,Vr=Ir-(Fr[1]-Br)/Yr,[zr,Hr]=[Hr,-zr];break;case 180:Ur=Or-this.width+(Fr[0]-qr)/Wr,Vr=Ir-(Fr[1]-Br)/Yr,[zr,Hr]=[-zr,-Hr];break;case 270:Ur=Or+(Fr[0]-qr-this.height*Yr)/Wr,Vr=Ir+(Fr[1]-Br-this.width*Wr)/Yr,[zr,Hr]=[-Hr,zr];break}this.setAt(Ur*$r,Vr*jr,zr,Hr)}else this.setAt(Or*$r,Ir*jr,this.width*$r,this.height*jr);ws(this,wr,Il).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(Or,Ir,Mr){let $r=null;if(Or instanceof dr.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:Fr,fontColor:zr},rect:Hr,rotation:Wr,id:Yr},textContent:qr,textPosition:Br,parent:{page:{pageNumber:Ur}}}=Or;if(!qr||qr.length===0)return null;$r=Or={annotationType:ur.AnnotationEditorType.FREETEXT,color:Array.from(zr),fontSize:Fr,value:qr.join(`
`),position:Br,pageIndex:Ur-1,rect:Hr,rotation:Wr,id:Yr,deleted:!1}}const jr=super.deserialize(Or,Ir,Mr);return _s(jr,Cr,Or.fontSize),_s(jr,br,ur.Util.makeHexColor(...Or.color)),_s(jr,yr,Or.value),jr.annotationElementId=Or.id||null,_s(jr,Sr,$r),jr}serialize(Or=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Ir=Dr._internalPadding*this.parentScale,Mr=this.getRect(Ir,Ir),$r=hr.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:Gr(this,br)),jr={annotationType:ur.AnnotationEditorType.FREETEXT,color:$r,fontSize:Gr(this,Cr),value:Gr(this,yr),pageIndex:this.pageIndex,rect:Mr,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Or?jr:this.annotationElementId&&!ws(this,wr,pu).call(this,jr)?null:(jr.id=this.annotationElementId,jr)}};pr=new WeakMap,vr=new WeakMap,gr=new WeakMap,mr=new WeakMap,br=new WeakMap,yr=new WeakMap,xr=new WeakMap,Cr=new WeakMap,Sr=new WeakMap,wr=new WeakSet,hu=function(Or){const Ir=$r=>{this.editorDiv.style.fontSize=`calc(${$r}px * var(--scale-factor))`,this.translate(0,-($r-Gr(this,Cr))*this.parentScale),_s(this,Cr,$r),ws(this,wr,ko).call(this)},Mr=Gr(this,Cr);this.addCommands({cmd:()=>{Ir(Or)},undo:()=>{Ir(Mr)},mustExec:!0,type:ur.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},du=function(Or){const Ir=Gr(this,br);this.addCommands({cmd:()=>{_s(this,br,this.editorDiv.style.color=Or)},undo:()=>{_s(this,br,this.editorDiv.style.color=Ir)},mustExec:!0,type:ur.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},fu=function(){const Or=this.editorDiv.getElementsByTagName("div");if(Or.length===0)return this.editorDiv.innerText;const Ir=[];for(const Mr of Or)Ir.push(Mr.innerText.replace(/\r\n?|\n/,""));return Ir.join(`
`)},ko=function(){const[Or,Ir]=this.parentDimensions;let Mr;if(this.isAttachedToDOM)Mr=this.div.getBoundingClientRect();else{const{currentLayer:$r,div:jr}=this,Fr=jr.style.display;jr.style.display="hidden",$r.div.append(this.div),Mr=jr.getBoundingClientRect(),jr.remove(),jr.style.display=Fr}this.rotation%180===this.parentRotation%180?(this.width=Mr.width/Or,this.height=Mr.height/Ir):(this.width=Mr.height/Or,this.height=Mr.width/Ir),this.fixAndSetPosition()},Il=function(){if(this.editorDiv.replaceChildren(),!!Gr(this,yr))for(const Or of Gr(this,yr).split(`
`)){const Ir=document.createElement("div");Ir.append(Or?document.createTextNode(Or):document.createElement("br")),this.editorDiv.append(Ir)}},pu=function(Or){const{value:Ir,fontSize:Mr,color:$r,rect:jr,pageIndex:Fr}=Gr(this,Sr);return Or.value!==Ir||Or.fontSize!==Mr||Or.rect.some((zr,Hr)=>Math.abs(zr-jr[Hr])>=1)||Or.color.some((zr,Hr)=>zr!==$r[Hr])||Or.pageIndex!==Fr},Fl=function(Or=!1){if(!this.annotationElementId)return;if(ws(this,wr,ko).call(this),!Or&&(this.width===0||this.height===0)){setTimeout(()=>ws(this,wr,Fl).call(this,!0),0);return}const Ir=Dr._internalPadding*this.parentScale;Gr(this,Sr).rect=this.getRect(Ir,Ir)},Zs(Dr,"_freeTextDefaultContent",""),Zs(Dr,"_internalPadding",0),Zs(Dr,"_defaultColor",null),Zs(Dr,"_defaultFontSize",10),Zs(Dr,"_type","freetext");let fr=Dr;ar.FreeTextEditor=fr},(or,ar,lr)=>{var Vr,Zr,vo,vu,ga,ba,_i,os,ls,ys,ns,as,Kr,$a,ss,hs,vs,bs,xs,fs,Is,Os,gu,zo,$l,Bl,us,na,ds,is,_a,rs,Cs,zl,Rs,xa,ps,Ps,mu,Ul;Object.defineProperty(ar,"__esModule",{value:!0}),ar.StampAnnotationElement=ar.InkAnnotationElement=ar.FreeTextAnnotationElement=ar.AnnotationLayer=void 0;var ur=lr(1),cr=lr(6),hr=lr(3),dr=lr(30),fr=lr(31),pr=lr(32);const vr=1e3,gr=9,mr=new WeakSet;function br(Ds){return{width:Ds[2]-Ds[0],height:Ds[3]-Ds[1]}}class yr{static create(es){switch(es.data.annotationType){case ur.AnnotationType.LINK:return new Cr(es);case ur.AnnotationType.TEXT:return new Sr(es);case ur.AnnotationType.WIDGET:switch(es.data.fieldType){case"Tx":return new Er(es);case"Btn":return es.data.radioButton?new Rr(es):es.data.checkBox?new Tr(es):new Pr(es);case"Ch":return new _r(es);case"Sig":return new Ar(es)}return new wr(es);case ur.AnnotationType.POPUP:return new kr(es);case ur.AnnotationType.FREETEXT:return new Nr(es);case ur.AnnotationType.LINE:return new Lr(es);case ur.AnnotationType.SQUARE:return new Or(es);case ur.AnnotationType.CIRCLE:return new Ir(es);case ur.AnnotationType.POLYLINE:return new Mr(es);case ur.AnnotationType.CARET:return new jr(es);case ur.AnnotationType.INK:return new Fr(es);case ur.AnnotationType.POLYGON:return new $r(es);case ur.AnnotationType.HIGHLIGHT:return new zr(es);case ur.AnnotationType.UNDERLINE:return new Hr(es);case ur.AnnotationType.SQUIGGLY:return new Wr(es);case ur.AnnotationType.STRIKEOUT:return new Yr(es);case ur.AnnotationType.STAMP:return new qr(es);case ur.AnnotationType.FILEATTACHMENT:return new Br(es);default:return new xr(es)}}}const Xr=class Xr{constructor(es,{isRenderable:ts=!1,ignoreBorder:cs=!1,createQuadrilaterals:gs=!1}={}){Ts(this,Vr,!1);this.isRenderable=ts,this.data=es.data,this.layer=es.layer,this.linkService=es.linkService,this.downloadManager=es.downloadManager,this.imageResourcesPath=es.imageResourcesPath,this.renderForms=es.renderForms,this.svgFactory=es.svgFactory,this.annotationStorage=es.annotationStorage,this.enableScripting=es.enableScripting,this.hasJSActions=es.hasJSActions,this._fieldObjects=es.fieldObjects,this.parent=es.parent,ts&&(this.container=this._createContainer(cs)),gs&&this._createQuadrilaterals()}static _hasPopupData({titleObj:es,contentsObj:ts,richText:cs}){return!!(es!=null&&es.str||ts!=null&&ts.str||cs!=null&&cs.str)}get hasPopupData(){return Xr._hasPopupData(this.data)}_createContainer(es){const{data:ts,parent:{page:cs,viewport:gs}}=this,Ss=document.createElement("section");Ss.setAttribute("data-annotation-id",ts.id),this instanceof wr||(Ss.tabIndex=vr),Ss.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Ss.setAttribute("aria-haspopup","dialog"),ts.noRotate&&Ss.classList.add("norotate");const{pageWidth:As,pageHeight:ks,pageX:js,pageY:zs}=gs.rawDims;if(!ts.rect||this instanceof kr){const{rotation:Gs}=ts;return!ts.hasOwnCanvas&&Gs!==0&&this.setRotation(Gs,Ss),Ss}const{width:Fs,height:qs}=br(ts.rect),Hs=ur.Util.normalizeRect([ts.rect[0],cs.view[3]-ts.rect[1]+cs.view[1],ts.rect[2],cs.view[3]-ts.rect[3]+cs.view[1]]);if(!es&&ts.borderStyle.width>0){Ss.style.borderWidth=`${ts.borderStyle.width}px`;const Gs=ts.borderStyle.horizontalCornerRadius,Ws=ts.borderStyle.verticalCornerRadius;if(Gs>0||Ws>0){const Ys=`calc(${Gs}px * var(--scale-factor)) / calc(${Ws}px * var(--scale-factor))`;Ss.style.borderRadius=Ys}else if(this instanceof Rr){const Ys=`calc(${Fs}px * var(--scale-factor)) / calc(${qs}px * var(--scale-factor))`;Ss.style.borderRadius=Ys}switch(ts.borderStyle.style){case ur.AnnotationBorderStyleType.SOLID:Ss.style.borderStyle="solid";break;case ur.AnnotationBorderStyleType.DASHED:Ss.style.borderStyle="dashed";break;case ur.AnnotationBorderStyleType.BEVELED:(0,ur.warn)("Unimplemented border style: beveled");break;case ur.AnnotationBorderStyleType.INSET:(0,ur.warn)("Unimplemented border style: inset");break;case ur.AnnotationBorderStyleType.UNDERLINE:Ss.style.borderBottomStyle="solid";break}const Xs=ts.borderColor||null;Xs?(_s(this,Vr,!0),Ss.style.borderColor=ur.Util.makeHexColor(Xs[0]|0,Xs[1]|0,Xs[2]|0)):Ss.style.borderWidth=0}Ss.style.left=`${100*(Hs[0]-js)/As}%`,Ss.style.top=`${100*(Hs[1]-zs)/ks}%`;const{rotation:Vs}=ts;return ts.hasOwnCanvas||Vs===0?(Ss.style.width=`${100*Fs/As}%`,Ss.style.height=`${100*qs/ks}%`):this.setRotation(Vs,Ss),Ss}setRotation(es,ts=this.container){if(!this.data.rect)return;const{pageWidth:cs,pageHeight:gs}=this.parent.viewport.rawDims,{width:Ss,height:As}=br(this.data.rect);let ks,js;es%180===0?(ks=100*Ss/cs,js=100*As/gs):(ks=100*As/cs,js=100*Ss/gs),ts.style.width=`${ks}%`,ts.style.height=`${js}%`,ts.setAttribute("data-main-rotation",(360-es)%360)}get _commonActions(){const es=(ts,cs,gs)=>{const Ss=gs.detail[ts],As=Ss[0],ks=Ss.slice(1);gs.target.style[cs]=dr.ColorConverters[`${As}_HTML`](ks),this.annotationStorage.setValue(this.data.id,{[cs]:dr.ColorConverters[`${As}_rgb`](ks)})};return(0,ur.shadow)(this,"_commonActions",{display:ts=>{const{display:cs}=ts.detail,gs=cs%2===1;this.container.style.visibility=gs?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:gs,noPrint:cs===1||cs===2})},print:ts=>{this.annotationStorage.setValue(this.data.id,{noPrint:!ts.detail.print})},hidden:ts=>{const{hidden:cs}=ts.detail;this.container.style.visibility=cs?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:cs,noView:cs})},focus:ts=>{setTimeout(()=>ts.target.focus({preventScroll:!1}),0)},userName:ts=>{ts.target.title=ts.detail.userName},readonly:ts=>{ts.target.disabled=ts.detail.readonly},required:ts=>{this._setRequired(ts.target,ts.detail.required)},bgColor:ts=>{es("bgColor","backgroundColor",ts)},fillColor:ts=>{es("fillColor","backgroundColor",ts)},fgColor:ts=>{es("fgColor","color",ts)},textColor:ts=>{es("textColor","color",ts)},borderColor:ts=>{es("borderColor","borderColor",ts)},strokeColor:ts=>{es("strokeColor","borderColor",ts)},rotation:ts=>{const cs=ts.detail.rotation;this.setRotation(cs),this.annotationStorage.setValue(this.data.id,{rotation:cs})}})}_dispatchEventFromSandbox(es,ts){const cs=this._commonActions;for(const gs of Object.keys(ts.detail)){const Ss=es[gs]||cs[gs];Ss==null||Ss(ts)}}_setDefaultPropertiesFromJS(es){if(!this.enableScripting)return;const ts=this.annotationStorage.getRawValue(this.data.id);if(!ts)return;const cs=this._commonActions;for(const[gs,Ss]of Object.entries(ts)){const As=cs[gs];if(As){const ks={detail:{[gs]:Ss},target:es};As(ks),delete ts[gs]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:es}=this.data;if(!es)return;const[ts,cs,gs,Ss]=this.data.rect;if(es.length===1){const[,{x:Ws,y:Xs},{x:Ys,y:Qs}]=es[0];if(gs===Ws&&Ss===Xs&&ts===Ys&&cs===Qs)return}const{style:As}=this.container;let ks;if(Gr(this,Vr)){const{borderColor:Ws,borderWidth:Xs}=As;As.borderWidth=0,ks=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ws}" stroke-width="${Xs}">`],this.container.classList.add("hasBorder")}const js=gs-ts,zs=Ss-cs,{svgFactory:Fs}=this,qs=Fs.createElement("svg");qs.classList.add("quadrilateralsContainer"),qs.setAttribute("width",0),qs.setAttribute("height",0);const Hs=Fs.createElement("defs");qs.append(Hs);const Vs=Fs.createElement("clipPath"),Gs=`clippath_${this.data.id}`;Vs.setAttribute("id",Gs),Vs.setAttribute("clipPathUnits","objectBoundingBox"),Hs.append(Vs);for(const[,{x:Ws,y:Xs},{x:Ys,y:Qs}]of es){const Js=Fs.createElement("rect"),to=(Ys-ts)/js,ao=(Ss-Xs)/zs,so=(Ws-Ys)/js,co=(Xs-Qs)/zs;Js.setAttribute("x",to),Js.setAttribute("y",ao),Js.setAttribute("width",so),Js.setAttribute("height",co),Vs.append(Js),ks==null||ks.push(`<rect vector-effect="non-scaling-stroke" x="${to}" y="${ao}" width="${so}" height="${co}"/>`)}Gr(this,Vr)&&(ks.push("</g></svg>')"),As.backgroundImage=ks.join("")),this.container.append(qs),this.container.style.clipPath=`url(#${Gs})`}_createPopup(){const{container:es,data:ts}=this;es.setAttribute("aria-haspopup","dialog");const cs=new kr({data:{color:ts.color,titleObj:ts.titleObj,modificationDate:ts.modificationDate,contentsObj:ts.contentsObj,richText:ts.richText,parentRect:ts.rect,borderStyle:0,id:`popup_${ts.id}`,rotation:ts.rotation},parent:this.parent,elements:[this]});this.parent.div.append(cs.render())}render(){(0,ur.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(es,ts=null){const cs=[];if(this._fieldObjects){const gs=this._fieldObjects[es];if(gs)for(const{page:Ss,id:As,exportValues:ks}of gs){if(Ss===-1||As===ts)continue;const js=typeof ks=="string"?ks:null,zs=document.querySelector(`[data-element-id="${As}"]`);if(zs&&!mr.has(zs)){(0,ur.warn)(`_getElementsByName - element not allowed: ${As}`);continue}cs.push({id:As,exportValue:js,domElement:zs})}return cs}for(const gs of document.getElementsByName(es)){const{exportValue:Ss}=gs,As=gs.getAttribute("data-element-id");As!==ts&&mr.has(gs)&&cs.push({id:As,exportValue:Ss,domElement:gs})}return cs}show(){var es;this.container&&(this.container.hidden=!1),(es=this.popup)==null||es.maybeShow()}hide(){var es;this.container&&(this.container.hidden=!0),(es=this.popup)==null||es.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const es=this.getElementsToTriggerPopup();if(Array.isArray(es))for(const ts of es)ts.classList.add("highlightArea");else es.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:es,data:{id:ts}}=this;this.container.addEventListener("dblclick",()=>{var cs;(cs=this.linkService.eventBus)==null||cs.dispatch("switchannotationeditormode",{source:this,mode:es,editId:ts})})}};Vr=new WeakMap;let xr=Xr;class Cr extends xr{constructor(ts,cs=null){super(ts,{isRenderable:!0,ignoreBorder:!!(cs!=null&&cs.ignoreBorder),createQuadrilaterals:!0});Ts(this,Zr);this.isTooltipOnly=ts.data.isTooltipOnly}render(){const{data:ts,linkService:cs}=this,gs=document.createElement("a");gs.setAttribute("data-element-id",ts.id);let Ss=!1;return ts.url?(cs.addLinkAttributes(gs,ts.url,ts.newWindow),Ss=!0):ts.action?(this._bindNamedAction(gs,ts.action),Ss=!0):ts.attachment?(this._bindAttachment(gs,ts.attachment),Ss=!0):ts.setOCGState?(ws(this,Zr,vu).call(this,gs,ts.setOCGState),Ss=!0):ts.dest?(this._bindLink(gs,ts.dest),Ss=!0):(ts.actions&&(ts.actions.Action||ts.actions["Mouse Up"]||ts.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(gs,ts),Ss=!0),ts.resetForm?(this._bindResetFormAction(gs,ts.resetForm),Ss=!0):this.isTooltipOnly&&!Ss&&(this._bindLink(gs,""),Ss=!0)),this.container.classList.add("linkAnnotation"),Ss&&this.container.append(gs),this.container}_bindLink(ts,cs){ts.href=this.linkService.getDestinationHash(cs),ts.onclick=()=>(cs&&this.linkService.goToDestination(cs),!1),(cs||cs==="")&&ws(this,Zr,vo).call(this)}_bindNamedAction(ts,cs){ts.href=this.linkService.getAnchorUrl(""),ts.onclick=()=>(this.linkService.executeNamedAction(cs),!1),ws(this,Zr,vo).call(this)}_bindAttachment(ts,cs){ts.href=this.linkService.getAnchorUrl(""),ts.onclick=()=>{var gs;return(gs=this.downloadManager)==null||gs.openOrDownloadData(this.container,cs.content,cs.filename),!1},ws(this,Zr,vo).call(this)}_bindJSAction(ts,cs){ts.href=this.linkService.getAnchorUrl("");const gs=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const Ss of Object.keys(cs.actions)){const As=gs.get(Ss);As&&(ts[As]=()=>{var ks;return(ks=this.linkService.eventBus)==null||ks.dispatch("dispatcheventinsandbox",{source:this,detail:{id:cs.id,name:Ss}}),!1})}ts.onclick||(ts.onclick=()=>!1),ws(this,Zr,vo).call(this)}_bindResetFormAction(ts,cs){const gs=ts.onclick;if(gs||(ts.href=this.linkService.getAnchorUrl("")),ws(this,Zr,vo).call(this),!this._fieldObjects){(0,ur.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),gs||(ts.onclick=()=>!1);return}ts.onclick=()=>{var qs;gs==null||gs();const{fields:Ss,refs:As,include:ks}=cs,js=[];if(Ss.length!==0||As.length!==0){const Hs=new Set(As);for(const Vs of Ss){const Gs=this._fieldObjects[Vs]||[];for(const{id:Ws}of Gs)Hs.add(Ws)}for(const Vs of Object.values(this._fieldObjects))for(const Gs of Vs)Hs.has(Gs.id)===ks&&js.push(Gs)}else for(const Hs of Object.values(this._fieldObjects))js.push(...Hs);const zs=this.annotationStorage,Fs=[];for(const Hs of js){const{id:Vs}=Hs;switch(Fs.push(Vs),Hs.type){case"text":{const Ws=Hs.defaultValue||"";zs.setValue(Vs,{value:Ws});break}case"checkbox":case"radiobutton":{const Ws=Hs.defaultValue===Hs.exportValues;zs.setValue(Vs,{value:Ws});break}case"combobox":case"listbox":{const Ws=Hs.defaultValue||"";zs.setValue(Vs,{value:Ws});break}default:continue}const Gs=document.querySelector(`[data-element-id="${Vs}"]`);if(Gs){if(!mr.has(Gs)){(0,ur.warn)(`_bindResetFormAction - element not allowed: ${Vs}`);continue}}else continue;Gs.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((qs=this.linkService.eventBus)==null||qs.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:Fs,name:"ResetForm"}})),!1}}}Zr=new WeakSet,vo=function(){this.container.setAttribute("data-internal-link","")},vu=function(ts,cs){ts.href=this.linkService.getAnchorUrl(""),ts.onclick=()=>(this.linkService.executeSetOCGState(cs),!1),ws(this,Zr,vo).call(this)};class Sr extends xr{constructor(es){super(es,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const es=document.createElement("img");return es.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",es.alt="[{{type}} Annotation]",es.dataset.l10nId="text_annotation_type",es.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(es),this.container}}class wr extends xr{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(es){var ts;this.data.hasOwnCanvas&&(((ts=es.previousSibling)==null?void 0:ts.nodeName)==="CANVAS"&&(es.previousSibling.hidden=!0),es.hidden=!1)}_getKeyModifier(es){const{isWin:ts,isMac:cs}=ur.FeatureTest.platform;return ts&&es.ctrlKey||cs&&es.metaKey}_setEventListener(es,ts,cs,gs,Ss){cs.includes("mouse")?es.addEventListener(cs,As=>{var ks;(ks=this.linkService.eventBus)==null||ks.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:gs,value:Ss(As),shift:As.shiftKey,modifier:this._getKeyModifier(As)}})}):es.addEventListener(cs,As=>{var ks;if(cs==="blur"){if(!ts.focused||!As.relatedTarget)return;ts.focused=!1}else if(cs==="focus"){if(ts.focused)return;ts.focused=!0}Ss&&((ks=this.linkService.eventBus)==null||ks.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:gs,value:Ss(As)}}))})}_setEventListeners(es,ts,cs,gs){var Ss,As,ks;for(const[js,zs]of cs)(zs==="Action"||(Ss=this.data.actions)!=null&&Ss[zs])&&((zs==="Focus"||zs==="Blur")&&(ts||(ts={focused:!1})),this._setEventListener(es,ts,js,zs,gs),zs==="Focus"&&!((As=this.data.actions)!=null&&As.Blur)?this._setEventListener(es,ts,"blur","Blur",null):zs==="Blur"&&!((ks=this.data.actions)!=null&&ks.Focus)&&this._setEventListener(es,ts,"focus","Focus",null))}_setBackgroundColor(es){const ts=this.data.backgroundColor||null;es.style.backgroundColor=ts===null?"transparent":ur.Util.makeHexColor(ts[0],ts[1],ts[2])}_setTextStyle(es){const ts=["left","center","right"],{fontColor:cs}=this.data.defaultAppearanceData,gs=this.data.defaultAppearanceData.fontSize||gr,Ss=es.style;let As;const ks=2,js=zs=>Math.round(10*zs)/10;if(this.data.multiLine){const zs=Math.abs(this.data.rect[3]-this.data.rect[1]-ks),Fs=Math.round(zs/(ur.LINE_FACTOR*gs))||1,qs=zs/Fs;As=Math.min(gs,js(qs/ur.LINE_FACTOR))}else{const zs=Math.abs(this.data.rect[3]-this.data.rect[1]-ks);As=Math.min(gs,js(zs/ur.LINE_FACTOR))}Ss.fontSize=`calc(${As}px * var(--scale-factor))`,Ss.color=ur.Util.makeHexColor(cs[0],cs[1],cs[2]),this.data.textAlignment!==null&&(Ss.textAlign=ts[this.data.textAlignment])}_setRequired(es,ts){ts?es.setAttribute("required",!0):es.removeAttribute("required"),es.setAttribute("aria-required",ts)}}class Er extends wr{constructor(es){const ts=es.renderForms||!es.data.hasAppearance&&!!es.data.fieldValue;super(es,{isRenderable:ts})}setPropertyOnSiblings(es,ts,cs,gs){const Ss=this.annotationStorage;for(const As of this._getElementsByName(es.name,es.id))As.domElement&&(As.domElement[ts]=cs),Ss.setValue(As.id,{[gs]:cs})}render(){var gs,Ss;const es=this.annotationStorage,ts=this.data.id;this.container.classList.add("textWidgetAnnotation");let cs=null;if(this.renderForms){const As=es.getValue(ts,{value:this.data.fieldValue});let ks=As.value||"";const js=es.getValue(ts,{charLimit:this.data.maxLen}).charLimit;js&&ks.length>js&&(ks=ks.slice(0,js));let zs=As.formattedValue||((gs=this.data.textContent)==null?void 0:gs.join(`
`))||null;zs&&this.data.comb&&(zs=zs.replaceAll(/\s+/g,""));const Fs={userValue:ks,formattedValue:zs,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(cs=document.createElement("textarea"),cs.textContent=zs??ks,this.data.doNotScroll&&(cs.style.overflowY="hidden")):(cs=document.createElement("input"),cs.type="text",cs.setAttribute("value",zs??ks),this.data.doNotScroll&&(cs.style.overflowX="hidden")),this.data.hasOwnCanvas&&(cs.hidden=!0),mr.add(cs),cs.setAttribute("data-element-id",ts),cs.disabled=this.data.readOnly,cs.name=this.data.fieldName,cs.tabIndex=vr,this._setRequired(cs,this.data.required),js&&(cs.maxLength=js),cs.addEventListener("input",Hs=>{es.setValue(ts,{value:Hs.target.value}),this.setPropertyOnSiblings(cs,"value",Hs.target.value,"value"),Fs.formattedValue=null}),cs.addEventListener("resetform",Hs=>{const Vs=this.data.defaultFieldValue??"";cs.value=Fs.userValue=Vs,Fs.formattedValue=null});let qs=Hs=>{const{formattedValue:Vs}=Fs;Vs!=null&&(Hs.target.value=Vs),Hs.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){cs.addEventListener("focus",Vs=>{if(Fs.focused)return;const{target:Gs}=Vs;Fs.userValue&&(Gs.value=Fs.userValue),Fs.lastCommittedValue=Gs.value,Fs.commitKey=1,Fs.focused=!0}),cs.addEventListener("updatefromsandbox",Vs=>{this.showElementAndHideCanvas(Vs.target);const Gs={value(Ws){Fs.userValue=Ws.detail.value??"",es.setValue(ts,{value:Fs.userValue.toString()}),Ws.target.value=Fs.userValue},formattedValue(Ws){const{formattedValue:Xs}=Ws.detail;Fs.formattedValue=Xs,Xs!=null&&Ws.target!==document.activeElement&&(Ws.target.value=Xs),es.setValue(ts,{formattedValue:Xs})},selRange(Ws){Ws.target.setSelectionRange(...Ws.detail.selRange)},charLimit:Ws=>{var Js;const{charLimit:Xs}=Ws.detail,{target:Ys}=Ws;if(Xs===0){Ys.removeAttribute("maxLength");return}Ys.setAttribute("maxLength",Xs);let Qs=Fs.userValue;!Qs||Qs.length<=Xs||(Qs=Qs.slice(0,Xs),Ys.value=Fs.userValue=Qs,es.setValue(ts,{value:Qs}),(Js=this.linkService.eventBus)==null||Js.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ts,name:"Keystroke",value:Qs,willCommit:!0,commitKey:1,selStart:Ys.selectionStart,selEnd:Ys.selectionEnd}}))}};this._dispatchEventFromSandbox(Gs,Vs)}),cs.addEventListener("keydown",Vs=>{var Xs;Fs.commitKey=1;let Gs=-1;if(Vs.key==="Escape"?Gs=0:Vs.key==="Enter"&&!this.data.multiLine?Gs=2:Vs.key==="Tab"&&(Fs.commitKey=3),Gs===-1)return;const{value:Ws}=Vs.target;Fs.lastCommittedValue!==Ws&&(Fs.lastCommittedValue=Ws,Fs.userValue=Ws,(Xs=this.linkService.eventBus)==null||Xs.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ts,name:"Keystroke",value:Ws,willCommit:!0,commitKey:Gs,selStart:Vs.target.selectionStart,selEnd:Vs.target.selectionEnd}}))});const Hs=qs;qs=null,cs.addEventListener("blur",Vs=>{var Ws;if(!Fs.focused||!Vs.relatedTarget)return;Fs.focused=!1;const{value:Gs}=Vs.target;Fs.userValue=Gs,Fs.lastCommittedValue!==Gs&&((Ws=this.linkService.eventBus)==null||Ws.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ts,name:"Keystroke",value:Gs,willCommit:!0,commitKey:Fs.commitKey,selStart:Vs.target.selectionStart,selEnd:Vs.target.selectionEnd}})),Hs(Vs)}),(Ss=this.data.actions)!=null&&Ss.Keystroke&&cs.addEventListener("beforeinput",Vs=>{var ao;Fs.lastCommittedValue=null;const{data:Gs,target:Ws}=Vs,{value:Xs,selectionStart:Ys,selectionEnd:Qs}=Ws;let Js=Ys,to=Qs;switch(Vs.inputType){case"deleteWordBackward":{const so=Xs.substring(0,Ys).match(/\w*[^\w]*$/);so&&(Js-=so[0].length);break}case"deleteWordForward":{const so=Xs.substring(Ys).match(/^[^\w]*\w*/);so&&(to+=so[0].length);break}case"deleteContentBackward":Ys===Qs&&(Js-=1);break;case"deleteContentForward":Ys===Qs&&(to+=1);break}Vs.preventDefault(),(ao=this.linkService.eventBus)==null||ao.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ts,name:"Keystroke",value:Xs,change:Gs||"",willCommit:!1,selStart:Js,selEnd:to}})}),this._setEventListeners(cs,Fs,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Vs=>Vs.target.value)}if(qs&&cs.addEventListener("blur",qs),this.data.comb){const Vs=(this.data.rect[2]-this.data.rect[0])/js;cs.classList.add("comb"),cs.style.letterSpacing=`calc(${Vs}px * var(--scale-factor) - 1ch)`}}else cs=document.createElement("div"),cs.textContent=this.data.fieldValue,cs.style.verticalAlign="middle",cs.style.display="table-cell";return this._setTextStyle(cs),this._setBackgroundColor(cs),this._setDefaultPropertiesFromJS(cs),this.container.append(cs),this.container}}class Ar extends wr{constructor(es){super(es,{isRenderable:!!es.data.hasOwnCanvas})}}class Tr extends wr{constructor(es){super(es,{isRenderable:es.renderForms})}render(){const es=this.annotationStorage,ts=this.data,cs=ts.id;let gs=es.getValue(cs,{value:ts.exportValue===ts.fieldValue}).value;typeof gs=="string"&&(gs=gs!=="Off",es.setValue(cs,{value:gs})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Ss=document.createElement("input");return mr.add(Ss),Ss.setAttribute("data-element-id",cs),Ss.disabled=ts.readOnly,this._setRequired(Ss,this.data.required),Ss.type="checkbox",Ss.name=ts.fieldName,gs&&Ss.setAttribute("checked",!0),Ss.setAttribute("exportValue",ts.exportValue),Ss.tabIndex=vr,Ss.addEventListener("change",As=>{const{name:ks,checked:js}=As.target;for(const zs of this._getElementsByName(ks,cs)){const Fs=js&&zs.exportValue===ts.exportValue;zs.domElement&&(zs.domElement.checked=Fs),es.setValue(zs.id,{value:Fs})}es.setValue(cs,{value:js})}),Ss.addEventListener("resetform",As=>{const ks=ts.defaultFieldValue||"Off";As.target.checked=ks===ts.exportValue}),this.enableScripting&&this.hasJSActions&&(Ss.addEventListener("updatefromsandbox",As=>{const ks={value(js){js.target.checked=js.detail.value!=="Off",es.setValue(cs,{value:js.target.checked})}};this._dispatchEventFromSandbox(ks,As)}),this._setEventListeners(Ss,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],As=>As.target.checked)),this._setBackgroundColor(Ss),this._setDefaultPropertiesFromJS(Ss),this.container.append(Ss),this.container}}class Rr extends wr{constructor(es){super(es,{isRenderable:es.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const es=this.annotationStorage,ts=this.data,cs=ts.id;let gs=es.getValue(cs,{value:ts.fieldValue===ts.buttonValue}).value;typeof gs=="string"&&(gs=gs!==ts.buttonValue,es.setValue(cs,{value:gs}));const Ss=document.createElement("input");if(mr.add(Ss),Ss.setAttribute("data-element-id",cs),Ss.disabled=ts.readOnly,this._setRequired(Ss,this.data.required),Ss.type="radio",Ss.name=ts.fieldName,gs&&Ss.setAttribute("checked",!0),Ss.tabIndex=vr,Ss.addEventListener("change",As=>{const{name:ks,checked:js}=As.target;for(const zs of this._getElementsByName(ks,cs))es.setValue(zs.id,{value:!1});es.setValue(cs,{value:js})}),Ss.addEventListener("resetform",As=>{const ks=ts.defaultFieldValue;As.target.checked=ks!=null&&ks===ts.buttonValue}),this.enableScripting&&this.hasJSActions){const As=ts.buttonValue;Ss.addEventListener("updatefromsandbox",ks=>{const js={value:zs=>{const Fs=As===zs.detail.value;for(const qs of this._getElementsByName(zs.target.name)){const Hs=Fs&&qs.id===cs;qs.domElement&&(qs.domElement.checked=Hs),es.setValue(qs.id,{value:Hs})}}};this._dispatchEventFromSandbox(js,ks)}),this._setEventListeners(Ss,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ks=>ks.target.checked)}return this._setBackgroundColor(Ss),this._setDefaultPropertiesFromJS(Ss),this.container.append(Ss),this.container}}class Pr extends Cr{constructor(es){super(es,{ignoreBorder:es.data.hasAppearance})}render(){const es=super.render();es.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(es.title=this.data.alternativeText);const ts=es.lastChild;return this.enableScripting&&this.hasJSActions&&ts&&(this._setDefaultPropertiesFromJS(ts),ts.addEventListener("updatefromsandbox",cs=>{this._dispatchEventFromSandbox({},cs)})),es}}class _r extends wr{constructor(es){super(es,{isRenderable:es.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const es=this.annotationStorage,ts=this.data.id,cs=es.getValue(ts,{value:this.data.fieldValue}),gs=document.createElement("select");mr.add(gs),gs.setAttribute("data-element-id",ts),gs.disabled=this.data.readOnly,this._setRequired(gs,this.data.required),gs.name=this.data.fieldName,gs.tabIndex=vr;let Ss=this.data.combo&&this.data.options.length>0;this.data.combo||(gs.size=this.data.options.length,this.data.multiSelect&&(gs.multiple=!0)),gs.addEventListener("resetform",Fs=>{const qs=this.data.defaultFieldValue;for(const Hs of gs.options)Hs.selected=Hs.value===qs});for(const Fs of this.data.options){const qs=document.createElement("option");qs.textContent=Fs.displayValue,qs.value=Fs.exportValue,cs.value.includes(Fs.exportValue)&&(qs.setAttribute("selected",!0),Ss=!1),gs.append(qs)}let As=null;if(Ss){const Fs=document.createElement("option");Fs.value=" ",Fs.setAttribute("hidden",!0),Fs.setAttribute("selected",!0),gs.prepend(Fs),As=()=>{Fs.remove(),gs.removeEventListener("input",As),As=null},gs.addEventListener("input",As)}const ks=Fs=>{const qs=Fs?"value":"textContent",{options:Hs,multiple:Vs}=gs;return Vs?Array.prototype.filter.call(Hs,Gs=>Gs.selected).map(Gs=>Gs[qs]):Hs.selectedIndex===-1?null:Hs[Hs.selectedIndex][qs]};let js=ks(!1);const zs=Fs=>{const qs=Fs.target.options;return Array.prototype.map.call(qs,Hs=>({displayValue:Hs.textContent,exportValue:Hs.value}))};return this.enableScripting&&this.hasJSActions?(gs.addEventListener("updatefromsandbox",Fs=>{const qs={value(Hs){As==null||As();const Vs=Hs.detail.value,Gs=new Set(Array.isArray(Vs)?Vs:[Vs]);for(const Ws of gs.options)Ws.selected=Gs.has(Ws.value);es.setValue(ts,{value:ks(!0)}),js=ks(!1)},multipleSelection(Hs){gs.multiple=!0},remove(Hs){const Vs=gs.options,Gs=Hs.detail.remove;Vs[Gs].selected=!1,gs.remove(Gs),Vs.length>0&&Array.prototype.findIndex.call(Vs,Xs=>Xs.selected)===-1&&(Vs[0].selected=!0),es.setValue(ts,{value:ks(!0),items:zs(Hs)}),js=ks(!1)},clear(Hs){for(;gs.length!==0;)gs.remove(0);es.setValue(ts,{value:null,items:[]}),js=ks(!1)},insert(Hs){const{index:Vs,displayValue:Gs,exportValue:Ws}=Hs.detail.insert,Xs=gs.children[Vs],Ys=document.createElement("option");Ys.textContent=Gs,Ys.value=Ws,Xs?Xs.before(Ys):gs.append(Ys),es.setValue(ts,{value:ks(!0),items:zs(Hs)}),js=ks(!1)},items(Hs){const{items:Vs}=Hs.detail;for(;gs.length!==0;)gs.remove(0);for(const Gs of Vs){const{displayValue:Ws,exportValue:Xs}=Gs,Ys=document.createElement("option");Ys.textContent=Ws,Ys.value=Xs,gs.append(Ys)}gs.options.length>0&&(gs.options[0].selected=!0),es.setValue(ts,{value:ks(!0),items:zs(Hs)}),js=ks(!1)},indices(Hs){const Vs=new Set(Hs.detail.indices);for(const Gs of Hs.target.options)Gs.selected=Vs.has(Gs.index);es.setValue(ts,{value:ks(!0)}),js=ks(!1)},editable(Hs){Hs.target.disabled=!Hs.detail.editable}};this._dispatchEventFromSandbox(qs,Fs)}),gs.addEventListener("input",Fs=>{var Hs;const qs=ks(!0);es.setValue(ts,{value:qs}),Fs.preventDefault(),(Hs=this.linkService.eventBus)==null||Hs.dispatch("dispatcheventinsandbox",{source:this,detail:{id:ts,name:"Keystroke",value:js,changeEx:qs,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(gs,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Fs=>Fs.target.value)):gs.addEventListener("input",function(Fs){es.setValue(ts,{value:ks(!0)})}),this.data.combo&&this._setTextStyle(gs),this._setBackgroundColor(gs),this._setDefaultPropertiesFromJS(gs),this.container.append(gs),this.container}}class kr extends xr{constructor(es){const{data:ts,elements:cs}=es;super(es,{isRenderable:xr._hasPopupData(ts)}),this.elements=cs}render(){this.container.classList.add("popupAnnotation");const es=new Dr({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),ts=[];for(const cs of this.elements)cs.popup=es,ts.push(cs.data.id),cs.addHighlightArea();return this.container.setAttribute("aria-controls",ts.map(cs=>`${ur.AnnotationPrefix}${cs}`).join(",")),this.container}}class Dr{constructor({container:es,color:ts,elements:cs,titleObj:gs,modificationDate:Ss,contentsObj:As,richText:ks,parent:js,rect:zs,parentRect:Fs,open:qs}){Ts(this,Os);Ts(this,ga,null);Ts(this,ba,ws(this,Os,gu).bind(this));Ts(this,_i,ws(this,Os,Bl).bind(this));Ts(this,os,ws(this,Os,$l).bind(this));Ts(this,ls,ws(this,Os,zo).bind(this));Ts(this,ys,null);Ts(this,ns,null);Ts(this,as,null);Ts(this,Kr,null);Ts(this,$a,null);Ts(this,ss,null);Ts(this,hs,!1);Ts(this,vs,null);Ts(this,bs,null);Ts(this,xs,null);Ts(this,fs,null);Ts(this,Is,!1);var Vs;_s(this,ns,es),_s(this,fs,gs),_s(this,as,As),_s(this,xs,ks),_s(this,$a,js),_s(this,ys,ts),_s(this,bs,zs),_s(this,ss,Fs),_s(this,Kr,cs);const Hs=cr.PDFDateString.toDateObject(Ss);Hs&&_s(this,ga,js.l10n.get("annotation_date_string",{date:Hs.toLocaleDateString(),time:Hs.toLocaleTimeString()})),this.trigger=cs.flatMap(Gs=>Gs.getElementsToTriggerPopup());for(const Gs of this.trigger)Gs.addEventListener("click",Gr(this,ls)),Gs.addEventListener("mouseenter",Gr(this,os)),Gs.addEventListener("mouseleave",Gr(this,_i)),Gs.classList.add("popupTriggerArea");for(const Gs of cs)(Vs=Gs.container)==null||Vs.addEventListener("keydown",Gr(this,ba));Gr(this,ns).hidden=!0,qs&&ws(this,Os,zo).call(this)}render(){if(Gr(this,vs))return;const{page:{view:es},viewport:{rawDims:{pageWidth:ts,pageHeight:cs,pageX:gs,pageY:Ss}}}=Gr(this,$a),As=_s(this,vs,document.createElement("div"));if(As.className="popup",Gr(this,ys)){const Js=As.style.outlineColor=ur.Util.makeHexColor(...Gr(this,ys));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?As.style.backgroundColor=`color-mix(in srgb, ${Js} 30%, white)`:As.style.backgroundColor=ur.Util.makeHexColor(...Gr(this,ys).map(ao=>Math.floor(.7*(255-ao)+ao)))}const ks=document.createElement("span");ks.className="header";const js=document.createElement("h1");if(ks.append(js),{dir:js.dir,str:js.textContent}=Gr(this,fs),As.append(ks),Gr(this,ga)){const Js=document.createElement("span");Js.classList.add("popupDate"),Gr(this,ga).then(to=>{Js.textContent=to}),ks.append(Js)}const zs=Gr(this,as),Fs=Gr(this,xs);if(Fs!=null&&Fs.str&&(!(zs!=null&&zs.str)||zs.str===Fs.str))pr.XfaLayer.render({xfaHtml:Fs.html,intent:"richText",div:As}),As.lastChild.classList.add("richText","popupContent");else{const Js=this._formatContents(zs);As.append(Js)}let qs=!!Gr(this,ss),Hs=qs?Gr(this,ss):Gr(this,bs);for(const Js of Gr(this,Kr))if(!Hs||ur.Util.intersect(Js.data.rect,Hs)!==null){Hs=Js.data.rect,qs=!0;break}const Vs=ur.Util.normalizeRect([Hs[0],es[3]-Hs[1]+es[1],Hs[2],es[3]-Hs[3]+es[1]]),Ws=qs?Hs[2]-Hs[0]+5:0,Xs=Vs[0]+Ws,Ys=Vs[1],{style:Qs}=Gr(this,ns);Qs.left=`${100*(Xs-gs)/ts}%`,Qs.top=`${100*(Ys-Ss)/cs}%`,Gr(this,ns).append(As)}_formatContents({str:es,dir:ts}){const cs=document.createElement("p");cs.classList.add("popupContent"),cs.dir=ts;const gs=es.split(/(?:\r\n?|\n)/);for(let Ss=0,As=gs.length;Ss<As;++Ss){const ks=gs[Ss];cs.append(document.createTextNode(ks)),Ss<As-1&&cs.append(document.createElement("br"))}return cs}forceHide(){_s(this,Is,this.isVisible),Gr(this,Is)&&(Gr(this,ns).hidden=!0)}maybeShow(){Gr(this,Is)&&(_s(this,Is,!1),Gr(this,ns).hidden=!1)}get isVisible(){return Gr(this,ns).hidden===!1}}ga=new WeakMap,ba=new WeakMap,_i=new WeakMap,os=new WeakMap,ls=new WeakMap,ys=new WeakMap,ns=new WeakMap,as=new WeakMap,Kr=new WeakMap,$a=new WeakMap,ss=new WeakMap,hs=new WeakMap,vs=new WeakMap,bs=new WeakMap,xs=new WeakMap,fs=new WeakMap,Is=new WeakMap,Os=new WeakSet,gu=function(es){es.altKey||es.shiftKey||es.ctrlKey||es.metaKey||(es.key==="Enter"||es.key==="Escape"&&Gr(this,hs))&&ws(this,Os,zo).call(this)},zo=function(){_s(this,hs,!Gr(this,hs)),Gr(this,hs)?(ws(this,Os,$l).call(this),Gr(this,ns).addEventListener("click",Gr(this,ls)),Gr(this,ns).addEventListener("keydown",Gr(this,ba))):(ws(this,Os,Bl).call(this),Gr(this,ns).removeEventListener("click",Gr(this,ls)),Gr(this,ns).removeEventListener("keydown",Gr(this,ba)))},$l=function(){Gr(this,vs)||this.render(),this.isVisible?Gr(this,hs)&&Gr(this,ns).classList.add("focused"):(Gr(this,ns).hidden=!1,Gr(this,ns).style.zIndex=parseInt(Gr(this,ns).style.zIndex)+1e3)},Bl=function(){Gr(this,ns).classList.remove("focused"),!(Gr(this,hs)||!this.isVisible)&&(Gr(this,ns).hidden=!0,Gr(this,ns).style.zIndex=parseInt(Gr(this,ns).style.zIndex)-1e3)};class Nr extends xr{constructor(es){super(es,{isRenderable:!0,ignoreBorder:!0}),this.textContent=es.data.textContent,this.textPosition=es.data.textPosition,this.annotationEditorType=ur.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const es=document.createElement("div");es.classList.add("annotationTextContent"),es.setAttribute("role","comment");for(const ts of this.textContent){const cs=document.createElement("span");cs.textContent=ts,es.append(cs)}this.container.append(es)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}ar.FreeTextAnnotationElement=Nr;class Lr extends xr{constructor(ts){super(ts,{isRenderable:!0,ignoreBorder:!0});Ts(this,us,null)}render(){this.container.classList.add("lineAnnotation");const ts=this.data,{width:cs,height:gs}=br(ts.rect),Ss=this.svgFactory.create(cs,gs,!0),As=_s(this,us,this.svgFactory.createElement("svg:line"));return As.setAttribute("x1",ts.rect[2]-ts.lineCoordinates[0]),As.setAttribute("y1",ts.rect[3]-ts.lineCoordinates[1]),As.setAttribute("x2",ts.rect[2]-ts.lineCoordinates[2]),As.setAttribute("y2",ts.rect[3]-ts.lineCoordinates[3]),As.setAttribute("stroke-width",ts.borderStyle.width||1),As.setAttribute("stroke","transparent"),As.setAttribute("fill","transparent"),Ss.append(As),this.container.append(Ss),!ts.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Gr(this,us)}addHighlightArea(){this.container.classList.add("highlightArea")}}us=new WeakMap;class Or extends xr{constructor(ts){super(ts,{isRenderable:!0,ignoreBorder:!0});Ts(this,na,null)}render(){this.container.classList.add("squareAnnotation");const ts=this.data,{width:cs,height:gs}=br(ts.rect),Ss=this.svgFactory.create(cs,gs,!0),As=ts.borderStyle.width,ks=_s(this,na,this.svgFactory.createElement("svg:rect"));return ks.setAttribute("x",As/2),ks.setAttribute("y",As/2),ks.setAttribute("width",cs-As),ks.setAttribute("height",gs-As),ks.setAttribute("stroke-width",As||1),ks.setAttribute("stroke","transparent"),ks.setAttribute("fill","transparent"),Ss.append(ks),this.container.append(Ss),!ts.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Gr(this,na)}addHighlightArea(){this.container.classList.add("highlightArea")}}na=new WeakMap;class Ir extends xr{constructor(ts){super(ts,{isRenderable:!0,ignoreBorder:!0});Ts(this,ds,null)}render(){this.container.classList.add("circleAnnotation");const ts=this.data,{width:cs,height:gs}=br(ts.rect),Ss=this.svgFactory.create(cs,gs,!0),As=ts.borderStyle.width,ks=_s(this,ds,this.svgFactory.createElement("svg:ellipse"));return ks.setAttribute("cx",cs/2),ks.setAttribute("cy",gs/2),ks.setAttribute("rx",cs/2-As/2),ks.setAttribute("ry",gs/2-As/2),ks.setAttribute("stroke-width",As||1),ks.setAttribute("stroke","transparent"),ks.setAttribute("fill","transparent"),Ss.append(ks),this.container.append(Ss),!ts.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Gr(this,ds)}addHighlightArea(){this.container.classList.add("highlightArea")}}ds=new WeakMap;class Mr extends xr{constructor(ts){super(ts,{isRenderable:!0,ignoreBorder:!0});Ts(this,is,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const ts=this.data,{width:cs,height:gs}=br(ts.rect),Ss=this.svgFactory.create(cs,gs,!0);let As=[];for(const js of ts.vertices){const zs=js.x-ts.rect[0],Fs=ts.rect[3]-js.y;As.push(zs+","+Fs)}As=As.join(" ");const ks=_s(this,is,this.svgFactory.createElement(this.svgElementName));return ks.setAttribute("points",As),ks.setAttribute("stroke-width",ts.borderStyle.width||1),ks.setAttribute("stroke","transparent"),ks.setAttribute("fill","transparent"),Ss.append(ks),this.container.append(Ss),!ts.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return Gr(this,is)}addHighlightArea(){this.container.classList.add("highlightArea")}}is=new WeakMap;class $r extends Mr{constructor(es){super(es),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class jr extends xr{constructor(es){super(es,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Fr extends xr{constructor(ts){super(ts,{isRenderable:!0,ignoreBorder:!0});Ts(this,_a,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=ur.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const ts=this.data,{width:cs,height:gs}=br(ts.rect),Ss=this.svgFactory.create(cs,gs,!0);for(const As of ts.inkLists){let ks=[];for(const zs of As){const Fs=zs.x-ts.rect[0],qs=ts.rect[3]-zs.y;ks.push(`${Fs},${qs}`)}ks=ks.join(" ");const js=this.svgFactory.createElement(this.svgElementName);Gr(this,_a).push(js),js.setAttribute("points",ks),js.setAttribute("stroke-width",ts.borderStyle.width||1),js.setAttribute("stroke","transparent"),js.setAttribute("fill","transparent"),!ts.popupRef&&this.hasPopupData&&this._createPopup(),Ss.append(js)}return this.container.append(Ss),this.container}getElementsToTriggerPopup(){return Gr(this,_a)}addHighlightArea(){this.container.classList.add("highlightArea")}}_a=new WeakMap,ar.InkAnnotationElement=Fr;class zr extends xr{constructor(es){super(es,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class Hr extends xr{constructor(es){super(es,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class Wr extends xr{constructor(es){super(es,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class Yr extends xr{constructor(es){super(es,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class qr extends xr{constructor(es){super(es,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}ar.StampAnnotationElement=qr;class Br extends xr{constructor(ts){var Ss;super(ts,{isRenderable:!0});Ts(this,Cs);Ts(this,rs,null);const{filename:cs,content:gs}=this.data.file;this.filename=(0,cr.getFilenameFromUrl)(cs,!0),this.content=gs,(Ss=this.linkService.eventBus)==null||Ss.dispatch("fileattachmentannotation",{source:this,filename:cs,content:gs})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:ts,data:cs}=this;let gs;cs.hasAppearance||cs.fillAlpha===0?gs=document.createElement("div"):(gs=document.createElement("img"),gs.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(cs.name)?"paperclip":"pushpin"}.svg`,cs.fillAlpha&&cs.fillAlpha<1&&(gs.style=`filter: opacity(${Math.round(cs.fillAlpha*100)}%);`)),gs.addEventListener("dblclick",ws(this,Cs,zl).bind(this)),_s(this,rs,gs);const{isMac:Ss}=ur.FeatureTest.platform;return ts.addEventListener("keydown",As=>{As.key==="Enter"&&(Ss?As.metaKey:As.ctrlKey)&&ws(this,Cs,zl).call(this)}),!cs.popupRef&&this.hasPopupData?this._createPopup():gs.classList.add("popupTriggerArea"),ts.append(gs),ts}getElementsToTriggerPopup(){return Gr(this,rs)}addHighlightArea(){this.container.classList.add("highlightArea")}}rs=new WeakMap,Cs=new WeakSet,zl=function(){var ts;(ts=this.downloadManager)==null||ts.openOrDownloadData(this.container,this.content,this.filename)};class Ur{constructor({div:es,accessibilityManager:ts,annotationCanvasMap:cs,l10n:gs,page:Ss,viewport:As}){Ts(this,Ps);Ts(this,Rs,null);Ts(this,xa,null);Ts(this,ps,new Map);this.div=es,_s(this,Rs,ts),_s(this,xa,cs),this.l10n=gs,this.page=Ss,this.viewport=As,this.zIndex=0,this.l10n||(this.l10n=fr.NullL10n)}async render(es){const{annotations:ts}=es,cs=this.div;(0,cr.setLayerDimensions)(cs,this.viewport);const gs=new Map,Ss={data:null,layer:cs,linkService:es.linkService,downloadManager:es.downloadManager,imageResourcesPath:es.imageResourcesPath||"",renderForms:es.renderForms!==!1,svgFactory:new cr.DOMSVGFactory,annotationStorage:es.annotationStorage||new hr.AnnotationStorage,enableScripting:es.enableScripting===!0,hasJSActions:es.hasJSActions,fieldObjects:es.fieldObjects,parent:this,elements:null};for(const As of ts){if(As.noHTML)continue;const ks=As.annotationType===ur.AnnotationType.POPUP;if(ks){const Fs=gs.get(As.id);if(!Fs)continue;Ss.elements=Fs}else{const{width:Fs,height:qs}=br(As.rect);if(Fs<=0||qs<=0)continue}Ss.data=As;const js=yr.create(Ss);if(!js.isRenderable)continue;if(!ks&&As.popupRef){const Fs=gs.get(As.popupRef);Fs?Fs.push(js):gs.set(As.popupRef,[js])}js.annotationEditorType>0&&Gr(this,ps).set(js.data.id,js);const zs=js.render();As.hidden&&(zs.style.visibility="hidden"),ws(this,Ps,mu).call(this,zs,As.id)}ws(this,Ps,Ul).call(this),await this.l10n.translate(cs)}update({viewport:es}){const ts=this.div;this.viewport=es,(0,cr.setLayerDimensions)(ts,{rotation:es.rotation}),ws(this,Ps,Ul).call(this),ts.hidden=!1}getEditableAnnotations(){return Array.from(Gr(this,ps).values())}getEditableAnnotation(es){return Gr(this,ps).get(es)}}Rs=new WeakMap,xa=new WeakMap,ps=new WeakMap,Ps=new WeakSet,mu=function(es,ts){var gs;const cs=es.firstChild||es;cs.id=`${ur.AnnotationPrefix}${ts}`,this.div.append(es),(gs=Gr(this,Rs))==null||gs.moveElementInDOM(this.div,es,cs,!1)},Ul=function(){if(!Gr(this,xa))return;const es=this.div;for(const[ts,cs]of Gr(this,xa)){const gs=es.querySelector(`[data-annotation-id="${ts}"]`);if(!gs)continue;const{firstChild:Ss}=gs;Ss?Ss.nodeName==="CANVAS"?Ss.replaceWith(cs):Ss.before(cs):gs.append(cs)}Gr(this,xa).clear()},ar.AnnotationLayer=Ur},(or,ar)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.ColorConverters=void 0;function lr(hr){return Math.floor(Math.max(0,Math.min(1,hr))*255).toString(16).padStart(2,"0")}function ur(hr){return Math.max(0,Math.min(255,255*hr))}class cr{static CMYK_G([dr,fr,pr,vr]){return["G",1-Math.min(1,.3*dr+.59*pr+.11*fr+vr)]}static G_CMYK([dr]){return["CMYK",0,0,0,1-dr]}static G_RGB([dr]){return["RGB",dr,dr,dr]}static G_rgb([dr]){return dr=ur(dr),[dr,dr,dr]}static G_HTML([dr]){const fr=lr(dr);return`#${fr}${fr}${fr}`}static RGB_G([dr,fr,pr]){return["G",.3*dr+.59*fr+.11*pr]}static RGB_rgb(dr){return dr.map(ur)}static RGB_HTML(dr){return`#${dr.map(lr).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([dr,fr,pr,vr]){return["RGB",1-Math.min(1,dr+vr),1-Math.min(1,pr+vr),1-Math.min(1,fr+vr)]}static CMYK_rgb([dr,fr,pr,vr]){return[ur(1-Math.min(1,dr+vr)),ur(1-Math.min(1,pr+vr)),ur(1-Math.min(1,fr+vr))]}static CMYK_HTML(dr){const fr=this.CMYK_RGB(dr).slice(1);return this.RGB_HTML(fr)}static RGB_CMYK([dr,fr,pr]){const vr=1-dr,gr=1-fr,mr=1-pr,br=Math.min(vr,gr,mr);return["CMYK",vr,gr,mr,br]}}ar.ColorConverters=cr},(or,ar)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.NullL10n=void 0,ar.getL10nFallback=ur;const lr={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};lr.print_progress_percent="{{progress}}%";function ur(dr,fr){switch(dr){case"find_match_count":dr=`find_match_count[${fr.total===1?"one":"other"}]`;break;case"find_match_count_limit":dr=`find_match_count_limit[${fr.limit===1?"one":"other"}]`;break}return lr[dr]||""}function cr(dr,fr){return fr?dr.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(pr,vr)=>vr in fr?fr[vr]:"{{"+vr+"}}"):dr}const hr={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(dr,fr=null,pr=ur(dr,fr)){return cr(pr,fr)},async translate(dr){}};ar.NullL10n=hr},(or,ar,lr)=>{Object.defineProperty(ar,"__esModule",{value:!0}),ar.XfaLayer=void 0;var ur=lr(25);class cr{static setupStorage(dr,fr,pr,vr,gr){const mr=vr.getValue(fr,{value:null});switch(pr.name){case"textarea":if(mr.value!==null&&(dr.textContent=mr.value),gr==="print")break;dr.addEventListener("input",br=>{vr.setValue(fr,{value:br.target.value})});break;case"input":if(pr.attributes.type==="radio"||pr.attributes.type==="checkbox"){if(mr.value===pr.attributes.xfaOn?dr.setAttribute("checked",!0):mr.value===pr.attributes.xfaOff&&dr.removeAttribute("checked"),gr==="print")break;dr.addEventListener("change",br=>{vr.setValue(fr,{value:br.target.checked?br.target.getAttribute("xfaOn"):br.target.getAttribute("xfaOff")})})}else{if(mr.value!==null&&dr.setAttribute("value",mr.value),gr==="print")break;dr.addEventListener("input",br=>{vr.setValue(fr,{value:br.target.value})})}break;case"select":if(mr.value!==null){dr.setAttribute("value",mr.value);for(const br of pr.children)br.attributes.value===mr.value?br.attributes.selected=!0:br.attributes.hasOwnProperty("selected")&&delete br.attributes.selected}dr.addEventListener("input",br=>{const yr=br.target.options,xr=yr.selectedIndex===-1?"":yr[yr.selectedIndex].value;vr.setValue(fr,{value:xr})});break}}static setAttributes({html:dr,element:fr,storage:pr=null,intent:vr,linkService:gr}){const{attributes:mr}=fr,br=dr instanceof HTMLAnchorElement;mr.type==="radio"&&(mr.name=`${mr.name}-${vr}`);for(const[yr,xr]of Object.entries(mr))if(xr!=null)switch(yr){case"class":xr.length&&dr.setAttribute(yr,xr.join(" "));break;case"dataId":break;case"id":dr.setAttribute("data-element-id",xr);break;case"style":Object.assign(dr.style,xr);break;case"textContent":dr.textContent=xr;break;default:(!br||yr!=="href"&&yr!=="newWindow")&&dr.setAttribute(yr,xr)}br&&gr.addLinkAttributes(dr,mr.href,mr.newWindow),pr&&mr.dataId&&this.setupStorage(dr,mr.dataId,fr,pr)}static render(dr){var Cr;const fr=dr.annotationStorage,pr=dr.linkService,vr=dr.xfaHtml,gr=dr.intent||"display",mr=document.createElement(vr.name);vr.attributes&&this.setAttributes({html:mr,element:vr,intent:gr,linkService:pr});const br=[[vr,-1,mr]],yr=dr.div;if(yr.append(mr),dr.viewport){const Sr=`matrix(${dr.viewport.transform.join(",")})`;yr.style.transform=Sr}gr!=="richText"&&yr.setAttribute("class","xfaLayer xfaFont");const xr=[];for(;br.length>0;){const[Sr,wr,Er]=br.at(-1);if(wr+1===Sr.children.length){br.pop();continue}const Ar=Sr.children[++br.at(-1)[1]];if(Ar===null)continue;const{name:Tr}=Ar;if(Tr==="#text"){const Pr=document.createTextNode(Ar.value);xr.push(Pr),Er.append(Pr);continue}const Rr=(Cr=Ar==null?void 0:Ar.attributes)!=null&&Cr.xmlns?document.createElementNS(Ar.attributes.xmlns,Tr):document.createElement(Tr);if(Er.append(Rr),Ar.attributes&&this.setAttributes({html:Rr,element:Ar,storage:fr,intent:gr,linkService:pr}),Ar.children&&Ar.children.length>0)br.push([Ar,-1,Rr]);else if(Ar.value){const Pr=document.createTextNode(Ar.value);ur.XfaText.shouldBuildText(Tr)&&xr.push(Pr),Rr.append(Pr)}}for(const Sr of yr.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))Sr.setAttribute("readOnly",!0);return{textDivs:xr}}static update(dr){const fr=`matrix(${dr.viewport.transform.join(",")})`;dr.div.style.transform=fr,dr.div.hidden=!1}}ar.XfaLayer=cr},(or,ar,lr)=>{var vr,gr,mr,br,yr,xr,Cr,Sr,wr,Er,Ar,Tr,Rr,Pr,_r,yu,bu,xu,wu,Hl,Eu,Vl,Cu,Su,Au,Tu,_u,uo,Gl,Uo,Ho,bo,Wl,Vo,Zr,Ru,Xl,ku,Pu,Yl,qo,xo;Object.defineProperty(ar,"__esModule",{value:!0}),ar.InkEditor=void 0;var ur=lr(1),cr=lr(4),hr=lr(29),dr=lr(6),fr=lr(5);const ys=class ys extends cr.AnnotationEditor{constructor(Kr){super({...Kr,name:"inkEditor"});Ts(this,_r);Ts(this,vr,0);Ts(this,gr,0);Ts(this,mr,this.canvasPointermove.bind(this));Ts(this,br,this.canvasPointerleave.bind(this));Ts(this,yr,this.canvasPointerup.bind(this));Ts(this,xr,this.canvasPointerdown.bind(this));Ts(this,Cr,new Path2D);Ts(this,Sr,!1);Ts(this,wr,!1);Ts(this,Er,!1);Ts(this,Ar,null);Ts(this,Tr,0);Ts(this,Rr,0);Ts(this,Pr,null);this.color=Kr.color||null,this.thickness=Kr.thickness||null,this.opacity=Kr.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Kr){cr.AnnotationEditor.initialize(Kr,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Kr,$a){switch(Kr){case ur.AnnotationEditorParamsType.INK_THICKNESS:ys._defaultThickness=$a;break;case ur.AnnotationEditorParamsType.INK_COLOR:ys._defaultColor=$a;break;case ur.AnnotationEditorParamsType.INK_OPACITY:ys._defaultOpacity=$a/100;break}}updateParams(Kr,$a){switch(Kr){case ur.AnnotationEditorParamsType.INK_THICKNESS:ws(this,_r,yu).call(this,$a);break;case ur.AnnotationEditorParamsType.INK_COLOR:ws(this,_r,bu).call(this,$a);break;case ur.AnnotationEditorParamsType.INK_OPACITY:ws(this,_r,xu).call(this,$a);break}}static get defaultPropertiesToUpdate(){return[[ur.AnnotationEditorParamsType.INK_THICKNESS,ys._defaultThickness],[ur.AnnotationEditorParamsType.INK_COLOR,ys._defaultColor||cr.AnnotationEditor._defaultLineColor],[ur.AnnotationEditorParamsType.INK_OPACITY,Math.round(ys._defaultOpacity*100)]]}get propertiesToUpdate(){return[[ur.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ys._defaultThickness],[ur.AnnotationEditorParamsType.INK_COLOR,this.color||ys._defaultColor||cr.AnnotationEditor._defaultLineColor],[ur.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??ys._defaultOpacity))]]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(ws(this,_r,Uo).call(this),ws(this,_r,Ho).call(this)),this.isAttachedToDOM||(this.parent.add(this),ws(this,_r,bo).call(this)),ws(this,_r,xo).call(this)))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,Gr(this,Ar).disconnect(),_s(this,Ar,null),super.remove())}setParent(Kr){!this.parent&&Kr?this._uiManager.removeShouldRescale(this):this.parent&&Kr===null&&this._uiManager.addShouldRescale(this),super.setParent(Kr)}onScaleChanging(){const[Kr,$a]=this.parentDimensions,ss=this.width*Kr,hs=this.height*$a;this.setDimensions(ss,hs)}enableEditMode(){Gr(this,Sr)||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",Gr(this,xr)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",Gr(this,xr)))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){Gr(this,Sr)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),_s(this,Sr,!0),this.div.classList.add("disabled"),ws(this,_r,xo).call(this,!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Kr){this._focusEventsAllowed&&(super.focusin(Kr),this.enableEditMode())}canvasPointerdown(Kr){Kr.button!==0||!this.isInEditMode()||Gr(this,Sr)||(this.setInForeground(),Kr.preventDefault(),Kr.type!=="mouse"&&this.div.focus(),ws(this,_r,Eu).call(this,Kr.offsetX,Kr.offsetY))}canvasPointermove(Kr){Kr.preventDefault(),ws(this,_r,Vl).call(this,Kr.offsetX,Kr.offsetY)}canvasPointerup(Kr){Kr.preventDefault(),ws(this,_r,Gl).call(this,Kr)}canvasPointerleave(Kr){ws(this,_r,Gl).call(this,Kr)}get isResizable(){return!this.isEmpty()&&Gr(this,Sr)}render(){if(this.div)return this.div;let Kr,$a;this.width&&(Kr=this.x,$a=this.y),super.render(),cr.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(xs=>{var fs;return(fs=this.div)==null?void 0:fs.setAttribute("aria-label",xs)});const[ss,hs,vs,bs]=ws(this,_r,wu).call(this);if(this.setAt(ss,hs,0,0),this.setDims(vs,bs),ws(this,_r,Uo).call(this),this.width){const[xs,fs]=this.parentDimensions;this.setAspectRatio(this.width*xs,this.height*fs),this.setAt(Kr*xs,$a*fs,this.width*xs,this.height*fs),_s(this,Er,!0),ws(this,_r,bo).call(this),this.setDims(this.width*xs,this.height*fs),ws(this,_r,uo).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return ws(this,_r,Ho).call(this),this.div}setDimensions(Kr,$a){const ss=Math.round(Kr),hs=Math.round($a);if(Gr(this,Tr)===ss&&Gr(this,Rr)===hs)return;_s(this,Tr,ss),_s(this,Rr,hs),this.canvas.style.visibility="hidden";const[vs,bs]=this.parentDimensions;this.width=Kr/vs,this.height=$a/bs,this.fixAndSetPosition(),Gr(this,Sr)&&ws(this,_r,Wl).call(this,Kr,$a),ws(this,_r,bo).call(this),ws(this,_r,uo).call(this),this.canvas.style.visibility="visible",this.fixDims()}static deserialize(Kr,$a,ss){var us,na,ds;if(Kr instanceof hr.InkAnnotationElement)return null;const hs=super.deserialize(Kr,$a,ss);hs.thickness=Kr.thickness,hs.color=ur.Util.makeHexColor(...Kr.color),hs.opacity=Kr.opacity;const[vs,bs]=hs.pageDimensions,xs=hs.width*vs,fs=hs.height*bs,Is=hs.parentScale,Os=Kr.thickness/2;_s(hs,Sr,!0),_s(hs,Tr,Math.round(xs)),_s(hs,Rr,Math.round(fs));const{paths:Us,rect:$s,rotation:Bs}=Kr;for(let{bezier:is}of Us){is=ws(us=ys,Zr,ku).call(us,is,$s,Bs);const _a=[];hs.paths.push(_a);let rs=Is*(is[0]-Os),Cs=Is*(is[1]-Os);for(let Rs=2,xa=is.length;Rs<xa;Rs+=6){const ps=Is*(is[Rs]-Os),Ps=Is*(is[Rs+1]-Os),Ms=Is*(is[Rs+2]-Os),Ls=Is*(is[Rs+3]-Os),Ds=Is*(is[Rs+4]-Os),es=Is*(is[Rs+5]-Os);_a.push([[rs,Cs],[ps,Ps],[Ms,Ls],[Ds,es]]),rs=Ds,Cs=es}const Es=ws(this,Zr,Ru).call(this,_a);hs.bezierPath2D.push(Es)}const Ns=ws(na=hs,_r,Yl).call(na);return _s(hs,gr,Math.max(cr.AnnotationEditor.MIN_SIZE,Ns[2]-Ns[0])),_s(hs,vr,Math.max(cr.AnnotationEditor.MIN_SIZE,Ns[3]-Ns[1])),ws(ds=hs,_r,Wl).call(ds,xs,fs),hs}serialize(){if(this.isEmpty())return null;const Kr=this.getRect(0,0),$a=cr.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:ur.AnnotationEditorType.INK,color:$a,thickness:this.thickness,opacity:this.opacity,paths:ws(this,_r,Pu).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,Kr),pageIndex:this.pageIndex,rect:Kr,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}};vr=new WeakMap,gr=new WeakMap,mr=new WeakMap,br=new WeakMap,yr=new WeakMap,xr=new WeakMap,Cr=new WeakMap,Sr=new WeakMap,wr=new WeakMap,Er=new WeakMap,Ar=new WeakMap,Tr=new WeakMap,Rr=new WeakMap,Pr=new WeakMap,_r=new WeakSet,yu=function(Kr){const $a=this.thickness;this.addCommands({cmd:()=>{this.thickness=Kr,ws(this,_r,xo).call(this)},undo:()=>{this.thickness=$a,ws(this,_r,xo).call(this)},mustExec:!0,type:ur.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},bu=function(Kr){const $a=this.color;this.addCommands({cmd:()=>{this.color=Kr,ws(this,_r,uo).call(this)},undo:()=>{this.color=$a,ws(this,_r,uo).call(this)},mustExec:!0,type:ur.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},xu=function(Kr){Kr/=100;const $a=this.opacity;this.addCommands({cmd:()=>{this.opacity=Kr,ws(this,_r,uo).call(this)},undo:()=>{this.opacity=$a,ws(this,_r,uo).call(this)},mustExec:!0,type:ur.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},wu=function(){const{parentRotation:Kr,parentDimensions:[$a,ss]}=this;switch(Kr){case 90:return[0,ss,ss,$a];case 180:return[$a,ss,$a,ss];case 270:return[$a,0,ss,$a];default:return[0,0,$a,ss]}},Hl=function(){const{ctx:Kr,color:$a,opacity:ss,thickness:hs,parentScale:vs,scaleFactor:bs}=this;Kr.lineWidth=hs*vs/bs,Kr.lineCap="round",Kr.lineJoin="round",Kr.miterLimit=10,Kr.strokeStyle=`${$a}${(0,fr.opacityToHex)(ss)}`},Eu=function(Kr,$a){this.canvas.addEventListener("contextmenu",dr.noContextMenu),this.canvas.addEventListener("pointerleave",Gr(this,br)),this.canvas.addEventListener("pointermove",Gr(this,mr)),this.canvas.addEventListener("pointerup",Gr(this,yr)),this.canvas.removeEventListener("pointerdown",Gr(this,xr)),this.isEditing=!0,Gr(this,Er)||(_s(this,Er,!0),ws(this,_r,bo).call(this),this.thickness||(this.thickness=ys._defaultThickness),this.color||(this.color=ys._defaultColor||cr.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=ys._defaultOpacity)),this.currentPath.push([Kr,$a]),_s(this,wr,!1),ws(this,_r,Hl).call(this),_s(this,Pr,()=>{ws(this,_r,Au).call(this),Gr(this,Pr)&&window.requestAnimationFrame(Gr(this,Pr))}),window.requestAnimationFrame(Gr(this,Pr))},Vl=function(Kr,$a){const[ss,hs]=this.currentPath.at(-1);if(this.currentPath.length>1&&Kr===ss&&$a===hs)return;const vs=this.currentPath;let bs=Gr(this,Cr);if(vs.push([Kr,$a]),_s(this,wr,!0),vs.length<=2){bs.moveTo(...vs[0]),bs.lineTo(Kr,$a);return}vs.length===3&&(_s(this,Cr,bs=new Path2D),bs.moveTo(...vs[0])),ws(this,_r,Tu).call(this,bs,...vs.at(-3),...vs.at(-2),Kr,$a)},Cu=function(){if(this.currentPath.length===0)return;const Kr=this.currentPath.at(-1);Gr(this,Cr).lineTo(...Kr)},Su=function(Kr,$a){_s(this,Pr,null),Kr=Math.min(Math.max(Kr,0),this.canvas.width),$a=Math.min(Math.max($a,0),this.canvas.height),ws(this,_r,Vl).call(this,Kr,$a),ws(this,_r,Cu).call(this);let ss;if(this.currentPath.length!==1)ss=ws(this,_r,_u).call(this);else{const fs=[Kr,$a];ss=[[fs,fs.slice(),fs.slice(),fs]]}const hs=Gr(this,Cr),vs=this.currentPath;this.currentPath=[],_s(this,Cr,new Path2D);const bs=()=>{this.allRawPaths.push(vs),this.paths.push(ss),this.bezierPath2D.push(hs),this.rebuild()},xs=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(ws(this,_r,Uo).call(this),ws(this,_r,Ho).call(this)),ws(this,_r,xo).call(this))};this.addCommands({cmd:bs,undo:xs,mustExec:!0})},Au=function(){if(!Gr(this,wr))return;_s(this,wr,!1);const Kr=Math.ceil(this.thickness*this.parentScale),$a=this.currentPath.slice(-3),ss=$a.map(bs=>bs[0]),hs=$a.map(bs=>bs[1]);Math.min(...ss)-Kr,Math.max(...ss)+Kr,Math.min(...hs)-Kr,Math.max(...hs)+Kr;const{ctx:vs}=this;vs.save(),vs.clearRect(0,0,this.canvas.width,this.canvas.height);for(const bs of this.bezierPath2D)vs.stroke(bs);vs.stroke(Gr(this,Cr)),vs.restore()},Tu=function(Kr,$a,ss,hs,vs,bs,xs){const fs=($a+hs)/2,Is=(ss+vs)/2,Os=(hs+bs)/2,Us=(vs+xs)/2;Kr.bezierCurveTo(fs+2*(hs-fs)/3,Is+2*(vs-Is)/3,Os+2*(hs-Os)/3,Us+2*(vs-Us)/3,Os,Us)},_u=function(){const Kr=this.currentPath;if(Kr.length<=2)return[[Kr[0],Kr[0],Kr.at(-1),Kr.at(-1)]];const $a=[];let ss,[hs,vs]=Kr[0];for(ss=1;ss<Kr.length-2;ss++){const[$s,Bs]=Kr[ss],[Ns,us]=Kr[ss+1],na=($s+Ns)/2,ds=(Bs+us)/2,is=[hs+2*($s-hs)/3,vs+2*(Bs-vs)/3],_a=[na+2*($s-na)/3,ds+2*(Bs-ds)/3];$a.push([[hs,vs],is,_a,[na,ds]]),[hs,vs]=[na,ds]}const[bs,xs]=Kr[ss],[fs,Is]=Kr[ss+1],Os=[hs+2*(bs-hs)/3,vs+2*(xs-vs)/3],Us=[fs+2*(bs-fs)/3,Is+2*(xs-Is)/3];return $a.push([[hs,vs],Os,Us,[fs,Is]]),$a},uo=function(){if(this.isEmpty()){ws(this,_r,Vo).call(this);return}ws(this,_r,Hl).call(this);const{canvas:Kr,ctx:$a}=this;$a.setTransform(1,0,0,1,0,0),$a.clearRect(0,0,Kr.width,Kr.height),ws(this,_r,Vo).call(this);for(const ss of this.bezierPath2D)$a.stroke(ss)},Gl=function(Kr){this.canvas.removeEventListener("pointerleave",Gr(this,br)),this.canvas.removeEventListener("pointermove",Gr(this,mr)),this.canvas.removeEventListener("pointerup",Gr(this,yr)),this.canvas.addEventListener("pointerdown",Gr(this,xr)),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",dr.noContextMenu)},10),ws(this,_r,Su).call(this,Kr.offsetX,Kr.offsetY),this.addToAnnotationStorage(),this.setInBackground()},Uo=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",cr.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Kr=>{var $a;return($a=this.canvas)==null?void 0:$a.setAttribute("aria-label",Kr)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Ho=function(){_s(this,Ar,new ResizeObserver(Kr=>{const $a=Kr[0].contentRect;$a.width&&$a.height&&this.setDimensions($a.width,$a.height)})),Gr(this,Ar).observe(this.div)},bo=function(){if(!Gr(this,Er))return;const[Kr,$a]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Kr),this.canvas.height=Math.ceil(this.height*$a),ws(this,_r,Vo).call(this)},Wl=function(Kr,$a){const ss=ws(this,_r,qo).call(this),hs=(Kr-ss)/Gr(this,gr),vs=($a-ss)/Gr(this,vr);this.scaleFactor=Math.min(hs,vs)},Vo=function(){const Kr=ws(this,_r,qo).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Kr,this.translationY*this.scaleFactor+Kr)},Zr=new WeakSet,Ru=function(Kr){const $a=new Path2D;for(let ss=0,hs=Kr.length;ss<hs;ss++){const[vs,bs,xs,fs]=Kr[ss];ss===0&&$a.moveTo(...vs),$a.bezierCurveTo(bs[0],bs[1],xs[0],xs[1],fs[0],fs[1])}return $a},Xl=function(Kr,$a,ss){const[hs,vs,bs,xs]=$a;switch(ss){case 0:for(let fs=0,Is=Kr.length;fs<Is;fs+=2)Kr[fs]+=hs,Kr[fs+1]=xs-Kr[fs+1];break;case 90:for(let fs=0,Is=Kr.length;fs<Is;fs+=2){const Os=Kr[fs];Kr[fs]=Kr[fs+1]+hs,Kr[fs+1]=Os+vs}break;case 180:for(let fs=0,Is=Kr.length;fs<Is;fs+=2)Kr[fs]=bs-Kr[fs],Kr[fs+1]+=vs;break;case 270:for(let fs=0,Is=Kr.length;fs<Is;fs+=2){const Os=Kr[fs];Kr[fs]=bs-Kr[fs+1],Kr[fs+1]=xs-Os}break;default:throw new Error("Invalid rotation")}return Kr},ku=function(Kr,$a,ss){const[hs,vs,bs,xs]=$a;switch(ss){case 0:for(let fs=0,Is=Kr.length;fs<Is;fs+=2)Kr[fs]-=hs,Kr[fs+1]=xs-Kr[fs+1];break;case 90:for(let fs=0,Is=Kr.length;fs<Is;fs+=2){const Os=Kr[fs];Kr[fs]=Kr[fs+1]-vs,Kr[fs+1]=Os-hs}break;case 180:for(let fs=0,Is=Kr.length;fs<Is;fs+=2)Kr[fs]=bs-Kr[fs],Kr[fs+1]-=vs;break;case 270:for(let fs=0,Is=Kr.length;fs<Is;fs+=2){const Os=Kr[fs];Kr[fs]=xs-Kr[fs+1],Kr[fs+1]=bs-Os}break;default:throw new Error("Invalid rotation")}return Kr},Pu=function(Kr,$a,ss,hs){var Is,Os;const vs=[],bs=this.thickness/2,xs=Kr*$a+bs,fs=Kr*ss+bs;for(const Us of this.paths){const $s=[],Bs=[];for(let Ns=0,us=Us.length;Ns<us;Ns++){const[na,ds,is,_a]=Us[Ns],rs=Kr*na[0]+xs,Cs=Kr*na[1]+fs,Es=Kr*ds[0]+xs,Rs=Kr*ds[1]+fs,xa=Kr*is[0]+xs,ps=Kr*is[1]+fs,Ps=Kr*_a[0]+xs,Ms=Kr*_a[1]+fs;Ns===0&&($s.push(rs,Cs),Bs.push(rs,Cs)),$s.push(Es,Rs,xa,ps,Ps,Ms),Bs.push(Es,Rs),Ns===us-1&&Bs.push(Ps,Ms)}vs.push({bezier:ws(Is=ys,Zr,Xl).call(Is,$s,hs,this.rotation),points:ws(Os=ys,Zr,Xl).call(Os,Bs,hs,this.rotation)})}return vs},Yl=function(){let Kr=1/0,$a=-1/0,ss=1/0,hs=-1/0;for(const vs of this.paths)for(const[bs,xs,fs,Is]of vs){const Os=ur.Util.bezierBoundingBox(...bs,...xs,...fs,...Is);Kr=Math.min(Kr,Os[0]),ss=Math.min(ss,Os[1]),$a=Math.max($a,Os[2]),hs=Math.max(hs,Os[3])}return[Kr,ss,$a,hs]},qo=function(){return Gr(this,Sr)?Math.ceil(this.thickness*this.parentScale):0},xo=function(Kr=!1){if(this.isEmpty())return;if(!Gr(this,Sr)){ws(this,_r,uo).call(this);return}const $a=ws(this,_r,Yl).call(this),ss=ws(this,_r,qo).call(this);_s(this,gr,Math.max(cr.AnnotationEditor.MIN_SIZE,$a[2]-$a[0])),_s(this,vr,Math.max(cr.AnnotationEditor.MIN_SIZE,$a[3]-$a[1]));const hs=Math.ceil(ss+Gr(this,gr)*this.scaleFactor),vs=Math.ceil(ss+Gr(this,vr)*this.scaleFactor),[bs,xs]=this.parentDimensions;this.width=hs/bs,this.height=vs/xs,this.setAspectRatio(hs,vs);const fs=this.translationX,Is=this.translationY;this.translationX=-$a[0],this.translationY=-$a[1],ws(this,_r,bo).call(this),ws(this,_r,uo).call(this),_s(this,Tr,hs),_s(this,Rr,vs),this.setDims(hs,vs);const Os=Kr?ss/this.scaleFactor/2:0;this.translate(fs-this.translationX-Os,Is-this.translationY-Os)},Ts(ys,Zr),Zs(ys,"_defaultColor",null),Zs(ys,"_defaultOpacity",1),Zs(ys,"_defaultThickness",1),Zs(ys,"_type","ink");let pr=ys;ar.InkEditor=pr},(or,ar,lr)=>{var pr,vr,gr,mr,br,yr,xr,Cr,Sr,wr,Er,Po,Do,Go,Kl,Du,Mu,Ql,Wo,Lu;Object.defineProperty(ar,"__esModule",{value:!0}),ar.StampEditor=void 0;var ur=lr(1),cr=lr(4),hr=lr(6),dr=lr(29);const Or=class Or extends cr.AnnotationEditor{constructor($r){super({...$r,name:"stampEditor"});Ts(this,Er);Ts(this,pr,null);Ts(this,vr,null);Ts(this,gr,null);Ts(this,mr,null);Ts(this,br,null);Ts(this,yr,null);Ts(this,xr,null);Ts(this,Cr,null);Ts(this,Sr,!1);Ts(this,wr,!1);_s(this,mr,$r.bitmapUrl),_s(this,br,$r.bitmapFile)}static initialize($r){cr.AnnotationEditor.initialize($r)}static get supportedTypes(){const $r=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,ur.shadow)(this,"supportedTypes",$r.map(jr=>`image/${jr}`))}static get supportedTypesStr(){return(0,ur.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting($r){return this.supportedTypes.includes($r)}static paste($r,jr){jr.pasteEditor(ur.AnnotationEditorType.STAMP,{bitmapFile:$r.getAsFile()})}remove(){var $r,jr;Gr(this,vr)&&(_s(this,pr,null),this._uiManager.imageManager.deleteId(Gr(this,vr)),($r=Gr(this,yr))==null||$r.remove(),_s(this,yr,null),(jr=Gr(this,xr))==null||jr.disconnect(),_s(this,xr,null)),super.remove()}rebuild(){if(!this.parent){Gr(this,vr)&&ws(this,Er,Go).call(this);return}super.rebuild(),this.div!==null&&(Gr(this,vr)&&ws(this,Er,Go).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(Gr(this,gr)||Gr(this,pr)||Gr(this,mr)||Gr(this,br))}get isResizable(){return!0}render(){if(this.div)return this.div;let $r,jr;if(this.width&&($r=this.x,jr=this.y),super.render(),this.div.hidden=!0,Gr(this,pr)?ws(this,Er,Kl).call(this):ws(this,Er,Go).call(this),this.width){const[Fr,zr]=this.parentDimensions;this.setAt($r*Fr,jr*zr,this.width*Fr,this.height*zr)}return this.div}static deserialize($r,jr,Fr){if($r instanceof dr.StampAnnotationElement)return null;const zr=super.deserialize($r,jr,Fr),{rect:Hr,bitmapUrl:Wr,bitmapId:Yr,isSvg:qr,accessibilityData:Br}=$r;Yr&&Fr.imageManager.isValidId(Yr)?_s(zr,vr,Yr):_s(zr,mr,Wr),_s(zr,Sr,qr);const[Ur,Vr]=zr.pageDimensions;return zr.width=(Hr[2]-Hr[0])/Ur,zr.height=(Hr[3]-Hr[1])/Vr,Br&&(zr.altTextData=Br),zr}serialize($r=!1,jr=null){if(this.isEmpty())return null;const Fr={annotationType:ur.AnnotationEditorType.STAMP,bitmapId:Gr(this,vr),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:Gr(this,Sr),structTreeParentId:this._structTreeParentId};if($r)return Fr.bitmapUrl=ws(this,Er,Wo).call(this,!0),Fr.accessibilityData=this.altTextData,Fr;const{decorative:zr,altText:Hr}=this.altTextData;if(!zr&&Hr&&(Fr.accessibilityData={type:"Figure",alt:Hr}),jr===null)return Fr;jr.stamps||(jr.stamps=new Map);const Wr=Gr(this,Sr)?(Fr.rect[2]-Fr.rect[0])*(Fr.rect[3]-Fr.rect[1]):null;if(!jr.stamps.has(Gr(this,vr)))jr.stamps.set(Gr(this,vr),{area:Wr,serialized:Fr}),Fr.bitmap=ws(this,Er,Wo).call(this,!1);else if(Gr(this,Sr)){const Yr=jr.stamps.get(Gr(this,vr));Wr>Yr.area&&(Yr.area=Wr,Yr.serialized.bitmap.close(),Yr.serialized.bitmap=ws(this,Er,Wo).call(this,!1))}return Fr}};pr=new WeakMap,vr=new WeakMap,gr=new WeakMap,mr=new WeakMap,br=new WeakMap,yr=new WeakMap,xr=new WeakMap,Cr=new WeakMap,Sr=new WeakMap,wr=new WeakMap,Er=new WeakSet,Po=function($r,jr=!1){if(!$r){this.remove();return}_s(this,pr,$r.bitmap),jr||(_s(this,vr,$r.id),_s(this,Sr,$r.isSvg)),ws(this,Er,Kl).call(this)},Do=function(){_s(this,gr,null),this._uiManager.enableWaiting(!1),Gr(this,yr)&&this.div.focus()},Go=function(){if(Gr(this,vr)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(Gr(this,vr)).then(jr=>ws(this,Er,Po).call(this,jr,!0)).finally(()=>ws(this,Er,Do).call(this));return}if(Gr(this,mr)){const jr=Gr(this,mr);_s(this,mr,null),this._uiManager.enableWaiting(!0),_s(this,gr,this._uiManager.imageManager.getFromUrl(jr).then(Fr=>ws(this,Er,Po).call(this,Fr)).finally(()=>ws(this,Er,Do).call(this)));return}if(Gr(this,br)){const jr=Gr(this,br);_s(this,br,null),this._uiManager.enableWaiting(!0),_s(this,gr,this._uiManager.imageManager.getFromFile(jr).then(Fr=>ws(this,Er,Po).call(this,Fr)).finally(()=>ws(this,Er,Do).call(this)));return}const $r=document.createElement("input");$r.type="file",$r.accept=Or.supportedTypesStr,_s(this,gr,new Promise(jr=>{$r.addEventListener("change",async()=>{if(!$r.files||$r.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const Fr=await this._uiManager.imageManager.getFromFile($r.files[0]);ws(this,Er,Po).call(this,Fr)}jr()}),$r.addEventListener("cancel",()=>{this.remove(),jr()})}).finally(()=>ws(this,Er,Do).call(this))),$r.click()},Kl=function(){const{div:$r}=this;let{width:jr,height:Fr}=Gr(this,pr);const[zr,Hr]=this.pageDimensions,Wr=.75;if(this.width)jr=this.width*zr,Fr=this.height*Hr;else if(jr>Wr*zr||Fr>Wr*Hr){const Ur=Math.min(Wr*zr/jr,Wr*Hr/Fr);jr*=Ur,Fr*=Ur}const[Yr,qr]=this.parentDimensions;this.setDims(jr*Yr/zr,Fr*qr/Hr),this._uiManager.enableWaiting(!1);const Br=_s(this,yr,document.createElement("canvas"));$r.append(Br),$r.hidden=!1,ws(this,Er,Ql).call(this,jr,Fr),ws(this,Er,Lu).call(this),Gr(this,wr)||(this.parent.addUndoableEditor(this),_s(this,wr,!0)),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()},Du=function($r,jr){var Wr;const[Fr,zr]=this.parentDimensions;this.width=$r/Fr,this.height=jr/zr,this.setDims($r,jr),(Wr=this._initialOptions)!=null&&Wr.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,Gr(this,Cr)!==null&&clearTimeout(Gr(this,Cr)),_s(this,Cr,setTimeout(()=>{_s(this,Cr,null),ws(this,Er,Ql).call(this,$r,jr)},200))},Mu=function($r,jr){const{width:Fr,height:zr}=Gr(this,pr);let Hr=Fr,Wr=zr,Yr=Gr(this,pr);for(;Hr>2*$r||Wr>2*jr;){const qr=Hr,Br=Wr;Hr>2*$r&&(Hr=Hr>=16384?Math.floor(Hr/2)-1:Math.ceil(Hr/2)),Wr>2*jr&&(Wr=Wr>=16384?Math.floor(Wr/2)-1:Math.ceil(Wr/2));const Ur=new OffscreenCanvas(Hr,Wr);Ur.getContext("2d").drawImage(Yr,0,0,qr,Br,0,0,Hr,Wr),Yr=Ur.transferToImageBitmap()}return Yr},Ql=function($r,jr){$r=Math.ceil($r),jr=Math.ceil(jr);const Fr=Gr(this,yr);if(!Fr||Fr.width===$r&&Fr.height===jr)return;Fr.width=$r,Fr.height=jr;const zr=Gr(this,Sr)?Gr(this,pr):ws(this,Er,Mu).call(this,$r,jr),Hr=Fr.getContext("2d");Hr.filter=this._uiManager.hcmFilter,Hr.drawImage(zr,0,0,zr.width,zr.height,0,0,$r,jr)},Wo=function($r){if($r){if(Gr(this,Sr)){const zr=this._uiManager.imageManager.getSvgUrl(Gr(this,vr));if(zr)return zr}const jr=document.createElement("canvas");return{width:jr.width,height:jr.height}=Gr(this,pr),jr.getContext("2d").drawImage(Gr(this,pr),0,0),jr.toDataURL()}if(Gr(this,Sr)){const[jr,Fr]=this.pageDimensions,zr=Math.round(this.width*jr*hr.PixelsPerInch.PDF_TO_CSS_UNITS),Hr=Math.round(this.height*Fr*hr.PixelsPerInch.PDF_TO_CSS_UNITS),Wr=new OffscreenCanvas(zr,Hr);return Wr.getContext("2d").drawImage(Gr(this,pr),0,0,Gr(this,pr).width,Gr(this,pr).height,0,0,zr,Hr),Wr.transferToImageBitmap()}return structuredClone(Gr(this,pr))},Lu=function(){_s(this,xr,new ResizeObserver($r=>{const jr=$r[0].contentRect;jr.width&&jr.height&&ws(this,Er,Du).call(this,jr.width,jr.height)})),Gr(this,xr).observe(this.div)},Zs(Or,"_type","stamp");let fr=Or;ar.StampEditor=fr}],__webpack_module_cache__={};function __w_pdfjs_require__(or){var ar=__webpack_module_cache__[or];if(ar!==void 0)return ar.exports;var lr=__webpack_module_cache__[or]={exports:{}};return __webpack_modules__[or](lr,lr.exports,__w_pdfjs_require__),lr.exports}var __webpack_exports__={};return(()=>{var or=__webpack_exports__;Object.defineProperty(or,"__esModule",{value:!0}),Object.defineProperty(or,"AbortException",{enumerable:!0,get:function(){return ar.AbortException}}),Object.defineProperty(or,"AnnotationEditorLayer",{enumerable:!0,get:function(){return hr.AnnotationEditorLayer}}),Object.defineProperty(or,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return ar.AnnotationEditorParamsType}}),Object.defineProperty(or,"AnnotationEditorType",{enumerable:!0,get:function(){return ar.AnnotationEditorType}}),Object.defineProperty(or,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return dr.AnnotationEditorUIManager}}),Object.defineProperty(or,"AnnotationLayer",{enumerable:!0,get:function(){return fr.AnnotationLayer}}),Object.defineProperty(or,"AnnotationMode",{enumerable:!0,get:function(){return ar.AnnotationMode}}),Object.defineProperty(or,"CMapCompressionType",{enumerable:!0,get:function(){return ar.CMapCompressionType}}),Object.defineProperty(or,"DOMSVGFactory",{enumerable:!0,get:function(){return ur.DOMSVGFactory}}),Object.defineProperty(or,"FeatureTest",{enumerable:!0,get:function(){return ar.FeatureTest}}),Object.defineProperty(or,"GlobalWorkerOptions",{enumerable:!0,get:function(){return pr.GlobalWorkerOptions}}),Object.defineProperty(or,"ImageKind",{enumerable:!0,get:function(){return ar.ImageKind}}),Object.defineProperty(or,"InvalidPDFException",{enumerable:!0,get:function(){return ar.InvalidPDFException}}),Object.defineProperty(or,"MissingPDFException",{enumerable:!0,get:function(){return ar.MissingPDFException}}),Object.defineProperty(or,"OPS",{enumerable:!0,get:function(){return ar.OPS}}),Object.defineProperty(or,"PDFDataRangeTransport",{enumerable:!0,get:function(){return lr.PDFDataRangeTransport}}),Object.defineProperty(or,"PDFDateString",{enumerable:!0,get:function(){return ur.PDFDateString}}),Object.defineProperty(or,"PDFWorker",{enumerable:!0,get:function(){return lr.PDFWorker}}),Object.defineProperty(or,"PasswordResponses",{enumerable:!0,get:function(){return ar.PasswordResponses}}),Object.defineProperty(or,"PermissionFlag",{enumerable:!0,get:function(){return ar.PermissionFlag}}),Object.defineProperty(or,"PixelsPerInch",{enumerable:!0,get:function(){return ur.PixelsPerInch}}),Object.defineProperty(or,"PromiseCapability",{enumerable:!0,get:function(){return ar.PromiseCapability}}),Object.defineProperty(or,"RenderingCancelledException",{enumerable:!0,get:function(){return ur.RenderingCancelledException}}),Object.defineProperty(or,"SVGGraphics",{enumerable:!0,get:function(){return lr.SVGGraphics}}),Object.defineProperty(or,"UnexpectedResponseException",{enumerable:!0,get:function(){return ar.UnexpectedResponseException}}),Object.defineProperty(or,"Util",{enumerable:!0,get:function(){return ar.Util}}),Object.defineProperty(or,"VerbosityLevel",{enumerable:!0,get:function(){return ar.VerbosityLevel}}),Object.defineProperty(or,"XfaLayer",{enumerable:!0,get:function(){return vr.XfaLayer}}),Object.defineProperty(or,"build",{enumerable:!0,get:function(){return lr.build}}),Object.defineProperty(or,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return ar.createValidAbsoluteUrl}}),Object.defineProperty(or,"getDocument",{enumerable:!0,get:function(){return lr.getDocument}}),Object.defineProperty(or,"getFilenameFromUrl",{enumerable:!0,get:function(){return ur.getFilenameFromUrl}}),Object.defineProperty(or,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return ur.getPdfFilenameFromUrl}}),Object.defineProperty(or,"getXfaPageViewport",{enumerable:!0,get:function(){return ur.getXfaPageViewport}}),Object.defineProperty(or,"isDataScheme",{enumerable:!0,get:function(){return ur.isDataScheme}}),Object.defineProperty(or,"isPdfFile",{enumerable:!0,get:function(){return ur.isPdfFile}}),Object.defineProperty(or,"loadScript",{enumerable:!0,get:function(){return ur.loadScript}}),Object.defineProperty(or,"noContextMenu",{enumerable:!0,get:function(){return ur.noContextMenu}}),Object.defineProperty(or,"normalizeUnicode",{enumerable:!0,get:function(){return ar.normalizeUnicode}}),Object.defineProperty(or,"renderTextLayer",{enumerable:!0,get:function(){return cr.renderTextLayer}}),Object.defineProperty(or,"setLayerDimensions",{enumerable:!0,get:function(){return ur.setLayerDimensions}}),Object.defineProperty(or,"shadow",{enumerable:!0,get:function(){return ar.shadow}}),Object.defineProperty(or,"updateTextLayer",{enumerable:!0,get:function(){return cr.updateTextLayer}}),Object.defineProperty(or,"version",{enumerable:!0,get:function(){return lr.version}});var ar=__w_pdfjs_require__(1),lr=__w_pdfjs_require__(2),ur=__w_pdfjs_require__(6),cr=__w_pdfjs_require__(26),hr=__w_pdfjs_require__(27),dr=__w_pdfjs_require__(5),fr=__w_pdfjs_require__(29),pr=__w_pdfjs_require__(14),vr=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf);var pdfExports=pdf.exports;pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`;class PDFProcessor{constructor(){Zs(this,"pdfDocument",null)}async loadPDF(ar){const lr=await ar.arrayBuffer();this.pdfDocument=await pdfExports.getDocument(lr).promise}async extractTextFromPage(ar){if(!this.pdfDocument)throw new Error("PDF not loaded");const ur=await(await this.pdfDocument.getPage(ar)).getTextContent();let cr="";const hr=[];return ur.items.forEach(dr=>{"str"in dr&&(cr+=dr.str+" ","height"in dr&&hr.push(dr.height))}),{text:cr.trim(),fontSize:hr}}async extractChapterText(ar){let lr="";for(let ur=ar.startPage;ur<=ar.endPage;ur++){const{text:cr}=await this.extractTextFromPage(ur);lr+=cr+`
`}return lr}async detectChapters(){if(!this.pdfDocument)throw new Error("PDF not loaded");const ar=this.pdfDocument.numPages,lr=await this.findExplicitChapterMarkers(ar);if(lr.length>0)return this.createChapterBoundaries(lr,ar);const ur=await this.findChaptersByFontSize(ar);return ur.length>0?this.createChapterBoundaries(ur,ar):[{chapter:1,startPage:1,endPage:ar}]}async findExplicitChapterMarkers(ar){const lr=[],ur=[/chapter\s+(\d+)/i,/chapter\s+([ivxlcdm]+)/i,/ch\.\s*(\d+)/i,/^(\d+)\.\s*[A-Z]/,/^[A-Z\s]+$/];for(let cr=1;cr<=ar;cr++)try{const{text:hr}=await this.extractTextFromPage(cr),dr=hr.split(`
`).map(fr=>fr.trim());for(const fr of dr)for(const pr of ur)if(pr.test(fr)){lr.push(cr);break}}catch(hr){console.warn(`Error processing page ${cr}:`,hr)}return this.deduplicateChapterPages(lr)}async findChaptersByFontSize(ar){const lr=[],ur=[];for(let dr=1;dr<=ar;dr++)try{const{fontSize:fr}=await this.extractTextFromPage(dr);if(fr.length>0){const pr=Math.max(...fr),vr=fr.reduce((gr,mr)=>gr+mr,0)/fr.length;ur.push({page:dr,maxFontSize:pr,avgFontSize:vr})}}catch(fr){console.warn(`Error processing page ${dr}:`,fr)}if(ur.length===0)return[];const hr=ur.reduce((dr,fr)=>dr+fr.maxFontSize,0)/ur.length*1.2;return ur.forEach(dr=>{dr.maxFontSize>hr&&lr.push(dr.page)}),this.deduplicateChapterPages(lr)}deduplicateChapterPages(ar){const lr=[...new Set(ar)].sort((cr,hr)=>cr-hr),ur=[];return lr.forEach(cr=>{(ur.length===0||cr-ur[ur.length-1]>3)&&ur.push(cr)}),ur}createChapterBoundaries(ar,lr){const ur=[];ar[0]!==1&&ar.unshift(1);for(let cr=0;cr<ar.length;cr++){const hr=ar[cr],dr=cr<ar.length-1?ar[cr+1]-1:lr;ur.push({chapter:cr+1,startPage:hr,endPage:dr})}return ur}getTotalPages(){var ar;return((ar=this.pdfDocument)==null?void 0:ar.numPages)||0}cleanup(){this.pdfDocument&&(this.pdfDocument.destroy(),this.pdfDocument=null)}}class BookService{async createBook(ar,lr,ur,cr){return new Promise(async(hr,dr)=>{try{if(console&&console.log&&console.log("BookService: Creating book:",lr),!ar||ar.size===0)throw new Error("PDF file is empty or invalid");if(!ar.type.includes("pdf"))throw new Error("File must be a PDF");const fr=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),pr=50*1024*1024;if(fr&&ar.size>pr)throw new Error("File too large for Safari. Please use a smaller PDF file.");let vr;try{if(fr){const xr=[];for(let Cr=0;Cr<ar.size;Cr+=1048576){const wr=await ar.slice(Cr,Cr+1048576).arrayBuffer();xr.push(wr)}vr=new Blob(xr,{type:"application/pdf"})}else{const yr=await ar.arrayBuffer();vr=new Blob([yr],{type:"application/pdf"})}if(vr.size===0)throw new Error("PDF blob creation failed")}catch(yr){throw new Error(`Failed to process PDF file: ${yr instanceof Error?yr.message:"Unknown error"}`)}const mr={id:crypto&&crypto.randomUUID?crypto.randomUUID():"book_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),title:lr,author:ur,fileName:ar.name,pdfBlob:vr,totalChapters:cr.length,currentChapter:1,chapterBoundaries:cr,uploadDate:new Date().toISOString()};await db.transaction("rw",db.books,async()=>{await db.books.add(mr)}),console&&console.log&&console.log("BookService: Book successfully created and stored:",mr.id),hr(mr)}catch(fr){console&&console.error&&console.error("BookService: Error creating book:",fr),dr(new Error(`Failed to create book: ${fr instanceof Error?fr.message:"Unknown error"}`))}})}async updateBookChapter(ar,lr){await db.books.update(ar,{currentChapter:lr})}async updateChapterBoundaries(ar,lr){return new Promise(async(ur,cr)=>{try{if(console&&console.log&&(console.log("BookService: updateChapterBoundaries called with bookId:",ar),console.log("BookService: Chapter boundaries count:",lr.length)),!ar||typeof ar!="string")throw new Error("Invalid book ID provided");if(!Array.isArray(lr))throw new Error("Chapter boundaries must be an array");let hr=null;await this.removeDuplicateBooks(),await db.transaction("rw",db.books,async()=>{const pr=await db.books.get(ar);if(!pr)throw new Error(`Book with ID ${ar} not found`);console&&console.log&&console.log("BookService: Found book for update:",{id:pr.id,title:pr.title});const vr={...pr,chapterBoundaries:[...lr],totalChapters:lr.length,id:ar};await db.books.put(vr);const gr=await db.books.where("fileName").equals(pr.fileName).toArray();if(gr.length>1){console&&console.warn&&console.warn("BookService: Duplicate detected after update, cleaning up...");for(const mr of gr)mr.id!==ar&&(await db.books.delete(mr.id),console&&console.log&&console.log("BookService: Removed duplicate book:",mr.id))}return hr=1,hr}),console&&console.log&&console.log("BookService: Transaction completed, rows affected:",hr);let fr=!1;for(let pr=0;pr<5;pr++)try{await new Promise(gr=>setTimeout(gr,100+pr*200));const vr=await db.books.get(ar);if(vr&&vr.chapterBoundaries&&vr.chapterBoundaries.length===lr.length){console&&console.log&&console.log("BookService: Update verification successful on attempt",pr+1),fr=!0;break}else console&&console.log&&console.log("BookService: Verification attempt",pr+1,"failed, retrying...")}catch(vr){console&&console.warn&&console.warn("BookService: Verification attempt",pr+1,"error:",vr)}!fr&&console&&console.warn&&console.warn("BookService: Could not verify update after 5 attempts"),console&&console.log&&console.log("BookService: Successfully updated chapter boundaries"),ur()}catch(hr){console&&console.error&&console.error("BookService: Error in updateChapterBoundaries:",hr),cr(new Error(`Failed to update chapter boundaries: ${hr instanceof Error?hr.message:"Unknown error"}`))}})}async getBook(ar){return await db.books.get(ar)}async getAllBooks(){return await db.books.toArray()}async deleteBook(ar){await db.characters.where("bookId").equals(ar).delete(),await db.books.delete(ar)}async removeDuplicateBooks(){try{const ar=await db.books.toArray();console&&console.log&&console.log("BookService: Checking for duplicates among",ar.length,"books");const lr=new Map;for(const cr of ar)cr.fileName&&(lr.has(cr.fileName)||lr.set(cr.fileName,[]),lr.get(cr.fileName).push(cr));let ur=0;for(const[cr,hr]of lr)if(hr.length>1){console&&console.log&&console.log("BookService: Found",hr.length,"copies of:",cr),hr.sort((pr,vr)=>{const gr=new Date(pr.uploadDate||0).getTime(),mr=new Date(vr.uploadDate||0).getTime();return mr!==gr?mr-gr:pr.id.localeCompare(vr.id)});const dr=hr[0],fr=hr.slice(1);console&&console.log&&console.log("BookService: Keeping book:",dr.id,"Removing:",fr.length);for(const pr of fr)try{await this.deleteBook(pr.id),ur++}catch(vr){console&&console.warn&&console.warn("BookService: Failed to delete duplicate:",pr.id,vr)}}console&&console.log&&console.log("BookService: Removed",ur,"duplicate books")}catch(ar){console&&console.error&&console.error("BookService: Error removing duplicates:",ar)}}async validateAndFixBooks(){const ar=await db.books.toArray(),lr=[];for(const ur of ar)try{if(!ur.pdfBlob||ur.pdfBlob.size===0){lr.push(ur.id);continue}await ur.pdfBlob.slice(0,100).arrayBuffer()}catch(cr){console.warn(`Book ${ur.title} has corrupted PDF:`,cr),lr.push(ur.id)}for(const ur of lr)await this.deleteBook(ur);lr.length>0&&console.log(`Removed ${lr.length} corrupted books`)}}class CharacterService{async saveCharacters(ar,lr){const ur=lr.map(cr=>({...cr,bookId:ar}));await db.characters.bulkPut(ur)}async getCharactersForBook(ar){return await db.characters.where("bookId").equals(ar).toArray()}async getCharactersUpToChapter(ar,lr){return(await this.getCharactersForBook(ar)).filter(cr=>cr.firstAppearance<=lr)}async updateCharacter(ar){await db.characters.put(ar)}async findCharacterByName(ar,lr){return await db.characters.where("bookId").equals(ar).and(ur=>ur.name.toLowerCase()===lr.toLowerCase()).first()}async deleteCharactersForBook(ar){await db.characters.where("bookId").equals(ar).delete()}async getAnalyzedChapters(ar){const lr=await this.getCharactersForBook(ar),ur=new Set;for(const cr of lr){ur.add(cr.firstAppearance);for(const hr of cr.chapterHistory)ur.add(hr.chapter)}return ur}async mergeCharacters(ar,lr){const ur=await db.characters.get(ar),cr=await db.characters.get(lr);if(!ur||!cr)throw new Error("Source or target character not found");if(ur.bookId!==cr.bookId)throw new Error("Cannot merge characters from different books");const hr={...cr,mentionCount:cr.mentionCount+ur.mentionCount,firstAppearance:Math.min(cr.firstAppearance,ur.firstAppearance),relationships:[...cr.relationships,...ur.relationships.filter(fr=>!cr.relationships.some(pr=>pr.targetCharacterId===fr.targetCharacterId&&pr.type===fr.type))],chapterHistory:[...cr.chapterHistory,...ur.chapterHistory.filter(fr=>!cr.chapterHistory.some(pr=>pr.chapter===fr.chapter))].sort((fr,pr)=>fr.chapter-pr.chapter),aliases:[...cr.aliases||[],ur.name,...ur.aliases||[]].filter((fr,pr,vr)=>vr.indexOf(fr)===pr)},dr=await db.characters.where("bookId").equals(ur.bookId).toArray();for(const fr of dr){let pr=!1;const vr=fr.relationships.map(gr=>gr.targetCharacterId===ar?(pr=!0,{...gr,targetCharacterId:lr}):gr);pr&&await db.characters.put({...fr,relationships:vr})}await db.characters.put(hr),await db.characters.delete(ar)}}class PDFService{constructor(){Zs(this,"processor",new PDFProcessor)}async processBookFile(ar){await this.processor.loadPDF(ar);const lr=await this.processor.detectChapters(),ur=this.processor.getTotalPages();return{chapterBoundaries:lr,totalPages:ur}}async extractChapterText(ar,lr){try{if(!ar||ar.size===0)throw new Error("Invalid PDF file provided");return await ar.slice(0,1024).arrayBuffer(),await this.processor.loadPDF(ar),await this.processor.extractChapterText(lr)}catch(ur){throw console.error("PDF extraction error:",ur),new Error(`Failed to extract text from PDF: ${ur instanceof Error?ur.message:"Unknown error"}`)}}async extractTextFromPage(ar,lr){return await this.processor.loadPDF(ar),await this.processor.extractTextFromPage(lr)}cleanup(){this.processor.cleanup()}}class DatabaseManager{async resetDatabase(){try{if(await db.delete(),"indexedDB"in window&&"databases"in indexedDB){const ar=await indexedDB.databases();await Promise.all(ar.filter(lr=>{var ur;return(ur=lr.name)==null?void 0:ur.includes("BookCharacter")}).map(lr=>{if(lr.name){const ur=indexedDB.deleteDatabase(lr.name);return new Promise((cr,hr)=>{ur.onsuccess=()=>cr(!0),ur.onerror=()=>hr(ur.error)})}}))}await db.open(),console.log("Database reset successfully")}catch(ar){throw console.error("Error resetting database:",ar),ar}}async isDatabaseCorrupted(){try{return await db.books.toArray(),!1}catch(ar){return console.error("Database corruption detected:",ar),!0}}async repairDatabase(){try{console.log("Starting database repair...");const ar=await db.books.toArray(),lr=[];for(const ur of ar)try{if(!ur.id||!ur.title||!ur.fileName){console.warn("Book missing required fields:",ur),lr.push(ur.id);continue}if(!ur.pdfBlob||ur.pdfBlob.size===0){console.warn("Book has invalid PDF blob:",ur.title),lr.push(ur.id);continue}try{const cr=ur.pdfBlob.slice(0,Math.min(ur.pdfBlob.size,5e4)),hr=new Promise((gr,mr)=>setTimeout(()=>mr(new Error("Blob validation timeout")),5e3));await Promise.race([cr.arrayBuffer(),hr]);const fr=await ur.pdfBlob.slice(0,10).arrayBuffer(),pr=new Uint8Array(fr),vr=String.fromCharCode(...pr.slice(0,4));if(vr!=="%PDF"){console.warn("Book blob does not have PDF signature:",ur.title,"signature:",vr),lr.push(ur.id);continue}}catch(cr){console.warn("Blob validation failed for book:",ur.title,cr),lr.push(ur.id);continue}}catch(cr){console.warn(`Book ${ur.title} is corrupted:`,cr),lr.push(ur.id)}if(lr.length>0){console.log(`Removing ${lr.length} corrupted books...`);for(const ur of lr)await bookService.deleteBook(ur)}console.log("Database repair completed")}catch(ar){throw console.error("Database repair failed:",ar),ar}}async forceCleanDatabase(){try{console.log("Starting force clean of database..."),db.close(),await db.delete(),localStorage.clear(),sessionStorage.clear(),"gc"in window&&window.gc(),console.log("Force cleaned database and storage"),await db.open(),console.log("Database reopened successfully")}catch(ar){throw console.error("Error force cleaning database:",ar),ar}}async emergencyDatabaseRepair(){try{console.log(" Starting emergency database repair...");const ar=await db.books.toArray();console.log(`Found ${ar.length} books to check`);let lr=0,ur=0;for(const cr of ar)try{if(!cr.pdfBlob||cr.pdfBlob.size===0){console.log(` Removing book with invalid blob: ${cr.title}`),await bookService.deleteBook(cr.id),ur++;continue}await cr.pdfBlob.slice(0,1e3).arrayBuffer();const fr=await cr.pdfBlob.slice(0,4).arrayBuffer(),pr=new Uint8Array(fr);if(!String.fromCharCode(...pr).startsWith("%PDF")){console.log(` Removing book with invalid PDF signature: ${cr.title}`),await bookService.deleteBook(cr.id),ur++;continue}console.log(` Book OK: ${cr.title}`),lr++}catch(hr){console.log(` Removing corrupted book: ${cr.title}`,hr),await bookService.deleteBook(cr.id),ur++}console.log(` Emergency repair complete: ${lr} books OK, ${ur} books removed`)}catch(ar){throw console.error("Emergency repair failed:",ar),ar}}}const databaseManager=new DatabaseManager,bookService=new BookService,characterService=new CharacterService,pdfService=new PDFService,services=Object.freeze(Object.defineProperty({__proto__:null,BookService,CharacterService,DatabaseManager,PDFService,bookService,characterService,databaseManager,pdfService},Symbol.toStringTag,{value:"Module"})),ChapterSidebar=({chapters:or,selectedChapter:ar,onChapterSelect:lr,onAddChapter:ur,onRemoveChapter:cr,onChapterTitleChange:hr})=>{const dr=vr=>vr.startPage&&vr.endPage?"complete":vr.startPage?"partial":"empty",fr=vr=>{switch(vr){case"complete":return"bg-green-100 border-green-300 text-green-800";case"partial":return"bg-yellow-100 border-yellow-300 text-yellow-800";default:return"bg-gray-100 border-gray-300 text-gray-600"}},pr=vr=>{switch(vr){case"complete":return"";case"partial":return"";default:return""}};return jsxRuntimeExports.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col h-full",children:[jsxRuntimeExports.jsxs("div",{className:"p-4 border-b border-gray-200",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Chapter Overview"}),jsxRuntimeExports.jsx("button",{onClick:ur,className:"w-full px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"+ Add Chapter"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto",children:or.length===0?jsxRuntimeExports.jsxs("div",{className:"p-4 text-center text-gray-500",children:[jsxRuntimeExports.jsx("p",{children:"No chapters added yet."}),jsxRuntimeExports.jsx("p",{className:"text-sm mt-1",children:'Click "Add Chapter" to start.'})]}):jsxRuntimeExports.jsx("div",{className:"p-2",children:or.map((vr,gr)=>{const mr=dr(vr),br=ar===gr;return jsxRuntimeExports.jsxs("div",{className:`mb-2 p-3 rounded-lg border-2 cursor-pointer transition-all ${br?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>lr(gr),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-medium ${fr(mr)}`,children:pr(mr)}),jsxRuntimeExports.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["Chapter ",gr+1]})]}),jsxRuntimeExports.jsx("button",{onClick:yr=>{yr.stopPropagation(),cr(gr)},className:"text-red-500 hover:text-red-700 text-xs p-1",title:"Remove chapter",children:""})]}),jsxRuntimeExports.jsx("input",{type:"text",value:vr.title,onChange:yr=>{yr.stopPropagation(),hr(gr,yr.target.value)},onClick:yr=>yr.stopPropagation(),placeholder:`Chapter ${gr+1} Title`,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:border-blue-500"}),jsxRuntimeExports.jsx("div",{className:"mt-2 text-xs text-gray-500",children:vr.startPage&&vr.endPage?jsxRuntimeExports.jsxs("span",{children:["Pages ",vr.startPage,"-",vr.endPage]}):vr.startPage?jsxRuntimeExports.jsxs("span",{children:["Starts: Page ",vr.startPage]}):jsxRuntimeExports.jsx("span",{children:"No pages set"})}),jsxRuntimeExports.jsx("div",{className:"mt-2",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx("div",{className:`w-2 h-2 rounded-full ${vr.startPage?"bg-green-400":"bg-gray-300"}`}),jsxRuntimeExports.jsx("div",{className:`w-2 h-2 rounded-full ${vr.endPage?"bg-green-400":"bg-gray-300"}`})]})})]},gr)})})}),jsxRuntimeExports.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:[jsxRuntimeExports.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"How to use:"}),jsxRuntimeExports.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[jsxRuntimeExports.jsx("li",{children:"1. Select a chapter from the list"}),jsxRuntimeExports.jsx("li",{children:"2. Navigate to the first page in the PDF"}),jsxRuntimeExports.jsx("li",{children:'3. Click "Set Chapter Start"'}),jsxRuntimeExports.jsx("li",{children:"4. Navigate to the last page"}),jsxRuntimeExports.jsx("li",{children:'5. Click "Set Chapter End"'})]})]})]})},PDFViewer$1=({pdfDocument:or,chapters:ar,onChapterBoundarySet:lr,selectedChapter:ur})=>{var _r,kr,Dr,Nr,Lr;const[cr,hr]=reactExports.useState(1),[dr,fr]=reactExports.useState(0),[pr,vr]=reactExports.useState(null),[gr,mr]=reactExports.useState(!1),br=reactExports.useRef(null);reactExports.useEffect(()=>{or&&fr(or.numPages)},[or]),reactExports.useEffect(()=>{or&&cr>0&&cr<=dr&&yr(cr)},[or,cr,dr]);const yr=async Or=>{if(!(!or||!br.current)){mr(!0);try{const Ir=await or.getPage(Or),Mr=Ir.getViewport({scale:1.5}),$r=br.current,jr=$r.getContext("2d");if(!jr){console.error("Failed to get 2D context from canvas");return}$r.height=Mr.height,$r.width=Mr.width;const Fr={canvasContext:jr,viewport:Mr};await Ir.render(Fr).promise;const zr=$r.toDataURL();vr(zr)}catch(Ir){console.error("Error rendering page:",Ir)}finally{mr(!1)}}},xr=()=>{cr>1&&hr(cr-1)},Cr=()=>{cr<dr&&hr(cr+1)},Sr=()=>ur===null?null:ar[ur],wr=()=>{if(ur===null)return!1;const Or=ar[ur];return!Or.startPage||Or.startPage!==cr},Er=()=>{if(ur===null)return!1;const Or=ar[ur];return Or.startPage&&(!Or.endPage||Or.endPage!==cr)},Ar=()=>{ur!==null&&wr()&&lr(ur,"start",cr)},Tr=()=>{ur!==null&&Er()&&lr(ur,"end",cr)},Rr=()=>cr.toString(),Pr=Or=>{const Ir=parseInt(Or.target.value);!isNaN(Ir)&&Ir>=1&&Ir<=dr&&hr(Ir)};return or?jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full bg-white",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-center gap-4 p-4 bg-gray-50 border-b",children:[ur!==null&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("button",{onClick:Ar,disabled:!wr(),className:`px-4 py-2 rounded-lg font-medium transition-colors ${wr()?"bg-green-600 text-white hover:bg-green-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:["Set Chapter Start (Page ",cr,")"]}),jsxRuntimeExports.jsxs("button",{onClick:Tr,disabled:!Er(),className:`px-4 py-2 rounded-lg font-medium transition-colors ${Er()?"bg-red-600 text-white hover:bg-red-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:["Set Chapter End (Page ",cr,")"]})]}),ur===null&&jsxRuntimeExports.jsx("p",{className:"text-gray-600 py-2",children:"Select a chapter from the sidebar to set boundaries"})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 flex items-center justify-center p-4 overflow-auto",children:gr?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),jsxRuntimeExports.jsxs("span",{className:"ml-3 text-gray-600",children:["Loading page ",cr,"..."]})]}):jsxRuntimeExports.jsxs("div",{className:"max-w-full max-h-full",children:[jsxRuntimeExports.jsx("canvas",{ref:br,className:"shadow-lg border border-gray-300 max-w-full max-h-full",style:{display:pr?"none":"block"}}),pr&&jsxRuntimeExports.jsx("img",{src:pr,alt:`Page ${cr}`,className:"shadow-lg border border-gray-300 max-w-full max-h-full"})]})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 border-t",children:[jsxRuntimeExports.jsx("button",{onClick:xr,disabled:cr<=1,className:"px-4 py-2 bg-blue-600 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-blue-700 transition-colors",children:" Previous"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600",children:"Page"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",max:dr,value:Rr(),onChange:Pr,className:"w-16 px-2 py-1 border border-gray-300 rounded text-center text-sm"}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-600",children:["of ",dr]})]}),jsxRuntimeExports.jsx("button",{onClick:Cr,disabled:cr>=dr,className:"px-4 py-2 bg-blue-600 text-white rounded-lg disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-blue-700 transition-colors",children:"Next "})]}),Sr()&&jsxRuntimeExports.jsxs("div",{className:"px-4 py-2 bg-blue-50 border-t text-sm",children:[jsxRuntimeExports.jsx("span",{className:"font-medium text-blue-900",children:(_r=Sr())==null?void 0:_r.title}),((kr=Sr())==null?void 0:kr.startPage)&&jsxRuntimeExports.jsxs("span",{className:"text-blue-700 ml-2",children:["Start: Page ",(Dr=Sr())==null?void 0:Dr.startPage]}),((Nr=Sr())==null?void 0:Nr.endPage)&&jsxRuntimeExports.jsxs("span",{className:"text-blue-700 ml-2",children:["End: Page ",(Lr=Sr())==null?void 0:Lr.endPage]})]})]}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full bg-gray-100",children:jsxRuntimeExports.jsx("p",{className:"text-gray-600",children:"No PDF document loaded"})})},ChapterBoundaryManager=({pdfDocument:or,initialChapters:ar=[],onChaptersUpdated:lr,onComplete:ur,onCancel:cr})=>{const[hr,dr]=reactExports.useState(ar),[fr,pr]=reactExports.useState(null);reactExports.useEffect(()=>{ar.length===0&&or&&dr([{index:0,title:"Chapter 1",isComplete:!1},{index:1,title:"Chapter 2",isComplete:!1},{index:2,title:"Chapter 3",isComplete:!1}])},[ar,or]),reactExports.useEffect(()=>{lr(hr)},[hr,lr]);const vr=()=>{const wr={index:hr.length,title:`Chapter ${hr.length+1}`,isComplete:!1};dr(Er=>[...Er,wr])},gr=wr=>{if(hr.length<=1){alert("You must have at least one chapter");return}dr(Er=>Er.filter((Tr,Rr)=>Rr!==wr).map((Tr,Rr)=>({...Tr,index:Rr}))),fr===wr?pr(null):fr!==null&&fr>wr&&pr(fr-1)},mr=(wr,Er)=>{dr(Ar=>Ar.map((Tr,Rr)=>Rr===wr?{...Tr,title:Er}:Tr))},br=wr=>{pr(wr)},yr=(wr,Er,Ar)=>{dr(Tr=>{const Rr=[...Tr];if(Er==="start")Rr[wr]={...Rr[wr],startPage:Ar};else if(Er==="end"&&(Rr[wr]={...Rr[wr],endPage:Ar},wr<Rr.length-1)){const Pr=wr+1;Rr[Pr]={...Rr[Pr],startPage:Ar+1}}return Rr[wr]={...Rr[wr],isComplete:!!(Rr[wr].startPage&&Rr[wr].endPage)},Rr})},xr=()=>{const wr=hr.filter(Er=>!Er.startPage);if(wr.length>0){const Er=wr.map(Ar=>Ar.title).join(", ");alert(`Please set start pages for: ${Er}`);return}ur(hr)},Sr=(()=>{const wr=hr.filter(Ar=>Ar.isComplete).length,Er=hr.filter(Ar=>Ar.startPage).length;return{complete:wr,withStart:Er,total:hr.length}})();return jsxRuntimeExports.jsxs("div",{className:"flex h-full w-full bg-gray-100",children:[jsxRuntimeExports.jsx(ChapterSidebar,{chapters:hr,selectedChapter:fr,onChapterSelect:br,onAddChapter:vr,onRemoveChapter:gr,onChapterTitleChange:mr}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-gray-200 p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Chapter Boundary Editor"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Define where each chapter starts and ends in your PDF"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-sm text-gray-600",children:[jsxRuntimeExports.jsx("span",{className:"font-medium",children:Sr.complete})," complete,",jsxRuntimeExports.jsx("span",{className:"font-medium ml-1",children:Sr.withStart})," with start pages",jsxRuntimeExports.jsxs("span",{className:"ml-1",children:["of ",Sr.total," chapters"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:cr,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:xr,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Continue to Analysis"})]})]})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1",children:jsxRuntimeExports.jsx(PDFViewer$1,{pdfDocument:or,chapters:hr,selectedChapter:fr,onChapterBoundarySet:yr})})]})]})};function ChapterBoundaryEditor({file:or,detectedChapters:ar,onChaptersUpdated:lr,onClose:ur}){const[cr,hr]=reactExports.useState(null),[dr,fr]=reactExports.useState([]);console.log("ChapterBoundaryEditor rendered, pdfDocument:",!!cr,"file:",or.name),reactExports.useEffect(()=>{console.log("ChapterBoundaryEditor useEffect triggered"),pr(),vr()},[or,ar]);const pr=async()=>{try{if(console.log("Loading PDF document...",or.name,"Type:",or.type,"Size:",or.size),pdfExports.GlobalWorkerOptions.workerSrc||(pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`),!or||or.size===0)throw new Error("PDF file is empty or corrupted");const br=await or.arrayBuffer();if(console.log("PDF ArrayBuffer loaded, size:",br.byteLength),br.byteLength===0)throw new Error("PDF file contains no data");const yr=await pdfExports.getDocument({data:br,verbosity:0}).promise;console.log("PDF Document loaded, pages:",yr.numPages),hr(yr)}catch(br){console.error("Error loading PDF:",br);const yr=br instanceof Error?br.message:String(br);let xr="Failed to load PDF: "+yr;yr.includes("Invalid PDF structure")||yr.includes("object can not be found")?xr="The PDF file appears to be corrupted or invalid. Please try uploading the file again.":yr.includes("empty")||yr.includes("no data")?xr="The PDF file appears to be empty or corrupted. Please check the file and try again.":(yr.includes("network")||yr.includes("fetch"))&&(xr="Network error loading PDF. Please check your connection and try again."),alert(xr),ur()}},vr=()=>{const br=ar.map((yr,xr)=>({index:xr,title:`Chapter ${yr.chapter}`,startPage:yr.startPage,endPage:yr.endPage,isComplete:!!(yr.startPage&&yr.endPage)}));br.length===0&&br.push({index:0,title:"Chapter 1",isComplete:!1},{index:1,title:"Chapter 2",isComplete:!1},{index:2,title:"Chapter 3",isComplete:!1}),fr(br)},gr=br=>{const yr=br.filter(xr=>xr.startPage&&xr.endPage).map((xr,Cr)=>({chapter:Cr+1,startPage:xr.startPage,endPage:xr.endPage}));lr(yr)},mr=br=>{gr(br),ur()};return cr?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50",onClick:br=>{br.target===br.currentTarget&&ur()},children:jsxRuntimeExports.jsx("div",{className:"h-full w-full",onClick:br=>br.stopPropagation(),children:jsxRuntimeExports.jsx(ChapterBoundaryManager,{pdfDocument:cr,initialChapters:dr,onChaptersUpdated:gr,onComplete:mr,onCancel:ur})})}):jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center mb-4",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),jsxRuntimeExports.jsx("span",{className:"ml-3 text-gray-700",children:"Loading PDF..."})]}),jsxRuntimeExports.jsxs("div",{className:"text-center text-sm text-gray-500",children:[jsxRuntimeExports.jsx("p",{children:"Preparing chapter editor..."}),jsxRuntimeExports.jsxs("p",{className:"mt-2",children:["File: ",or.name]})]}),jsxRuntimeExports.jsx("button",{onClick:ur,className:"mt-4 w-full px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",children:"Cancel"})]})})}function BookUpload({onBookAdded:or,onCancel:ar,setIsUploading:lr}){const[ur,cr]=reactExports.useState(null),[hr,dr]=reactExports.useState(""),[fr,pr]=reactExports.useState(""),[vr,gr]=reactExports.useState(!1),[mr,br]=reactExports.useState(""),[yr,xr]=reactExports.useState([]),[Cr,Sr]=reactExports.useState(!1),[wr,Er]=reactExports.useState(10),[Ar,Tr]=reactExports.useState(!1),[Rr,Pr]=reactExports.useState(0),_r=Ir=>{var $r;const Mr=($r=Ir.target.files)==null?void 0:$r[0];if(Mr&&Mr.type==="application/pdf"){cr(Mr);const jr=Mr.name.replace(".pdf","");hr||dr(jr)}else alert("Please select a valid PDF file")},kr=async()=>{if(!ur||!hr.trim()||!fr.trim()){alert("Please fill in all fields and select a PDF file");return}gr(!0),lr(!0);try{br("Analyzing PDF structure...");const{chapterBoundaries:Ir,totalPages:Mr}=await pdfService.processBookFile(ur);Pr(Mr),Ir.length>0?(xr(Ir),br(`Detected ${Ir.length} chapters - Review boundaries`),Tr(!0),gr(!1)):(br("Could not detect chapters automatically"),Sr(!0),Er(Math.max(1,Math.floor(Mr/20))),gr(!1))}catch(Ir){console.error("Error processing file:",Ir),alert("Failed to process PDF file. Please try again."),gr(!1),lr(!1)}},Dr=(Ir,Mr)=>{const $r=Math.floor(Mr/Ir),jr=[];for(let Fr=0;Fr<Ir;Fr++){const zr=Fr*$r+1,Hr=Fr===Ir-1?Mr:(Fr+1)*$r;jr.push({chapter:Fr+1,startPage:zr,endPage:Hr})}return jr},Nr=async()=>{if(ur){gr(!0);try{const Ir=Dr(wr,Rr);await Or(Ir)}catch(Ir){console.error("Error creating manual chapters:",Ir),alert("Failed to create book. Please try again."),gr(!1)}}},Lr=async Ir=>{xr(Ir),await Or(Ir)},Or=async Ir=>{if(ur)try{br("Saving book to library...");const Mr=await bookService.createBook(ur,hr.trim(),fr.trim(),Ir);br("Book added successfully!"),or(Mr)}catch(Mr){console.error("Error creating book:",Mr);const $r=Mr instanceof Error?Mr.message:"Unknown error";$r.includes("already exists")?alert(`A book with the filename "${ur.name}" already exists in your library. Please rename the file or delete the existing book first.`):$r.includes("ConstraintError")||$r.includes("AbortError")?alert("Database constraint error occurred. This might be due to duplicate data. Please refresh the page and try again. If the problem persists, the database may need to be reset."):alert("Failed to save book: "+$r)}finally{gr(!1),lr(!1),pdfService.cleanup()}};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Upload New Book"}),jsxRuntimeExports.jsx("button",{onClick:ar,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:vr,children:jsxRuntimeExports.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Cr?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:[jsxRuntimeExports.jsx("p",{className:"text-yellow-800 font-medium",children:"Manual Chapter Setup"}),jsxRuntimeExports.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Automatic chapter detection failed or found unusual results. Please specify the number of chapters manually."})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Chapters"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",max:"100",value:wr,onChange:Ir=>Er(parseInt(Ir.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:vr}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Pages will be divided equally among chapters"})]}),vr&&jsxRuntimeExports.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-600 border-t-transparent rounded-full mr-3"}),jsxRuntimeExports.jsx("span",{className:"text-blue-800",children:mr})]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-4",children:[jsxRuntimeExports.jsx("button",{onClick:Nr,disabled:vr,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white py-2 px-4 rounded-md transition-colors font-medium",children:vr?"Creating...":"Create Book"}),jsxRuntimeExports.jsx("button",{onClick:()=>Sr(!1),disabled:vr,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors font-medium disabled:opacity-50",children:"Back"})]})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PDF File"}),jsxRuntimeExports.jsx("input",{type:"file",accept:".pdf",onChange:_r,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:vr})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Book Title"}),jsxRuntimeExports.jsx("input",{type:"text",value:hr,onChange:Ir=>dr(Ir.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter book title",disabled:vr})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Author"}),jsxRuntimeExports.jsx("input",{type:"text",value:fr,onChange:Ir=>pr(Ir.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter author name",disabled:vr})]}),vr&&jsxRuntimeExports.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-blue-600 border-t-transparent rounded-full mr-3"}),jsxRuntimeExports.jsx("span",{className:"text-blue-800",children:mr})]})}),yr.length>0&&!vr&&jsxRuntimeExports.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:"text-green-800 font-medium",children:[" Detected ",yr.length," chapters"]}),jsxRuntimeExports.jsx("p",{className:"text-green-600 text-sm mt-1",children:"Review and adjust chapter boundaries to ensure accuracy"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>Tr(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm",children:"Review Chapters"})]})}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 pt-4",children:[jsxRuntimeExports.jsx("button",{onClick:kr,disabled:!ur||!hr.trim()||!fr.trim()||vr,className:"flex-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white py-2 px-4 rounded-md transition-colors font-medium",children:vr?"Processing...":"Upload Book"}),jsxRuntimeExports.jsx("button",{onClick:ar,disabled:vr,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors font-medium disabled:opacity-50",children:"Cancel"})]})]})]}),Ar&&ur&&jsxRuntimeExports.jsx(ChapterBoundaryEditor,{file:ur,detectedChapters:yr,totalPages:Rr,onChaptersUpdated:Lr,onClose:()=>Tr(!1)})]})}function AdminMenu({onResetDatabase:or,onForceCleanDatabase:ar}){const[lr,ur]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("div",{className:"admin-menu",children:[jsxRuntimeExports.jsx("button",{className:"admin-menu-toggle",onClick:()=>ur(!lr),title:lr?"Hide admin menu":"Show admin menu",children:jsxRuntimeExports.jsxs("svg",{className:"w-5 h-5 text-gray-600 transition-transform",style:{transform:lr?"rotate(45deg)":"rotate(0deg)"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]})}),lr&&jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{ar(),ur(!1)},className:"admin-menu-button warning",title:"Force clean database and cache (for persistent issues)",children:"Force Clean"}),jsxRuntimeExports.jsx("button",{onClick:()=>{or(),ur(!1)},className:"admin-menu-button danger",title:"Reset database (delete all data)",children:"Reset Database"})]})]})}async function searchBookISBN(or,ar){try{const lr=`title:"${or}" author:"${ar}"`,ur=`https://openlibrary.org/search.json?q=${encodeURIComponent(lr)}&limit=5`,cr=await fetch(ur);if(!cr.ok)return null;const hr=await cr.json();if(hr.docs&&hr.docs.length>0){for(const dr of hr.docs)if(dr.isbn&&dr.isbn.length>0)return dr.isbn[0]}return null}catch(lr){return console.warn("Error searching for book ISBN:",lr),null}}async function getBookCover(or,ar){var ur;const lr={coverUrl:null,title:or,author:ar};try{const cr=await searchBookISBN(or,ar);if(cr){lr.isbn=cr;const fr=`https://covers.openlibrary.org/b/isbn/${cr}-L.jpg`,pr=await fetch(fr,{method:"HEAD"});if(pr.ok&&((ur=pr.headers.get("content-type"))!=null&&ur.includes("image")))return lr.coverUrl=fr,lr}const hr=`https://openlibrary.org/search.json?title=${encodeURIComponent(or)}&author=${encodeURIComponent(ar)}&limit=1`,dr=await fetch(hr);if(dr.ok){const fr=await dr.json();if(fr.docs&&fr.docs.length>0){const pr=fr.docs[0];if(pr.cover_i){const vr=`https://covers.openlibrary.org/b/id/${pr.cover_i}-L.jpg`;return lr.coverUrl=vr,lr}if(pr.key){const gr=`https://covers.openlibrary.org/w/olid/${pr.key.replace("/works/","")}-L.jpg`;return lr.coverUrl=gr,lr}}}return lr}catch(cr){return console.warn("Error fetching book cover:",cr),lr}}class BookCoverCache{constructor(){Zs(this,"cache",new Map)}getCacheKey(ar,lr){return`${ar.toLowerCase().trim()}_${lr.toLowerCase().trim()}`}async getCover(ar,lr){const ur=this.getCacheKey(ar,lr);if(this.cache.has(ur))return this.cache.get(ur);const cr=await getBookCover(ar,lr);return this.cache.set(ur,cr),cr}clearCache(){this.cache.clear()}}const bookCoverCache=new BookCoverCache;function BookCover({title:or,author:ar,className:lr=""}){const[ur,cr]=reactExports.useState(null),[hr,dr]=reactExports.useState(!0),[fr,pr]=reactExports.useState(!1);reactExports.useEffect(()=>{let gr=!0;return(async()=>{try{dr(!0),pr(!1);const br=await bookCoverCache.getCover(or,ar);if(gr)if(br.coverUrl){const yr=new Image;yr.onload=()=>{gr&&(cr(br.coverUrl),dr(!1))},yr.onerror=()=>{gr&&(pr(!0),dr(!1))},yr.src=br.coverUrl}else pr(!0),dr(!1)}catch{gr&&(pr(!0),dr(!1))}})(),()=>{gr=!1}},[or,ar]);const vr=()=>{const gr=or.split(" ");return gr.length===1?gr[0].charAt(0).toUpperCase():gr.slice(0,2).map(mr=>mr.charAt(0).toUpperCase()).join("")};return hr?jsxRuntimeExports.jsx("div",{className:`book-cover-placeholder ${lr}`,children:jsxRuntimeExports.jsx("div",{className:"animate-pulse",children:jsxRuntimeExports.jsx("div",{className:"w-6 h-6 bg-white bg-opacity-30 rounded"})})}):fr||!ur?jsxRuntimeExports.jsx("div",{className:`book-cover-placeholder ${lr}`,children:vr()}):jsxRuntimeExports.jsx("img",{src:ur,alt:`Cover of ${or}`,className:`book-cover ${lr}`,loading:"lazy",onError:()=>pr(!0)})}function BookLibrary({books:or,onBookSelect:ar,onBookAdded:lr,onBooksUpdated:ur}){const[cr,hr]=reactExports.useState(!1),[dr,fr]=reactExports.useState(!1),pr=async br=>{if(confirm("Are you sure you want to delete this book? This will also delete all character data."))try{await bookService.deleteBook(br),ur()}catch(yr){console.error("Error deleting book:",yr),alert("Failed to delete book. Please try again.")}},vr=async()=>{if(confirm("Are you SURE you want to reset the entire database? This will permanently delete ALL books and character data. This action cannot be undone!")&&confirm("Last warning: This will delete everything! Are you absolutely sure?"))try{await databaseManager.resetDatabase(),ur(),alert("Database reset successfully. You can now upload new books.")}catch(xr){console.error("Error resetting database:",xr),alert("Failed to reset database. Please clear your browser data manually.")}},gr=async()=>{if(confirm("FORCE CLEAN database? This is more aggressive than reset and will clear all browser storage. Use this if you are having persistent duplicate/caching issues."))try{await databaseManager.forceCleanDatabase(),ur(),alert("Database force cleaned successfully. Page will reload."),window.location.reload()}catch(yr){console.error("Error force cleaning database:",yr),alert("Failed to force clean database. Please manually clear browser data.")}},mr=br=>new Date(br).toLocaleDateString();return jsxRuntimeExports.jsxs("div",{className:"min-h-screen",style:{backgroundColor:"var(--apple-gray-50)"},children:[jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-12",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-bold mb-3",style:{color:"var(--apple-gray-900)"},children:"Book Character Tracker"}),jsxRuntimeExports.jsx("p",{className:"text-lg",style:{color:"var(--apple-gray-600)"},children:"Track characters chapter-by-chapter without spoilers"})]}),dr&&jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm",onClick:()=>fr(!1)}),jsxRuntimeExports.jsx("div",{className:"relative apple-card p-6 max-w-2xl w-full max-h-[80vh] overflow-auto",children:jsxRuntimeExports.jsx(BookUpload,{onBookAdded:br=>{lr(br),fr(!1)},onCancel:()=>fr(!1),setIsUploading:hr})})]}),or.length===0&&!dr?jsxRuntimeExports.jsxs("div",{className:"text-center py-20",children:[jsxRuntimeExports.jsx("div",{className:"mb-8",children:jsxRuntimeExports.jsx("div",{className:"w-32 h-32 mx-auto mb-6 rounded-full flex items-center justify-center",style:{backgroundColor:"var(--apple-gray-200)"},children:jsxRuntimeExports.jsx("svg",{className:"w-16 h-16",style:{color:"var(--apple-gray-500)"},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})})}),jsxRuntimeExports.jsx("h3",{className:"text-2xl font-semibold mb-3",style:{color:"var(--apple-gray-900)"},children:"Welcome to Your Library"}),jsxRuntimeExports.jsx("p",{className:"text-lg mb-8",style:{color:"var(--apple-gray-600)"},children:"Upload your first book to start tracking characters"}),jsxRuntimeExports.jsx("button",{onClick:()=>fr(!0),className:"apple-button-primary px-8 py-4 text-lg font-semibold",disabled:cr,children:cr?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):"Upload Your First Book"})]}):jsxRuntimeExports.jsx("div",{className:"relative",children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[or.map(br=>jsxRuntimeExports.jsxs("div",{className:"apple-card p-6 cursor-pointer group",onClick:()=>ar(br),children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[jsxRuntimeExports.jsx(BookCover,{title:br.title,author:br.author}),jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold mb-1 truncate",style:{color:"var(--apple-gray-900)"},children:br.title}),jsxRuntimeExports.jsxs("p",{className:"text-sm truncate",style:{color:"var(--apple-gray-600)"},children:["by ",br.author]}),jsxRuntimeExports.jsx("div",{className:"mt-3 flex items-center justify-between text-xs",style:{color:"var(--apple-gray-500)"},children:jsxRuntimeExports.jsxs("span",{children:["Chapter ",br.currentChapter," of ",br.totalChapters]})})]}),jsxRuntimeExports.jsx("button",{onClick:yr=>{yr.stopPropagation(),pr(br.id)},className:"opacity-0 group-hover:opacity-100 p-2 rounded-full hover:bg-gray-100 transition-all duration-200",style:{color:"var(--apple-gray-400)"},title:"Delete book",children:jsxRuntimeExports.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]}),jsxRuntimeExports.jsx("div",{className:"mb-4",children:jsxRuntimeExports.jsx("div",{className:"w-full h-2 rounded-full",style:{backgroundColor:"var(--apple-gray-200)"},children:jsxRuntimeExports.jsx("div",{className:"h-2 rounded-full transition-all duration-500",style:{width:`${br.currentChapter/br.totalChapters*100}%`,background:"linear-gradient(90deg, var(--apple-blue) 0%, var(--apple-teal) 100%)"}})})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between text-xs",style:{color:"var(--apple-gray-500)"},children:[jsxRuntimeExports.jsx("span",{children:mr(br.uploadDate)}),jsxRuntimeExports.jsxs("span",{className:"font-medium",style:{color:"var(--apple-blue)"},children:[Math.round(br.currentChapter/br.totalChapters*100),"% complete"]})]})]},br.id)),jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center min-h-[200px]",children:jsxRuntimeExports.jsx("button",{onClick:()=>fr(!0),className:"apple-plus-button",disabled:cr,title:"Add new book",children:cr?jsxRuntimeExports.jsx("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"}):jsxRuntimeExports.jsx("svg",{className:"apple-plus-icon",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})})]})}),or.length>0&&jsxRuntimeExports.jsx("div",{className:"text-center mt-12",children:jsxRuntimeExports.jsxs("p",{className:"text-sm font-medium",style:{color:"var(--apple-gray-500)"},children:[or.length," ",or.length===1?"book":"books"," in your library"]})})]}),jsxRuntimeExports.jsx(AdminMenu,{onResetDatabase:vr,onForceCleanDatabase:gr})]})}function _arrayLikeToArray(or,ar){(ar==null||ar>or.length)&&(ar=or.length);for(var lr=0,ur=Array(ar);lr<ar;lr++)ur[lr]=or[lr];return ur}function _arrayWithHoles(or){if(Array.isArray(or))return or}function _arrayWithoutHoles(or){if(Array.isArray(or))return _arrayLikeToArray(or)}function _classCallCheck(or,ar){if(!(or instanceof ar))throw new TypeError("Cannot call a class as a function")}function _defineProperties(or,ar){for(var lr=0;lr<ar.length;lr++){var ur=ar[lr];ur.enumerable=ur.enumerable||!1,ur.configurable=!0,"value"in ur&&(ur.writable=!0),Object.defineProperty(or,_toPropertyKey(ur.key),ur)}}function _createClass(or,ar,lr){return ar&&_defineProperties(or.prototype,ar),Object.defineProperty(or,"prototype",{writable:!1}),or}function _createForOfIteratorHelper(or,ar){var lr=typeof Symbol<"u"&&or[Symbol.iterator]||or["@@iterator"];if(!lr){if(Array.isArray(or)||(lr=_unsupportedIterableToArray(or))||ar){lr&&(or=lr);var ur=0,cr=function(){};return{s:cr,n:function(){return ur>=or.length?{done:!0}:{done:!1,value:or[ur++]}},e:function(pr){throw pr},f:cr}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hr,dr=!0,fr=!1;return{s:function(){lr=lr.call(or)},n:function(){var pr=lr.next();return dr=pr.done,pr},e:function(pr){fr=!0,hr=pr},f:function(){try{dr||lr.return==null||lr.return()}finally{if(fr)throw hr}}}}function _defineProperty$1(or,ar,lr){return(ar=_toPropertyKey(ar))in or?Object.defineProperty(or,ar,{value:lr,enumerable:!0,configurable:!0,writable:!0}):or[ar]=lr,or}function _iterableToArray(or){if(typeof Symbol<"u"&&or[Symbol.iterator]!=null||or["@@iterator"]!=null)return Array.from(or)}function _iterableToArrayLimit(or,ar){var lr=or==null?null:typeof Symbol<"u"&&or[Symbol.iterator]||or["@@iterator"];if(lr!=null){var ur,cr,hr,dr,fr=[],pr=!0,vr=!1;try{if(hr=(lr=lr.call(or)).next,ar===0){if(Object(lr)!==lr)return;pr=!1}else for(;!(pr=(ur=hr.call(lr)).done)&&(fr.push(ur.value),fr.length!==ar);pr=!0);}catch(gr){vr=!0,cr=gr}finally{try{if(!pr&&lr.return!=null&&(dr=lr.return(),Object(dr)!==dr))return}finally{if(vr)throw cr}}return fr}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(or,ar){return _arrayWithHoles(or)||_iterableToArrayLimit(or,ar)||_unsupportedIterableToArray(or,ar)||_nonIterableRest()}function _toConsumableArray(or){return _arrayWithoutHoles(or)||_iterableToArray(or)||_unsupportedIterableToArray(or)||_nonIterableSpread()}function _toPrimitive(or,ar){if(typeof or!="object"||!or)return or;var lr=or[Symbol.toPrimitive];if(lr!==void 0){var ur=lr.call(or,ar);if(typeof ur!="object")return ur;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(or)}function _toPropertyKey(or){var ar=_toPrimitive(or,"string");return typeof ar=="symbol"?ar:ar+""}function _typeof(or){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ar){return typeof ar}:function(ar){return ar&&typeof Symbol=="function"&&ar.constructor===Symbol&&ar!==Symbol.prototype?"symbol":typeof ar},_typeof(or)}function _unsupportedIterableToArray(or,ar){if(or){if(typeof or=="string")return _arrayLikeToArray(or,ar);var lr={}.toString.call(or).slice(8,-1);return lr==="Object"&&or.constructor&&(lr=or.constructor.name),lr==="Map"||lr==="Set"?Array.from(or):lr==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(lr)?_arrayLikeToArray(or,ar):void 0}}var _window=typeof window>"u"?null:window,navigator$1=_window?_window.navigator:null;_window&&_window.document;var typeofstr=_typeof(""),typeofobj=_typeof({}),typeoffn=_typeof(function(){}),typeofhtmlele=typeof HTMLElement>"u"?"undefined":_typeof(HTMLElement),instanceStr=function or(ar){return ar&&ar.instanceString&&fn$6(ar.instanceString)?ar.instanceString():null},string=function or(ar){return ar!=null&&_typeof(ar)==typeofstr},fn$6=function or(ar){return ar!=null&&_typeof(ar)===typeoffn},array=function or(ar){return!elementOrCollection(ar)&&(Array.isArray?Array.isArray(ar):ar!=null&&ar instanceof Array)},plainObject=function or(ar){return ar!=null&&_typeof(ar)===typeofobj&&!array(ar)&&ar.constructor===Object},object=function or(ar){return ar!=null&&_typeof(ar)===typeofobj},number$1=function or(ar){return ar!=null&&_typeof(ar)===_typeof(1)&&!isNaN(ar)},integer=function or(ar){return number$1(ar)&&Math.floor(ar)===ar},htmlElement=function or(ar){if(typeofhtmlele!=="undefined")return ar!=null&&ar instanceof HTMLElement},elementOrCollection=function or(ar){return element(ar)||collection(ar)},element=function or(ar){return instanceStr(ar)==="collection"&&ar._private.single},collection=function or(ar){return instanceStr(ar)==="collection"&&!ar._private.single},core=function or(ar){return instanceStr(ar)==="core"},stylesheet=function or(ar){return instanceStr(ar)==="stylesheet"},event=function or(ar){return instanceStr(ar)==="event"},emptyString=function or(ar){return ar==null?!0:!!(ar===""||ar.match(/^\s+$/))},domElement=function or(ar){return typeof HTMLElement>"u"?!1:ar instanceof HTMLElement},boundingBox=function or(ar){return plainObject(ar)&&number$1(ar.x1)&&number$1(ar.x2)&&number$1(ar.y1)&&number$1(ar.y2)},promise=function or(ar){return object(ar)&&fn$6(ar.then)},ms=function or(){return navigator$1&&navigator$1.userAgent.match(/msie|trident|edge/i)},memoize=function or(ar,lr){lr||(lr=function(){if(arguments.length===1)return arguments[0];if(arguments.length===0)return"undefined";for(var hr=[],dr=0;dr<arguments.length;dr++)hr.push(arguments[dr]);return hr.join("$")});var ur=function(){var hr=this,dr=arguments,fr,pr=lr.apply(hr,dr),vr=ur.cache;return(fr=vr[pr])||(fr=vr[pr]=ar.apply(hr,dr)),fr};return ur.cache={},ur},camel2dash=memoize(function(or){return or.replace(/([A-Z])/g,function(ar){return"-"+ar.toLowerCase()})}),dash2camel=memoize(function(or){return or.replace(/(-\w)/g,function(ar){return ar[1].toUpperCase()})}),prependCamel=memoize(function(or,ar){return or+ar[0].toUpperCase()+ar.substring(1)},function(or,ar){return or+"$"+ar}),capitalize=function or(ar){return emptyString(ar)?ar:ar.charAt(0).toUpperCase()+ar.substring(1)},endsWith=function or(ar,lr){return ar.slice(-1*lr.length)===lr},number="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",rgba="rgb[a]?\\(("+number+"[%]?)\\s*,\\s*("+number+"[%]?)\\s*,\\s*("+number+"[%]?)(?:\\s*,\\s*("+number+"))?\\)",rgbaNoBackRefs="rgb[a]?\\((?:"+number+"[%]?)\\s*,\\s*(?:"+number+"[%]?)\\s*,\\s*(?:"+number+"[%]?)(?:\\s*,\\s*(?:"+number+"))?\\)",hsla="hsl[a]?\\(("+number+")\\s*,\\s*("+number+"[%])\\s*,\\s*("+number+"[%])(?:\\s*,\\s*("+number+"))?\\)",hslaNoBackRefs="hsl[a]?\\((?:"+number+")\\s*,\\s*(?:"+number+"[%])\\s*,\\s*(?:"+number+"[%])(?:\\s*,\\s*(?:"+number+"))?\\)",hex3="\\#[0-9a-fA-F]{3}",hex6="\\#[0-9a-fA-F]{6}",ascending=function or(ar,lr){return ar<lr?-1:ar>lr?1:0},descending=function or(ar,lr){return-1*ascending(ar,lr)},extend=Object.assign!=null?Object.assign.bind(Object):function(or){for(var ar=arguments,lr=1;lr<ar.length;lr++){var ur=ar[lr];if(ur!=null)for(var cr=Object.keys(ur),hr=0;hr<cr.length;hr++){var dr=cr[hr];or[dr]=ur[dr]}}return or},hex2tuple=function or(ar){if(!(!(ar.length===4||ar.length===7)||ar[0]!=="#")){var lr=ar.length===4,ur,cr,hr,dr=16;return lr?(ur=parseInt(ar[1]+ar[1],dr),cr=parseInt(ar[2]+ar[2],dr),hr=parseInt(ar[3]+ar[3],dr)):(ur=parseInt(ar[1]+ar[2],dr),cr=parseInt(ar[3]+ar[4],dr),hr=parseInt(ar[5]+ar[6],dr)),[ur,cr,hr]}},hsl2tuple=function or(ar){var lr,ur,cr,hr,dr,fr,pr,vr;function gr(xr,Cr,Sr){return Sr<0&&(Sr+=1),Sr>1&&(Sr-=1),Sr<1/6?xr+(Cr-xr)*6*Sr:Sr<1/2?Cr:Sr<2/3?xr+(Cr-xr)*(2/3-Sr)*6:xr}var mr=new RegExp("^"+hsla+"$").exec(ar);if(mr){if(ur=parseInt(mr[1]),ur<0?ur=(360- -1*ur%360)%360:ur>360&&(ur=ur%360),ur/=360,cr=parseFloat(mr[2]),cr<0||cr>100||(cr=cr/100,hr=parseFloat(mr[3]),hr<0||hr>100)||(hr=hr/100,dr=mr[4],dr!==void 0&&(dr=parseFloat(dr),dr<0||dr>1)))return;if(cr===0)fr=pr=vr=Math.round(hr*255);else{var br=hr<.5?hr*(1+cr):hr+cr-hr*cr,yr=2*hr-br;fr=Math.round(255*gr(yr,br,ur+1/3)),pr=Math.round(255*gr(yr,br,ur)),vr=Math.round(255*gr(yr,br,ur-1/3))}lr=[fr,pr,vr,dr]}return lr},rgb2tuple=function or(ar){var lr,ur=new RegExp("^"+rgba+"$").exec(ar);if(ur){lr=[];for(var cr=[],hr=1;hr<=3;hr++){var dr=ur[hr];if(dr[dr.length-1]==="%"&&(cr[hr]=!0),dr=parseFloat(dr),cr[hr]&&(dr=dr/100*255),dr<0||dr>255)return;lr.push(Math.floor(dr))}var fr=cr[1]||cr[2]||cr[3],pr=cr[1]&&cr[2]&&cr[3];if(fr&&!pr)return;var vr=ur[4];if(vr!==void 0){if(vr=parseFloat(vr),vr<0||vr>1)return;lr.push(vr)}}return lr},colorname2tuple=function or(ar){return colors[ar.toLowerCase()]},color2tuple=function or(ar){return(array(ar)?ar:null)||colorname2tuple(ar)||hex2tuple(ar)||rgb2tuple(ar)||hsl2tuple(ar)},colors={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},setMap=function or(ar){for(var lr=ar.map,ur=ar.keys,cr=ur.length,hr=0;hr<cr;hr++){var dr=ur[hr];if(plainObject(dr))throw Error("Tried to set map with object key");hr<ur.length-1?(lr[dr]==null&&(lr[dr]={}),lr=lr[dr]):lr[dr]=ar.value}},getMap=function or(ar){for(var lr=ar.map,ur=ar.keys,cr=ur.length,hr=0;hr<cr;hr++){var dr=ur[hr];if(plainObject(dr))throw Error("Tried to get map with object key");if(lr=lr[dr],lr==null)return lr}return lr},commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(or){return or&&or.__esModule&&Object.prototype.hasOwnProperty.call(or,"default")?or.default:or}var isObject_1,hasRequiredIsObject;function requireIsObject(){if(hasRequiredIsObject)return isObject_1;hasRequiredIsObject=1;function or(ar){var lr=typeof ar;return ar!=null&&(lr=="object"||lr=="function")}return isObject_1=or,isObject_1}var _freeGlobal,hasRequired_freeGlobal;function require_freeGlobal(){if(hasRequired_freeGlobal)return _freeGlobal;hasRequired_freeGlobal=1;var or=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal;return _freeGlobal=or,_freeGlobal}var _root,hasRequired_root;function require_root(){if(hasRequired_root)return _root;hasRequired_root=1;var or=require_freeGlobal(),ar=typeof self=="object"&&self&&self.Object===Object&&self,lr=or||ar||Function("return this")();return _root=lr,_root}var now_1,hasRequiredNow;function requireNow(){if(hasRequiredNow)return now_1;hasRequiredNow=1;var or=require_root(),ar=function(){return or.Date.now()};return now_1=ar,now_1}var _trimmedEndIndex,hasRequired_trimmedEndIndex;function require_trimmedEndIndex(){if(hasRequired_trimmedEndIndex)return _trimmedEndIndex;hasRequired_trimmedEndIndex=1;var or=/\s/;function ar(lr){for(var ur=lr.length;ur--&&or.test(lr.charAt(ur)););return ur}return _trimmedEndIndex=ar,_trimmedEndIndex}var _baseTrim,hasRequired_baseTrim;function require_baseTrim(){if(hasRequired_baseTrim)return _baseTrim;hasRequired_baseTrim=1;var or=require_trimmedEndIndex(),ar=/^\s+/;function lr(ur){return ur&&ur.slice(0,or(ur)+1).replace(ar,"")}return _baseTrim=lr,_baseTrim}var _Symbol,hasRequired_Symbol;function require_Symbol(){if(hasRequired_Symbol)return _Symbol;hasRequired_Symbol=1;var or=require_root(),ar=or.Symbol;return _Symbol=ar,_Symbol}var _getRawTag,hasRequired_getRawTag;function require_getRawTag(){if(hasRequired_getRawTag)return _getRawTag;hasRequired_getRawTag=1;var or=require_Symbol(),ar=Object.prototype,lr=ar.hasOwnProperty,ur=ar.toString,cr=or?or.toStringTag:void 0;function hr(dr){var fr=lr.call(dr,cr),pr=dr[cr];try{dr[cr]=void 0;var vr=!0}catch{}var gr=ur.call(dr);return vr&&(fr?dr[cr]=pr:delete dr[cr]),gr}return _getRawTag=hr,_getRawTag}var _objectToString,hasRequired_objectToString;function require_objectToString(){if(hasRequired_objectToString)return _objectToString;hasRequired_objectToString=1;var or=Object.prototype,ar=or.toString;function lr(ur){return ar.call(ur)}return _objectToString=lr,_objectToString}var _baseGetTag,hasRequired_baseGetTag;function require_baseGetTag(){if(hasRequired_baseGetTag)return _baseGetTag;hasRequired_baseGetTag=1;var or=require_Symbol(),ar=require_getRawTag(),lr=require_objectToString(),ur="[object Null]",cr="[object Undefined]",hr=or?or.toStringTag:void 0;function dr(fr){return fr==null?fr===void 0?cr:ur:hr&&hr in Object(fr)?ar(fr):lr(fr)}return _baseGetTag=dr,_baseGetTag}var isObjectLike_1,hasRequiredIsObjectLike;function requireIsObjectLike(){if(hasRequiredIsObjectLike)return isObjectLike_1;hasRequiredIsObjectLike=1;function or(ar){return ar!=null&&typeof ar=="object"}return isObjectLike_1=or,isObjectLike_1}var isSymbol_1,hasRequiredIsSymbol;function requireIsSymbol(){if(hasRequiredIsSymbol)return isSymbol_1;hasRequiredIsSymbol=1;var or=require_baseGetTag(),ar=requireIsObjectLike(),lr="[object Symbol]";function ur(cr){return typeof cr=="symbol"||ar(cr)&&or(cr)==lr}return isSymbol_1=ur,isSymbol_1}var toNumber_1,hasRequiredToNumber;function requireToNumber(){if(hasRequiredToNumber)return toNumber_1;hasRequiredToNumber=1;var or=require_baseTrim(),ar=requireIsObject(),lr=requireIsSymbol(),ur=NaN,cr=/^[-+]0x[0-9a-f]+$/i,hr=/^0b[01]+$/i,dr=/^0o[0-7]+$/i,fr=parseInt;function pr(vr){if(typeof vr=="number")return vr;if(lr(vr))return ur;if(ar(vr)){var gr=typeof vr.valueOf=="function"?vr.valueOf():vr;vr=ar(gr)?gr+"":gr}if(typeof vr!="string")return vr===0?vr:+vr;vr=or(vr);var mr=hr.test(vr);return mr||dr.test(vr)?fr(vr.slice(2),mr?2:8):cr.test(vr)?ur:+vr}return toNumber_1=pr,toNumber_1}var debounce_1,hasRequiredDebounce;function requireDebounce(){if(hasRequiredDebounce)return debounce_1;hasRequiredDebounce=1;var or=requireIsObject(),ar=requireNow(),lr=requireToNumber(),ur="Expected a function",cr=Math.max,hr=Math.min;function dr(fr,pr,vr){var gr,mr,br,yr,xr,Cr,Sr=0,wr=!1,Er=!1,Ar=!0;if(typeof fr!="function")throw new TypeError(ur);pr=lr(pr)||0,or(vr)&&(wr=!!vr.leading,Er="maxWait"in vr,br=Er?cr(lr(vr.maxWait)||0,pr):br,Ar="trailing"in vr?!!vr.trailing:Ar);function Tr(Ir){var Mr=gr,$r=mr;return gr=mr=void 0,Sr=Ir,yr=fr.apply($r,Mr),yr}function Rr(Ir){return Sr=Ir,xr=setTimeout(kr,pr),wr?Tr(Ir):yr}function Pr(Ir){var Mr=Ir-Cr,$r=Ir-Sr,jr=pr-Mr;return Er?hr(jr,br-$r):jr}function _r(Ir){var Mr=Ir-Cr,$r=Ir-Sr;return Cr===void 0||Mr>=pr||Mr<0||Er&&$r>=br}function kr(){var Ir=ar();if(_r(Ir))return Dr(Ir);xr=setTimeout(kr,Pr(Ir))}function Dr(Ir){return xr=void 0,Ar&&gr?Tr(Ir):(gr=mr=void 0,yr)}function Nr(){xr!==void 0&&clearTimeout(xr),Sr=0,gr=Cr=mr=xr=void 0}function Lr(){return xr===void 0?yr:Dr(ar())}function Or(){var Ir=ar(),Mr=_r(Ir);if(gr=arguments,mr=this,Cr=Ir,Mr){if(xr===void 0)return Rr(Cr);if(Er)return clearTimeout(xr),xr=setTimeout(kr,pr),Tr(Cr)}return xr===void 0&&(xr=setTimeout(kr,pr)),yr}return Or.cancel=Nr,Or.flush=Lr,Or}return debounce_1=dr,debounce_1}var debounceExports=requireDebounce(),debounce=getDefaultExportFromCjs(debounceExports),performance$1=_window?_window.performance:null,pnow=performance$1&&performance$1.now?function(){return performance$1.now()}:function(){return Date.now()},raf=function(){if(_window){if(_window.requestAnimationFrame)return function(or){_window.requestAnimationFrame(or)};if(_window.mozRequestAnimationFrame)return function(or){_window.mozRequestAnimationFrame(or)};if(_window.webkitRequestAnimationFrame)return function(or){_window.webkitRequestAnimationFrame(or)};if(_window.msRequestAnimationFrame)return function(or){_window.msRequestAnimationFrame(or)}}return function(or){or&&setTimeout(function(){or(pnow())},1e3/60)}}(),requestAnimationFrame=function or(ar){return raf(ar)},performanceNow=pnow,DEFAULT_HASH_SEED=9261,K=65599,DEFAULT_HASH_SEED_ALT=5381,hashIterableInts=function or(ar){for(var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_HASH_SEED,ur=lr,cr;cr=ar.next(),!cr.done;)ur=ur*K+cr.value|0;return ur},hashInt=function or(ar){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_HASH_SEED;return lr*K+ar|0},hashIntAlt=function or(ar){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_HASH_SEED_ALT;return(lr<<5)+lr+ar|0},combineHashes=function or(ar,lr){return ar*2097152+lr},combineHashesArray=function or(ar){return ar[0]*2097152+ar[1]},hashArrays=function or(ar,lr){return[hashInt(ar[0],lr[0]),hashIntAlt(ar[1],lr[1])]},hashIntsArray=function or(ar,lr){var ur={value:0,done:!1},cr=0,hr=ar.length,dr={next:function(){return cr<hr?ur.value=ar[cr++]:ur.done=!0,ur}};return hashIterableInts(dr,lr)},hashString=function or(ar,lr){var ur={value:0,done:!1},cr=0,hr=ar.length,dr={next:function(){return cr<hr?ur.value=ar.charCodeAt(cr++):ur.done=!0,ur}};return hashIterableInts(dr,lr)},hashStrings=function or(){return hashStringsArray(arguments)},hashStringsArray=function or(ar){for(var lr,ur=0;ur<ar.length;ur++){var cr=ar[ur];ur===0?lr=hashString(cr):lr=hashString(cr,lr)}return lr};function rotatePoint(or,ar,lr,ur,cr){var hr=cr*Math.PI/180,dr=Math.cos(hr)*(or-lr)-Math.sin(hr)*(ar-ur)+lr,fr=Math.sin(hr)*(or-lr)+Math.cos(hr)*(ar-ur)+ur;return{x:dr,y:fr}}var movePointByBoxAspect=function or(ar,lr,ur,cr,hr,dr){return{x:(ar-ur)*hr+ur,y:(lr-cr)*dr+cr}};function rotatePosAndSkewByBox(or,ar,lr){if(lr===0)return or;var ur=(ar.x1+ar.x2)/2,cr=(ar.y1+ar.y2)/2,hr=ar.w/ar.h,dr=1/hr,fr=rotatePoint(or.x,or.y,ur,cr,lr),pr=movePointByBoxAspect(fr.x,fr.y,ur,cr,hr,dr);return{x:pr.x,y:pr.y}}var warningsEnabled=!0,warnSupported=console.warn!=null,traceSupported=console.trace!=null,MAX_INT$1=Number.MAX_SAFE_INTEGER||9007199254740991,trueify=function or(){return!0},falsify=function or(){return!1},zeroify=function or(){return 0},noop$1=function or(){},error=function or(ar){throw new Error(ar)},warnings=function or(ar){if(ar!==void 0)warningsEnabled=!!ar;else return warningsEnabled},warn=function or(ar){warnings()&&(warnSupported?console.warn(ar):(console.log(ar),traceSupported&&console.trace()))},clone=function or(ar){return extend({},ar)},copy=function or(ar){return ar==null?ar:array(ar)?ar.slice():plainObject(ar)?clone(ar):ar},copyArray=function or(ar){return ar.slice()},uuid=function or(ar,lr){for(lr=ar="";ar++<36;lr+=ar*51&52?(ar^15?8^Math.random()*(ar^20?16:4):4).toString(16):"-");return lr},_staticEmptyObject={},staticEmptyObject=function or(){return _staticEmptyObject},defaults$g=function or(ar){var lr=Object.keys(ar);return function(ur){for(var cr={},hr=0;hr<lr.length;hr++){var dr=lr[hr],fr=ur==null?void 0:ur[dr];cr[dr]=fr===void 0?ar[dr]:fr}return cr}},removeFromArray=function or(ar,lr,ur){for(var cr=ar.length-1;cr>=0;cr--)ar[cr]===lr&&ar.splice(cr,1)},clearArray=function or(ar){ar.splice(0,ar.length)},push=function or(ar,lr){for(var ur=0;ur<lr.length;ur++){var cr=lr[ur];ar.push(cr)}},getPrefixedProperty=function or(ar,lr,ur){return ur&&(lr=prependCamel(ur,lr)),ar[lr]},setPrefixedProperty=function or(ar,lr,ur,cr){ur&&(lr=prependCamel(ur,lr)),ar[lr]=cr},ObjectMap=function(){function or(){_classCallCheck(this,or),this._obj={}}return _createClass(or,[{key:"set",value:function(lr,ur){return this._obj[lr]=ur,this}},{key:"delete",value:function(lr){return this._obj[lr]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(lr){return this._obj[lr]!==void 0}},{key:"get",value:function(lr){return this._obj[lr]}}])}(),Map$1=typeof Map<"u"?Map:ObjectMap,undef="undefined",ObjectSet=function(){function or(ar){if(_classCallCheck(this,or),this._obj=Object.create(null),this.size=0,ar!=null){var lr;ar.instanceString!=null&&ar.instanceString()===this.instanceString()?lr=ar.toArray():lr=ar;for(var ur=0;ur<lr.length;ur++)this.add(lr[ur])}}return _createClass(or,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(lr){var ur=this._obj;ur[lr]!==1&&(ur[lr]=1,this.size++)}},{key:"delete",value:function(lr){var ur=this._obj;ur[lr]===1&&(ur[lr]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(lr){return this._obj[lr]===1}},{key:"toArray",value:function(){var lr=this;return Object.keys(this._obj).filter(function(ur){return lr.has(ur)})}},{key:"forEach",value:function(lr,ur){return this.toArray().forEach(lr,ur)}}])}(),Set$1=(typeof Set>"u"?"undefined":_typeof(Set))!==undef?Set:ObjectSet,Element$1=function or(ar,lr){var ur=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(ar===void 0||lr===void 0||!core(ar)){error("An element must have a core reference and parameters set");return}var cr=lr.group;if(cr==null&&(lr.data&&lr.data.source!=null&&lr.data.target!=null?cr="edges":cr="nodes"),cr!=="nodes"&&cr!=="edges"){error("An element must be of type `nodes` or `edges`; you specified `"+cr+"`");return}this.length=1,this[0]=this;var hr=this._private={cy:ar,single:!0,data:lr.data||{},position:lr.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:cr,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!lr.selected,selectable:lr.selectable===void 0?!0:!!lr.selectable,locked:!!lr.locked,grabbed:!1,grabbable:lr.grabbable===void 0?!0:!!lr.grabbable,pannable:lr.pannable===void 0?cr==="edges":!!lr.pannable,active:!1,classes:new Set$1,animation:{current:[],queue:[]},rscratch:{},scratch:lr.scratch||{},edges:[],children:[],parent:lr.parent&&lr.parent.isNode()?lr.parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(hr.position.x==null&&(hr.position.x=0),hr.position.y==null&&(hr.position.y=0),lr.renderedPosition){var dr=lr.renderedPosition,fr=ar.pan(),pr=ar.zoom();hr.position={x:(dr.x-fr.x)/pr,y:(dr.y-fr.y)/pr}}var vr=[];array(lr.classes)?vr=lr.classes:string(lr.classes)&&(vr=lr.classes.split(/\s+/));for(var gr=0,mr=vr.length;gr<mr;gr++){var br=vr[gr];!br||br===""||hr.classes.add(br)}this.createEmitter(),(ur===void 0||ur)&&this.restore();var yr=lr.style||lr.css;yr&&(warn("Setting a `style` bypass at element creation should be done only when absolutely necessary.  Try to use the stylesheet instead."),this.style(yr))},defineSearch=function or(ar){return ar={bfs:ar.bfs||!ar.dfs,dfs:ar.dfs||!ar.bfs},function(ur,cr,hr){var dr;plainObject(ur)&&!elementOrCollection(ur)&&(dr=ur,ur=dr.roots||dr.root,cr=dr.visit,hr=dr.directed),hr=arguments.length===2&&!fn$6(cr)?cr:hr,cr=fn$6(cr)?cr:function(){};for(var fr=this._private.cy,pr=ur=string(ur)?this.filter(ur):ur,vr=[],gr=[],mr={},br={},yr={},xr=0,Cr,Sr=this.byGroup(),wr=Sr.nodes,Er=Sr.edges,Ar=0;Ar<pr.length;Ar++){var Tr=pr[Ar],Rr=Tr.id();Tr.isNode()&&(vr.unshift(Tr),ar.bfs&&(yr[Rr]=!0,gr.push(Tr)),br[Rr]=0)}for(var Pr=function(){var Ir=ar.bfs?vr.shift():vr.pop(),Mr=Ir.id();if(ar.dfs){if(yr[Mr])return 0;yr[Mr]=!0,gr.push(Ir)}var $r=br[Mr],jr=mr[Mr],Fr=jr!=null?jr.source():null,zr=jr!=null?jr.target():null,Hr=jr==null?void 0:Ir.same(Fr)?zr[0]:Fr[0],Wr;if(Wr=cr(Ir,jr,Hr,xr++,$r),Wr===!0)return Cr=Ir,1;if(Wr===!1)return 1;for(var Yr=Ir.connectedEdges().filter(function(Xr){return(!hr||Xr.source().same(Ir))&&Er.has(Xr)}),qr=0;qr<Yr.length;qr++){var Br=Yr[qr],Ur=Br.connectedNodes().filter(function(Xr){return!Xr.same(Ir)&&wr.has(Xr)}),Vr=Ur.id();Ur.length!==0&&!yr[Vr]&&(Ur=Ur[0],vr.push(Ur),ar.bfs&&(yr[Vr]=!0,gr.push(Ur)),mr[Vr]=Br,br[Vr]=br[Mr]+1)}},_r;vr.length!==0&&(_r=Pr(),!(_r!==0&&_r===1)););for(var kr=fr.collection(),Dr=0;Dr<gr.length;Dr++){var Nr=gr[Dr],Lr=mr[Nr.id()];Lr!=null&&kr.push(Lr),kr.push(Nr)}return{path:fr.collection(kr),found:fr.collection(Cr)}}},elesfn$v={breadthFirstSearch:defineSearch({bfs:!0}),depthFirstSearch:defineSearch({dfs:!0})};elesfn$v.bfs=elesfn$v.breadthFirstSearch;elesfn$v.dfs=elesfn$v.depthFirstSearch;var heap$2={exports:{}},heap$1=heap$2.exports,hasRequiredHeap$1;function requireHeap$1(){return hasRequiredHeap$1||(hasRequiredHeap$1=1,function(or,ar){(function(){var lr,ur,cr,hr,dr,fr,pr,vr,gr,mr,br,yr,xr,Cr,Sr;cr=Math.floor,mr=Math.min,ur=function(wr,Er){return wr<Er?-1:wr>Er?1:0},gr=function(wr,Er,Ar,Tr,Rr){var Pr;if(Ar==null&&(Ar=0),Rr==null&&(Rr=ur),Ar<0)throw new Error("lo must be non-negative");for(Tr==null&&(Tr=wr.length);Ar<Tr;)Pr=cr((Ar+Tr)/2),Rr(Er,wr[Pr])<0?Tr=Pr:Ar=Pr+1;return[].splice.apply(wr,[Ar,Ar-Ar].concat(Er)),Er},fr=function(wr,Er,Ar){return Ar==null&&(Ar=ur),wr.push(Er),Cr(wr,0,wr.length-1,Ar)},dr=function(wr,Er){var Ar,Tr;return Er==null&&(Er=ur),Ar=wr.pop(),wr.length?(Tr=wr[0],wr[0]=Ar,Sr(wr,0,Er)):Tr=Ar,Tr},vr=function(wr,Er,Ar){var Tr;return Ar==null&&(Ar=ur),Tr=wr[0],wr[0]=Er,Sr(wr,0,Ar),Tr},pr=function(wr,Er,Ar){var Tr;return Ar==null&&(Ar=ur),wr.length&&Ar(wr[0],Er)<0&&(Tr=[wr[0],Er],Er=Tr[0],wr[0]=Tr[1],Sr(wr,0,Ar)),Er},hr=function(wr,Er){var Ar,Tr,Rr,Pr,_r,kr;for(Er==null&&(Er=ur),Pr=(function(){kr=[];for(var Dr=0,Nr=cr(wr.length/2);0<=Nr?Dr<Nr:Dr>Nr;0<=Nr?Dr++:Dr--)kr.push(Dr);return kr}).apply(this).reverse(),_r=[],Tr=0,Rr=Pr.length;Tr<Rr;Tr++)Ar=Pr[Tr],_r.push(Sr(wr,Ar,Er));return _r},xr=function(wr,Er,Ar){var Tr;if(Ar==null&&(Ar=ur),Tr=wr.indexOf(Er),Tr!==-1)return Cr(wr,0,Tr,Ar),Sr(wr,Tr,Ar)},br=function(wr,Er,Ar){var Tr,Rr,Pr,_r,kr;if(Ar==null&&(Ar=ur),Rr=wr.slice(0,Er),!Rr.length)return Rr;for(hr(Rr,Ar),kr=wr.slice(Er),Pr=0,_r=kr.length;Pr<_r;Pr++)Tr=kr[Pr],pr(Rr,Tr,Ar);return Rr.sort(Ar).reverse()},yr=function(wr,Er,Ar){var Tr,Rr,Pr,_r,kr,Dr,Nr,Lr,Or;if(Ar==null&&(Ar=ur),Er*10<=wr.length){if(Pr=wr.slice(0,Er).sort(Ar),!Pr.length)return Pr;for(Rr=Pr[Pr.length-1],Nr=wr.slice(Er),_r=0,Dr=Nr.length;_r<Dr;_r++)Tr=Nr[_r],Ar(Tr,Rr)<0&&(gr(Pr,Tr,0,null,Ar),Pr.pop(),Rr=Pr[Pr.length-1]);return Pr}for(hr(wr,Ar),Or=[],kr=0,Lr=mr(Er,wr.length);0<=Lr?kr<Lr:kr>Lr;0<=Lr?++kr:--kr)Or.push(dr(wr,Ar));return Or},Cr=function(wr,Er,Ar,Tr){var Rr,Pr,_r;for(Tr==null&&(Tr=ur),Rr=wr[Ar];Ar>Er;){if(_r=Ar-1>>1,Pr=wr[_r],Tr(Rr,Pr)<0){wr[Ar]=Pr,Ar=_r;continue}break}return wr[Ar]=Rr},Sr=function(wr,Er,Ar){var Tr,Rr,Pr,_r,kr;for(Ar==null&&(Ar=ur),Rr=wr.length,kr=Er,Pr=wr[Er],Tr=2*Er+1;Tr<Rr;)_r=Tr+1,_r<Rr&&!(Ar(wr[Tr],wr[_r])<0)&&(Tr=_r),wr[Er]=wr[Tr],Er=Tr,Tr=2*Er+1;return wr[Er]=Pr,Cr(wr,kr,Er,Ar)},lr=function(){wr.push=fr,wr.pop=dr,wr.replace=vr,wr.pushpop=pr,wr.heapify=hr,wr.updateItem=xr,wr.nlargest=br,wr.nsmallest=yr;function wr(Er){this.cmp=Er??ur,this.nodes=[]}return wr.prototype.push=function(Er){return fr(this.nodes,Er,this.cmp)},wr.prototype.pop=function(){return dr(this.nodes,this.cmp)},wr.prototype.peek=function(){return this.nodes[0]},wr.prototype.contains=function(Er){return this.nodes.indexOf(Er)!==-1},wr.prototype.replace=function(Er){return vr(this.nodes,Er,this.cmp)},wr.prototype.pushpop=function(Er){return pr(this.nodes,Er,this.cmp)},wr.prototype.heapify=function(){return hr(this.nodes,this.cmp)},wr.prototype.updateItem=function(Er){return xr(this.nodes,Er,this.cmp)},wr.prototype.clear=function(){return this.nodes=[]},wr.prototype.empty=function(){return this.nodes.length===0},wr.prototype.size=function(){return this.nodes.length},wr.prototype.clone=function(){var Er;return Er=new wr,Er.nodes=this.nodes.slice(0),Er},wr.prototype.toArray=function(){return this.nodes.slice(0)},wr.prototype.insert=wr.prototype.push,wr.prototype.top=wr.prototype.peek,wr.prototype.front=wr.prototype.peek,wr.prototype.has=wr.prototype.contains,wr.prototype.copy=wr.prototype.clone,wr}(),function(wr,Er){return or.exports=Er()}(this,function(){return lr})}).call(heap$1)}(heap$2)),heap$2.exports}var heap,hasRequiredHeap;function requireHeap(){return hasRequiredHeap||(hasRequiredHeap=1,heap=requireHeap$1()),heap}var heapExports=requireHeap(),Heap=getDefaultExportFromCjs(heapExports),dijkstraDefaults=defaults$g({root:null,weight:function or(ar){return 1},directed:!1}),elesfn$u={dijkstra:function or(ar){if(!plainObject(ar)){var lr=arguments;ar={root:lr[0],weight:lr[1],directed:lr[2]}}var ur=dijkstraDefaults(ar),cr=ur.root,hr=ur.weight,dr=ur.directed,fr=this,pr=hr,vr=string(cr)?this.filter(cr)[0]:cr[0],gr={},mr={},br={},yr=this.byGroup(),xr=yr.nodes,Cr=yr.edges;Cr.unmergeBy(function($r){return $r.isLoop()});for(var Sr=function(jr){return gr[jr.id()]},wr=function(jr,Fr){gr[jr.id()]=Fr,Er.updateItem(jr)},Er=new Heap(function($r,jr){return Sr($r)-Sr(jr)}),Ar=0;Ar<xr.length;Ar++){var Tr=xr[Ar];gr[Tr.id()]=Tr.same(vr)?0:1/0,Er.push(Tr)}for(var Rr=function(jr,Fr){for(var zr=(dr?jr.edgesTo(Fr):jr.edgesWith(Fr)).intersect(Cr),Hr=1/0,Wr,Yr=0;Yr<zr.length;Yr++){var qr=zr[Yr],Br=pr(qr);(Br<Hr||!Wr)&&(Hr=Br,Wr=qr)}return{edge:Wr,dist:Hr}};Er.size()>0;){var Pr=Er.pop(),_r=Sr(Pr),kr=Pr.id();if(br[kr]=_r,_r!==1/0)for(var Dr=Pr.neighborhood().intersect(xr),Nr=0;Nr<Dr.length;Nr++){var Lr=Dr[Nr],Or=Lr.id(),Ir=Rr(Pr,Lr),Mr=_r+Ir.dist;Mr<Sr(Lr)&&(wr(Lr,Mr),mr[Or]={node:Pr,edge:Ir.edge})}}return{distanceTo:function(jr){var Fr=string(jr)?xr.filter(jr)[0]:jr[0];return br[Fr.id()]},pathTo:function(jr){var Fr=string(jr)?xr.filter(jr)[0]:jr[0],zr=[],Hr=Fr,Wr=Hr.id();if(Fr.length>0)for(zr.unshift(Fr);mr[Wr];){var Yr=mr[Wr];zr.unshift(Yr.edge),zr.unshift(Yr.node),Hr=Yr.node,Wr=Hr.id()}return fr.spawn(zr)}}}},elesfn$t={kruskal:function or(ar){ar=ar||function(Ar){return 1};for(var lr=this.byGroup(),ur=lr.nodes,cr=lr.edges,hr=ur.length,dr=new Array(hr),fr=ur,pr=function(Tr){for(var Rr=0;Rr<dr.length;Rr++){var Pr=dr[Rr];if(Pr.has(Tr))return Rr}},vr=0;vr<hr;vr++)dr[vr]=this.spawn(ur[vr]);for(var gr=cr.sort(function(Ar,Tr){return ar(Ar)-ar(Tr)}),mr=0;mr<gr.length;mr++){var br=gr[mr],yr=br.source()[0],xr=br.target()[0],Cr=pr(yr),Sr=pr(xr),wr=dr[Cr],Er=dr[Sr];Cr!==Sr&&(fr.merge(br),wr.merge(Er),dr.splice(Sr,1))}return fr}},aStarDefaults=defaults$g({root:null,goal:null,weight:function or(ar){return 1},heuristic:function or(ar){return 0},directed:!1}),elesfn$s={aStar:function or(ar){var lr=this.cy(),ur=aStarDefaults(ar),cr=ur.root,hr=ur.goal,dr=ur.heuristic,fr=ur.directed,pr=ur.weight;cr=lr.collection(cr)[0],hr=lr.collection(hr)[0];var vr=cr.id(),gr=hr.id(),mr={},br={},yr={},xr=new Heap(function(Wr,Yr){return br[Wr.id()]-br[Yr.id()]}),Cr=new Set$1,Sr={},wr={},Er=function(Yr,qr){xr.push(Yr),Cr.add(qr)},Ar,Tr,Rr=function(){Ar=xr.pop(),Tr=Ar.id(),Cr.delete(Tr)},Pr=function(Yr){return Cr.has(Yr)};Er(cr,vr),mr[vr]=0,br[vr]=dr(cr);for(var _r=0;xr.size()>0;){if(Rr(),_r++,Tr===gr){for(var kr=[],Dr=hr,Nr=gr,Lr=wr[Nr];kr.unshift(Dr),Lr!=null&&kr.unshift(Lr),Dr=Sr[Nr],Dr!=null;)Nr=Dr.id(),Lr=wr[Nr];return{found:!0,distance:mr[Tr],path:this.spawn(kr),steps:_r}}yr[Tr]=!0;for(var Or=Ar._private.edges,Ir=0;Ir<Or.length;Ir++){var Mr=Or[Ir];if(this.hasElementWithId(Mr.id())&&!(fr&&Mr.data("source")!==Tr)){var $r=Mr.source(),jr=Mr.target(),Fr=$r.id()!==Tr?$r:jr,zr=Fr.id();if(this.hasElementWithId(zr)&&!yr[zr]){var Hr=mr[Tr]+pr(Mr);if(!Pr(zr)){mr[zr]=Hr,br[zr]=Hr+dr(Fr),Er(Fr,zr),Sr[zr]=Ar,wr[zr]=Mr;continue}Hr<mr[zr]&&(mr[zr]=Hr,br[zr]=Hr+dr(Fr),Sr[zr]=Ar,wr[zr]=Mr)}}}}return{found:!1,distance:void 0,path:void 0,steps:_r}}},floydWarshallDefaults=defaults$g({weight:function or(ar){return 1},directed:!1}),elesfn$r={floydWarshall:function or(ar){for(var lr=this.cy(),ur=floydWarshallDefaults(ar),cr=ur.weight,hr=ur.directed,dr=cr,fr=this.byGroup(),pr=fr.nodes,vr=fr.edges,gr=pr.length,mr=gr*gr,br=function(Br){return pr.indexOf(Br)},yr=function(Br){return pr[Br]},xr=new Array(mr),Cr=0;Cr<mr;Cr++){var Sr=Cr%gr,wr=(Cr-Sr)/gr;wr===Sr?xr[Cr]=0:xr[Cr]=1/0}for(var Er=new Array(mr),Ar=new Array(mr),Tr=0;Tr<vr.length;Tr++){var Rr=vr[Tr],Pr=Rr.source()[0],_r=Rr.target()[0];if(Pr!==_r){var kr=br(Pr),Dr=br(_r),Nr=kr*gr+Dr,Lr=dr(Rr);if(xr[Nr]>Lr&&(xr[Nr]=Lr,Er[Nr]=Dr,Ar[Nr]=Rr),!hr){var Or=Dr*gr+kr;!hr&&xr[Or]>Lr&&(xr[Or]=Lr,Er[Or]=kr,Ar[Or]=Rr)}}}for(var Ir=0;Ir<gr;Ir++)for(var Mr=0;Mr<gr;Mr++)for(var $r=Mr*gr+Ir,jr=0;jr<gr;jr++){var Fr=Mr*gr+jr,zr=Ir*gr+jr;xr[$r]+xr[zr]<xr[Fr]&&(xr[Fr]=xr[$r]+xr[zr],Er[Fr]=Er[$r])}var Hr=function(Br){return(string(Br)?lr.filter(Br):Br)[0]},Wr=function(Br){return br(Hr(Br))},Yr={distance:function(Br,Ur){var Vr=Wr(Br),Xr=Wr(Ur);return xr[Vr*gr+Xr]},path:function(Br,Ur){var Vr=Wr(Br),Xr=Wr(Ur),Zr=yr(Vr);if(Vr===Xr)return Zr.collection();if(Er[Vr*gr+Xr]==null)return lr.collection();var Jr=lr.collection(),Qr=Vr,ga;for(Jr.merge(Zr);Vr!==Xr;)Qr=Vr,Vr=Er[Vr*gr+Xr],ga=Ar[Qr*gr+Vr],Jr.merge(ga),Jr.merge(yr(Vr));return Jr}};return Yr}},bellmanFordDefaults=defaults$g({weight:function or(ar){return 1},directed:!1,root:null}),elesfn$q={bellmanFord:function or(ar){var lr=this,ur=bellmanFordDefaults(ar),cr=ur.weight,hr=ur.directed,dr=ur.root,fr=cr,pr=this,vr=this.cy(),gr=this.byGroup(),mr=gr.edges,br=gr.nodes,yr=br.length,xr=new Map$1,Cr=!1,Sr=[];dr=vr.collection(dr)[0],mr.unmergeBy(function(as){return as.isLoop()});for(var wr=mr.length,Er=function(Kr){var $a=xr.get(Kr.id());return $a||($a={},xr.set(Kr.id(),$a)),$a},Ar=function(Kr){return(string(Kr)?vr.$(Kr):Kr)[0]},Tr=function(Kr){return Er(Ar(Kr)).dist},Rr=function(Kr){for(var $a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:dr,ss=Ar(Kr),hs=[],vs=ss;;){if(vs==null)return lr.spawn();var bs=Er(vs),xs=bs.edge,fs=bs.pred;if(hs.unshift(vs[0]),vs.same($a)&&hs.length>0)break;xs!=null&&hs.unshift(xs),vs=fs}return pr.spawn(hs)},Pr=0;Pr<yr;Pr++){var _r=br[Pr],kr=Er(_r);_r.same(dr)?kr.dist=0:kr.dist=1/0,kr.pred=null,kr.edge=null}for(var Dr=!1,Nr=function(Kr,$a,ss,hs,vs,bs){var xs=hs.dist+bs;xs<vs.dist&&!ss.same(hs.edge)&&(vs.dist=xs,vs.pred=Kr,vs.edge=ss,Dr=!0)},Lr=1;Lr<yr;Lr++){Dr=!1;for(var Or=0;Or<wr;Or++){var Ir=mr[Or],Mr=Ir.source(),$r=Ir.target(),jr=fr(Ir),Fr=Er(Mr),zr=Er($r);Nr(Mr,$r,Ir,Fr,zr,jr),hr||Nr($r,Mr,Ir,zr,Fr,jr)}if(!Dr)break}if(Dr)for(var Hr=[],Wr=0;Wr<wr;Wr++){var Yr=mr[Wr],qr=Yr.source(),Br=Yr.target(),Ur=fr(Yr),Vr=Er(qr).dist,Xr=Er(Br).dist;if(Vr+Ur<Xr||!hr&&Xr+Ur<Vr)if(Cr||(warn("Graph contains a negative weight cycle for Bellman-Ford"),Cr=!0),ar.findNegativeWeightCycles!==!1){var Zr=[];Vr+Ur<Xr&&Zr.push(qr),!hr&&Xr+Ur<Vr&&Zr.push(Br);for(var Jr=Zr.length,Qr=0;Qr<Jr;Qr++){var ga=Zr[Qr],ba=[ga];ba.push(Er(ga).edge);for(var _i=Er(ga).pred;ba.indexOf(_i)===-1;)ba.push(_i),ba.push(Er(_i).edge),_i=Er(_i).pred;ba=ba.slice(ba.indexOf(_i));for(var os=ba[0].id(),ls=0,ys=2;ys<ba.length;ys+=2)ba[ys].id()<os&&(os=ba[ys].id(),ls=ys);ba=ba.slice(ls).concat(ba.slice(0,ls)),ba.push(ba[0]);var ns=ba.map(function(as){return as.id()}).join(",");Hr.indexOf(ns)===-1&&(Sr.push(pr.spawn(ba)),Hr.push(ns))}}else break}return{distanceTo:Tr,pathTo:Rr,hasNegativeWeightCycle:Cr,negativeWeightCycles:Sr}}},sqrt2=Math.sqrt(2),collapse=function or(ar,lr,ur){ur.length===0&&error("Karger-Stein must be run on a connected (sub)graph");for(var cr=ur[ar],hr=cr[1],dr=cr[2],fr=lr[hr],pr=lr[dr],vr=ur,gr=vr.length-1;gr>=0;gr--){var mr=vr[gr],br=mr[1],yr=mr[2];(lr[br]===fr&&lr[yr]===pr||lr[br]===pr&&lr[yr]===fr)&&vr.splice(gr,1)}for(var xr=0;xr<vr.length;xr++){var Cr=vr[xr];Cr[1]===pr?(vr[xr]=Cr.slice(),vr[xr][1]=fr):Cr[2]===pr&&(vr[xr]=Cr.slice(),vr[xr][2]=fr)}for(var Sr=0;Sr<lr.length;Sr++)lr[Sr]===pr&&(lr[Sr]=fr);return vr},contractUntil=function or(ar,lr,ur,cr){for(;ur>cr;){var hr=Math.floor(Math.random()*lr.length);lr=collapse(hr,ar,lr),ur--}return lr},elesfn$p={kargerStein:function or(){var ar=this,lr=this.byGroup(),ur=lr.nodes,cr=lr.edges;cr.unmergeBy(function(zr){return zr.isLoop()});var hr=ur.length,dr=cr.length,fr=Math.ceil(Math.pow(Math.log(hr)/Math.LN2,2)),pr=Math.floor(hr/sqrt2);if(hr<2){error("At least 2 nodes are required for Karger-Stein algorithm");return}for(var vr=[],gr=0;gr<dr;gr++){var mr=cr[gr];vr.push([gr,ur.indexOf(mr.source()),ur.indexOf(mr.target())])}for(var br=1/0,yr=[],xr=new Array(hr),Cr=new Array(hr),Sr=new Array(hr),wr=function(Hr,Wr){for(var Yr=0;Yr<hr;Yr++)Wr[Yr]=Hr[Yr]},Er=0;Er<=fr;Er++){for(var Ar=0;Ar<hr;Ar++)Cr[Ar]=Ar;var Tr=contractUntil(Cr,vr.slice(),hr,pr),Rr=Tr.slice();wr(Cr,Sr);var Pr=contractUntil(Cr,Tr,pr,2),_r=contractUntil(Sr,Rr,pr,2);Pr.length<=_r.length&&Pr.length<br?(br=Pr.length,yr=Pr,wr(Cr,xr)):_r.length<=Pr.length&&_r.length<br&&(br=_r.length,yr=_r,wr(Sr,xr))}for(var kr=this.spawn(yr.map(function(zr){return cr[zr[0]]})),Dr=this.spawn(),Nr=this.spawn(),Lr=xr[0],Or=0;Or<xr.length;Or++){var Ir=xr[Or],Mr=ur[Or];Ir===Lr?Dr.merge(Mr):Nr.merge(Mr)}var $r=function(Hr){var Wr=ar.spawn();return Hr.forEach(function(Yr){Wr.merge(Yr),Yr.connectedEdges().forEach(function(qr){ar.contains(qr)&&!kr.contains(qr)&&Wr.merge(qr)})}),Wr},jr=[$r(Dr),$r(Nr)],Fr={cut:kr,components:jr,partition1:Dr,partition2:Nr};return Fr}},_Math$hypot,copyPosition=function or(ar){return{x:ar.x,y:ar.y}},modelToRenderedPosition$1=function or(ar,lr,ur){return{x:ar.x*lr+ur.x,y:ar.y*lr+ur.y}},renderedToModelPosition=function or(ar,lr,ur){return{x:(ar.x-ur.x)/lr,y:(ar.y-ur.y)/lr}},array2point=function or(ar){return{x:ar[0],y:ar[1]}},min=function or(ar){for(var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ur=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ar.length,cr=1/0,hr=lr;hr<ur;hr++){var dr=ar[hr];isFinite(dr)&&(cr=Math.min(dr,cr))}return cr},max=function or(ar){for(var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ur=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ar.length,cr=-1/0,hr=lr;hr<ur;hr++){var dr=ar[hr];isFinite(dr)&&(cr=Math.max(dr,cr))}return cr},mean=function or(ar){for(var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ur=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ar.length,cr=0,hr=0,dr=lr;dr<ur;dr++){var fr=ar[dr];isFinite(fr)&&(cr+=fr,hr++)}return cr/hr},median=function or(ar){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ur=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ar.length,cr=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,hr=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,dr=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;cr?ar=ar.slice(lr,ur):(ur<ar.length&&ar.splice(ur,ar.length-ur),lr>0&&ar.splice(0,lr));for(var fr=0,pr=ar.length-1;pr>=0;pr--){var vr=ar[pr];dr?isFinite(vr)||(ar[pr]=-1/0,fr++):ar.splice(pr,1)}hr&&ar.sort(function(br,yr){return br-yr});var gr=ar.length,mr=Math.floor(gr/2);return gr%2!==0?ar[mr+1+fr]:(ar[mr-1+fr]+ar[mr+fr])/2},deg2rad=function or(ar){return Math.PI*ar/180},getAngleFromDisp=function or(ar,lr){return Math.atan2(lr,ar)-Math.PI/2},log2=Math.log2||function(or){return Math.log(or)/Math.log(2)},signum=function or(ar){return ar>0?1:ar<0?-1:0},dist=function or(ar,lr){return Math.sqrt(sqdist(ar,lr))},sqdist=function or(ar,lr){var ur=lr.x-ar.x,cr=lr.y-ar.y;return ur*ur+cr*cr},inPlaceSumNormalize=function or(ar){for(var lr=ar.length,ur=0,cr=0;cr<lr;cr++)ur+=ar[cr];for(var hr=0;hr<lr;hr++)ar[hr]=ar[hr]/ur;return ar},qbezierAt=function or(ar,lr,ur,cr){return(1-cr)*(1-cr)*ar+2*(1-cr)*cr*lr+cr*cr*ur},qbezierPtAt=function or(ar,lr,ur,cr){return{x:qbezierAt(ar.x,lr.x,ur.x,cr),y:qbezierAt(ar.y,lr.y,ur.y,cr)}},lineAt=function or(ar,lr,ur,cr){var hr={x:lr.x-ar.x,y:lr.y-ar.y},dr=dist(ar,lr),fr={x:hr.x/dr,y:hr.y/dr};return ur=ur??0,cr=cr??ur*dr,{x:ar.x+fr.x*cr,y:ar.y+fr.y*cr}},bound=function or(ar,lr,ur){return Math.max(ar,Math.min(ur,lr))},makeBoundingBox=function or(ar){if(ar==null)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(ar.x1!=null&&ar.y1!=null){if(ar.x2!=null&&ar.y2!=null&&ar.x2>=ar.x1&&ar.y2>=ar.y1)return{x1:ar.x1,y1:ar.y1,x2:ar.x2,y2:ar.y2,w:ar.x2-ar.x1,h:ar.y2-ar.y1};if(ar.w!=null&&ar.h!=null&&ar.w>=0&&ar.h>=0)return{x1:ar.x1,y1:ar.y1,x2:ar.x1+ar.w,y2:ar.y1+ar.h,w:ar.w,h:ar.h}}},copyBoundingBox=function or(ar){return{x1:ar.x1,x2:ar.x2,w:ar.w,y1:ar.y1,y2:ar.y2,h:ar.h}},clearBoundingBox=function or(ar){ar.x1=1/0,ar.y1=1/0,ar.x2=-1/0,ar.y2=-1/0,ar.w=0,ar.h=0},updateBoundingBox=function or(ar,lr){ar.x1=Math.min(ar.x1,lr.x1),ar.x2=Math.max(ar.x2,lr.x2),ar.w=ar.x2-ar.x1,ar.y1=Math.min(ar.y1,lr.y1),ar.y2=Math.max(ar.y2,lr.y2),ar.h=ar.y2-ar.y1},expandBoundingBoxByPoint=function or(ar,lr,ur){ar.x1=Math.min(ar.x1,lr),ar.x2=Math.max(ar.x2,lr),ar.w=ar.x2-ar.x1,ar.y1=Math.min(ar.y1,ur),ar.y2=Math.max(ar.y2,ur),ar.h=ar.y2-ar.y1},expandBoundingBox=function or(ar){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return ar.x1-=lr,ar.x2+=lr,ar.y1-=lr,ar.y2+=lr,ar.w=ar.x2-ar.x1,ar.h=ar.y2-ar.y1,ar},expandBoundingBoxSides=function or(ar){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0],ur,cr,hr,dr;if(lr.length===1)ur=cr=hr=dr=lr[0];else if(lr.length===2)ur=hr=lr[0],dr=cr=lr[1];else if(lr.length===4){var fr=_slicedToArray(lr,4);ur=fr[0],cr=fr[1],hr=fr[2],dr=fr[3]}return ar.x1-=dr,ar.x2+=cr,ar.y1-=ur,ar.y2+=hr,ar.w=ar.x2-ar.x1,ar.h=ar.y2-ar.y1,ar},assignBoundingBox=function or(ar,lr){ar.x1=lr.x1,ar.y1=lr.y1,ar.x2=lr.x2,ar.y2=lr.y2,ar.w=ar.x2-ar.x1,ar.h=ar.y2-ar.y1},boundingBoxesIntersect=function or(ar,lr){return!(ar.x1>lr.x2||lr.x1>ar.x2||ar.x2<lr.x1||lr.x2<ar.x1||ar.y2<lr.y1||lr.y2<ar.y1||ar.y1>lr.y2||lr.y1>ar.y2)},inBoundingBox=function or(ar,lr,ur){return ar.x1<=lr&&lr<=ar.x2&&ar.y1<=ur&&ur<=ar.y2},pointInBoundingBox=function or(ar,lr){return inBoundingBox(ar,lr.x,lr.y)},boundingBoxInBoundingBox=function or(ar,lr){return inBoundingBox(ar,lr.x1,lr.y1)&&inBoundingBox(ar,lr.x2,lr.y2)},hypot=(_Math$hypot=Math.hypot)!==null&&_Math$hypot!==void 0?_Math$hypot:function(or,ar){return Math.sqrt(or*or+ar*ar)};function inflatePolygon(or,ar){if(or.length<3)throw new Error("Need at least 3 vertices");var lr=function(kr,Dr){return{x:kr.x+Dr.x,y:kr.y+Dr.y}},ur=function(kr,Dr){return{x:kr.x-Dr.x,y:kr.y-Dr.y}},cr=function(kr,Dr){return{x:kr.x*Dr,y:kr.y*Dr}},hr=function(kr,Dr){return kr.x*Dr.y-kr.y*Dr.x},dr=function(kr){var Dr=hypot(kr.x,kr.y);return Dr===0?{x:0,y:0}:{x:kr.x/Dr,y:kr.y/Dr}},fr=function(kr){for(var Dr=0,Nr=0;Nr<kr.length;Nr++){var Lr=kr[Nr],Or=kr[(Nr+1)%kr.length];Dr+=Lr.x*Or.y-Or.x*Lr.y}return Dr/2},pr=function(kr,Dr,Nr,Lr){var Or=ur(Dr,kr),Ir=ur(Lr,Nr),Mr=hr(Or,Ir);if(Math.abs(Mr)<1e-9)return lr(kr,cr(Or,.5));var $r=hr(ur(Nr,kr),Ir)/Mr;return lr(kr,cr(Or,$r))},vr=or.map(function(_r){return{x:_r.x,y:_r.y}});fr(vr)<0&&vr.reverse();for(var gr=vr.length,mr=[],br=0;br<gr;br++){var yr=vr[br],xr=vr[(br+1)%gr],Cr=ur(xr,yr),Sr=dr({x:Cr.y,y:-Cr.x});mr.push(Sr)}for(var wr=mr.map(function(_r,kr){var Dr=lr(vr[kr],cr(_r,ar)),Nr=lr(vr[(kr+1)%gr],cr(_r,ar));return{p1:Dr,p2:Nr}}),Er=[],Ar=0;Ar<gr;Ar++){var Tr=wr[(Ar-1+gr)%gr],Rr=wr[Ar],Pr=pr(Tr.p1,Tr.p2,Rr.p1,Rr.p2);Er.push(Pr)}return Er}function miterBox(or,ar,lr,ur,cr,hr){var dr=transformPoints(or,ar,lr,ur,cr),fr=inflatePolygon(dr,hr),pr=makeBoundingBox();return fr.forEach(function(vr){return expandBoundingBoxByPoint(pr,vr.x,vr.y)}),pr}var roundRectangleIntersectLine=function or(ar,lr,ur,cr,hr,dr,fr){var pr=arguments.length>7&&arguments[7]!==void 0?arguments[7]:"auto",vr=pr==="auto"?getRoundRectangleRadius(hr,dr):pr,gr=hr/2,mr=dr/2;vr=Math.min(vr,gr,mr);var br=vr!==gr,yr=vr!==mr,xr;if(br){var Cr=ur-gr+vr-fr,Sr=cr-mr-fr,wr=ur+gr-vr+fr,Er=Sr;if(xr=finiteLinesIntersect(ar,lr,ur,cr,Cr,Sr,wr,Er,!1),xr.length>0)return xr}if(yr){var Ar=ur+gr+fr,Tr=cr-mr+vr-fr,Rr=Ar,Pr=cr+mr-vr+fr;if(xr=finiteLinesIntersect(ar,lr,ur,cr,Ar,Tr,Rr,Pr,!1),xr.length>0)return xr}if(br){var _r=ur-gr+vr-fr,kr=cr+mr+fr,Dr=ur+gr-vr+fr,Nr=kr;if(xr=finiteLinesIntersect(ar,lr,ur,cr,_r,kr,Dr,Nr,!1),xr.length>0)return xr}if(yr){var Lr=ur-gr-fr,Or=cr-mr+vr-fr,Ir=Lr,Mr=cr+mr-vr+fr;if(xr=finiteLinesIntersect(ar,lr,ur,cr,Lr,Or,Ir,Mr,!1),xr.length>0)return xr}var $r;{var jr=ur-gr+vr,Fr=cr-mr+vr;if($r=intersectLineCircle(ar,lr,ur,cr,jr,Fr,vr+fr),$r.length>0&&$r[0]<=jr&&$r[1]<=Fr)return[$r[0],$r[1]]}{var zr=ur+gr-vr,Hr=cr-mr+vr;if($r=intersectLineCircle(ar,lr,ur,cr,zr,Hr,vr+fr),$r.length>0&&$r[0]>=zr&&$r[1]<=Hr)return[$r[0],$r[1]]}{var Wr=ur+gr-vr,Yr=cr+mr-vr;if($r=intersectLineCircle(ar,lr,ur,cr,Wr,Yr,vr+fr),$r.length>0&&$r[0]>=Wr&&$r[1]>=Yr)return[$r[0],$r[1]]}{var qr=ur-gr+vr,Br=cr+mr-vr;if($r=intersectLineCircle(ar,lr,ur,cr,qr,Br,vr+fr),$r.length>0&&$r[0]<=qr&&$r[1]>=Br)return[$r[0],$r[1]]}return[]},inLineVicinity=function or(ar,lr,ur,cr,hr,dr,fr){var pr=fr,vr=Math.min(ur,hr),gr=Math.max(ur,hr),mr=Math.min(cr,dr),br=Math.max(cr,dr);return vr-pr<=ar&&ar<=gr+pr&&mr-pr<=lr&&lr<=br+pr},inBezierVicinity=function or(ar,lr,ur,cr,hr,dr,fr,pr,vr){var gr={x1:Math.min(ur,fr,hr)-vr,x2:Math.max(ur,fr,hr)+vr,y1:Math.min(cr,pr,dr)-vr,y2:Math.max(cr,pr,dr)+vr};return!(ar<gr.x1||ar>gr.x2||lr<gr.y1||lr>gr.y2)},solveQuadratic=function or(ar,lr,ur,cr){ur-=cr;var hr=lr*lr-4*ar*ur;if(hr<0)return[];var dr=Math.sqrt(hr),fr=2*ar,pr=(-lr+dr)/fr,vr=(-lr-dr)/fr;return[pr,vr]},solveCubic=function or(ar,lr,ur,cr,hr){var dr=1e-5;ar===0&&(ar=dr),lr/=ar,ur/=ar,cr/=ar;var fr,pr,vr,gr,mr,br,yr,xr;if(pr=(3*ur-lr*lr)/9,vr=-(27*cr)+lr*(9*ur-2*(lr*lr)),vr/=54,fr=pr*pr*pr+vr*vr,hr[1]=0,yr=lr/3,fr>0){mr=vr+Math.sqrt(fr),mr=mr<0?-Math.pow(-mr,1/3):Math.pow(mr,1/3),br=vr-Math.sqrt(fr),br=br<0?-Math.pow(-br,1/3):Math.pow(br,1/3),hr[0]=-yr+mr+br,yr+=(mr+br)/2,hr[4]=hr[2]=-yr,yr=Math.sqrt(3)*(-br+mr)/2,hr[3]=yr,hr[5]=-yr;return}if(hr[5]=hr[3]=0,fr===0){xr=vr<0?-Math.pow(-vr,1/3):Math.pow(vr,1/3),hr[0]=-yr+2*xr,hr[4]=hr[2]=-(xr+yr);return}pr=-pr,gr=pr*pr*pr,gr=Math.acos(vr/Math.sqrt(gr)),xr=2*Math.sqrt(pr),hr[0]=-yr+xr*Math.cos(gr/3),hr[2]=-yr+xr*Math.cos((gr+2*Math.PI)/3),hr[4]=-yr+xr*Math.cos((gr+4*Math.PI)/3)},sqdistToQuadraticBezier=function or(ar,lr,ur,cr,hr,dr,fr,pr){var vr=1*ur*ur-4*ur*hr+2*ur*fr+4*hr*hr-4*hr*fr+fr*fr+cr*cr-4*cr*dr+2*cr*pr+4*dr*dr-4*dr*pr+pr*pr,gr=1*9*ur*hr-3*ur*ur-3*ur*fr-6*hr*hr+3*hr*fr+9*cr*dr-3*cr*cr-3*cr*pr-6*dr*dr+3*dr*pr,mr=1*3*ur*ur-6*ur*hr+ur*fr-ur*ar+2*hr*hr+2*hr*ar-fr*ar+3*cr*cr-6*cr*dr+cr*pr-cr*lr+2*dr*dr+2*dr*lr-pr*lr,br=1*ur*hr-ur*ur+ur*ar-hr*ar+cr*dr-cr*cr+cr*lr-dr*lr,yr=[];solveCubic(vr,gr,mr,br,yr);for(var xr=1e-7,Cr=[],Sr=0;Sr<6;Sr+=2)Math.abs(yr[Sr+1])<xr&&yr[Sr]>=0&&yr[Sr]<=1&&Cr.push(yr[Sr]);Cr.push(1),Cr.push(0);for(var wr=-1,Er,Ar,Tr,Rr=0;Rr<Cr.length;Rr++)Er=Math.pow(1-Cr[Rr],2)*ur+2*(1-Cr[Rr])*Cr[Rr]*hr+Cr[Rr]*Cr[Rr]*fr,Ar=Math.pow(1-Cr[Rr],2)*cr+2*(1-Cr[Rr])*Cr[Rr]*dr+Cr[Rr]*Cr[Rr]*pr,Tr=Math.pow(Er-ar,2)+Math.pow(Ar-lr,2),wr>=0?Tr<wr&&(wr=Tr):wr=Tr;return wr},sqdistToFiniteLine=function or(ar,lr,ur,cr,hr,dr){var fr=[ar-ur,lr-cr],pr=[hr-ur,dr-cr],vr=pr[0]*pr[0]+pr[1]*pr[1],gr=fr[0]*fr[0]+fr[1]*fr[1],mr=fr[0]*pr[0]+fr[1]*pr[1],br=mr*mr/vr;return mr<0?gr:br>vr?(ar-hr)*(ar-hr)+(lr-dr)*(lr-dr):gr-br},pointInsidePolygonPoints=function or(ar,lr,ur){for(var cr,hr,dr,fr,pr,vr=0,gr=0;gr<ur.length/2;gr++)if(cr=ur[gr*2],hr=ur[gr*2+1],gr+1<ur.length/2?(dr=ur[(gr+1)*2],fr=ur[(gr+1)*2+1]):(dr=ur[(gr+1-ur.length/2)*2],fr=ur[(gr+1-ur.length/2)*2+1]),!(cr==ar&&dr==ar))if(cr>=ar&&ar>=dr||cr<=ar&&ar<=dr)pr=(ar-cr)/(dr-cr)*(fr-hr)+hr,pr>lr&&vr++;else continue;return vr%2!==0},pointInsidePolygon=function or(ar,lr,ur,cr,hr,dr,fr,pr,vr){var gr=new Array(ur.length),mr;pr[0]!=null?(mr=Math.atan(pr[1]/pr[0]),pr[0]<0?mr=mr+Math.PI/2:mr=-mr-Math.PI/2):mr=pr;for(var br=Math.cos(-mr),yr=Math.sin(-mr),xr=0;xr<gr.length/2;xr++)gr[xr*2]=dr/2*(ur[xr*2]*br-ur[xr*2+1]*yr),gr[xr*2+1]=fr/2*(ur[xr*2+1]*br+ur[xr*2]*yr),gr[xr*2]+=cr,gr[xr*2+1]+=hr;var Cr;if(vr>0){var Sr=expandPolygon(gr,-vr);Cr=joinLines(Sr)}else Cr=gr;return pointInsidePolygonPoints(ar,lr,Cr)},pointInsideRoundPolygon=function or(ar,lr,ur,cr,hr,dr,fr,pr){for(var vr=new Array(ur.length*2),gr=0;gr<pr.length;gr++){var mr=pr[gr];vr[gr*4+0]=mr.startX,vr[gr*4+1]=mr.startY,vr[gr*4+2]=mr.stopX,vr[gr*4+3]=mr.stopY;var br=Math.pow(mr.cx-ar,2)+Math.pow(mr.cy-lr,2);if(br<=Math.pow(mr.radius,2))return!0}return pointInsidePolygonPoints(ar,lr,vr)},joinLines=function or(ar){for(var lr=new Array(ar.length/2),ur,cr,hr,dr,fr,pr,vr,gr,mr=0;mr<ar.length/4;mr++){ur=ar[mr*4],cr=ar[mr*4+1],hr=ar[mr*4+2],dr=ar[mr*4+3],mr<ar.length/4-1?(fr=ar[(mr+1)*4],pr=ar[(mr+1)*4+1],vr=ar[(mr+1)*4+2],gr=ar[(mr+1)*4+3]):(fr=ar[0],pr=ar[1],vr=ar[2],gr=ar[3]);var br=finiteLinesIntersect(ur,cr,hr,dr,fr,pr,vr,gr,!0);lr[mr*2]=br[0],lr[mr*2+1]=br[1]}return lr},expandPolygon=function or(ar,lr){for(var ur=new Array(ar.length*2),cr,hr,dr,fr,pr=0;pr<ar.length/2;pr++){cr=ar[pr*2],hr=ar[pr*2+1],pr<ar.length/2-1?(dr=ar[(pr+1)*2],fr=ar[(pr+1)*2+1]):(dr=ar[0],fr=ar[1]);var vr=fr-hr,gr=-(dr-cr),mr=Math.sqrt(vr*vr+gr*gr),br=vr/mr,yr=gr/mr;ur[pr*4]=cr+br*lr,ur[pr*4+1]=hr+yr*lr,ur[pr*4+2]=dr+br*lr,ur[pr*4+3]=fr+yr*lr}return ur},intersectLineEllipse=function or(ar,lr,ur,cr,hr,dr){var fr=ur-ar,pr=cr-lr;fr/=hr,pr/=dr;var vr=Math.sqrt(fr*fr+pr*pr),gr=vr-1;if(gr<0)return[];var mr=gr/vr;return[(ur-ar)*mr+ar,(cr-lr)*mr+lr]},checkInEllipse=function or(ar,lr,ur,cr,hr,dr,fr){return ar-=hr,lr-=dr,ar/=ur/2+fr,lr/=cr/2+fr,ar*ar+lr*lr<=1},intersectLineCircle=function or(ar,lr,ur,cr,hr,dr,fr){var pr=[ur-ar,cr-lr],vr=[ar-hr,lr-dr],gr=pr[0]*pr[0]+pr[1]*pr[1],mr=2*(vr[0]*pr[0]+vr[1]*pr[1]),br=vr[0]*vr[0]+vr[1]*vr[1]-fr*fr,yr=mr*mr-4*gr*br;if(yr<0)return[];var xr=(-mr+Math.sqrt(yr))/(2*gr),Cr=(-mr-Math.sqrt(yr))/(2*gr),Sr=Math.min(xr,Cr),wr=Math.max(xr,Cr),Er=[];if(Sr>=0&&Sr<=1&&Er.push(Sr),wr>=0&&wr<=1&&Er.push(wr),Er.length===0)return[];var Ar=Er[0]*pr[0]+ar,Tr=Er[0]*pr[1]+lr;if(Er.length>1){if(Er[0]==Er[1])return[Ar,Tr];var Rr=Er[1]*pr[0]+ar,Pr=Er[1]*pr[1]+lr;return[Ar,Tr,Rr,Pr]}else return[Ar,Tr]},midOfThree=function or(ar,lr,ur){return lr<=ar&&ar<=ur||ur<=ar&&ar<=lr?ar:ar<=lr&&lr<=ur||ur<=lr&&lr<=ar?lr:ur},finiteLinesIntersect=function or(ar,lr,ur,cr,hr,dr,fr,pr,vr){var gr=ar-hr,mr=ur-ar,br=fr-hr,yr=lr-dr,xr=cr-lr,Cr=pr-dr,Sr=br*yr-Cr*gr,wr=mr*yr-xr*gr,Er=Cr*mr-br*xr;if(Er!==0){var Ar=Sr/Er,Tr=wr/Er,Rr=.001,Pr=0-Rr,_r=1+Rr;return Pr<=Ar&&Ar<=_r&&Pr<=Tr&&Tr<=_r?[ar+Ar*mr,lr+Ar*xr]:vr?[ar+Ar*mr,lr+Ar*xr]:[]}else return Sr===0||wr===0?midOfThree(ar,ur,fr)===fr?[fr,pr]:midOfThree(ar,ur,hr)===hr?[hr,dr]:midOfThree(hr,fr,ur)===ur?[ur,cr]:[]:[]},transformPoints=function or(ar,lr,ur,cr,hr){var dr=[],fr=cr/2,pr=hr/2,vr=lr,gr=ur;dr.push({x:vr+fr*ar[0],y:gr+pr*ar[1]});for(var mr=1;mr<ar.length/2;mr++)dr.push({x:vr+fr*ar[mr*2],y:gr+pr*ar[mr*2+1]});return dr},polygonIntersectLine=function or(ar,lr,ur,cr,hr,dr,fr,pr){var vr=[],gr,mr=new Array(ur.length),br=!0;dr==null&&(br=!1);var yr;if(br){for(var xr=0;xr<mr.length/2;xr++)mr[xr*2]=ur[xr*2]*dr+cr,mr[xr*2+1]=ur[xr*2+1]*fr+hr;if(pr>0){var Cr=expandPolygon(mr,-pr);yr=joinLines(Cr)}else yr=mr}else yr=ur;for(var Sr,wr,Er,Ar,Tr=0;Tr<yr.length/2;Tr++)Sr=yr[Tr*2],wr=yr[Tr*2+1],Tr<yr.length/2-1?(Er=yr[(Tr+1)*2],Ar=yr[(Tr+1)*2+1]):(Er=yr[0],Ar=yr[1]),gr=finiteLinesIntersect(ar,lr,cr,hr,Sr,wr,Er,Ar),gr.length!==0&&vr.push(gr[0],gr[1]);return vr},roundPolygonIntersectLine=function or(ar,lr,ur,cr,hr,dr,fr,pr,vr){var gr=[],mr,br=new Array(ur.length*2);vr.forEach(function(Er,Ar){Ar===0?(br[br.length-2]=Er.startX,br[br.length-1]=Er.startY):(br[Ar*4-2]=Er.startX,br[Ar*4-1]=Er.startY),br[Ar*4]=Er.stopX,br[Ar*4+1]=Er.stopY,mr=intersectLineCircle(ar,lr,cr,hr,Er.cx,Er.cy,Er.radius),mr.length!==0&&gr.push(mr[0],mr[1])});for(var yr=0;yr<br.length/4;yr++)mr=finiteLinesIntersect(ar,lr,cr,hr,br[yr*4],br[yr*4+1],br[yr*4+2],br[yr*4+3],!1),mr.length!==0&&gr.push(mr[0],mr[1]);if(gr.length>2){for(var xr=[gr[0],gr[1]],Cr=Math.pow(xr[0]-ar,2)+Math.pow(xr[1]-lr,2),Sr=1;Sr<gr.length/2;Sr++){var wr=Math.pow(gr[Sr*2]-ar,2)+Math.pow(gr[Sr*2+1]-lr,2);wr<=Cr&&(xr[0]=gr[Sr*2],xr[1]=gr[Sr*2+1],Cr=wr)}return xr}return gr},shortenIntersection=function or(ar,lr,ur){var cr=[ar[0]-lr[0],ar[1]-lr[1]],hr=Math.sqrt(cr[0]*cr[0]+cr[1]*cr[1]),dr=(hr-ur)/hr;return dr<0&&(dr=1e-5),[lr[0]+dr*cr[0],lr[1]+dr*cr[1]]},generateUnitNgonPointsFitToSquare=function or(ar,lr){var ur=generateUnitNgonPoints(ar,lr);return ur=fitPolygonToSquare(ur),ur},fitPolygonToSquare=function or(ar){for(var lr,ur,cr=ar.length/2,hr=1/0,dr=1/0,fr=-1/0,pr=-1/0,vr=0;vr<cr;vr++)lr=ar[2*vr],ur=ar[2*vr+1],hr=Math.min(hr,lr),fr=Math.max(fr,lr),dr=Math.min(dr,ur),pr=Math.max(pr,ur);for(var gr=2/(fr-hr),mr=2/(pr-dr),br=0;br<cr;br++)lr=ar[2*br]=ar[2*br]*gr,ur=ar[2*br+1]=ar[2*br+1]*mr,hr=Math.min(hr,lr),fr=Math.max(fr,lr),dr=Math.min(dr,ur),pr=Math.max(pr,ur);if(dr<-1)for(var yr=0;yr<cr;yr++)ur=ar[2*yr+1]=ar[2*yr+1]+(-1-dr);return ar},generateUnitNgonPoints=function or(ar,lr){var ur=1/ar*2*Math.PI,cr=ar%2===0?Math.PI/2+ur/2:Math.PI/2;cr+=lr;for(var hr=new Array(ar*2),dr,fr=0;fr<ar;fr++)dr=fr*ur+cr,hr[2*fr]=Math.cos(dr),hr[2*fr+1]=Math.sin(-dr);return hr},getRoundRectangleRadius=function or(ar,lr){return Math.min(ar/4,lr/4,8)},getRoundPolygonRadius=function or(ar,lr){return Math.min(ar/10,lr/10,8)},getCutRectangleCornerLength=function or(){return 8},bezierPtsToQuadCoeff=function or(ar,lr,ur){return[ar-2*lr+ur,2*(lr-ar),ar]},getBarrelCurveConstants=function or(ar,lr){return{heightOffset:Math.min(15,.05*lr),widthOffset:Math.min(100,.25*ar),ctrlPtOffsetPct:.05}};function satPolygonIntersection(or,ar){function lr(mr){for(var br=[],yr=0;yr<mr.length;yr++){var xr=mr[yr],Cr=mr[(yr+1)%mr.length],Sr={x:Cr.x-xr.x,y:Cr.y-xr.y},wr={x:-Sr.y,y:Sr.x},Er=Math.sqrt(wr.x*wr.x+wr.y*wr.y);br.push({x:wr.x/Er,y:wr.y/Er})}return br}function ur(mr,br){var yr=1/0,xr=-1/0,Cr=_createForOfIteratorHelper(mr),Sr;try{for(Cr.s();!(Sr=Cr.n()).done;){var wr=Sr.value,Er=wr.x*br.x+wr.y*br.y;yr=Math.min(yr,Er),xr=Math.max(xr,Er)}}catch(Ar){Cr.e(Ar)}finally{Cr.f()}return{min:yr,max:xr}}function cr(mr,br){return!(mr.max<br.min||br.max<mr.min)}var hr=[].concat(_toConsumableArray(lr(or)),_toConsumableArray(lr(ar))),dr=_createForOfIteratorHelper(hr),fr;try{for(dr.s();!(fr=dr.n()).done;){var pr=fr.value,vr=ur(or,pr),gr=ur(ar,pr);if(!cr(vr,gr))return!1}}catch(mr){dr.e(mr)}finally{dr.f()}return!0}var pageRankDefaults=defaults$g({dampingFactor:.8,precision:1e-6,iterations:200,weight:function or(ar){return 1}}),elesfn$o={pageRank:function or(ar){for(var lr=pageRankDefaults(ar),ur=lr.dampingFactor,cr=lr.precision,hr=lr.iterations,dr=lr.weight,fr=this._private.cy,pr=this.byGroup(),vr=pr.nodes,gr=pr.edges,mr=vr.length,br=mr*mr,yr=gr.length,xr=new Array(br),Cr=new Array(mr),Sr=(1-ur)/mr,wr=0;wr<mr;wr++){for(var Er=0;Er<mr;Er++){var Ar=wr*mr+Er;xr[Ar]=0}Cr[wr]=0}for(var Tr=0;Tr<yr;Tr++){var Rr=gr[Tr],Pr=Rr.data("source"),_r=Rr.data("target");if(Pr!==_r){var kr=vr.indexOfId(Pr),Dr=vr.indexOfId(_r),Nr=dr(Rr),Lr=Dr*mr+kr;xr[Lr]+=Nr,Cr[kr]+=Nr}}for(var Or=1/mr+Sr,Ir=0;Ir<mr;Ir++)if(Cr[Ir]===0)for(var Mr=0;Mr<mr;Mr++){var $r=Mr*mr+Ir;xr[$r]=Or}else for(var jr=0;jr<mr;jr++){var Fr=jr*mr+Ir;xr[Fr]=xr[Fr]/Cr[Ir]+Sr}for(var zr=new Array(mr),Hr=new Array(mr),Wr,Yr=0;Yr<mr;Yr++)zr[Yr]=1;for(var qr=0;qr<hr;qr++){for(var Br=0;Br<mr;Br++)Hr[Br]=0;for(var Ur=0;Ur<mr;Ur++)for(var Vr=0;Vr<mr;Vr++){var Xr=Ur*mr+Vr;Hr[Ur]+=xr[Xr]*zr[Vr]}inPlaceSumNormalize(Hr),Wr=zr,zr=Hr,Hr=Wr;for(var Zr=0,Jr=0;Jr<mr;Jr++){var Qr=Wr[Jr]-zr[Jr];Zr+=Qr*Qr}if(Zr<cr)break}var ga={rank:function(_i){return _i=fr.collection(_i)[0],zr[vr.indexOf(_i)]}};return ga}},defaults$f=defaults$g({root:null,weight:function or(ar){return 1},directed:!1,alpha:0}),elesfn$n={degreeCentralityNormalized:function or(ar){ar=defaults$f(ar);var lr=this.cy(),ur=this.nodes(),cr=ur.length;if(ar.directed){for(var gr={},mr={},br=0,yr=0,xr=0;xr<cr;xr++){var Cr=ur[xr],Sr=Cr.id();ar.root=Cr;var wr=this.degreeCentrality(ar);br<wr.indegree&&(br=wr.indegree),yr<wr.outdegree&&(yr=wr.outdegree),gr[Sr]=wr.indegree,mr[Sr]=wr.outdegree}return{indegree:function(Ar){return br==0?0:(string(Ar)&&(Ar=lr.filter(Ar)),gr[Ar.id()]/br)},outdegree:function(Ar){return yr===0?0:(string(Ar)&&(Ar=lr.filter(Ar)),mr[Ar.id()]/yr)}}}else{for(var hr={},dr=0,fr=0;fr<cr;fr++){var pr=ur[fr];ar.root=pr;var vr=this.degreeCentrality(ar);dr<vr.degree&&(dr=vr.degree),hr[pr.id()]=vr.degree}return{degree:function(Ar){return dr===0?0:(string(Ar)&&(Ar=lr.filter(Ar)),hr[Ar.id()]/dr)}}}},degreeCentrality:function or(ar){ar=defaults$f(ar);var lr=this.cy(),ur=this,cr=ar,hr=cr.root,dr=cr.weight,fr=cr.directed,pr=cr.alpha;if(hr=lr.collection(hr)[0],fr){for(var yr=hr.connectedEdges(),xr=yr.filter(function(Pr){return Pr.target().same(hr)&&ur.has(Pr)}),Cr=yr.filter(function(Pr){return Pr.source().same(hr)&&ur.has(Pr)}),Sr=xr.length,wr=Cr.length,Er=0,Ar=0,Tr=0;Tr<xr.length;Tr++)Er+=dr(xr[Tr]);for(var Rr=0;Rr<Cr.length;Rr++)Ar+=dr(Cr[Rr]);return{indegree:Math.pow(Sr,1-pr)*Math.pow(Er,pr),outdegree:Math.pow(wr,1-pr)*Math.pow(Ar,pr)}}else{for(var vr=hr.connectedEdges().intersection(ur),gr=vr.length,mr=0,br=0;br<vr.length;br++)mr+=dr(vr[br]);return{degree:Math.pow(gr,1-pr)*Math.pow(mr,pr)}}}};elesfn$n.dc=elesfn$n.degreeCentrality;elesfn$n.dcn=elesfn$n.degreeCentralityNormalised=elesfn$n.degreeCentralityNormalized;var defaults$e=defaults$g({harmonic:!0,weight:function or(){return 1},directed:!1,root:null}),elesfn$m={closenessCentralityNormalized:function or(ar){for(var lr=defaults$e(ar),ur=lr.harmonic,cr=lr.weight,hr=lr.directed,dr=this.cy(),fr={},pr=0,vr=this.nodes(),gr=this.floydWarshall({weight:cr,directed:hr}),mr=0;mr<vr.length;mr++){for(var br=0,yr=vr[mr],xr=0;xr<vr.length;xr++)if(mr!==xr){var Cr=gr.distance(yr,vr[xr]);ur?br+=1/Cr:br+=Cr}ur||(br=1/br),pr<br&&(pr=br),fr[yr.id()]=br}return{closeness:function(wr){return pr==0?0:(string(wr)?wr=dr.filter(wr)[0].id():wr=wr.id(),fr[wr]/pr)}}},closenessCentrality:function or(ar){var lr=defaults$e(ar),ur=lr.root,cr=lr.weight,hr=lr.directed,dr=lr.harmonic;ur=this.filter(ur)[0];for(var fr=this.dijkstra({root:ur,weight:cr,directed:hr}),pr=0,vr=this.nodes(),gr=0;gr<vr.length;gr++){var mr=vr[gr];if(!mr.same(ur)){var br=fr.distanceTo(mr);dr?pr+=1/br:pr+=br}}return dr?pr:1/pr}};elesfn$m.cc=elesfn$m.closenessCentrality;elesfn$m.ccn=elesfn$m.closenessCentralityNormalised=elesfn$m.closenessCentralityNormalized;var defaults$d=defaults$g({weight:null,directed:!1}),elesfn$l={betweennessCentrality:function or(ar){for(var lr=defaults$d(ar),ur=lr.directed,cr=lr.weight,hr=cr!=null,dr=this.cy(),fr=this.nodes(),pr={},vr={},gr=0,mr={set:function(Ar,Tr){vr[Ar]=Tr,Tr>gr&&(gr=Tr)},get:function(Ar){return vr[Ar]}},br=0;br<fr.length;br++){var yr=fr[br],xr=yr.id();ur?pr[xr]=yr.outgoers().nodes():pr[xr]=yr.openNeighborhood().nodes(),mr.set(xr,0)}for(var Cr=function(){for(var Ar=fr[Sr].id(),Tr=[],Rr={},Pr={},_r={},kr=new Heap(function(Ur,Vr){return _r[Ur]-_r[Vr]}),Dr=0;Dr<fr.length;Dr++){var Nr=fr[Dr].id();Rr[Nr]=[],Pr[Nr]=0,_r[Nr]=1/0}for(Pr[Ar]=1,_r[Ar]=0,kr.push(Ar);!kr.empty();){var Lr=kr.pop();if(Tr.push(Lr),hr)for(var Or=0;Or<pr[Lr].length;Or++){var Ir=pr[Lr][Or],Mr=dr.getElementById(Lr),$r=void 0;Mr.edgesTo(Ir).length>0?$r=Mr.edgesTo(Ir)[0]:$r=Ir.edgesTo(Mr)[0];var jr=cr($r);Ir=Ir.id(),_r[Ir]>_r[Lr]+jr&&(_r[Ir]=_r[Lr]+jr,kr.nodes.indexOf(Ir)<0?kr.push(Ir):kr.updateItem(Ir),Pr[Ir]=0,Rr[Ir]=[]),_r[Ir]==_r[Lr]+jr&&(Pr[Ir]=Pr[Ir]+Pr[Lr],Rr[Ir].push(Lr))}else for(var Fr=0;Fr<pr[Lr].length;Fr++){var zr=pr[Lr][Fr].id();_r[zr]==1/0&&(kr.push(zr),_r[zr]=_r[Lr]+1),_r[zr]==_r[Lr]+1&&(Pr[zr]=Pr[zr]+Pr[Lr],Rr[zr].push(Lr))}}for(var Hr={},Wr=0;Wr<fr.length;Wr++)Hr[fr[Wr].id()]=0;for(;Tr.length>0;){for(var Yr=Tr.pop(),qr=0;qr<Rr[Yr].length;qr++){var Br=Rr[Yr][qr];Hr[Br]=Hr[Br]+Pr[Br]/Pr[Yr]*(1+Hr[Yr])}Yr!=fr[Sr].id()&&mr.set(Yr,mr.get(Yr)+Hr[Yr])}},Sr=0;Sr<fr.length;Sr++)Cr();var wr={betweenness:function(Ar){var Tr=dr.collection(Ar).id();return mr.get(Tr)},betweennessNormalized:function(Ar){if(gr==0)return 0;var Tr=dr.collection(Ar).id();return mr.get(Tr)/gr}};return wr.betweennessNormalised=wr.betweennessNormalized,wr}};elesfn$l.bc=elesfn$l.betweennessCentrality;var defaults$c=defaults$g({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(or){return 1}]}),setOptions$3=function or(ar){return defaults$c(ar)},getSimilarity$1=function or(ar,lr){for(var ur=0,cr=0;cr<lr.length;cr++)ur+=lr[cr](ar);return ur},addLoops=function or(ar,lr,ur){for(var cr=0;cr<lr;cr++)ar[cr*lr+cr]=ur},normalize=function or(ar,lr){for(var ur,cr=0;cr<lr;cr++){ur=0;for(var hr=0;hr<lr;hr++)ur+=ar[hr*lr+cr];for(var dr=0;dr<lr;dr++)ar[dr*lr+cr]=ar[dr*lr+cr]/ur}},mmult=function or(ar,lr,ur){for(var cr=new Array(ur*ur),hr=0;hr<ur;hr++){for(var dr=0;dr<ur;dr++)cr[hr*ur+dr]=0;for(var fr=0;fr<ur;fr++)for(var pr=0;pr<ur;pr++)cr[hr*ur+pr]+=ar[hr*ur+fr]*lr[fr*ur+pr]}return cr},expand=function or(ar,lr,ur){for(var cr=ar.slice(0),hr=1;hr<ur;hr++)ar=mmult(ar,cr,lr);return ar},inflate=function or(ar,lr,ur){for(var cr=new Array(lr*lr),hr=0;hr<lr*lr;hr++)cr[hr]=Math.pow(ar[hr],ur);return normalize(cr,lr),cr},hasConverged=function or(ar,lr,ur,cr){for(var hr=0;hr<ur;hr++){var dr=Math.round(ar[hr]*Math.pow(10,cr))/Math.pow(10,cr),fr=Math.round(lr[hr]*Math.pow(10,cr))/Math.pow(10,cr);if(dr!==fr)return!1}return!0},assign$2=function or(ar,lr,ur,cr){for(var hr=[],dr=0;dr<lr;dr++){for(var fr=[],pr=0;pr<lr;pr++)Math.round(ar[dr*lr+pr]*1e3)/1e3>0&&fr.push(ur[pr]);fr.length!==0&&hr.push(cr.collection(fr))}return hr},isDuplicate=function or(ar,lr){for(var ur=0;ur<ar.length;ur++)if(!lr[ur]||ar[ur].id()!==lr[ur].id())return!1;return!0},removeDuplicates=function or(ar){for(var lr=0;lr<ar.length;lr++)for(var ur=0;ur<ar.length;ur++)lr!=ur&&isDuplicate(ar[lr],ar[ur])&&ar.splice(ur,1);return ar},markovClustering=function or(ar){for(var lr=this.nodes(),ur=this.edges(),cr=this.cy(),hr=setOptions$3(ar),dr={},fr=0;fr<lr.length;fr++)dr[lr[fr].id()]=fr;for(var pr=lr.length,vr=pr*pr,gr=new Array(vr),mr,br=0;br<vr;br++)gr[br]=0;for(var yr=0;yr<ur.length;yr++){var xr=ur[yr],Cr=dr[xr.source().id()],Sr=dr[xr.target().id()],wr=getSimilarity$1(xr,hr.attributes);gr[Cr*pr+Sr]+=wr,gr[Sr*pr+Cr]+=wr}addLoops(gr,pr,hr.multFactor),normalize(gr,pr);for(var Er=!0,Ar=0;Er&&Ar<hr.maxIterations;)Er=!1,mr=expand(gr,pr,hr.expandFactor),gr=inflate(mr,pr,hr.inflateFactor),hasConverged(gr,mr,vr,4)||(Er=!0),Ar++;var Tr=assign$2(gr,pr,lr,cr);return Tr=removeDuplicates(Tr),Tr},markovClustering$1={markovClustering,mcl:markovClustering},identity$1=function or(ar){return ar},absDiff=function or(ar,lr){return Math.abs(lr-ar)},addAbsDiff=function or(ar,lr,ur){return ar+absDiff(lr,ur)},addSquaredDiff=function or(ar,lr,ur){return ar+Math.pow(ur-lr,2)},sqrt=function or(ar){return Math.sqrt(ar)},maxAbsDiff=function or(ar,lr,ur){return Math.max(ar,absDiff(lr,ur))},getDistance=function or(ar,lr,ur,cr,hr){for(var dr=arguments.length>5&&arguments[5]!==void 0?arguments[5]:identity$1,fr=cr,pr,vr,gr=0;gr<ar;gr++)pr=lr(gr),vr=ur(gr),fr=hr(fr,pr,vr);return dr(fr)},distances={euclidean:function or(ar,lr,ur){return ar>=2?getDistance(ar,lr,ur,0,addSquaredDiff,sqrt):getDistance(ar,lr,ur,0,addAbsDiff)},squaredEuclidean:function or(ar,lr,ur){return getDistance(ar,lr,ur,0,addSquaredDiff)},manhattan:function or(ar,lr,ur){return getDistance(ar,lr,ur,0,addAbsDiff)},max:function or(ar,lr,ur){return getDistance(ar,lr,ur,-1/0,maxAbsDiff)}};distances["squared-euclidean"]=distances.squaredEuclidean;distances.squaredeuclidean=distances.squaredEuclidean;function clusteringDistance(or,ar,lr,ur,cr,hr){var dr;return fn$6(or)?dr=or:dr=distances[or]||distances.euclidean,ar===0&&fn$6(or)?dr(cr,hr):dr(ar,lr,ur,cr,hr)}var defaults$b=defaults$g({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),setOptions$2=function or(ar){return defaults$b(ar)},getDist=function or(ar,lr,ur,cr,hr){var dr=hr!=="kMedoids",fr=dr?function(mr){return ur[mr]}:function(mr){return cr[mr](ur)},pr=function(br){return cr[br](lr)},vr=ur,gr=lr;return clusteringDistance(ar,cr.length,fr,pr,vr,gr)},randomCentroids=function or(ar,lr,ur){for(var cr=ur.length,hr=new Array(cr),dr=new Array(cr),fr=new Array(lr),pr=null,vr=0;vr<cr;vr++)hr[vr]=ar.min(ur[vr]).value,dr[vr]=ar.max(ur[vr]).value;for(var gr=0;gr<lr;gr++){pr=[];for(var mr=0;mr<cr;mr++)pr[mr]=Math.random()*(dr[mr]-hr[mr])+hr[mr];fr[gr]=pr}return fr},classify=function or(ar,lr,ur,cr,hr){for(var dr=1/0,fr=0,pr=0;pr<lr.length;pr++){var vr=getDist(ur,ar,lr[pr],cr,hr);vr<dr&&(dr=vr,fr=pr)}return fr},buildCluster=function or(ar,lr,ur){for(var cr=[],hr=null,dr=0;dr<lr.length;dr++)hr=lr[dr],ur[hr.id()]===ar&&cr.push(hr);return cr},haveValuesConverged=function or(ar,lr,ur){return Math.abs(lr-ar)<=ur},haveMatricesConverged=function or(ar,lr,ur){for(var cr=0;cr<ar.length;cr++)for(var hr=0;hr<ar[cr].length;hr++){var dr=Math.abs(ar[cr][hr]-lr[cr][hr]);if(dr>ur)return!1}return!0},seenBefore=function or(ar,lr,ur){for(var cr=0;cr<ur;cr++)if(ar===lr[cr])return!0;return!1},randomMedoids=function or(ar,lr){var ur=new Array(lr);if(ar.length<50)for(var cr=0;cr<lr;cr++){for(var hr=ar[Math.floor(Math.random()*ar.length)];seenBefore(hr,ur,cr);)hr=ar[Math.floor(Math.random()*ar.length)];ur[cr]=hr}else for(var dr=0;dr<lr;dr++)ur[dr]=ar[Math.floor(Math.random()*ar.length)];return ur},findCost=function or(ar,lr,ur){for(var cr=0,hr=0;hr<lr.length;hr++)cr+=getDist("manhattan",lr[hr],ar,ur,"kMedoids");return cr},kMeans=function or(ar){var lr=this.cy(),ur=this.nodes(),cr=null,hr=setOptions$2(ar),dr=new Array(hr.k),fr={},pr;hr.testMode?typeof hr.testCentroids=="number"?(hr.testCentroids,pr=randomCentroids(ur,hr.k,hr.attributes)):_typeof(hr.testCentroids)==="object"?pr=hr.testCentroids:pr=randomCentroids(ur,hr.k,hr.attributes):pr=randomCentroids(ur,hr.k,hr.attributes);for(var vr=!0,gr=0;vr&&gr<hr.maxIterations;){for(var mr=0;mr<ur.length;mr++)cr=ur[mr],fr[cr.id()]=classify(cr,pr,hr.distance,hr.attributes,"kMeans");vr=!1;for(var br=0;br<hr.k;br++){var yr=buildCluster(br,ur,fr);if(yr.length!==0){for(var xr=hr.attributes.length,Cr=pr[br],Sr=new Array(xr),wr=new Array(xr),Er=0;Er<xr;Er++){wr[Er]=0;for(var Ar=0;Ar<yr.length;Ar++)cr=yr[Ar],wr[Er]+=hr.attributes[Er](cr);Sr[Er]=wr[Er]/yr.length,haveValuesConverged(Sr[Er],Cr[Er],hr.sensitivityThreshold)||(vr=!0)}pr[br]=Sr,dr[br]=lr.collection(yr)}}gr++}return dr},kMedoids=function or(ar){var lr=this.cy(),ur=this.nodes(),cr=null,hr=setOptions$2(ar),dr=new Array(hr.k),fr,pr={},vr,gr=new Array(hr.k);hr.testMode?typeof hr.testCentroids=="number"||(_typeof(hr.testCentroids)==="object"?fr=hr.testCentroids:fr=randomMedoids(ur,hr.k)):fr=randomMedoids(ur,hr.k);for(var mr=!0,br=0;mr&&br<hr.maxIterations;){for(var yr=0;yr<ur.length;yr++)cr=ur[yr],pr[cr.id()]=classify(cr,fr,hr.distance,hr.attributes,"kMedoids");mr=!1;for(var xr=0;xr<fr.length;xr++){var Cr=buildCluster(xr,ur,pr);if(Cr.length!==0){gr[xr]=findCost(fr[xr],Cr,hr.attributes);for(var Sr=0;Sr<Cr.length;Sr++)vr=findCost(Cr[Sr],Cr,hr.attributes),vr<gr[xr]&&(gr[xr]=vr,fr[xr]=Cr[Sr],mr=!0);dr[xr]=lr.collection(Cr)}}br++}return dr},updateCentroids=function or(ar,lr,ur,cr,hr){for(var dr,fr,pr=0;pr<lr.length;pr++)for(var vr=0;vr<ar.length;vr++)cr[pr][vr]=Math.pow(ur[pr][vr],hr.m);for(var gr=0;gr<ar.length;gr++)for(var mr=0;mr<hr.attributes.length;mr++){dr=0,fr=0;for(var br=0;br<lr.length;br++)dr+=cr[br][gr]*hr.attributes[mr](lr[br]),fr+=cr[br][gr];ar[gr][mr]=dr/fr}},updateMembership=function or(ar,lr,ur,cr,hr){for(var dr=0;dr<ar.length;dr++)lr[dr]=ar[dr].slice();for(var fr,pr,vr,gr=2/(hr.m-1),mr=0;mr<ur.length;mr++)for(var br=0;br<cr.length;br++){fr=0;for(var yr=0;yr<ur.length;yr++)pr=getDist(hr.distance,cr[br],ur[mr],hr.attributes,"cmeans"),vr=getDist(hr.distance,cr[br],ur[yr],hr.attributes,"cmeans"),fr+=Math.pow(pr/vr,gr);ar[br][mr]=1/fr}},assign$1=function or(ar,lr,ur,cr){for(var hr=new Array(ur.k),dr=0;dr<hr.length;dr++)hr[dr]=[];for(var fr,pr,vr=0;vr<lr.length;vr++){fr=-1/0,pr=-1;for(var gr=0;gr<lr[0].length;gr++)lr[vr][gr]>fr&&(fr=lr[vr][gr],pr=gr);hr[pr].push(ar[vr])}for(var mr=0;mr<hr.length;mr++)hr[mr]=cr.collection(hr[mr]);return hr},fuzzyCMeans=function or(ar){var lr=this.cy(),ur=this.nodes(),cr=setOptions$2(ar),hr,dr,fr,pr,vr;pr=new Array(ur.length);for(var gr=0;gr<ur.length;gr++)pr[gr]=new Array(cr.k);fr=new Array(ur.length);for(var mr=0;mr<ur.length;mr++)fr[mr]=new Array(cr.k);for(var br=0;br<ur.length;br++){for(var yr=0,xr=0;xr<cr.k;xr++)fr[br][xr]=Math.random(),yr+=fr[br][xr];for(var Cr=0;Cr<cr.k;Cr++)fr[br][Cr]=fr[br][Cr]/yr}dr=new Array(cr.k);for(var Sr=0;Sr<cr.k;Sr++)dr[Sr]=new Array(cr.attributes.length);vr=new Array(ur.length);for(var wr=0;wr<ur.length;wr++)vr[wr]=new Array(cr.k);for(var Er=!0,Ar=0;Er&&Ar<cr.maxIterations;)Er=!1,updateCentroids(dr,ur,fr,vr,cr),updateMembership(fr,pr,dr,ur,cr),haveMatricesConverged(fr,pr,cr.sensitivityThreshold)||(Er=!0),Ar++;return hr=assign$1(ur,fr,cr,lr),{clusters:hr,degreeOfMembership:fr}},kClustering={kMeans,kMedoids,fuzzyCMeans,fcm:fuzzyCMeans},defaults$a=defaults$g({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),linkageAliases={single:"min",complete:"max"},setOptions$1=function or(ar){var lr=defaults$a(ar),ur=linkageAliases[lr.linkage];return ur!=null&&(lr.linkage=ur),lr},mergeClosest=function or(ar,lr,ur,cr,hr){for(var dr=0,fr=1/0,pr,vr=hr.attributes,gr=function(Dr,Nr){return clusteringDistance(hr.distance,vr.length,function(Lr){return vr[Lr](Dr)},function(Lr){return vr[Lr](Nr)},Dr,Nr)},mr=0;mr<ar.length;mr++){var br=ar[mr].key,yr=ur[br][cr[br]];yr<fr&&(dr=br,fr=yr)}if(hr.mode==="threshold"&&fr>=hr.threshold||hr.mode==="dendrogram"&&ar.length===1)return!1;var xr=lr[dr],Cr=lr[cr[dr]],Sr;hr.mode==="dendrogram"?Sr={left:xr,right:Cr,key:xr.key}:Sr={value:xr.value.concat(Cr.value),key:xr.key},ar[xr.index]=Sr,ar.splice(Cr.index,1),lr[xr.key]=Sr;for(var wr=0;wr<ar.length;wr++){var Er=ar[wr];xr.key===Er.key?pr=1/0:hr.linkage==="min"?(pr=ur[xr.key][Er.key],ur[xr.key][Er.key]>ur[Cr.key][Er.key]&&(pr=ur[Cr.key][Er.key])):hr.linkage==="max"?(pr=ur[xr.key][Er.key],ur[xr.key][Er.key]<ur[Cr.key][Er.key]&&(pr=ur[Cr.key][Er.key])):hr.linkage==="mean"?pr=(ur[xr.key][Er.key]*xr.size+ur[Cr.key][Er.key]*Cr.size)/(xr.size+Cr.size):hr.mode==="dendrogram"?pr=gr(Er.value,xr.value):pr=gr(Er.value[0],xr.value[0]),ur[xr.key][Er.key]=ur[Er.key][xr.key]=pr}for(var Ar=0;Ar<ar.length;Ar++){var Tr=ar[Ar].key;if(cr[Tr]===xr.key||cr[Tr]===Cr.key){for(var Rr=Tr,Pr=0;Pr<ar.length;Pr++){var _r=ar[Pr].key;ur[Tr][_r]<ur[Tr][Rr]&&(Rr=_r)}cr[Tr]=Rr}ar[Ar].index=Ar}return xr.key=Cr.key=xr.index=Cr.index=null,!0},_getAllChildren=function or(ar,lr,ur){ar&&(ar.value?lr.push(ar.value):(ar.left&&_getAllChildren(ar.left,lr),ar.right&&_getAllChildren(ar.right,lr)))},_buildDendrogram=function or(ar,lr){if(!ar)return"";if(ar.left&&ar.right){var ur=_buildDendrogram(ar.left,lr),cr=_buildDendrogram(ar.right,lr),hr=lr.add({group:"nodes",data:{id:ur+","+cr}});return lr.add({group:"edges",data:{source:ur,target:hr.id()}}),lr.add({group:"edges",data:{source:cr,target:hr.id()}}),hr.id()}else if(ar.value)return ar.value.id()},_buildClustersFromTree=function or(ar,lr,ur){if(!ar)return[];var cr=[],hr=[],dr=[];return lr===0?(ar.left&&_getAllChildren(ar.left,cr),ar.right&&_getAllChildren(ar.right,hr),dr=cr.concat(hr),[ur.collection(dr)]):lr===1?ar.value?[ur.collection(ar.value)]:(ar.left&&_getAllChildren(ar.left,cr),ar.right&&_getAllChildren(ar.right,hr),[ur.collection(cr),ur.collection(hr)]):ar.value?[ur.collection(ar.value)]:(ar.left&&(cr=_buildClustersFromTree(ar.left,lr-1,ur)),ar.right&&(hr=_buildClustersFromTree(ar.right,lr-1,ur)),cr.concat(hr))},hierarchicalClustering=function or(ar){for(var lr=this.cy(),ur=this.nodes(),cr=setOptions$1(ar),hr=cr.attributes,dr=function(Ar,Tr){return clusteringDistance(cr.distance,hr.length,function(Rr){return hr[Rr](Ar)},function(Rr){return hr[Rr](Tr)},Ar,Tr)},fr=[],pr=[],vr=[],gr=[],mr=0;mr<ur.length;mr++){var br={value:cr.mode==="dendrogram"?ur[mr]:[ur[mr]],key:mr,index:mr};fr[mr]=br,gr[mr]=br,pr[mr]=[],vr[mr]=0}for(var yr=0;yr<fr.length;yr++)for(var xr=0;xr<=yr;xr++){var Cr=void 0;cr.mode==="dendrogram"?Cr=yr===xr?1/0:dr(fr[yr].value,fr[xr].value):Cr=yr===xr?1/0:dr(fr[yr].value[0],fr[xr].value[0]),pr[yr][xr]=Cr,pr[xr][yr]=Cr,Cr<pr[yr][vr[yr]]&&(vr[yr]=xr)}for(var Sr=mergeClosest(fr,gr,pr,vr,cr);Sr;)Sr=mergeClosest(fr,gr,pr,vr,cr);var wr;return cr.mode==="dendrogram"?(wr=_buildClustersFromTree(fr[0],cr.dendrogramDepth,lr),cr.addDendrogram&&_buildDendrogram(fr[0],lr)):(wr=new Array(fr.length),fr.forEach(function(Er,Ar){Er.key=Er.index=null,wr[Ar]=lr.collection(Er.value)})),wr},hierarchicalClustering$1={hierarchicalClustering,hca:hierarchicalClustering},defaults$9=defaults$g({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),setOptions=function or(ar){var lr=ar.damping,ur=ar.preference;.5<=lr&&lr<1||error("Damping must range on [0.5, 1).  Got: ".concat(lr));var cr=["median","mean","min","max"];return cr.some(function(hr){return hr===ur})||number$1(ur)||error("Preference must be one of [".concat(cr.map(function(hr){return"'".concat(hr,"'")}).join(", "),"] or a number.  Got: ").concat(ur)),defaults$9(ar)},getSimilarity=function or(ar,lr,ur,cr){var hr=function(fr,pr){return cr[pr](fr)};return-clusteringDistance(ar,cr.length,function(dr){return hr(lr,dr)},function(dr){return hr(ur,dr)},lr,ur)},getPreference=function or(ar,lr){var ur=null;return lr==="median"?ur=median(ar):lr==="mean"?ur=mean(ar):lr==="min"?ur=min(ar):lr==="max"?ur=max(ar):ur=lr,ur},findExemplars=function or(ar,lr,ur){for(var cr=[],hr=0;hr<ar;hr++)lr[hr*ar+hr]+ur[hr*ar+hr]>0&&cr.push(hr);return cr},assignClusters=function or(ar,lr,ur){for(var cr=[],hr=0;hr<ar;hr++){for(var dr=-1,fr=-1/0,pr=0;pr<ur.length;pr++){var vr=ur[pr];lr[hr*ar+vr]>fr&&(dr=vr,fr=lr[hr*ar+vr])}dr>0&&cr.push(dr)}for(var gr=0;gr<ur.length;gr++)cr[ur[gr]]=ur[gr];return cr},assign=function or(ar,lr,ur){for(var cr=assignClusters(ar,lr,ur),hr=0;hr<ur.length;hr++){for(var dr=[],fr=0;fr<cr.length;fr++)cr[fr]===ur[hr]&&dr.push(fr);for(var pr=-1,vr=-1/0,gr=0;gr<dr.length;gr++){for(var mr=0,br=0;br<dr.length;br++)mr+=lr[dr[br]*ar+dr[gr]];mr>vr&&(pr=gr,vr=mr)}ur[hr]=dr[pr]}return cr=assignClusters(ar,lr,ur),cr},affinityPropagation=function or(ar){for(var lr=this.cy(),ur=this.nodes(),cr=setOptions(ar),hr={},dr=0;dr<ur.length;dr++)hr[ur[dr].id()]=dr;var fr,pr,vr,gr,mr,br;fr=ur.length,pr=fr*fr,vr=new Array(pr);for(var yr=0;yr<pr;yr++)vr[yr]=-1/0;for(var xr=0;xr<fr;xr++)for(var Cr=0;Cr<fr;Cr++)xr!==Cr&&(vr[xr*fr+Cr]=getSimilarity(cr.distance,ur[xr],ur[Cr],cr.attributes));gr=getPreference(vr,cr.preference);for(var Sr=0;Sr<fr;Sr++)vr[Sr*fr+Sr]=gr;mr=new Array(pr);for(var wr=0;wr<pr;wr++)mr[wr]=0;br=new Array(pr);for(var Er=0;Er<pr;Er++)br[Er]=0;for(var Ar=new Array(fr),Tr=new Array(fr),Rr=new Array(fr),Pr=0;Pr<fr;Pr++)Ar[Pr]=0,Tr[Pr]=0,Rr[Pr]=0;for(var _r=new Array(fr*cr.minIterations),kr=0;kr<_r.length;kr++)_r[kr]=0;var Dr;for(Dr=0;Dr<cr.maxIterations;Dr++){for(var Nr=0;Nr<fr;Nr++){for(var Lr=-1/0,Or=-1/0,Ir=-1,Mr=0,$r=0;$r<fr;$r++)Ar[$r]=mr[Nr*fr+$r],Mr=br[Nr*fr+$r]+vr[Nr*fr+$r],Mr>=Lr?(Or=Lr,Lr=Mr,Ir=$r):Mr>Or&&(Or=Mr);for(var jr=0;jr<fr;jr++)mr[Nr*fr+jr]=(1-cr.damping)*(vr[Nr*fr+jr]-Lr)+cr.damping*Ar[jr];mr[Nr*fr+Ir]=(1-cr.damping)*(vr[Nr*fr+Ir]-Or)+cr.damping*Ar[Ir]}for(var Fr=0;Fr<fr;Fr++){for(var zr=0,Hr=0;Hr<fr;Hr++)Ar[Hr]=br[Hr*fr+Fr],Tr[Hr]=Math.max(0,mr[Hr*fr+Fr]),zr+=Tr[Hr];zr-=Tr[Fr],Tr[Fr]=mr[Fr*fr+Fr],zr+=Tr[Fr];for(var Wr=0;Wr<fr;Wr++)br[Wr*fr+Fr]=(1-cr.damping)*Math.min(0,zr-Tr[Wr])+cr.damping*Ar[Wr];br[Fr*fr+Fr]=(1-cr.damping)*(zr-Tr[Fr])+cr.damping*Ar[Fr]}for(var Yr=0,qr=0;qr<fr;qr++){var Br=br[qr*fr+qr]+mr[qr*fr+qr]>0?1:0;_r[Dr%cr.minIterations*fr+qr]=Br,Yr+=Br}if(Yr>0&&(Dr>=cr.minIterations-1||Dr==cr.maxIterations-1)){for(var Ur=0,Vr=0;Vr<fr;Vr++){Rr[Vr]=0;for(var Xr=0;Xr<cr.minIterations;Xr++)Rr[Vr]+=_r[Xr*fr+Vr];(Rr[Vr]===0||Rr[Vr]===cr.minIterations)&&Ur++}if(Ur===fr)break}}for(var Zr=findExemplars(fr,mr,br),Jr=assign(fr,vr,Zr),Qr={},ga=0;ga<Zr.length;ga++)Qr[Zr[ga]]=[];for(var ba=0;ba<ur.length;ba++){var _i=hr[ur[ba].id()],os=Jr[_i];os!=null&&Qr[os].push(ur[ba])}for(var ls=new Array(Zr.length),ys=0;ys<Zr.length;ys++)ls[ys]=lr.collection(Qr[Zr[ys]]);return ls},affinityPropagation$1={affinityPropagation,ap:affinityPropagation},hierholzerDefaults=defaults$g({root:void 0,directed:!1}),elesfn$k={hierholzer:function or(ar){if(!plainObject(ar)){var lr=arguments;ar={root:lr[0],directed:lr[1]}}var ur=hierholzerDefaults(ar),cr=ur.root,hr=ur.directed,dr=this,fr=!1,pr,vr,gr;cr&&(gr=string(cr)?this.filter(cr)[0].id():cr[0].id());var mr={},br={};hr?dr.forEach(function(Er){var Ar=Er.id();if(Er.isNode()){var Tr=Er.indegree(!0),Rr=Er.outdegree(!0),Pr=Tr-Rr,_r=Rr-Tr;Pr==1?pr?fr=!0:pr=Ar:_r==1?vr?fr=!0:vr=Ar:(_r>1||Pr>1)&&(fr=!0),mr[Ar]=[],Er.outgoers().forEach(function(kr){kr.isEdge()&&mr[Ar].push(kr.id())})}else br[Ar]=[void 0,Er.target().id()]}):dr.forEach(function(Er){var Ar=Er.id();if(Er.isNode()){var Tr=Er.degree(!0);Tr%2&&(pr?vr?fr=!0:vr=Ar:pr=Ar),mr[Ar]=[],Er.connectedEdges().forEach(function(Rr){return mr[Ar].push(Rr.id())})}else br[Ar]=[Er.source().id(),Er.target().id()]});var yr={found:!1,trail:void 0};if(fr)return yr;if(vr&&pr)if(hr){if(gr&&vr!=gr)return yr;gr=vr}else{if(gr&&vr!=gr&&pr!=gr)return yr;gr||(gr=vr)}else gr||(gr=dr[0].id());var xr=function(Ar){for(var Tr=Ar,Rr=[Ar],Pr,_r,kr;mr[Tr].length;)Pr=mr[Tr].shift(),_r=br[Pr][0],kr=br[Pr][1],Tr!=kr?(mr[kr]=mr[kr].filter(function(Dr){return Dr!=Pr}),Tr=kr):!hr&&Tr!=_r&&(mr[_r]=mr[_r].filter(function(Dr){return Dr!=Pr}),Tr=_r),Rr.unshift(Pr),Rr.unshift(Tr);return Rr},Cr=[],Sr=[];for(Sr=xr(gr);Sr.length!=1;)mr[Sr[0]].length==0?(Cr.unshift(dr.getElementById(Sr.shift())),Cr.unshift(dr.getElementById(Sr.shift()))):Sr=xr(Sr.shift()).concat(Sr);Cr.unshift(dr.getElementById(Sr.shift()));for(var wr in mr)if(mr[wr].length)return yr;return yr.found=!0,yr.trail=this.spawn(Cr,!0),yr}},hopcroftTarjanBiconnected=function or(){var ar=this,lr={},ur=0,cr=0,hr=[],dr=[],fr={},pr=function(br,yr){for(var xr=dr.length-1,Cr=[],Sr=ar.spawn();dr[xr].x!=br||dr[xr].y!=yr;)Cr.push(dr.pop().edge),xr--;Cr.push(dr.pop().edge),Cr.forEach(function(wr){var Er=wr.connectedNodes().intersection(ar);Sr.merge(wr),Er.forEach(function(Ar){var Tr=Ar.id(),Rr=Ar.connectedEdges().intersection(ar);Sr.merge(Ar),lr[Tr].cutVertex?Sr.merge(Rr.filter(function(Pr){return Pr.isLoop()})):Sr.merge(Rr)})}),hr.push(Sr)},vr=function(br,yr,xr){br===xr&&(cr+=1),lr[yr]={id:ur,low:ur++,cutVertex:!1};var Cr=ar.getElementById(yr).connectedEdges().intersection(ar);if(Cr.size()===0)hr.push(ar.spawn(ar.getElementById(yr)));else{var Sr,wr,Er,Ar;Cr.forEach(function(Tr){Sr=Tr.source().id(),wr=Tr.target().id(),Er=Sr===yr?wr:Sr,Er!==xr&&(Ar=Tr.id(),fr[Ar]||(fr[Ar]=!0,dr.push({x:yr,y:Er,edge:Tr})),Er in lr?lr[yr].low=Math.min(lr[yr].low,lr[Er].id):(vr(br,Er,yr),lr[yr].low=Math.min(lr[yr].low,lr[Er].low),lr[yr].id<=lr[Er].low&&(lr[yr].cutVertex=!0,pr(yr,Er))))})}};ar.forEach(function(mr){if(mr.isNode()){var br=mr.id();br in lr||(cr=0,vr(br,br),lr[br].cutVertex=cr>1)}});var gr=Object.keys(lr).filter(function(mr){return lr[mr].cutVertex}).map(function(mr){return ar.getElementById(mr)});return{cut:ar.spawn(gr),components:hr}},hopcroftTarjanBiconnected$1={hopcroftTarjanBiconnected,htbc:hopcroftTarjanBiconnected,htb:hopcroftTarjanBiconnected,hopcroftTarjanBiconnectedComponents:hopcroftTarjanBiconnected},tarjanStronglyConnected=function or(){var ar=this,lr={},ur=0,cr=[],hr=[],dr=ar.spawn(ar),fr=function(vr){hr.push(vr),lr[vr]={index:ur,low:ur++,explored:!1};var gr=ar.getElementById(vr).connectedEdges().intersection(ar);if(gr.forEach(function(Cr){var Sr=Cr.target().id();Sr!==vr&&(Sr in lr||fr(Sr),lr[Sr].explored||(lr[vr].low=Math.min(lr[vr].low,lr[Sr].low)))}),lr[vr].index===lr[vr].low){for(var mr=ar.spawn();;){var br=hr.pop();if(mr.merge(ar.getElementById(br)),lr[br].low=lr[vr].index,lr[br].explored=!0,br===vr)break}var yr=mr.edgesWith(mr),xr=mr.merge(yr);cr.push(xr),dr=dr.difference(xr)}};return ar.forEach(function(pr){if(pr.isNode()){var vr=pr.id();vr in lr||fr(vr)}}),{cut:dr,components:cr}},tarjanStronglyConnected$1={tarjanStronglyConnected,tsc:tarjanStronglyConnected,tscc:tarjanStronglyConnected,tarjanStronglyConnectedComponents:tarjanStronglyConnected},elesfn$j={};[elesfn$v,elesfn$u,elesfn$t,elesfn$s,elesfn$r,elesfn$q,elesfn$p,elesfn$o,elesfn$n,elesfn$m,elesfn$l,markovClustering$1,kClustering,hierarchicalClustering$1,affinityPropagation$1,elesfn$k,hopcroftTarjanBiconnected$1,tarjanStronglyConnected$1].forEach(function(or){extend(elesfn$j,or)});/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/var STATE_PENDING=0,STATE_FULFILLED=1,STATE_REJECTED=2,_api=function or(ar){if(!(this instanceof _api))return new _api(ar);this.id="Thenable/1.0.7",this.state=STATE_PENDING,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},typeof ar=="function"&&ar.call(this,this.fulfill.bind(this),this.reject.bind(this))};_api.prototype={fulfill:function or(ar){return deliver(this,STATE_FULFILLED,"fulfillValue",ar)},reject:function or(ar){return deliver(this,STATE_REJECTED,"rejectReason",ar)},then:function or(ar,lr){var ur=this,cr=new _api;return ur.onFulfilled.push(resolver(ar,cr,"fulfill")),ur.onRejected.push(resolver(lr,cr,"reject")),execute(ur),cr.proxy}};var deliver=function or(ar,lr,ur,cr){return ar.state===STATE_PENDING&&(ar.state=lr,ar[ur]=cr,execute(ar)),ar},execute=function or(ar){ar.state===STATE_FULFILLED?execute_handlers(ar,"onFulfilled",ar.fulfillValue):ar.state===STATE_REJECTED&&execute_handlers(ar,"onRejected",ar.rejectReason)},execute_handlers=function or(ar,lr,ur){if(ar[lr].length!==0){var cr=ar[lr];ar[lr]=[];var hr=function(){for(var fr=0;fr<cr.length;fr++)cr[fr](ur)};typeof setImmediate=="function"?setImmediate(hr):setTimeout(hr,0)}},resolver=function or(ar,lr,ur){return function(cr){if(typeof ar!="function")lr[ur].call(lr,cr);else{var hr;try{hr=ar(cr)}catch(dr){lr.reject(dr);return}_resolve(lr,hr)}}},_resolve=function or(ar,lr){if(ar===lr||ar.proxy===lr){ar.reject(new TypeError("cannot resolve promise with itself"));return}var ur;if(_typeof(lr)==="object"&&lr!==null||typeof lr=="function")try{ur=lr.then}catch(hr){ar.reject(hr);return}if(typeof ur=="function"){var cr=!1;try{ur.call(lr,function(hr){cr||(cr=!0,hr===lr?ar.reject(new TypeError("circular thenable chain")):_resolve(ar,hr))},function(hr){cr||(cr=!0,ar.reject(hr))})}catch(hr){cr||ar.reject(hr)}return}ar.fulfill(lr)};_api.all=function(or){return new _api(function(ar,lr){for(var ur=new Array(or.length),cr=0,hr=function(pr,vr){ur[pr]=vr,cr++,cr===or.length&&ar(ur)},dr=0;dr<or.length;dr++)(function(fr){var pr=or[fr],vr=pr!=null&&pr.then!=null;if(vr)pr.then(function(mr){hr(fr,mr)},function(mr){lr(mr)});else{var gr=pr;hr(fr,gr)}})(dr)})};_api.resolve=function(or){return new _api(function(ar,lr){ar(or)})};_api.reject=function(or){return new _api(function(ar,lr){lr(or)})};var Promise$1=typeof Promise<"u"?Promise:_api,Animation=function or(ar,lr,ur){var cr=core(ar),hr=!cr,dr=this._private=extend({duration:1e3},lr,ur);if(dr.target=ar,dr.style=dr.style||dr.css,dr.started=!1,dr.playing=!1,dr.hooked=!1,dr.applying=!1,dr.progress=0,dr.completes=[],dr.frames=[],dr.complete&&fn$6(dr.complete)&&dr.completes.push(dr.complete),hr){var fr=ar.position();dr.startPosition=dr.startPosition||{x:fr.x,y:fr.y},dr.startStyle=dr.startStyle||ar.cy().style().getAnimationStartStyle(ar,dr.style)}if(cr){var pr=ar.pan();dr.startPan={x:pr.x,y:pr.y},dr.startZoom=ar.zoom()}this.length=1,this[0]=this},anifn=Animation.prototype;extend(anifn,{instanceString:function or(){return"animation"},hook:function or(){var ar=this._private;if(!ar.hooked){var lr,ur=ar.target._private.animation;ar.queue?lr=ur.queue:lr=ur.current,lr.push(this),elementOrCollection(ar.target)&&ar.target.cy().addToAnimationPool(ar.target),ar.hooked=!0}return this},play:function or(){var ar=this._private;return ar.progress===1&&(ar.progress=0),ar.playing=!0,ar.started=!1,ar.stopped=!1,this.hook(),this},playing:function or(){return this._private.playing},apply:function or(){var ar=this._private;return ar.applying=!0,ar.started=!1,ar.stopped=!1,this.hook(),this},applying:function or(){return this._private.applying},pause:function or(){var ar=this._private;return ar.playing=!1,ar.started=!1,this},stop:function or(){var ar=this._private;return ar.playing=!1,ar.started=!1,ar.stopped=!0,this},rewind:function or(){return this.progress(0)},fastforward:function or(){return this.progress(1)},time:function or(ar){var lr=this._private;return ar===void 0?lr.progress*lr.duration:this.progress(ar/lr.duration)},progress:function or(ar){var lr=this._private,ur=lr.playing;return ar===void 0?lr.progress:(ur&&this.pause(),lr.progress=ar,lr.started=!1,ur&&this.play(),this)},completed:function or(){return this._private.progress===1},reverse:function or(){var ar=this._private,lr=ar.playing;lr&&this.pause(),ar.progress=1-ar.progress,ar.started=!1;var ur=function(vr,gr){var mr=ar[vr];mr!=null&&(ar[vr]=ar[gr],ar[gr]=mr)};if(ur("zoom","startZoom"),ur("pan","startPan"),ur("position","startPosition"),ar.style)for(var cr=0;cr<ar.style.length;cr++){var hr=ar.style[cr],dr=hr.name,fr=ar.startStyle[dr];ar.startStyle[dr]=hr,ar.style[cr]=fr}return lr&&this.play(),this},promise:function or(ar){var lr=this._private,ur;switch(ar){case"frame":ur=lr.frames;break;default:case"complete":case"completed":ur=lr.completes}return new Promise$1(function(cr,hr){ur.push(function(){cr()})})}});anifn.complete=anifn.completed;anifn.run=anifn.play;anifn.running=anifn.playing;var define$3={animated:function or(){return function(){var lr=this,ur=lr.length!==void 0,cr=ur?lr:[lr],hr=this._private.cy||this;if(!hr.styleEnabled())return!1;var dr=cr[0];if(dr)return dr._private.animation.current.length>0}},clearQueue:function or(){return function(){var lr=this,ur=lr.length!==void 0,cr=ur?lr:[lr],hr=this._private.cy||this;if(!hr.styleEnabled())return this;for(var dr=0;dr<cr.length;dr++){var fr=cr[dr];fr._private.animation.queue=[]}return this}},delay:function or(){return function(lr,ur){var cr=this._private.cy||this;return cr.styleEnabled()?this.animate({delay:lr,duration:lr,complete:ur}):this}},delayAnimation:function or(){return function(lr,ur){var cr=this._private.cy||this;return cr.styleEnabled()?this.animation({delay:lr,duration:lr,complete:ur}):this}},animation:function or(){return function(lr,ur){var cr=this,hr=cr.length!==void 0,dr=hr?cr:[cr],fr=this._private.cy||this,pr=!hr,vr=!pr;if(!fr.styleEnabled())return this;var gr=fr.style();lr=extend({},lr,ur);var mr=Object.keys(lr).length===0;if(mr)return new Animation(dr[0],lr);switch(lr.duration===void 0&&(lr.duration=400),lr.duration){case"slow":lr.duration=600;break;case"fast":lr.duration=200;break}if(vr&&(lr.style=gr.getPropsList(lr.style||lr.css),lr.css=void 0),vr&&lr.renderedPosition!=null){var br=lr.renderedPosition,yr=fr.pan(),xr=fr.zoom();lr.position=renderedToModelPosition(br,xr,yr)}if(pr&&lr.panBy!=null){var Cr=lr.panBy,Sr=fr.pan();lr.pan={x:Sr.x+Cr.x,y:Sr.y+Cr.y}}var wr=lr.center||lr.centre;if(pr&&wr!=null){var Er=fr.getCenterPan(wr.eles,lr.zoom);Er!=null&&(lr.pan=Er)}if(pr&&lr.fit!=null){var Ar=lr.fit,Tr=fr.getFitViewport(Ar.eles||Ar.boundingBox,Ar.padding);Tr!=null&&(lr.pan=Tr.pan,lr.zoom=Tr.zoom)}if(pr&&plainObject(lr.zoom)){var Rr=fr.getZoomedViewport(lr.zoom);Rr!=null?(Rr.zoomed&&(lr.zoom=Rr.zoom),Rr.panned&&(lr.pan=Rr.pan)):lr.zoom=null}return new Animation(dr[0],lr)}},animate:function or(){return function(lr,ur){var cr=this,hr=cr.length!==void 0,dr=hr?cr:[cr],fr=this._private.cy||this;if(!fr.styleEnabled())return this;ur&&(lr=extend({},lr,ur));for(var pr=0;pr<dr.length;pr++){var vr=dr[pr],gr=vr.animated()&&(lr.queue===void 0||lr.queue),mr=vr.animation(lr,gr?{queue:!0}:void 0);mr.play()}return this}},stop:function or(){return function(lr,ur){var cr=this,hr=cr.length!==void 0,dr=hr?cr:[cr],fr=this._private.cy||this;if(!fr.styleEnabled())return this;for(var pr=0;pr<dr.length;pr++){for(var vr=dr[pr],gr=vr._private,mr=gr.animation.current,br=0;br<mr.length;br++){var yr=mr[br],xr=yr._private;ur&&(xr.duration=0)}lr&&(gr.animation.queue=[]),ur||(gr.animation.current=[])}return fr.notify("draw"),this}}},isArray_1,hasRequiredIsArray;function requireIsArray(){if(hasRequiredIsArray)return isArray_1;hasRequiredIsArray=1;var or=Array.isArray;return isArray_1=or,isArray_1}var _isKey,hasRequired_isKey;function require_isKey(){if(hasRequired_isKey)return _isKey;hasRequired_isKey=1;var or=requireIsArray(),ar=requireIsSymbol(),lr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ur=/^\w*$/;function cr(hr,dr){if(or(hr))return!1;var fr=typeof hr;return fr=="number"||fr=="symbol"||fr=="boolean"||hr==null||ar(hr)?!0:ur.test(hr)||!lr.test(hr)||dr!=null&&hr in Object(dr)}return _isKey=cr,_isKey}var isFunction_1,hasRequiredIsFunction;function requireIsFunction(){if(hasRequiredIsFunction)return isFunction_1;hasRequiredIsFunction=1;var or=require_baseGetTag(),ar=requireIsObject(),lr="[object AsyncFunction]",ur="[object Function]",cr="[object GeneratorFunction]",hr="[object Proxy]";function dr(fr){if(!ar(fr))return!1;var pr=or(fr);return pr==ur||pr==cr||pr==lr||pr==hr}return isFunction_1=dr,isFunction_1}var _coreJsData,hasRequired_coreJsData;function require_coreJsData(){if(hasRequired_coreJsData)return _coreJsData;hasRequired_coreJsData=1;var or=require_root(),ar=or["__core-js_shared__"];return _coreJsData=ar,_coreJsData}var _isMasked,hasRequired_isMasked;function require_isMasked(){if(hasRequired_isMasked)return _isMasked;hasRequired_isMasked=1;var or=require_coreJsData(),ar=function(){var ur=/[^.]+$/.exec(or&&or.keys&&or.keys.IE_PROTO||"");return ur?"Symbol(src)_1."+ur:""}();function lr(ur){return!!ar&&ar in ur}return _isMasked=lr,_isMasked}var _toSource,hasRequired_toSource;function require_toSource(){if(hasRequired_toSource)return _toSource;hasRequired_toSource=1;var or=Function.prototype,ar=or.toString;function lr(ur){if(ur!=null){try{return ar.call(ur)}catch{}try{return ur+""}catch{}}return""}return _toSource=lr,_toSource}var _baseIsNative,hasRequired_baseIsNative;function require_baseIsNative(){if(hasRequired_baseIsNative)return _baseIsNative;hasRequired_baseIsNative=1;var or=requireIsFunction(),ar=require_isMasked(),lr=requireIsObject(),ur=require_toSource(),cr=/[\\^$.*+?()[\]{}|]/g,hr=/^\[object .+?Constructor\]$/,dr=Function.prototype,fr=Object.prototype,pr=dr.toString,vr=fr.hasOwnProperty,gr=RegExp("^"+pr.call(vr).replace(cr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function mr(br){if(!lr(br)||ar(br))return!1;var yr=or(br)?gr:hr;return yr.test(ur(br))}return _baseIsNative=mr,_baseIsNative}var _getValue,hasRequired_getValue;function require_getValue(){if(hasRequired_getValue)return _getValue;hasRequired_getValue=1;function or(ar,lr){return ar==null?void 0:ar[lr]}return _getValue=or,_getValue}var _getNative,hasRequired_getNative;function require_getNative(){if(hasRequired_getNative)return _getNative;hasRequired_getNative=1;var or=require_baseIsNative(),ar=require_getValue();function lr(ur,cr){var hr=ar(ur,cr);return or(hr)?hr:void 0}return _getNative=lr,_getNative}var _nativeCreate,hasRequired_nativeCreate;function require_nativeCreate(){if(hasRequired_nativeCreate)return _nativeCreate;hasRequired_nativeCreate=1;var or=require_getNative(),ar=or(Object,"create");return _nativeCreate=ar,_nativeCreate}var _hashClear,hasRequired_hashClear;function require_hashClear(){if(hasRequired_hashClear)return _hashClear;hasRequired_hashClear=1;var or=require_nativeCreate();function ar(){this.__data__=or?or(null):{},this.size=0}return _hashClear=ar,_hashClear}var _hashDelete,hasRequired_hashDelete;function require_hashDelete(){if(hasRequired_hashDelete)return _hashDelete;hasRequired_hashDelete=1;function or(ar){var lr=this.has(ar)&&delete this.__data__[ar];return this.size-=lr?1:0,lr}return _hashDelete=or,_hashDelete}var _hashGet,hasRequired_hashGet;function require_hashGet(){if(hasRequired_hashGet)return _hashGet;hasRequired_hashGet=1;var or=require_nativeCreate(),ar="__lodash_hash_undefined__",lr=Object.prototype,ur=lr.hasOwnProperty;function cr(hr){var dr=this.__data__;if(or){var fr=dr[hr];return fr===ar?void 0:fr}return ur.call(dr,hr)?dr[hr]:void 0}return _hashGet=cr,_hashGet}var _hashHas,hasRequired_hashHas;function require_hashHas(){if(hasRequired_hashHas)return _hashHas;hasRequired_hashHas=1;var or=require_nativeCreate(),ar=Object.prototype,lr=ar.hasOwnProperty;function ur(cr){var hr=this.__data__;return or?hr[cr]!==void 0:lr.call(hr,cr)}return _hashHas=ur,_hashHas}var _hashSet,hasRequired_hashSet;function require_hashSet(){if(hasRequired_hashSet)return _hashSet;hasRequired_hashSet=1;var or=require_nativeCreate(),ar="__lodash_hash_undefined__";function lr(ur,cr){var hr=this.__data__;return this.size+=this.has(ur)?0:1,hr[ur]=or&&cr===void 0?ar:cr,this}return _hashSet=lr,_hashSet}var _Hash,hasRequired_Hash;function require_Hash(){if(hasRequired_Hash)return _Hash;hasRequired_Hash=1;var or=require_hashClear(),ar=require_hashDelete(),lr=require_hashGet(),ur=require_hashHas(),cr=require_hashSet();function hr(dr){var fr=-1,pr=dr==null?0:dr.length;for(this.clear();++fr<pr;){var vr=dr[fr];this.set(vr[0],vr[1])}}return hr.prototype.clear=or,hr.prototype.delete=ar,hr.prototype.get=lr,hr.prototype.has=ur,hr.prototype.set=cr,_Hash=hr,_Hash}var _listCacheClear,hasRequired_listCacheClear;function require_listCacheClear(){if(hasRequired_listCacheClear)return _listCacheClear;hasRequired_listCacheClear=1;function or(){this.__data__=[],this.size=0}return _listCacheClear=or,_listCacheClear}var eq_1,hasRequiredEq;function requireEq(){if(hasRequiredEq)return eq_1;hasRequiredEq=1;function or(ar,lr){return ar===lr||ar!==ar&&lr!==lr}return eq_1=or,eq_1}var _assocIndexOf,hasRequired_assocIndexOf;function require_assocIndexOf(){if(hasRequired_assocIndexOf)return _assocIndexOf;hasRequired_assocIndexOf=1;var or=requireEq();function ar(lr,ur){for(var cr=lr.length;cr--;)if(or(lr[cr][0],ur))return cr;return-1}return _assocIndexOf=ar,_assocIndexOf}var _listCacheDelete,hasRequired_listCacheDelete;function require_listCacheDelete(){if(hasRequired_listCacheDelete)return _listCacheDelete;hasRequired_listCacheDelete=1;var or=require_assocIndexOf(),ar=Array.prototype,lr=ar.splice;function ur(cr){var hr=this.__data__,dr=or(hr,cr);if(dr<0)return!1;var fr=hr.length-1;return dr==fr?hr.pop():lr.call(hr,dr,1),--this.size,!0}return _listCacheDelete=ur,_listCacheDelete}var _listCacheGet,hasRequired_listCacheGet;function require_listCacheGet(){if(hasRequired_listCacheGet)return _listCacheGet;hasRequired_listCacheGet=1;var or=require_assocIndexOf();function ar(lr){var ur=this.__data__,cr=or(ur,lr);return cr<0?void 0:ur[cr][1]}return _listCacheGet=ar,_listCacheGet}var _listCacheHas,hasRequired_listCacheHas;function require_listCacheHas(){if(hasRequired_listCacheHas)return _listCacheHas;hasRequired_listCacheHas=1;var or=require_assocIndexOf();function ar(lr){return or(this.__data__,lr)>-1}return _listCacheHas=ar,_listCacheHas}var _listCacheSet,hasRequired_listCacheSet;function require_listCacheSet(){if(hasRequired_listCacheSet)return _listCacheSet;hasRequired_listCacheSet=1;var or=require_assocIndexOf();function ar(lr,ur){var cr=this.__data__,hr=or(cr,lr);return hr<0?(++this.size,cr.push([lr,ur])):cr[hr][1]=ur,this}return _listCacheSet=ar,_listCacheSet}var _ListCache,hasRequired_ListCache;function require_ListCache(){if(hasRequired_ListCache)return _ListCache;hasRequired_ListCache=1;var or=require_listCacheClear(),ar=require_listCacheDelete(),lr=require_listCacheGet(),ur=require_listCacheHas(),cr=require_listCacheSet();function hr(dr){var fr=-1,pr=dr==null?0:dr.length;for(this.clear();++fr<pr;){var vr=dr[fr];this.set(vr[0],vr[1])}}return hr.prototype.clear=or,hr.prototype.delete=ar,hr.prototype.get=lr,hr.prototype.has=ur,hr.prototype.set=cr,_ListCache=hr,_ListCache}var _Map,hasRequired_Map;function require_Map(){if(hasRequired_Map)return _Map;hasRequired_Map=1;var or=require_getNative(),ar=require_root(),lr=or(ar,"Map");return _Map=lr,_Map}var _mapCacheClear,hasRequired_mapCacheClear;function require_mapCacheClear(){if(hasRequired_mapCacheClear)return _mapCacheClear;hasRequired_mapCacheClear=1;var or=require_Hash(),ar=require_ListCache(),lr=require_Map();function ur(){this.size=0,this.__data__={hash:new or,map:new(lr||ar),string:new or}}return _mapCacheClear=ur,_mapCacheClear}var _isKeyable,hasRequired_isKeyable;function require_isKeyable(){if(hasRequired_isKeyable)return _isKeyable;hasRequired_isKeyable=1;function or(ar){var lr=typeof ar;return lr=="string"||lr=="number"||lr=="symbol"||lr=="boolean"?ar!=="__proto__":ar===null}return _isKeyable=or,_isKeyable}var _getMapData,hasRequired_getMapData;function require_getMapData(){if(hasRequired_getMapData)return _getMapData;hasRequired_getMapData=1;var or=require_isKeyable();function ar(lr,ur){var cr=lr.__data__;return or(ur)?cr[typeof ur=="string"?"string":"hash"]:cr.map}return _getMapData=ar,_getMapData}var _mapCacheDelete,hasRequired_mapCacheDelete;function require_mapCacheDelete(){if(hasRequired_mapCacheDelete)return _mapCacheDelete;hasRequired_mapCacheDelete=1;var or=require_getMapData();function ar(lr){var ur=or(this,lr).delete(lr);return this.size-=ur?1:0,ur}return _mapCacheDelete=ar,_mapCacheDelete}var _mapCacheGet,hasRequired_mapCacheGet;function require_mapCacheGet(){if(hasRequired_mapCacheGet)return _mapCacheGet;hasRequired_mapCacheGet=1;var or=require_getMapData();function ar(lr){return or(this,lr).get(lr)}return _mapCacheGet=ar,_mapCacheGet}var _mapCacheHas,hasRequired_mapCacheHas;function require_mapCacheHas(){if(hasRequired_mapCacheHas)return _mapCacheHas;hasRequired_mapCacheHas=1;var or=require_getMapData();function ar(lr){return or(this,lr).has(lr)}return _mapCacheHas=ar,_mapCacheHas}var _mapCacheSet,hasRequired_mapCacheSet;function require_mapCacheSet(){if(hasRequired_mapCacheSet)return _mapCacheSet;hasRequired_mapCacheSet=1;var or=require_getMapData();function ar(lr,ur){var cr=or(this,lr),hr=cr.size;return cr.set(lr,ur),this.size+=cr.size==hr?0:1,this}return _mapCacheSet=ar,_mapCacheSet}var _MapCache,hasRequired_MapCache;function require_MapCache(){if(hasRequired_MapCache)return _MapCache;hasRequired_MapCache=1;var or=require_mapCacheClear(),ar=require_mapCacheDelete(),lr=require_mapCacheGet(),ur=require_mapCacheHas(),cr=require_mapCacheSet();function hr(dr){var fr=-1,pr=dr==null?0:dr.length;for(this.clear();++fr<pr;){var vr=dr[fr];this.set(vr[0],vr[1])}}return hr.prototype.clear=or,hr.prototype.delete=ar,hr.prototype.get=lr,hr.prototype.has=ur,hr.prototype.set=cr,_MapCache=hr,_MapCache}var memoize_1,hasRequiredMemoize;function requireMemoize(){if(hasRequiredMemoize)return memoize_1;hasRequiredMemoize=1;var or=require_MapCache(),ar="Expected a function";function lr(ur,cr){if(typeof ur!="function"||cr!=null&&typeof cr!="function")throw new TypeError(ar);var hr=function(){var dr=arguments,fr=cr?cr.apply(this,dr):dr[0],pr=hr.cache;if(pr.has(fr))return pr.get(fr);var vr=ur.apply(this,dr);return hr.cache=pr.set(fr,vr)||pr,vr};return hr.cache=new(lr.Cache||or),hr}return lr.Cache=or,memoize_1=lr,memoize_1}var _memoizeCapped,hasRequired_memoizeCapped;function require_memoizeCapped(){if(hasRequired_memoizeCapped)return _memoizeCapped;hasRequired_memoizeCapped=1;var or=requireMemoize(),ar=500;function lr(ur){var cr=or(ur,function(dr){return hr.size===ar&&hr.clear(),dr}),hr=cr.cache;return cr}return _memoizeCapped=lr,_memoizeCapped}var _stringToPath,hasRequired_stringToPath;function require_stringToPath(){if(hasRequired_stringToPath)return _stringToPath;hasRequired_stringToPath=1;var or=require_memoizeCapped(),ar=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,lr=/\\(\\)?/g,ur=or(function(cr){var hr=[];return cr.charCodeAt(0)===46&&hr.push(""),cr.replace(ar,function(dr,fr,pr,vr){hr.push(pr?vr.replace(lr,"$1"):fr||dr)}),hr});return _stringToPath=ur,_stringToPath}var _arrayMap,hasRequired_arrayMap;function require_arrayMap(){if(hasRequired_arrayMap)return _arrayMap;hasRequired_arrayMap=1;function or(ar,lr){for(var ur=-1,cr=ar==null?0:ar.length,hr=Array(cr);++ur<cr;)hr[ur]=lr(ar[ur],ur,ar);return hr}return _arrayMap=or,_arrayMap}var _baseToString,hasRequired_baseToString;function require_baseToString(){if(hasRequired_baseToString)return _baseToString;hasRequired_baseToString=1;var or=require_Symbol(),ar=require_arrayMap(),lr=requireIsArray(),ur=requireIsSymbol(),cr=or?or.prototype:void 0,hr=cr?cr.toString:void 0;function dr(fr){if(typeof fr=="string")return fr;if(lr(fr))return ar(fr,dr)+"";if(ur(fr))return hr?hr.call(fr):"";var pr=fr+"";return pr=="0"&&1/fr==-1/0?"-0":pr}return _baseToString=dr,_baseToString}var toString_1,hasRequiredToString;function requireToString(){if(hasRequiredToString)return toString_1;hasRequiredToString=1;var or=require_baseToString();function ar(lr){return lr==null?"":or(lr)}return toString_1=ar,toString_1}var _castPath,hasRequired_castPath;function require_castPath(){if(hasRequired_castPath)return _castPath;hasRequired_castPath=1;var or=requireIsArray(),ar=require_isKey(),lr=require_stringToPath(),ur=requireToString();function cr(hr,dr){return or(hr)?hr:ar(hr,dr)?[hr]:lr(ur(hr))}return _castPath=cr,_castPath}var _toKey,hasRequired_toKey;function require_toKey(){if(hasRequired_toKey)return _toKey;hasRequired_toKey=1;var or=requireIsSymbol();function ar(lr){if(typeof lr=="string"||or(lr))return lr;var ur=lr+"";return ur=="0"&&1/lr==-1/0?"-0":ur}return _toKey=ar,_toKey}var _baseGet,hasRequired_baseGet;function require_baseGet(){if(hasRequired_baseGet)return _baseGet;hasRequired_baseGet=1;var or=require_castPath(),ar=require_toKey();function lr(ur,cr){cr=or(cr,ur);for(var hr=0,dr=cr.length;ur!=null&&hr<dr;)ur=ur[ar(cr[hr++])];return hr&&hr==dr?ur:void 0}return _baseGet=lr,_baseGet}var get_1,hasRequiredGet;function requireGet(){if(hasRequiredGet)return get_1;hasRequiredGet=1;var or=require_baseGet();function ar(lr,ur,cr){var hr=lr==null?void 0:or(lr,ur);return hr===void 0?cr:hr}return get_1=ar,get_1}var getExports=requireGet(),get=getDefaultExportFromCjs(getExports),_defineProperty,hasRequired_defineProperty;function require_defineProperty(){if(hasRequired_defineProperty)return _defineProperty;hasRequired_defineProperty=1;var or=require_getNative(),ar=function(){try{var lr=or(Object,"defineProperty");return lr({},"",{}),lr}catch{}}();return _defineProperty=ar,_defineProperty}var _baseAssignValue,hasRequired_baseAssignValue;function require_baseAssignValue(){if(hasRequired_baseAssignValue)return _baseAssignValue;hasRequired_baseAssignValue=1;var or=require_defineProperty();function ar(lr,ur,cr){ur=="__proto__"&&or?or(lr,ur,{configurable:!0,enumerable:!0,value:cr,writable:!0}):lr[ur]=cr}return _baseAssignValue=ar,_baseAssignValue}var _assignValue,hasRequired_assignValue;function require_assignValue(){if(hasRequired_assignValue)return _assignValue;hasRequired_assignValue=1;var or=require_baseAssignValue(),ar=requireEq(),lr=Object.prototype,ur=lr.hasOwnProperty;function cr(hr,dr,fr){var pr=hr[dr];(!(ur.call(hr,dr)&&ar(pr,fr))||fr===void 0&&!(dr in hr))&&or(hr,dr,fr)}return _assignValue=cr,_assignValue}var _isIndex,hasRequired_isIndex;function require_isIndex(){if(hasRequired_isIndex)return _isIndex;hasRequired_isIndex=1;var or=9007199254740991,ar=/^(?:0|[1-9]\d*)$/;function lr(ur,cr){var hr=typeof ur;return cr=cr??or,!!cr&&(hr=="number"||hr!="symbol"&&ar.test(ur))&&ur>-1&&ur%1==0&&ur<cr}return _isIndex=lr,_isIndex}var _baseSet,hasRequired_baseSet;function require_baseSet(){if(hasRequired_baseSet)return _baseSet;hasRequired_baseSet=1;var or=require_assignValue(),ar=require_castPath(),lr=require_isIndex(),ur=requireIsObject(),cr=require_toKey();function hr(dr,fr,pr,vr){if(!ur(dr))return dr;fr=ar(fr,dr);for(var gr=-1,mr=fr.length,br=mr-1,yr=dr;yr!=null&&++gr<mr;){var xr=cr(fr[gr]),Cr=pr;if(xr==="__proto__"||xr==="constructor"||xr==="prototype")return dr;if(gr!=br){var Sr=yr[xr];Cr=vr?vr(Sr,xr,yr):void 0,Cr===void 0&&(Cr=ur(Sr)?Sr:lr(fr[gr+1])?[]:{})}or(yr,xr,Cr),yr=yr[xr]}return dr}return _baseSet=hr,_baseSet}var set_1,hasRequiredSet;function requireSet(){if(hasRequiredSet)return set_1;hasRequiredSet=1;var or=require_baseSet();function ar(lr,ur,cr){return lr==null?lr:or(lr,ur,cr)}return set_1=ar,set_1}var setExports=requireSet(),set=getDefaultExportFromCjs(setExports),_copyArray,hasRequired_copyArray;function require_copyArray(){if(hasRequired_copyArray)return _copyArray;hasRequired_copyArray=1;function or(ar,lr){var ur=-1,cr=ar.length;for(lr||(lr=Array(cr));++ur<cr;)lr[ur]=ar[ur];return lr}return _copyArray=or,_copyArray}var toPath_1,hasRequiredToPath;function requireToPath(){if(hasRequiredToPath)return toPath_1;hasRequiredToPath=1;var or=require_arrayMap(),ar=require_copyArray(),lr=requireIsArray(),ur=requireIsSymbol(),cr=require_stringToPath(),hr=require_toKey(),dr=requireToString();function fr(pr){return lr(pr)?or(pr,hr):ur(pr)?[pr]:ar(cr(dr(pr)))}return toPath_1=fr,toPath_1}var toPathExports=requireToPath(),toPath=getDefaultExportFromCjs(toPathExports),define$2={data:function or(ar){var lr={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(cr){},beforeSet:function(cr,hr){},onSet:function(cr){},canSet:function(cr){return!0}};return ar=extend({},lr,ar),function(cr,hr){var dr=ar,fr=this,pr=fr.length!==void 0,vr=pr?fr:[fr],gr=pr?fr[0]:fr;if(string(cr)){var mr=cr.indexOf(".")!==-1,br=mr&&toPath(cr);if(dr.allowGetting&&hr===void 0){var yr;return gr&&(dr.beforeGet(gr),br&&gr._private[dr.field][cr]===void 0?yr=get(gr._private[dr.field],br):yr=gr._private[dr.field][cr]),yr}else if(dr.allowSetting&&hr!==void 0){var xr=!dr.immutableKeys[cr];if(xr){var Cr=_defineProperty$1({},cr,hr);dr.beforeSet(fr,Cr);for(var Sr=0,wr=vr.length;Sr<wr;Sr++){var Er=vr[Sr];dr.canSet(Er)&&(br&&gr._private[dr.field][cr]===void 0?set(Er._private[dr.field],br,hr):Er._private[dr.field][cr]=hr)}dr.updateStyle&&fr.updateStyle(),dr.onSet(fr),dr.settingTriggersEvent&&fr[dr.triggerFnName](dr.settingEvent)}}}else if(dr.allowSetting&&plainObject(cr)){var Ar=cr,Tr,Rr,Pr=Object.keys(Ar);dr.beforeSet(fr,Ar);for(var _r=0;_r<Pr.length;_r++){Tr=Pr[_r],Rr=Ar[Tr];var kr=!dr.immutableKeys[Tr];if(kr)for(var Dr=0;Dr<vr.length;Dr++){var Nr=vr[Dr];dr.canSet(Nr)&&(Nr._private[dr.field][Tr]=Rr)}}dr.updateStyle&&fr.updateStyle(),dr.onSet(fr),dr.settingTriggersEvent&&fr[dr.triggerFnName](dr.settingEvent)}else if(dr.allowBinding&&fn$6(cr)){var Lr=cr;fr.on(dr.bindingEvent,Lr)}else if(dr.allowGetting&&cr===void 0){var Or;return gr&&(dr.beforeGet(gr),Or=gr._private[dr.field]),Or}return fr}},removeData:function or(ar){var lr={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return ar=extend({},lr,ar),function(cr){var hr=ar,dr=this,fr=dr.length!==void 0,pr=fr?dr:[dr];if(string(cr)){for(var vr=cr.split(/\s+/),gr=vr.length,mr=0;mr<gr;mr++){var br=vr[mr];if(!emptyString(br)){var yr=!hr.immutableKeys[br];if(yr)for(var xr=0,Cr=pr.length;xr<Cr;xr++)pr[xr]._private[hr.field][br]=void 0}}hr.triggerEvent&&dr[hr.triggerFnName](hr.event)}else if(cr===void 0){for(var Sr=0,wr=pr.length;Sr<wr;Sr++)for(var Er=pr[Sr]._private[hr.field],Ar=Object.keys(Er),Tr=0;Tr<Ar.length;Tr++){var Rr=Ar[Tr],Pr=!hr.immutableKeys[Rr];Pr&&(Er[Rr]=void 0)}hr.triggerEvent&&dr[hr.triggerFnName](hr.event)}return dr}}},define$1={eventAliasesOn:function or(ar){var lr=ar;lr.addListener=lr.listen=lr.bind=lr.on,lr.unlisten=lr.unbind=lr.off=lr.removeListener,lr.trigger=lr.emit,lr.pon=lr.promiseOn=function(ur,cr){var hr=this,dr=Array.prototype.slice.call(arguments,0);return new Promise$1(function(fr,pr){var vr=function(yr){hr.off.apply(hr,mr),fr(yr)},gr=dr.concat([vr]),mr=gr.concat([]);hr.on.apply(hr,gr)})}}},define={};[define$3,define$2,define$1].forEach(function(or){extend(define,or)});var elesfn$i={animate:define.animate(),animation:define.animation(),animated:define.animated(),clearQueue:define.clearQueue(),delay:define.delay(),delayAnimation:define.delayAnimation(),stop:define.stop()},elesfn$h={classes:function or(ar){var lr=this;if(ar===void 0){var ur=[];return lr[0]._private.classes.forEach(function(xr){return ur.push(xr)}),ur}else array(ar)||(ar=(ar||"").match(/\S+/g)||[]);for(var cr=[],hr=new Set$1(ar),dr=0;dr<lr.length;dr++){for(var fr=lr[dr],pr=fr._private,vr=pr.classes,gr=!1,mr=0;mr<ar.length;mr++){var br=ar[mr],yr=vr.has(br);if(!yr){gr=!0;break}}gr||(gr=vr.size!==ar.length),gr&&(pr.classes=hr,cr.push(fr))}return cr.length>0&&this.spawn(cr).updateStyle().emit("class"),lr},addClass:function or(ar){return this.toggleClass(ar,!0)},hasClass:function or(ar){var lr=this[0];return lr!=null&&lr._private.classes.has(ar)},toggleClass:function or(ar,lr){array(ar)||(ar=ar.match(/\S+/g)||[]);for(var ur=this,cr=lr===void 0,hr=[],dr=0,fr=ur.length;dr<fr;dr++)for(var pr=ur[dr],vr=pr._private.classes,gr=!1,mr=0;mr<ar.length;mr++){var br=ar[mr],yr=vr.has(br),xr=!1;lr||cr&&!yr?(vr.add(br),xr=!0):(!lr||cr&&yr)&&(vr.delete(br),xr=!0),!gr&&xr&&(hr.push(pr),gr=!0)}return hr.length>0&&this.spawn(hr).updateStyle().emit("class"),ur},removeClass:function or(ar){return this.toggleClass(ar,!1)},flashClass:function or(ar,lr){var ur=this;if(lr==null)lr=250;else if(lr===0)return ur;return ur.addClass(ar),setTimeout(function(){ur.removeClass(ar)},lr),ur}};elesfn$h.className=elesfn$h.classNames=elesfn$h.classes;var tokens={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:`"(?:\\\\"|[^"])*"|'(?:\\\\'|[^'])*'`,number,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};tokens.variable="(?:[\\w-.]|(?:\\\\"+tokens.metaChar+"))+";tokens.className="(?:[\\w-]|(?:\\\\"+tokens.metaChar+"))+";tokens.value=tokens.string+"|"+tokens.number;tokens.id=tokens.variable;(function(){var or,ar,lr;for(or=tokens.comparatorOp.split("|"),lr=0;lr<or.length;lr++)ar=or[lr],tokens.comparatorOp+="|@"+ar;for(or=tokens.comparatorOp.split("|"),lr=0;lr<or.length;lr++)ar=or[lr],!(ar.indexOf("!")>=0)&&ar!=="="&&(tokens.comparatorOp+="|\\!"+ar)})();var newQuery=function or(){return{checks:[]}},Type={GROUP:0,COLLECTION:1,FILTER:2,DATA_COMPARE:3,DATA_EXIST:4,DATA_BOOL:5,META_COMPARE:6,STATE:7,ID:8,CLASS:9,UNDIRECTED_EDGE:10,DIRECTED_EDGE:11,NODE_SOURCE:12,NODE_TARGET:13,NODE_NEIGHBOR:14,CHILD:15,DESCENDANT:16,PARENT:17,ANCESTOR:18,COMPOUND_SPLIT:19,TRUE:20},stateSelectors=[{selector:":selected",matches:function or(ar){return ar.selected()}},{selector:":unselected",matches:function or(ar){return!ar.selected()}},{selector:":selectable",matches:function or(ar){return ar.selectable()}},{selector:":unselectable",matches:function or(ar){return!ar.selectable()}},{selector:":locked",matches:function or(ar){return ar.locked()}},{selector:":unlocked",matches:function or(ar){return!ar.locked()}},{selector:":visible",matches:function or(ar){return ar.visible()}},{selector:":hidden",matches:function or(ar){return!ar.visible()}},{selector:":transparent",matches:function or(ar){return ar.transparent()}},{selector:":grabbed",matches:function or(ar){return ar.grabbed()}},{selector:":free",matches:function or(ar){return!ar.grabbed()}},{selector:":removed",matches:function or(ar){return ar.removed()}},{selector:":inside",matches:function or(ar){return!ar.removed()}},{selector:":grabbable",matches:function or(ar){return ar.grabbable()}},{selector:":ungrabbable",matches:function or(ar){return!ar.grabbable()}},{selector:":animated",matches:function or(ar){return ar.animated()}},{selector:":unanimated",matches:function or(ar){return!ar.animated()}},{selector:":parent",matches:function or(ar){return ar.isParent()}},{selector:":childless",matches:function or(ar){return ar.isChildless()}},{selector:":child",matches:function or(ar){return ar.isChild()}},{selector:":orphan",matches:function or(ar){return ar.isOrphan()}},{selector:":nonorphan",matches:function or(ar){return ar.isChild()}},{selector:":compound",matches:function or(ar){return ar.isNode()?ar.isParent():ar.source().isParent()||ar.target().isParent()}},{selector:":loop",matches:function or(ar){return ar.isLoop()}},{selector:":simple",matches:function or(ar){return ar.isSimple()}},{selector:":active",matches:function or(ar){return ar.active()}},{selector:":inactive",matches:function or(ar){return!ar.active()}},{selector:":backgrounding",matches:function or(ar){return ar.backgrounding()}},{selector:":nonbackgrounding",matches:function or(ar){return!ar.backgrounding()}}].sort(function(or,ar){return descending(or.selector,ar.selector)}),lookup=function(){for(var or={},ar,lr=0;lr<stateSelectors.length;lr++)ar=stateSelectors[lr],or[ar.selector]=ar.matches;return or}(),stateSelectorMatches=function or(ar,lr){return lookup[ar](lr)},stateSelectorRegex="("+stateSelectors.map(function(or){return or.selector}).join("|")+")",cleanMetaChars=function or(ar){return ar.replace(new RegExp("\\\\("+tokens.metaChar+")","g"),function(lr,ur){return ur})},replaceLastQuery=function or(ar,lr,ur){ar[ar.length-1]=ur},exprs=[{name:"group",query:!0,regex:"("+tokens.group+")",populate:function or(ar,lr,ur){var cr=_slicedToArray(ur,1),hr=cr[0];lr.checks.push({type:Type.GROUP,value:hr==="*"?hr:hr+"s"})}},{name:"state",query:!0,regex:stateSelectorRegex,populate:function or(ar,lr,ur){var cr=_slicedToArray(ur,1),hr=cr[0];lr.checks.push({type:Type.STATE,value:hr})}},{name:"id",query:!0,regex:"\\#("+tokens.id+")",populate:function or(ar,lr,ur){var cr=_slicedToArray(ur,1),hr=cr[0];lr.checks.push({type:Type.ID,value:cleanMetaChars(hr)})}},{name:"className",query:!0,regex:"\\.("+tokens.className+")",populate:function or(ar,lr,ur){var cr=_slicedToArray(ur,1),hr=cr[0];lr.checks.push({type:Type.CLASS,value:cleanMetaChars(hr)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+tokens.variable+")\\s*\\]",populate:function or(ar,lr,ur){var cr=_slicedToArray(ur,1),hr=cr[0];lr.checks.push({type:Type.DATA_EXIST,field:cleanMetaChars(hr)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+tokens.variable+")\\s*("+tokens.comparatorOp+")\\s*("+tokens.value+")\\s*\\]",populate:function or(ar,lr,ur){var cr=_slicedToArray(ur,3),hr=cr[0],dr=cr[1],fr=cr[2],pr=new RegExp("^"+tokens.string+"$").exec(fr)!=null;pr?fr=fr.substring(1,fr.length-1):fr=parseFloat(fr),lr.checks.push({type:Type.DATA_COMPARE,field:cleanMetaChars(hr),operator:dr,value:fr})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+tokens.boolOp+")\\s*("+tokens.variable+")\\s*\\]",populate:function or(ar,lr,ur){var cr=_slicedToArray(ur,2),hr=cr[0],dr=cr[1];lr.checks.push({type:Type.DATA_BOOL,field:cleanMetaChars(dr),operator:hr})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+tokens.meta+")\\s*("+tokens.comparatorOp+")\\s*("+tokens.number+")\\s*\\]\\]",populate:function or(ar,lr,ur){var cr=_slicedToArray(ur,3),hr=cr[0],dr=cr[1],fr=cr[2];lr.checks.push({type:Type.META_COMPARE,field:cleanMetaChars(hr),operator:dr,value:parseFloat(fr)})}},{name:"nextQuery",separator:!0,regex:tokens.separator,populate:function or(ar,lr){var ur=ar.currentSubject,cr=ar.edgeCount,hr=ar.compoundCount,dr=ar[ar.length-1];ur!=null&&(dr.subject=ur,ar.currentSubject=null),dr.edgeCount=cr,dr.compoundCount=hr,ar.edgeCount=0,ar.compoundCount=0;var fr=ar[ar.length++]=newQuery();return fr}},{name:"directedEdge",separator:!0,regex:tokens.directedEdge,populate:function or(ar,lr){if(ar.currentSubject==null){var ur=newQuery(),cr=lr,hr=newQuery();return ur.checks.push({type:Type.DIRECTED_EDGE,source:cr,target:hr}),replaceLastQuery(ar,lr,ur),ar.edgeCount++,hr}else{var dr=newQuery(),fr=lr,pr=newQuery();return dr.checks.push({type:Type.NODE_SOURCE,source:fr,target:pr}),replaceLastQuery(ar,lr,dr),ar.edgeCount++,pr}}},{name:"undirectedEdge",separator:!0,regex:tokens.undirectedEdge,populate:function or(ar,lr){if(ar.currentSubject==null){var ur=newQuery(),cr=lr,hr=newQuery();return ur.checks.push({type:Type.UNDIRECTED_EDGE,nodes:[cr,hr]}),replaceLastQuery(ar,lr,ur),ar.edgeCount++,hr}else{var dr=newQuery(),fr=lr,pr=newQuery();return dr.checks.push({type:Type.NODE_NEIGHBOR,node:fr,neighbor:pr}),replaceLastQuery(ar,lr,dr),pr}}},{name:"child",separator:!0,regex:tokens.child,populate:function or(ar,lr){if(ar.currentSubject==null){var ur=newQuery(),cr=newQuery(),hr=ar[ar.length-1];return ur.checks.push({type:Type.CHILD,parent:hr,child:cr}),replaceLastQuery(ar,lr,ur),ar.compoundCount++,cr}else if(ar.currentSubject===lr){var dr=newQuery(),fr=ar[ar.length-1],pr=newQuery(),vr=newQuery(),gr=newQuery(),mr=newQuery();return dr.checks.push({type:Type.COMPOUND_SPLIT,left:fr,right:pr,subject:vr}),vr.checks=lr.checks,lr.checks=[{type:Type.TRUE}],mr.checks.push({type:Type.TRUE}),pr.checks.push({type:Type.PARENT,parent:mr,child:gr}),replaceLastQuery(ar,fr,dr),ar.currentSubject=vr,ar.compoundCount++,gr}else{var br=newQuery(),yr=newQuery(),xr=[{type:Type.PARENT,parent:br,child:yr}];return br.checks=lr.checks,lr.checks=xr,ar.compoundCount++,yr}}},{name:"descendant",separator:!0,regex:tokens.descendant,populate:function or(ar,lr){if(ar.currentSubject==null){var ur=newQuery(),cr=newQuery(),hr=ar[ar.length-1];return ur.checks.push({type:Type.DESCENDANT,ancestor:hr,descendant:cr}),replaceLastQuery(ar,lr,ur),ar.compoundCount++,cr}else if(ar.currentSubject===lr){var dr=newQuery(),fr=ar[ar.length-1],pr=newQuery(),vr=newQuery(),gr=newQuery(),mr=newQuery();return dr.checks.push({type:Type.COMPOUND_SPLIT,left:fr,right:pr,subject:vr}),vr.checks=lr.checks,lr.checks=[{type:Type.TRUE}],mr.checks.push({type:Type.TRUE}),pr.checks.push({type:Type.ANCESTOR,ancestor:mr,descendant:gr}),replaceLastQuery(ar,fr,dr),ar.currentSubject=vr,ar.compoundCount++,gr}else{var br=newQuery(),yr=newQuery(),xr=[{type:Type.ANCESTOR,ancestor:br,descendant:yr}];return br.checks=lr.checks,lr.checks=xr,ar.compoundCount++,yr}}},{name:"subject",modifier:!0,regex:tokens.subject,populate:function or(ar,lr){if(ar.currentSubject!=null&&ar.currentSubject!==lr)return warn("Redefinition of subject in selector `"+ar.toString()+"`"),!1;ar.currentSubject=lr;var ur=ar[ar.length-1],cr=ur.checks[0],hr=cr==null?null:cr.type;hr===Type.DIRECTED_EDGE?cr.type=Type.NODE_TARGET:hr===Type.UNDIRECTED_EDGE&&(cr.type=Type.NODE_NEIGHBOR,cr.node=cr.nodes[1],cr.neighbor=cr.nodes[0],cr.nodes=null)}}];exprs.forEach(function(or){return or.regexObj=new RegExp("^"+or.regex)});var consumeExpr=function or(ar){for(var lr,ur,cr,hr=0;hr<exprs.length;hr++){var dr=exprs[hr],fr=dr.name,pr=ar.match(dr.regexObj);if(pr!=null){ur=pr,lr=dr,cr=fr;var vr=pr[0];ar=ar.substring(vr.length);break}}return{expr:lr,match:ur,name:cr,remaining:ar}},consumeWhitespace=function or(ar){var lr=ar.match(/^\s+/);if(lr){var ur=lr[0];ar=ar.substring(ur.length)}return ar},parse=function or(ar){var lr=this,ur=lr.inputText=ar,cr=lr[0]=newQuery();for(lr.length=1,ur=consumeWhitespace(ur);;){var hr=consumeExpr(ur);if(hr.expr==null)return warn("The selector `"+ar+"`is invalid"),!1;var dr=hr.match.slice(1),fr=hr.expr.populate(lr,cr,dr);if(fr===!1)return!1;if(fr!=null&&(cr=fr),ur=hr.remaining,ur.match(/^\s*$/))break}var pr=lr[lr.length-1];lr.currentSubject!=null&&(pr.subject=lr.currentSubject),pr.edgeCount=lr.edgeCount,pr.compoundCount=lr.compoundCount;for(var vr=0;vr<lr.length;vr++){var gr=lr[vr];if(gr.compoundCount>0&&gr.edgeCount>0)return warn("The selector `"+ar+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(gr.edgeCount>1)return warn("The selector `"+ar+"` is invalid because it uses multiple edge selectors"),!1;gr.edgeCount===1&&warn("The selector `"+ar+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},toString=function or(){if(this.toStringCache!=null)return this.toStringCache;for(var ar=function(gr){return gr??""},lr=function(gr){return string(gr)?'"'+gr+'"':ar(gr)},ur=function(gr){return" "+gr+" "},cr=function(gr,mr){var br=gr.type,yr=gr.value;switch(br){case Type.GROUP:{var xr=ar(yr);return xr.substring(0,xr.length-1)}case Type.DATA_COMPARE:{var Cr=gr.field,Sr=gr.operator;return"["+Cr+ur(ar(Sr))+lr(yr)+"]"}case Type.DATA_BOOL:{var wr=gr.operator,Er=gr.field;return"["+ar(wr)+Er+"]"}case Type.DATA_EXIST:{var Ar=gr.field;return"["+Ar+"]"}case Type.META_COMPARE:{var Tr=gr.operator,Rr=gr.field;return"[["+Rr+ur(ar(Tr))+lr(yr)+"]]"}case Type.STATE:return yr;case Type.ID:return"#"+yr;case Type.CLASS:return"."+yr;case Type.PARENT:case Type.CHILD:return hr(gr.parent,mr)+ur(">")+hr(gr.child,mr);case Type.ANCESTOR:case Type.DESCENDANT:return hr(gr.ancestor,mr)+" "+hr(gr.descendant,mr);case Type.COMPOUND_SPLIT:{var Pr=hr(gr.left,mr),_r=hr(gr.subject,mr),kr=hr(gr.right,mr);return Pr+(Pr.length>0?" ":"")+_r+kr}case Type.TRUE:return""}},hr=function(gr,mr){return gr.checks.reduce(function(br,yr,xr){return br+(mr===gr&&xr===0?"$":"")+cr(yr,mr)},"")},dr="",fr=0;fr<this.length;fr++){var pr=this[fr];dr+=hr(pr,pr.subject),this.length>1&&fr<this.length-1&&(dr+=", ")}return this.toStringCache=dr,dr},parse$1={parse,toString},valCmp=function or(ar,lr,ur){var cr,hr=string(ar),dr=number$1(ar),fr=string(ur),pr,vr,gr=!1,mr=!1,br=!1;switch(lr.indexOf("!")>=0&&(lr=lr.replace("!",""),mr=!0),lr.indexOf("@")>=0&&(lr=lr.replace("@",""),gr=!0),(hr||fr||gr)&&(pr=!hr&&!dr?"":""+ar,vr=""+ur),gr&&(ar=pr=pr.toLowerCase(),ur=vr=vr.toLowerCase()),lr){case"*=":cr=pr.indexOf(vr)>=0;break;case"$=":cr=pr.indexOf(vr,pr.length-vr.length)>=0;break;case"^=":cr=pr.indexOf(vr)===0;break;case"=":cr=ar===ur;break;case">":br=!0,cr=ar>ur;break;case">=":br=!0,cr=ar>=ur;break;case"<":br=!0,cr=ar<ur;break;case"<=":br=!0,cr=ar<=ur;break;default:cr=!1;break}return mr&&(ar!=null||!br)&&(cr=!cr),cr},boolCmp=function or(ar,lr){switch(lr){case"?":return!!ar;case"!":return!ar;case"^":return ar===void 0}},existCmp=function or(ar){return ar!==void 0},data$1=function or(ar,lr){return ar.data(lr)},meta=function or(ar,lr){return ar[lr]()},match=[],matches$1=function or(ar,lr){return ar.checks.every(function(ur){return match[ur.type](ur,lr)})};match[Type.GROUP]=function(or,ar){var lr=or.value;return lr==="*"||lr===ar.group()};match[Type.STATE]=function(or,ar){var lr=or.value;return stateSelectorMatches(lr,ar)};match[Type.ID]=function(or,ar){var lr=or.value;return ar.id()===lr};match[Type.CLASS]=function(or,ar){var lr=or.value;return ar.hasClass(lr)};match[Type.META_COMPARE]=function(or,ar){var lr=or.field,ur=or.operator,cr=or.value;return valCmp(meta(ar,lr),ur,cr)};match[Type.DATA_COMPARE]=function(or,ar){var lr=or.field,ur=or.operator,cr=or.value;return valCmp(data$1(ar,lr),ur,cr)};match[Type.DATA_BOOL]=function(or,ar){var lr=or.field,ur=or.operator;return boolCmp(data$1(ar,lr),ur)};match[Type.DATA_EXIST]=function(or,ar){var lr=or.field;return or.operator,existCmp(data$1(ar,lr))};match[Type.UNDIRECTED_EDGE]=function(or,ar){var lr=or.nodes[0],ur=or.nodes[1],cr=ar.source(),hr=ar.target();return matches$1(lr,cr)&&matches$1(ur,hr)||matches$1(ur,cr)&&matches$1(lr,hr)};match[Type.NODE_NEIGHBOR]=function(or,ar){return matches$1(or.node,ar)&&ar.neighborhood().some(function(lr){return lr.isNode()&&matches$1(or.neighbor,lr)})};match[Type.DIRECTED_EDGE]=function(or,ar){return matches$1(or.source,ar.source())&&matches$1(or.target,ar.target())};match[Type.NODE_SOURCE]=function(or,ar){return matches$1(or.source,ar)&&ar.outgoers().some(function(lr){return lr.isNode()&&matches$1(or.target,lr)})};match[Type.NODE_TARGET]=function(or,ar){return matches$1(or.target,ar)&&ar.incomers().some(function(lr){return lr.isNode()&&matches$1(or.source,lr)})};match[Type.CHILD]=function(or,ar){return matches$1(or.child,ar)&&matches$1(or.parent,ar.parent())};match[Type.PARENT]=function(or,ar){return matches$1(or.parent,ar)&&ar.children().some(function(lr){return matches$1(or.child,lr)})};match[Type.DESCENDANT]=function(or,ar){return matches$1(or.descendant,ar)&&ar.ancestors().some(function(lr){return matches$1(or.ancestor,lr)})};match[Type.ANCESTOR]=function(or,ar){return matches$1(or.ancestor,ar)&&ar.descendants().some(function(lr){return matches$1(or.descendant,lr)})};match[Type.COMPOUND_SPLIT]=function(or,ar){return matches$1(or.subject,ar)&&matches$1(or.left,ar)&&matches$1(or.right,ar)};match[Type.TRUE]=function(){return!0};match[Type.COLLECTION]=function(or,ar){var lr=or.value;return lr.has(ar)};match[Type.FILTER]=function(or,ar){var lr=or.value;return lr(ar)};var filter=function or(ar){var lr=this;if(lr.length===1&&lr[0].checks.length===1&&lr[0].checks[0].type===Type.ID)return ar.getElementById(lr[0].checks[0].value).collection();var ur=function(hr){for(var dr=0;dr<lr.length;dr++){var fr=lr[dr];if(matches$1(fr,hr))return!0}return!1};return lr.text()==null&&(ur=function(){return!0}),ar.filter(ur)},matches=function or(ar){for(var lr=this,ur=0;ur<lr.length;ur++){var cr=lr[ur];if(matches$1(cr,ar))return!0}return!1},matching={matches,filter},Selector=function or(ar){this.inputText=ar,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,ar==null||string(ar)&&ar.match(/^\s*$/)||(elementOrCollection(ar)?this.addQuery({checks:[{type:Type.COLLECTION,value:ar.collection()}]}):fn$6(ar)?this.addQuery({checks:[{type:Type.FILTER,value:ar}]}):string(ar)?this.parse(ar)||(this.invalid=!0):error("A selector must be created from a string; found "))},selfn=Selector.prototype;[parse$1,matching].forEach(function(or){return extend(selfn,or)});selfn.text=function(){return this.inputText};selfn.size=function(){return this.length};selfn.eq=function(or){return this[or]};selfn.sameText=function(or){return!this.invalid&&!or.invalid&&this.text()===or.text()};selfn.addQuery=function(or){this[this.length++]=or};selfn.selector=selfn.toString;var elesfn$g={allAre:function or(ar){var lr=new Selector(ar);return this.every(function(ur){return lr.matches(ur)})},is:function or(ar){var lr=new Selector(ar);return this.some(function(ur){return lr.matches(ur)})},some:function or(ar,lr){for(var ur=0;ur<this.length;ur++){var cr=lr?ar.apply(lr,[this[ur],ur,this]):ar(this[ur],ur,this);if(cr)return!0}return!1},every:function or(ar,lr){for(var ur=0;ur<this.length;ur++){var cr=lr?ar.apply(lr,[this[ur],ur,this]):ar(this[ur],ur,this);if(!cr)return!1}return!0},same:function or(ar){if(this===ar)return!0;ar=this.cy().collection(ar);var lr=this.length,ur=ar.length;return lr!==ur?!1:lr===1?this[0]===ar[0]:this.every(function(cr){return ar.hasElementWithId(cr.id())})},anySame:function or(ar){return ar=this.cy().collection(ar),this.some(function(lr){return ar.hasElementWithId(lr.id())})},allAreNeighbors:function or(ar){ar=this.cy().collection(ar);var lr=this.neighborhood();return ar.every(function(ur){return lr.hasElementWithId(ur.id())})},contains:function or(ar){ar=this.cy().collection(ar);var lr=this;return ar.every(function(ur){return lr.hasElementWithId(ur.id())})}};elesfn$g.allAreNeighbours=elesfn$g.allAreNeighbors;elesfn$g.has=elesfn$g.contains;elesfn$g.equal=elesfn$g.equals=elesfn$g.same;var cache=function or(ar,lr){return function(cr,hr,dr,fr){var pr=cr,vr=this,gr;if(pr==null?gr="":elementOrCollection(pr)&&pr.length===1&&(gr=pr.id()),vr.length===1&&gr){var mr=vr[0]._private,br=mr.traversalCache=mr.traversalCache||{},yr=br[lr]=br[lr]||[],xr=hashString(gr),Cr=yr[xr];return Cr||(yr[xr]=ar.call(vr,cr,hr,dr,fr))}else return ar.call(vr,cr,hr,dr,fr)}},elesfn$f={parent:function or(ar){var lr=[];if(this.length===1){var ur=this[0]._private.parent;if(ur)return ur}for(var cr=0;cr<this.length;cr++){var hr=this[cr],dr=hr._private.parent;dr&&lr.push(dr)}return this.spawn(lr,!0).filter(ar)},parents:function or(ar){for(var lr=[],ur=this.parent();ur.nonempty();){for(var cr=0;cr<ur.length;cr++){var hr=ur[cr];lr.push(hr)}ur=ur.parent()}return this.spawn(lr,!0).filter(ar)},commonAncestors:function or(ar){for(var lr,ur=0;ur<this.length;ur++){var cr=this[ur],hr=cr.parents();lr=lr||hr,lr=lr.intersect(hr)}return lr.filter(ar)},orphans:function or(ar){return this.stdFilter(function(lr){return lr.isOrphan()}).filter(ar)},nonorphans:function or(ar){return this.stdFilter(function(lr){return lr.isChild()}).filter(ar)},children:cache(function(or){for(var ar=[],lr=0;lr<this.length;lr++)for(var ur=this[lr],cr=ur._private.children,hr=0;hr<cr.length;hr++)ar.push(cr[hr]);return this.spawn(ar,!0).filter(or)},"children"),siblings:function or(ar){return this.parent().children().not(this).filter(ar)},isParent:function or(){var ar=this[0];if(ar)return ar.isNode()&&ar._private.children.length!==0},isChildless:function or(){var ar=this[0];if(ar)return ar.isNode()&&ar._private.children.length===0},isChild:function or(){var ar=this[0];if(ar)return ar.isNode()&&ar._private.parent!=null},isOrphan:function or(){var ar=this[0];if(ar)return ar.isNode()&&ar._private.parent==null},descendants:function or(ar){var lr=[];function ur(cr){for(var hr=0;hr<cr.length;hr++){var dr=cr[hr];lr.push(dr),dr.children().nonempty()&&ur(dr.children())}}return ur(this.children()),this.spawn(lr,!0).filter(ar)}};function forEachCompound(or,ar,lr,ur){for(var cr=[],hr=new Set$1,dr=or.cy(),fr=dr.hasCompoundNodes(),pr=0;pr<or.length;pr++){var vr=or[pr];lr?cr.push(vr):fr&&ur(cr,hr,vr)}for(;cr.length>0;){var gr=cr.shift();ar(gr),hr.add(gr.id()),fr&&ur(cr,hr,gr)}return or}function addChildren(or,ar,lr){if(lr.isParent())for(var ur=lr._private.children,cr=0;cr<ur.length;cr++){var hr=ur[cr];ar.has(hr.id())||or.push(hr)}}elesfn$f.forEachDown=function(or){var ar=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return forEachCompound(this,or,ar,addChildren)};function addParent(or,ar,lr){if(lr.isChild()){var ur=lr._private.parent;ar.has(ur.id())||or.push(ur)}}elesfn$f.forEachUp=function(or){var ar=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return forEachCompound(this,or,ar,addParent)};function addParentAndChildren(or,ar,lr){addParent(or,ar,lr),addChildren(or,ar,lr)}elesfn$f.forEachUpAndDown=function(or){var ar=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return forEachCompound(this,or,ar,addParentAndChildren)};elesfn$f.ancestors=elesfn$f.parents;var fn$5,elesfn$e;fn$5=elesfn$e={data:define.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:define.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:define.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:define.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:define.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:define.removeData({field:"rscratch",triggerEvent:!1}),id:function or(){var ar=this[0];if(ar)return ar._private.data.id}};fn$5.attr=fn$5.data;fn$5.removeAttr=fn$5.removeData;var data=elesfn$e,elesfn$d={};function defineDegreeFunction(or){return function(ar){var lr=this;if(ar===void 0&&(ar=!0),lr.length!==0)if(lr.isNode()&&!lr.removed()){for(var ur=0,cr=lr[0],hr=cr._private.edges,dr=0;dr<hr.length;dr++){var fr=hr[dr];!ar&&fr.isLoop()||(ur+=or(cr,fr))}return ur}else return}}extend(elesfn$d,{degree:defineDegreeFunction(function(or,ar){return ar.source().same(ar.target())?2:1}),indegree:defineDegreeFunction(function(or,ar){return ar.target().same(or)?1:0}),outdegree:defineDegreeFunction(function(or,ar){return ar.source().same(or)?1:0})});function defineDegreeBoundsFunction(or,ar){return function(lr){for(var ur,cr=this.nodes(),hr=0;hr<cr.length;hr++){var dr=cr[hr],fr=dr[or](lr);fr!==void 0&&(ur===void 0||ar(fr,ur))&&(ur=fr)}return ur}}extend(elesfn$d,{minDegree:defineDegreeBoundsFunction("degree",function(or,ar){return or<ar}),maxDegree:defineDegreeBoundsFunction("degree",function(or,ar){return or>ar}),minIndegree:defineDegreeBoundsFunction("indegree",function(or,ar){return or<ar}),maxIndegree:defineDegreeBoundsFunction("indegree",function(or,ar){return or>ar}),minOutdegree:defineDegreeBoundsFunction("outdegree",function(or,ar){return or<ar}),maxOutdegree:defineDegreeBoundsFunction("outdegree",function(or,ar){return or>ar})});extend(elesfn$d,{totalDegree:function or(ar){for(var lr=0,ur=this.nodes(),cr=0;cr<ur.length;cr++)lr+=ur[cr].degree(ar);return lr}});var fn$4,elesfn$c,beforePositionSet=function or(ar,lr,ur){for(var cr=0;cr<ar.length;cr++){var hr=ar[cr];if(!hr.locked()){var dr=hr._private.position,fr={x:lr.x!=null?lr.x-dr.x:0,y:lr.y!=null?lr.y-dr.y:0};hr.isParent()&&!(fr.x===0&&fr.y===0)&&hr.children().shift(fr,ur),hr.dirtyBoundingBoxCache()}}},positionDef={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function or(ar){ar.updateCompoundBounds()},beforeSet:function or(ar,lr){beforePositionSet(ar,lr,!1)},onSet:function or(ar){ar.dirtyCompoundBoundsCache()},canSet:function or(ar){return!ar.locked()}};fn$4=elesfn$c={position:define.data(positionDef),silentPosition:define.data(extend({},positionDef,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function or(ar,lr){beforePositionSet(ar,lr,!0)},onSet:function or(ar){ar.dirtyCompoundBoundsCache()}})),positions:function or(ar,lr){if(plainObject(ar))lr?this.silentPosition(ar):this.position(ar);else if(fn$6(ar)){var ur=ar,cr=this.cy();cr.startBatch();for(var hr=0;hr<this.length;hr++){var dr=this[hr],fr=void 0;(fr=ur(dr,hr))&&(lr?dr.silentPosition(fr):dr.position(fr))}cr.endBatch()}return this},silentPositions:function or(ar){return this.positions(ar,!0)},shift:function or(ar,lr,ur){var cr;if(plainObject(ar)?(cr={x:number$1(ar.x)?ar.x:0,y:number$1(ar.y)?ar.y:0},ur=lr):string(ar)&&number$1(lr)&&(cr={x:0,y:0},cr[ar]=lr),cr!=null){var hr=this.cy();hr.startBatch();for(var dr=0;dr<this.length;dr++){var fr=this[dr];if(!(hr.hasCompoundNodes()&&fr.isChild()&&fr.ancestors().anySame(this))){var pr=fr.position(),vr={x:pr.x+cr.x,y:pr.y+cr.y};ur?fr.silentPosition(vr):fr.position(vr)}}hr.endBatch()}return this},silentShift:function or(ar,lr){return plainObject(ar)?this.shift(ar,!0):string(ar)&&number$1(lr)&&this.shift(ar,lr,!0),this},renderedPosition:function or(ar,lr){var ur=this[0],cr=this.cy(),hr=cr.zoom(),dr=cr.pan(),fr=plainObject(ar)?ar:void 0,pr=fr!==void 0||lr!==void 0&&string(ar);if(ur&&ur.isNode())if(pr)for(var vr=0;vr<this.length;vr++){var gr=this[vr];lr!==void 0?gr.position(ar,(lr-dr[ar])/hr):fr!==void 0&&gr.position(renderedToModelPosition(fr,hr,dr))}else{var mr=ur.position();return fr=modelToRenderedPosition$1(mr,hr,dr),ar===void 0?fr:fr[ar]}else if(!pr)return;return this},relativePosition:function or(ar,lr){var ur=this[0],cr=this.cy(),hr=plainObject(ar)?ar:void 0,dr=hr!==void 0||lr!==void 0&&string(ar),fr=cr.hasCompoundNodes();if(ur&&ur.isNode())if(dr)for(var pr=0;pr<this.length;pr++){var vr=this[pr],gr=fr?vr.parent():null,mr=gr&&gr.length>0,br=mr;mr&&(gr=gr[0]);var yr=br?gr.position():{x:0,y:0};lr!==void 0?vr.position(ar,lr+yr[ar]):hr!==void 0&&vr.position({x:hr.x+yr.x,y:hr.y+yr.y})}else{var xr=ur.position(),Cr=fr?ur.parent():null,Sr=Cr&&Cr.length>0,wr=Sr;Sr&&(Cr=Cr[0]);var Er=wr?Cr.position():{x:0,y:0};return hr={x:xr.x-Er.x,y:xr.y-Er.y},ar===void 0?hr:hr[ar]}else if(!dr)return;return this}};fn$4.modelPosition=fn$4.point=fn$4.position;fn$4.modelPositions=fn$4.points=fn$4.positions;fn$4.renderedPoint=fn$4.renderedPosition;fn$4.relativePoint=fn$4.relativePosition;var position=elesfn$c,fn$3,elesfn$b;fn$3=elesfn$b={};elesfn$b.renderedBoundingBox=function(or){var ar=this.boundingBox(or),lr=this.cy(),ur=lr.zoom(),cr=lr.pan(),hr=ar.x1*ur+cr.x,dr=ar.x2*ur+cr.x,fr=ar.y1*ur+cr.y,pr=ar.y2*ur+cr.y;return{x1:hr,x2:dr,y1:fr,y2:pr,w:dr-hr,h:pr-fr}};elesfn$b.dirtyCompoundBoundsCache=function(){var or=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ar=this.cy();return!ar.styleEnabled()||!ar.hasCompoundNodes()?this:(this.forEachUp(function(lr){if(lr.isParent()){var ur=lr._private;ur.compoundBoundsClean=!1,ur.bbCache=null,or||lr.emitAndNotify("bounds")}}),this)};elesfn$b.updateCompoundBounds=function(){var or=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,ar=this.cy();if(!ar.styleEnabled()||!ar.hasCompoundNodes())return this;if(!or&&ar.batching())return this;function lr(dr){if(!dr.isParent())return;var fr=dr._private,pr=dr.children(),vr=dr.pstyle("compound-sizing-wrt-labels").value==="include",gr={width:{val:dr.pstyle("min-width").pfValue,left:dr.pstyle("min-width-bias-left"),right:dr.pstyle("min-width-bias-right")},height:{val:dr.pstyle("min-height").pfValue,top:dr.pstyle("min-height-bias-top"),bottom:dr.pstyle("min-height-bias-bottom")}},mr=pr.boundingBox({includeLabels:vr,includeOverlays:!1,useCache:!1}),br=fr.position;(mr.w===0||mr.h===0)&&(mr={w:dr.pstyle("width").pfValue,h:dr.pstyle("height").pfValue},mr.x1=br.x-mr.w/2,mr.x2=br.x+mr.w/2,mr.y1=br.y-mr.h/2,mr.y2=br.y+mr.h/2);function yr(Dr,Nr,Lr){var Or=0,Ir=0,Mr=Nr+Lr;return Dr>0&&Mr>0&&(Or=Nr/Mr*Dr,Ir=Lr/Mr*Dr),{biasDiff:Or,biasComplementDiff:Ir}}function xr(Dr,Nr,Lr,Or){if(Lr.units==="%")switch(Or){case"width":return Dr>0?Lr.pfValue*Dr:0;case"height":return Nr>0?Lr.pfValue*Nr:0;case"average":return Dr>0&&Nr>0?Lr.pfValue*(Dr+Nr)/2:0;case"min":return Dr>0&&Nr>0?Dr>Nr?Lr.pfValue*Nr:Lr.pfValue*Dr:0;case"max":return Dr>0&&Nr>0?Dr>Nr?Lr.pfValue*Dr:Lr.pfValue*Nr:0;default:return 0}else return Lr.units==="px"?Lr.pfValue:0}var Cr=gr.width.left.value;gr.width.left.units==="px"&&gr.width.val>0&&(Cr=Cr*100/gr.width.val);var Sr=gr.width.right.value;gr.width.right.units==="px"&&gr.width.val>0&&(Sr=Sr*100/gr.width.val);var wr=gr.height.top.value;gr.height.top.units==="px"&&gr.height.val>0&&(wr=wr*100/gr.height.val);var Er=gr.height.bottom.value;gr.height.bottom.units==="px"&&gr.height.val>0&&(Er=Er*100/gr.height.val);var Ar=yr(gr.width.val-mr.w,Cr,Sr),Tr=Ar.biasDiff,Rr=Ar.biasComplementDiff,Pr=yr(gr.height.val-mr.h,wr,Er),_r=Pr.biasDiff,kr=Pr.biasComplementDiff;fr.autoPadding=xr(mr.w,mr.h,dr.pstyle("padding"),dr.pstyle("padding-relative-to").value),fr.autoWidth=Math.max(mr.w,gr.width.val),br.x=(-Tr+mr.x1+mr.x2+Rr)/2,fr.autoHeight=Math.max(mr.h,gr.height.val),br.y=(-_r+mr.y1+mr.y2+kr)/2}for(var ur=0;ur<this.length;ur++){var cr=this[ur],hr=cr._private;(!hr.compoundBoundsClean||or)&&(lr(cr),ar.batching()||(hr.compoundBoundsClean=!0))}return this};var noninf=function or(ar){return ar===1/0||ar===-1/0?0:ar},updateBounds=function or(ar,lr,ur,cr,hr){cr-lr===0||hr-ur===0||lr==null||ur==null||cr==null||hr==null||(ar.x1=lr<ar.x1?lr:ar.x1,ar.x2=cr>ar.x2?cr:ar.x2,ar.y1=ur<ar.y1?ur:ar.y1,ar.y2=hr>ar.y2?hr:ar.y2,ar.w=ar.x2-ar.x1,ar.h=ar.y2-ar.y1)},updateBoundsFromBox=function or(ar,lr){return lr==null?ar:updateBounds(ar,lr.x1,lr.y1,lr.x2,lr.y2)},prefixedProperty=function or(ar,lr,ur){return getPrefixedProperty(ar,lr,ur)},updateBoundsFromArrow=function or(ar,lr,ur){if(!lr.cy().headless()){var cr=lr._private,hr=cr.rstyle,dr=hr.arrowWidth/2,fr=lr.pstyle(ur+"-arrow-shape").value,pr,vr;if(fr!=="none"){ur==="source"?(pr=hr.srcX,vr=hr.srcY):ur==="target"?(pr=hr.tgtX,vr=hr.tgtY):(pr=hr.midX,vr=hr.midY);var gr=cr.arrowBounds=cr.arrowBounds||{},mr=gr[ur]=gr[ur]||{};mr.x1=pr-dr,mr.y1=vr-dr,mr.x2=pr+dr,mr.y2=vr+dr,mr.w=mr.x2-mr.x1,mr.h=mr.y2-mr.y1,expandBoundingBox(mr,1),updateBounds(ar,mr.x1,mr.y1,mr.x2,mr.y2)}}},updateBoundsFromLabel=function or(ar,lr,ur){if(!lr.cy().headless()){var cr;ur?cr=ur+"-":cr="";var hr=lr._private,dr=hr.rstyle,fr=lr.pstyle(cr+"label").strValue;if(fr){var pr=lr.pstyle("text-halign"),vr=lr.pstyle("text-valign"),gr=prefixedProperty(dr,"labelWidth",ur),mr=prefixedProperty(dr,"labelHeight",ur),br=prefixedProperty(dr,"labelX",ur),yr=prefixedProperty(dr,"labelY",ur),xr=lr.pstyle(cr+"text-margin-x").pfValue,Cr=lr.pstyle(cr+"text-margin-y").pfValue,Sr=lr.isEdge(),wr=lr.pstyle(cr+"text-rotation"),Er=lr.pstyle("text-outline-width").pfValue,Ar=lr.pstyle("text-border-width").pfValue,Tr=Ar/2,Rr=lr.pstyle("text-background-padding").pfValue,Pr=2,_r=mr,kr=gr,Dr=kr/2,Nr=_r/2,Lr,Or,Ir,Mr;if(Sr)Lr=br-Dr,Or=br+Dr,Ir=yr-Nr,Mr=yr+Nr;else{switch(pr.value){case"left":Lr=br-kr,Or=br;break;case"center":Lr=br-Dr,Or=br+Dr;break;case"right":Lr=br,Or=br+kr;break}switch(vr.value){case"top":Ir=yr-_r,Mr=yr;break;case"center":Ir=yr-Nr,Mr=yr+Nr;break;case"bottom":Ir=yr,Mr=yr+_r;break}}var $r=xr-Math.max(Er,Tr)-Rr-Pr,jr=xr+Math.max(Er,Tr)+Rr+Pr,Fr=Cr-Math.max(Er,Tr)-Rr-Pr,zr=Cr+Math.max(Er,Tr)+Rr+Pr;Lr+=$r,Or+=jr,Ir+=Fr,Mr+=zr;var Hr=ur||"main",Wr=hr.labelBounds,Yr=Wr[Hr]=Wr[Hr]||{};Yr.x1=Lr,Yr.y1=Ir,Yr.x2=Or,Yr.y2=Mr,Yr.w=Or-Lr,Yr.h=Mr-Ir,Yr.leftPad=$r,Yr.rightPad=jr,Yr.topPad=Fr,Yr.botPad=zr;var qr=Sr&&wr.strValue==="autorotate",Br=wr.pfValue!=null&&wr.pfValue!==0;if(qr||Br){var Ur=qr?prefixedProperty(hr.rstyle,"labelAngle",ur):wr.pfValue,Vr=Math.cos(Ur),Xr=Math.sin(Ur),Zr=(Lr+Or)/2,Jr=(Ir+Mr)/2;if(!Sr){switch(pr.value){case"left":Zr=Or;break;case"right":Zr=Lr;break}switch(vr.value){case"top":Jr=Mr;break;case"bottom":Jr=Ir;break}}var Qr=function(as,Kr){return as=as-Zr,Kr=Kr-Jr,{x:as*Vr-Kr*Xr+Zr,y:as*Xr+Kr*Vr+Jr}},ga=Qr(Lr,Ir),ba=Qr(Lr,Mr),_i=Qr(Or,Ir),os=Qr(Or,Mr);Lr=Math.min(ga.x,ba.x,_i.x,os.x),Or=Math.max(ga.x,ba.x,_i.x,os.x),Ir=Math.min(ga.y,ba.y,_i.y,os.y),Mr=Math.max(ga.y,ba.y,_i.y,os.y)}var ls=Hr+"Rot",ys=Wr[ls]=Wr[ls]||{};ys.x1=Lr,ys.y1=Ir,ys.x2=Or,ys.y2=Mr,ys.w=Or-Lr,ys.h=Mr-Ir,updateBounds(ar,Lr,Ir,Or,Mr),updateBounds(hr.labelBounds.all,Lr,Ir,Or,Mr)}return ar}},updateBoundsFromOutline=function or(ar,lr){if(!lr.cy().headless()){var ur=lr.pstyle("outline-opacity").value,cr=lr.pstyle("outline-width").value,hr=lr.pstyle("outline-offset").value,dr=cr+hr;updateBoundsFromMiter(ar,lr,ur,dr,"outside",dr/2)}},updateBoundsFromMiter=function or(ar,lr,ur,cr,hr,dr){if(!(ur===0||cr<=0||hr==="inside")){var fr=lr.cy(),pr=lr.pstyle("shape").value,vr=fr.renderer().nodeShapes[pr],gr=lr.position(),mr=gr.x,br=gr.y,yr=lr.width(),xr=lr.height();if(vr.hasMiterBounds){hr==="center"&&(cr/=2);var Cr=vr.miterBounds(mr,br,yr,xr,cr);updateBoundsFromBox(ar,Cr)}else dr!=null&&dr>0&&expandBoundingBoxSides(ar,[dr,dr,dr,dr])}},updateBoundsFromMiterBorder=function or(ar,lr){if(!lr.cy().headless()){var ur=lr.pstyle("border-opacity").value,cr=lr.pstyle("border-width").pfValue,hr=lr.pstyle("border-position").value;updateBoundsFromMiter(ar,lr,ur,cr,hr)}},boundingBoxImpl=function or(ar,lr){var ur=ar._private.cy,cr=ur.styleEnabled(),hr=ur.headless(),dr=makeBoundingBox(),fr=ar._private,pr=ar.isNode(),vr=ar.isEdge(),gr,mr,br,yr,xr,Cr,Sr=fr.rstyle,wr=pr&&cr?ar.pstyle("bounds-expansion").pfValue:[0],Er=function(ns){return ns.pstyle("display").value!=="none"},Ar=!cr||Er(ar)&&(!vr||Er(ar.source())&&Er(ar.target()));if(Ar){var Tr=0,Rr=0;cr&&lr.includeOverlays&&(Tr=ar.pstyle("overlay-opacity").value,Tr!==0&&(Rr=ar.pstyle("overlay-padding").value));var Pr=0,_r=0;cr&&lr.includeUnderlays&&(Pr=ar.pstyle("underlay-opacity").value,Pr!==0&&(_r=ar.pstyle("underlay-padding").value));var kr=Math.max(Rr,_r),Dr=0,Nr=0;if(cr&&(Dr=ar.pstyle("width").pfValue,Nr=Dr/2),pr&&lr.includeNodes){var Lr=ar.position();xr=Lr.x,Cr=Lr.y;var Or=ar.outerWidth(),Ir=Or/2,Mr=ar.outerHeight(),$r=Mr/2;gr=xr-Ir,mr=xr+Ir,br=Cr-$r,yr=Cr+$r,updateBounds(dr,gr,br,mr,yr),cr&&updateBoundsFromOutline(dr,ar),cr&&lr.includeOutlines&&!hr&&updateBoundsFromOutline(dr,ar),cr&&updateBoundsFromMiterBorder(dr,ar)}else if(vr&&lr.includeEdges)if(cr&&!hr){var jr=ar.pstyle("curve-style").strValue;if(gr=Math.min(Sr.srcX,Sr.midX,Sr.tgtX),mr=Math.max(Sr.srcX,Sr.midX,Sr.tgtX),br=Math.min(Sr.srcY,Sr.midY,Sr.tgtY),yr=Math.max(Sr.srcY,Sr.midY,Sr.tgtY),gr-=Nr,mr+=Nr,br-=Nr,yr+=Nr,updateBounds(dr,gr,br,mr,yr),jr==="haystack"){var Fr=Sr.haystackPts;if(Fr&&Fr.length===2){if(gr=Fr[0].x,br=Fr[0].y,mr=Fr[1].x,yr=Fr[1].y,gr>mr){var zr=gr;gr=mr,mr=zr}if(br>yr){var Hr=br;br=yr,yr=Hr}updateBounds(dr,gr-Nr,br-Nr,mr+Nr,yr+Nr)}}else if(jr==="bezier"||jr==="unbundled-bezier"||endsWith(jr,"segments")||endsWith(jr,"taxi")){var Wr;switch(jr){case"bezier":case"unbundled-bezier":Wr=Sr.bezierPts;break;case"segments":case"taxi":case"round-segments":case"round-taxi":Wr=Sr.linePts;break}if(Wr!=null)for(var Yr=0;Yr<Wr.length;Yr++){var qr=Wr[Yr];gr=qr.x-Nr,mr=qr.x+Nr,br=qr.y-Nr,yr=qr.y+Nr,updateBounds(dr,gr,br,mr,yr)}}}else{var Br=ar.source(),Ur=Br.position(),Vr=ar.target(),Xr=Vr.position();if(gr=Ur.x,mr=Xr.x,br=Ur.y,yr=Xr.y,gr>mr){var Zr=gr;gr=mr,mr=Zr}if(br>yr){var Jr=br;br=yr,yr=Jr}gr-=Nr,mr+=Nr,br-=Nr,yr+=Nr,updateBounds(dr,gr,br,mr,yr)}if(cr&&lr.includeEdges&&vr&&(updateBoundsFromArrow(dr,ar,"mid-source"),updateBoundsFromArrow(dr,ar,"mid-target"),updateBoundsFromArrow(dr,ar,"source"),updateBoundsFromArrow(dr,ar,"target")),cr){var Qr=ar.pstyle("ghost").value==="yes";if(Qr){var ga=ar.pstyle("ghost-offset-x").pfValue,ba=ar.pstyle("ghost-offset-y").pfValue;updateBounds(dr,dr.x1+ga,dr.y1+ba,dr.x2+ga,dr.y2+ba)}}var _i=fr.bodyBounds=fr.bodyBounds||{};assignBoundingBox(_i,dr),expandBoundingBoxSides(_i,wr),expandBoundingBox(_i,1),cr&&(gr=dr.x1,mr=dr.x2,br=dr.y1,yr=dr.y2,updateBounds(dr,gr-kr,br-kr,mr+kr,yr+kr));var os=fr.overlayBounds=fr.overlayBounds||{};assignBoundingBox(os,dr),expandBoundingBoxSides(os,wr),expandBoundingBox(os,1);var ls=fr.labelBounds=fr.labelBounds||{};ls.all!=null?clearBoundingBox(ls.all):ls.all=makeBoundingBox(),cr&&lr.includeLabels&&(lr.includeMainLabels&&updateBoundsFromLabel(dr,ar,null),vr&&(lr.includeSourceLabels&&updateBoundsFromLabel(dr,ar,"source"),lr.includeTargetLabels&&updateBoundsFromLabel(dr,ar,"target")))}return dr.x1=noninf(dr.x1),dr.y1=noninf(dr.y1),dr.x2=noninf(dr.x2),dr.y2=noninf(dr.y2),dr.w=noninf(dr.x2-dr.x1),dr.h=noninf(dr.y2-dr.y1),dr.w>0&&dr.h>0&&Ar&&(expandBoundingBoxSides(dr,wr),expandBoundingBox(dr,1)),dr},getKey=function or(ar){var lr=0,ur=function(dr){return(dr?1:0)<<lr++},cr=0;return cr+=ur(ar.incudeNodes),cr+=ur(ar.includeEdges),cr+=ur(ar.includeLabels),cr+=ur(ar.includeMainLabels),cr+=ur(ar.includeSourceLabels),cr+=ur(ar.includeTargetLabels),cr+=ur(ar.includeOverlays),cr+=ur(ar.includeOutlines),cr},getBoundingBoxPosKey=function or(ar){var lr=function(fr){return Math.round(fr)};if(ar.isEdge()){var ur=ar.source().position(),cr=ar.target().position();return hashIntsArray([lr(ur.x),lr(ur.y),lr(cr.x),lr(cr.y)])}else{var hr=ar.position();return hashIntsArray([lr(hr.x),lr(hr.y)])}},cachedBoundingBoxImpl=function or(ar,lr){var ur=ar._private,cr,hr=ar.isEdge(),dr=lr==null?defBbOptsKey:getKey(lr),fr=dr===defBbOptsKey;if(ur.bbCache==null?(cr=boundingBoxImpl(ar,defBbOpts),ur.bbCache=cr,ur.bbCachePosKey=getBoundingBoxPosKey(ar)):cr=ur.bbCache,!fr){var pr=ar.isNode();cr=makeBoundingBox(),(lr.includeNodes&&pr||lr.includeEdges&&!pr)&&(lr.includeOverlays?updateBoundsFromBox(cr,ur.overlayBounds):updateBoundsFromBox(cr,ur.bodyBounds)),lr.includeLabels&&(lr.includeMainLabels&&(!hr||lr.includeSourceLabels&&lr.includeTargetLabels)?updateBoundsFromBox(cr,ur.labelBounds.all):(lr.includeMainLabels&&updateBoundsFromBox(cr,ur.labelBounds.mainRot),lr.includeSourceLabels&&updateBoundsFromBox(cr,ur.labelBounds.sourceRot),lr.includeTargetLabels&&updateBoundsFromBox(cr,ur.labelBounds.targetRot))),cr.w=cr.x2-cr.x1,cr.h=cr.y2-cr.y1}return cr},defBbOpts={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,includeUnderlays:!0,includeOutlines:!0,useCache:!0},defBbOptsKey=getKey(defBbOpts),filledBbOpts=defaults$g(defBbOpts);elesfn$b.boundingBox=function(or){var ar,lr=or===void 0||or.useCache===void 0||or.useCache===!0,ur=memoize(function(gr){var mr=gr._private;return mr.bbCache==null||mr.styleDirty||mr.bbCachePosKey!==getBoundingBoxPosKey(gr)},function(gr){return gr.id()});if(lr&&this.length===1&&!ur(this[0]))or===void 0?or=defBbOpts:or=filledBbOpts(or),ar=cachedBoundingBoxImpl(this[0],or);else{ar=makeBoundingBox(),or=or||defBbOpts;var cr=filledBbOpts(or),hr=this,dr=hr.cy(),fr=dr.styleEnabled();this.edges().forEach(ur),this.nodes().forEach(ur),fr&&this.recalculateRenderedStyle(lr),this.updateCompoundBounds(!lr);for(var pr=0;pr<hr.length;pr++){var vr=hr[pr];ur(vr)&&vr.dirtyBoundingBoxCache(),updateBoundsFromBox(ar,cachedBoundingBoxImpl(vr,cr))}}return ar.x1=noninf(ar.x1),ar.y1=noninf(ar.y1),ar.x2=noninf(ar.x2),ar.y2=noninf(ar.y2),ar.w=noninf(ar.x2-ar.x1),ar.h=noninf(ar.y2-ar.y1),ar};elesfn$b.dirtyBoundingBoxCache=function(){for(var or=0;or<this.length;or++){var ar=this[or]._private;ar.bbCache=null,ar.bbCachePosKey=null,ar.bodyBounds=null,ar.overlayBounds=null,ar.labelBounds.all=null,ar.labelBounds.source=null,ar.labelBounds.target=null,ar.labelBounds.main=null,ar.labelBounds.sourceRot=null,ar.labelBounds.targetRot=null,ar.labelBounds.mainRot=null,ar.arrowBounds.source=null,ar.arrowBounds.target=null,ar.arrowBounds["mid-source"]=null,ar.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this};elesfn$b.boundingBoxAt=function(or){var ar=this.nodes(),lr=this.cy(),ur=lr.hasCompoundNodes(),cr=lr.collection();if(ur&&(cr=ar.filter(function(vr){return vr.isParent()}),ar=ar.not(cr)),plainObject(or)){var hr=or;or=function(){return hr}}var dr=function(gr,mr){return gr._private.bbAtOldPos=or(gr,mr)},fr=function(gr){return gr._private.bbAtOldPos};lr.startBatch(),ar.forEach(dr).silentPositions(or),ur&&(cr.dirtyCompoundBoundsCache(),cr.dirtyBoundingBoxCache(),cr.updateCompoundBounds(!0));var pr=copyBoundingBox(this.boundingBox({useCache:!1}));return ar.silentPositions(fr),ur&&(cr.dirtyCompoundBoundsCache(),cr.dirtyBoundingBoxCache(),cr.updateCompoundBounds(!0)),lr.endBatch(),pr};fn$3.boundingbox=fn$3.bb=fn$3.boundingBox;fn$3.renderedBoundingbox=fn$3.renderedBoundingBox;var bounds=elesfn$b,fn$2,elesfn$a;fn$2=elesfn$a={};var defineDimFns=function or(ar){ar.uppercaseName=capitalize(ar.name),ar.autoName="auto"+ar.uppercaseName,ar.labelName="label"+ar.uppercaseName,ar.outerName="outer"+ar.uppercaseName,ar.uppercaseOuterName=capitalize(ar.outerName),fn$2[ar.name]=function(){var ur=this[0],cr=ur._private,hr=cr.cy,dr=hr._private.styleEnabled;if(ur)if(dr){if(ur.isParent())return ur.updateCompoundBounds(),cr[ar.autoName]||0;var fr=ur.pstyle(ar.name);switch(fr.strValue){case"label":return ur.recalculateRenderedStyle(),cr.rstyle[ar.labelName]||0;default:return fr.pfValue}}else return 1},fn$2["outer"+ar.uppercaseName]=function(){var ur=this[0],cr=ur._private,hr=cr.cy,dr=hr._private.styleEnabled;if(ur)if(dr){var fr=ur[ar.name](),pr=ur.pstyle("border-position").value,vr;pr==="center"?vr=ur.pstyle("border-width").pfValue:pr==="outside"?vr=2*ur.pstyle("border-width").pfValue:vr=0;var gr=2*ur.padding();return fr+vr+gr}else return 1},fn$2["rendered"+ar.uppercaseName]=function(){var ur=this[0];if(ur){var cr=ur[ar.name]();return cr*this.cy().zoom()}},fn$2["rendered"+ar.uppercaseOuterName]=function(){var ur=this[0];if(ur){var cr=ur[ar.outerName]();return cr*this.cy().zoom()}}};defineDimFns({name:"width"});defineDimFns({name:"height"});elesfn$a.padding=function(){var or=this[0],ar=or._private;return or.isParent()?(or.updateCompoundBounds(),ar.autoPadding!==void 0?ar.autoPadding:or.pstyle("padding").pfValue):or.pstyle("padding").pfValue};elesfn$a.paddedHeight=function(){var or=this[0];return or.height()+2*or.padding()};elesfn$a.paddedWidth=function(){var or=this[0];return or.width()+2*or.padding()};var widthHeight=elesfn$a,ifEdge=function or(ar,lr){if(ar.isEdge()&&ar.takesUpSpace())return lr(ar)},ifEdgeRenderedPosition=function or(ar,lr){if(ar.isEdge()&&ar.takesUpSpace()){var ur=ar.cy();return modelToRenderedPosition$1(lr(ar),ur.zoom(),ur.pan())}},ifEdgeRenderedPositions=function or(ar,lr){if(ar.isEdge()&&ar.takesUpSpace()){var ur=ar.cy(),cr=ur.pan(),hr=ur.zoom();return lr(ar).map(function(dr){return modelToRenderedPosition$1(dr,hr,cr)})}},controlPoints=function or(ar){return ar.renderer().getControlPoints(ar)},segmentPoints=function or(ar){return ar.renderer().getSegmentPoints(ar)},sourceEndpoint=function or(ar){return ar.renderer().getSourceEndpoint(ar)},targetEndpoint=function or(ar){return ar.renderer().getTargetEndpoint(ar)},midpoint=function or(ar){return ar.renderer().getEdgeMidpoint(ar)},pts={controlPoints:{get:controlPoints,mult:!0},segmentPoints:{get:segmentPoints,mult:!0},sourceEndpoint:{get:sourceEndpoint},targetEndpoint:{get:targetEndpoint},midpoint:{get:midpoint}},renderedName=function or(ar){return"rendered"+ar[0].toUpperCase()+ar.substr(1)},edgePoints=Object.keys(pts).reduce(function(or,ar){var lr=pts[ar],ur=renderedName(ar);return or[ar]=function(){return ifEdge(this,lr.get)},lr.mult?or[ur]=function(){return ifEdgeRenderedPositions(this,lr.get)}:or[ur]=function(){return ifEdgeRenderedPosition(this,lr.get)},or},{}),dimensions=extend({},position,bounds,widthHeight,edgePoints);/*!
Event object based on jQuery events, MIT license

https://jquery.org/license/
https://tldrlegal.com/license/mit-license
https://github.com/jquery/jquery/blob/master/src/event.js
*/var Event$1=function or(ar,lr){this.recycle(ar,lr)};function returnFalse(){return!1}function returnTrue(){return!0}Event$1.prototype={instanceString:function or(){return"event"},recycle:function or(ar,lr){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=returnFalse,ar!=null&&ar.preventDefault?(this.type=ar.type,this.isDefaultPrevented=ar.defaultPrevented?returnTrue:returnFalse):ar!=null&&ar.type?lr=ar:this.type=ar,lr!=null&&(this.originalEvent=lr.originalEvent,this.type=lr.type!=null?lr.type:this.type,this.cy=lr.cy,this.target=lr.target,this.position=lr.position,this.renderedPosition=lr.renderedPosition,this.namespace=lr.namespace,this.layout=lr.layout),this.cy!=null&&this.position!=null&&this.renderedPosition==null){var ur=this.position,cr=this.cy.zoom(),hr=this.cy.pan();this.renderedPosition={x:ur.x*cr+hr.x,y:ur.y*cr+hr.y}}this.timeStamp=ar&&ar.timeStamp||Date.now()},preventDefault:function or(){this.isDefaultPrevented=returnTrue;var ar=this.originalEvent;ar&&ar.preventDefault&&ar.preventDefault()},stopPropagation:function or(){this.isPropagationStopped=returnTrue;var ar=this.originalEvent;ar&&ar.stopPropagation&&ar.stopPropagation()},stopImmediatePropagation:function or(){this.isImmediatePropagationStopped=returnTrue,this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};var eventRegex=/^([^.]+)(\.(?:[^.]+))?$/,universalNamespace=".*",defaults$8={qualifierCompare:function or(ar,lr){return ar===lr},eventMatches:function or(){return!0},addEventFields:function or(){},callbackContext:function or(ar){return ar},beforeEmit:function or(){},afterEmit:function or(){},bubble:function or(){return!1},parent:function or(){return null},context:null},defaultsKeys=Object.keys(defaults$8),emptyOpts={};function Emitter(){for(var or=arguments.length>0&&arguments[0]!==void 0?arguments[0]:emptyOpts,ar=arguments.length>1?arguments[1]:void 0,lr=0;lr<defaultsKeys.length;lr++){var ur=defaultsKeys[lr];this[ur]=or[ur]||defaults$8[ur]}this.context=ar||this.context,this.listeners=[],this.emitting=0}var p=Emitter.prototype,forEachEvent=function or(ar,lr,ur,cr,hr,dr,fr){fn$6(cr)&&(hr=cr,cr=null),fr&&(dr==null?dr=fr:dr=extend({},dr,fr));for(var pr=array(ur)?ur:ur.split(/\s+/),vr=0;vr<pr.length;vr++){var gr=pr[vr];if(!emptyString(gr)){var mr=gr.match(eventRegex);if(mr){var br=mr[1],yr=mr[2]?mr[2]:null,xr=lr(ar,gr,br,yr,cr,hr,dr);if(xr===!1)break}}}},makeEventObj=function or(ar,lr){return ar.addEventFields(ar.context,lr),new Event$1(lr.type,lr)},forEachEventObj=function or(ar,lr,ur){if(event(ur)){lr(ar,ur);return}else if(plainObject(ur)){lr(ar,makeEventObj(ar,ur));return}for(var cr=array(ur)?ur:ur.split(/\s+/),hr=0;hr<cr.length;hr++){var dr=cr[hr];if(!emptyString(dr)){var fr=dr.match(eventRegex);if(fr){var pr=fr[1],vr=fr[2]?fr[2]:null,gr=makeEventObj(ar,{type:pr,namespace:vr,target:ar.context});lr(ar,gr)}}}};p.on=p.addListener=function(or,ar,lr,ur,cr){return forEachEvent(this,function(hr,dr,fr,pr,vr,gr,mr){fn$6(gr)&&hr.listeners.push({event:dr,callback:gr,type:fr,namespace:pr,qualifier:vr,conf:mr})},or,ar,lr,ur,cr),this};p.one=function(or,ar,lr,ur){return this.on(or,ar,lr,ur,{one:!0})};p.removeListener=p.off=function(or,ar,lr,ur){var cr=this;this.emitting!==0&&(this.listeners=copyArray(this.listeners));for(var hr=this.listeners,dr=function(vr){var gr=hr[vr];forEachEvent(cr,function(mr,br,yr,xr,Cr,Sr){if((gr.type===yr||or==="*")&&(!xr&&gr.namespace!==".*"||gr.namespace===xr)&&(!Cr||mr.qualifierCompare(gr.qualifier,Cr))&&(!Sr||gr.callback===Sr))return hr.splice(vr,1),!1},or,ar,lr,ur)},fr=hr.length-1;fr>=0;fr--)dr(fr);return this};p.removeAllListeners=function(){return this.removeListener("*")};p.emit=p.trigger=function(or,ar,lr){var ur=this.listeners,cr=ur.length;return this.emitting++,array(ar)||(ar=[ar]),forEachEventObj(this,function(hr,dr){lr!=null&&(ur=[{event:dr.event,type:dr.type,namespace:dr.namespace,callback:lr}],cr=ur.length);for(var fr=function(){var gr=ur[pr];if(gr.type===dr.type&&(!gr.namespace||gr.namespace===dr.namespace||gr.namespace===universalNamespace)&&hr.eventMatches(hr.context,gr,dr)){var mr=[dr];ar!=null&&push(mr,ar),hr.beforeEmit(hr.context,gr,dr),gr.conf&&gr.conf.one&&(hr.listeners=hr.listeners.filter(function(xr){return xr!==gr}));var br=hr.callbackContext(hr.context,gr,dr),yr=gr.callback.apply(br,mr);hr.afterEmit(hr.context,gr,dr),yr===!1&&(dr.stopPropagation(),dr.preventDefault())}},pr=0;pr<cr;pr++)fr();hr.bubble(hr.context)&&!dr.isPropagationStopped()&&hr.parent(hr.context).emit(dr,ar)},or),this.emitting--,this};var emitterOptions$1={qualifierCompare:function or(ar,lr){return ar==null||lr==null?ar==null&&lr==null:ar.sameText(lr)},eventMatches:function or(ar,lr,ur){var cr=lr.qualifier;return cr!=null?ar!==ur.target&&element(ur.target)&&cr.matches(ur.target):!0},addEventFields:function or(ar,lr){lr.cy=ar.cy(),lr.target=ar},callbackContext:function or(ar,lr,ur){return lr.qualifier!=null?ur.target:ar},beforeEmit:function or(ar,lr){lr.conf&&lr.conf.once&&lr.conf.onceCollection.removeListener(lr.event,lr.qualifier,lr.callback)},bubble:function or(){return!0},parent:function or(ar){return ar.isChild()?ar.parent():ar.cy()}},argSelector$1=function or(ar){return string(ar)?new Selector(ar):ar},elesfn$9={createEmitter:function or(){for(var ar=0;ar<this.length;ar++){var lr=this[ar],ur=lr._private;ur.emitter||(ur.emitter=new Emitter(emitterOptions$1,lr))}return this},emitter:function or(){return this._private.emitter},on:function or(ar,lr,ur){for(var cr=argSelector$1(lr),hr=0;hr<this.length;hr++){var dr=this[hr];dr.emitter().on(ar,cr,ur)}return this},removeListener:function or(ar,lr,ur){for(var cr=argSelector$1(lr),hr=0;hr<this.length;hr++){var dr=this[hr];dr.emitter().removeListener(ar,cr,ur)}return this},removeAllListeners:function or(){for(var ar=0;ar<this.length;ar++){var lr=this[ar];lr.emitter().removeAllListeners()}return this},one:function or(ar,lr,ur){for(var cr=argSelector$1(lr),hr=0;hr<this.length;hr++){var dr=this[hr];dr.emitter().one(ar,cr,ur)}return this},once:function or(ar,lr,ur){for(var cr=argSelector$1(lr),hr=0;hr<this.length;hr++){var dr=this[hr];dr.emitter().on(ar,cr,ur,{once:!0,onceCollection:this})}},emit:function or(ar,lr){for(var ur=0;ur<this.length;ur++){var cr=this[ur];cr.emitter().emit(ar,lr)}return this},emitAndNotify:function or(ar,lr){if(this.length!==0)return this.cy().notify(ar,this),this.emit(ar,lr),this}};define.eventAliasesOn(elesfn$9);var elesfn$8={nodes:function or(ar){return this.filter(function(lr){return lr.isNode()}).filter(ar)},edges:function or(ar){return this.filter(function(lr){return lr.isEdge()}).filter(ar)},byGroup:function or(){for(var ar=this.spawn(),lr=this.spawn(),ur=0;ur<this.length;ur++){var cr=this[ur];cr.isNode()?ar.push(cr):lr.push(cr)}return{nodes:ar,edges:lr}},filter:function or(ar,lr){if(ar===void 0)return this;if(string(ar)||elementOrCollection(ar))return new Selector(ar).filter(this);if(fn$6(ar)){for(var ur=this.spawn(),cr=this,hr=0;hr<cr.length;hr++){var dr=cr[hr],fr=lr?ar.apply(lr,[dr,hr,cr]):ar(dr,hr,cr);fr&&ur.push(dr)}return ur}return this.spawn()},not:function or(ar){if(ar){string(ar)&&(ar=this.filter(ar));for(var lr=this.spawn(),ur=0;ur<this.length;ur++){var cr=this[ur],hr=ar.has(cr);hr||lr.push(cr)}return lr}else return this},absoluteComplement:function or(){var ar=this.cy();return ar.mutableElements().not(this)},intersect:function or(ar){if(string(ar)){var lr=ar;return this.filter(lr)}for(var ur=this.spawn(),cr=this,hr=ar,dr=this.length<ar.length,fr=dr?cr:hr,pr=dr?hr:cr,vr=0;vr<fr.length;vr++){var gr=fr[vr];pr.has(gr)&&ur.push(gr)}return ur},xor:function or(ar){var lr=this._private.cy;string(ar)&&(ar=lr.$(ar));var ur=this.spawn(),cr=this,hr=ar,dr=function(pr,vr){for(var gr=0;gr<pr.length;gr++){var mr=pr[gr],br=mr._private.data.id,yr=vr.hasElementWithId(br);yr||ur.push(mr)}};return dr(cr,hr),dr(hr,cr),ur},diff:function or(ar){var lr=this._private.cy;string(ar)&&(ar=lr.$(ar));var ur=this.spawn(),cr=this.spawn(),hr=this.spawn(),dr=this,fr=ar,pr=function(gr,mr,br){for(var yr=0;yr<gr.length;yr++){var xr=gr[yr],Cr=xr._private.data.id,Sr=mr.hasElementWithId(Cr);Sr?hr.merge(xr):br.push(xr)}};return pr(dr,fr,ur),pr(fr,dr,cr),{left:ur,right:cr,both:hr}},add:function or(ar){var lr=this._private.cy;if(!ar)return this;if(string(ar)){var ur=ar;ar=lr.mutableElements().filter(ur)}for(var cr=this.spawnSelf(),hr=0;hr<ar.length;hr++){var dr=ar[hr],fr=!this.has(dr);fr&&cr.push(dr)}return cr},merge:function or(ar){var lr=this._private,ur=lr.cy;if(!ar)return this;if(ar&&string(ar)){var cr=ar;ar=ur.mutableElements().filter(cr)}for(var hr=lr.map,dr=0;dr<ar.length;dr++){var fr=ar[dr],pr=fr._private.data.id,vr=!hr.has(pr);if(vr){var gr=this.length++;this[gr]=fr,hr.set(pr,{ele:fr,index:gr})}}return this},unmergeAt:function or(ar){var lr=this[ar],ur=lr.id(),cr=this._private,hr=cr.map;this[ar]=void 0,hr.delete(ur);var dr=ar===this.length-1;if(this.length>1&&!dr){var fr=this.length-1,pr=this[fr],vr=pr._private.data.id;this[fr]=void 0,this[ar]=pr,hr.set(vr,{ele:pr,index:ar})}return this.length--,this},unmergeOne:function or(ar){ar=ar[0];var lr=this._private,ur=ar._private.data.id,cr=lr.map,hr=cr.get(ur);if(!hr)return this;var dr=hr.index;return this.unmergeAt(dr),this},unmerge:function or(ar){var lr=this._private.cy;if(!ar)return this;if(ar&&string(ar)){var ur=ar;ar=lr.mutableElements().filter(ur)}for(var cr=0;cr<ar.length;cr++)this.unmergeOne(ar[cr]);return this},unmergeBy:function or(ar){for(var lr=this.length-1;lr>=0;lr--){var ur=this[lr];ar(ur)&&this.unmergeAt(lr)}return this},map:function or(ar,lr){for(var ur=[],cr=this,hr=0;hr<cr.length;hr++){var dr=cr[hr],fr=lr?ar.apply(lr,[dr,hr,cr]):ar(dr,hr,cr);ur.push(fr)}return ur},reduce:function or(ar,lr){for(var ur=lr,cr=this,hr=0;hr<cr.length;hr++)ur=ar(ur,cr[hr],hr,cr);return ur},max:function or(ar,lr){for(var ur=-1/0,cr,hr=this,dr=0;dr<hr.length;dr++){var fr=hr[dr],pr=lr?ar.apply(lr,[fr,dr,hr]):ar(fr,dr,hr);pr>ur&&(ur=pr,cr=fr)}return{value:ur,ele:cr}},min:function or(ar,lr){for(var ur=1/0,cr,hr=this,dr=0;dr<hr.length;dr++){var fr=hr[dr],pr=lr?ar.apply(lr,[fr,dr,hr]):ar(fr,dr,hr);pr<ur&&(ur=pr,cr=fr)}return{value:ur,ele:cr}}},fn$1=elesfn$8;fn$1.u=fn$1["|"]=fn$1["+"]=fn$1.union=fn$1.or=fn$1.add;fn$1["\\"]=fn$1["!"]=fn$1["-"]=fn$1.difference=fn$1.relativeComplement=fn$1.subtract=fn$1.not;fn$1.n=fn$1["&"]=fn$1["."]=fn$1.and=fn$1.intersection=fn$1.intersect;fn$1["^"]=fn$1["(+)"]=fn$1["(-)"]=fn$1.symmetricDifference=fn$1.symdiff=fn$1.xor;fn$1.fnFilter=fn$1.filterFn=fn$1.stdFilter=fn$1.filter;fn$1.complement=fn$1.abscomp=fn$1.absoluteComplement;var elesfn$7={isNode:function or(){return this.group()==="nodes"},isEdge:function or(){return this.group()==="edges"},isLoop:function or(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function or(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function or(){var ar=this[0];if(ar)return ar._private.group}},zIndexSort=function or(ar,lr){var ur=ar.cy(),cr=ur.hasCompoundNodes();function hr(gr){var mr=gr.pstyle("z-compound-depth");return mr.value==="auto"?cr?gr.zDepth():0:mr.value==="bottom"?-1:mr.value==="top"?MAX_INT$1:0}var dr=hr(ar)-hr(lr);if(dr!==0)return dr;function fr(gr){var mr=gr.pstyle("z-index-compare");return mr.value==="auto"&&gr.isNode()?1:0}var pr=fr(ar)-fr(lr);if(pr!==0)return pr;var vr=ar.pstyle("z-index").value-lr.pstyle("z-index").value;return vr!==0?vr:ar.poolIndex()-lr.poolIndex()},elesfn$6={forEach:function or(ar,lr){if(fn$6(ar))for(var ur=this.length,cr=0;cr<ur;cr++){var hr=this[cr],dr=lr?ar.apply(lr,[hr,cr,this]):ar(hr,cr,this);if(dr===!1)break}return this},toArray:function or(){for(var ar=[],lr=0;lr<this.length;lr++)ar.push(this[lr]);return ar},slice:function or(ar,lr){var ur=[],cr=this.length;lr==null&&(lr=cr),ar==null&&(ar=0),ar<0&&(ar=cr+ar),lr<0&&(lr=cr+lr);for(var hr=ar;hr>=0&&hr<lr&&hr<cr;hr++)ur.push(this[hr]);return this.spawn(ur)},size:function or(){return this.length},eq:function or(ar){return this[ar]||this.spawn()},first:function or(){return this[0]||this.spawn()},last:function or(){return this[this.length-1]||this.spawn()},empty:function or(){return this.length===0},nonempty:function or(){return!this.empty()},sort:function or(ar){if(!fn$6(ar))return this;var lr=this.toArray().sort(ar);return this.spawn(lr)},sortByZIndex:function or(){return this.sort(zIndexSort)},zDepth:function or(){var ar=this[0];if(ar){var lr=ar._private,ur=lr.group;if(ur==="nodes"){var cr=lr.data.parent?ar.parents().size():0;return ar.isParent()?cr:MAX_INT$1-1}else{var hr=lr.source,dr=lr.target,fr=hr.zDepth(),pr=dr.zDepth();return Math.max(fr,pr,0)}}}};elesfn$6.each=elesfn$6.forEach;var defineSymbolIterator=function or(){var ar="undefined",lr=(typeof Symbol>"u"?"undefined":_typeof(Symbol))!=ar&&_typeof(Symbol.iterator)!=ar;lr&&(elesfn$6[Symbol.iterator]=function(){var ur=this,cr={value:void 0,done:!1},hr=0,dr=this.length;return _defineProperty$1({next:function(){return hr<dr?cr.value=ur[hr++]:(cr.value=void 0,cr.done=!0),cr}},Symbol.iterator,function(){return this})})};defineSymbolIterator();var getLayoutDimensionOptions=defaults$g({nodeDimensionsIncludeLabels:!1}),elesfn$5={layoutDimensions:function or(ar){ar=getLayoutDimensionOptions(ar);var lr;if(!this.takesUpSpace())lr={w:0,h:0};else if(ar.nodeDimensionsIncludeLabels){var ur=this.boundingBox();lr={w:ur.w,h:ur.h}}else lr={w:this.outerWidth(),h:this.outerHeight()};return(lr.w===0||lr.h===0)&&(lr.w=lr.h=1),lr},layoutPositions:function or(ar,lr,ur){var cr=this.nodes().filter(function(Rr){return!Rr.isParent()}),hr=this.cy(),dr=lr.eles,fr=function(Pr){return Pr.id()},pr=memoize(ur,fr);ar.emit({type:"layoutstart",layout:ar}),ar.animations=[];var vr=function(Pr,_r,kr){var Dr={x:_r.x1+_r.w/2,y:_r.y1+_r.h/2},Nr={x:(kr.x-Dr.x)*Pr,y:(kr.y-Dr.y)*Pr};return{x:Dr.x+Nr.x,y:Dr.y+Nr.y}},gr=lr.spacingFactor&&lr.spacingFactor!==1,mr=function(){if(!gr)return null;for(var Pr=makeBoundingBox(),_r=0;_r<cr.length;_r++){var kr=cr[_r],Dr=pr(kr,_r);expandBoundingBoxByPoint(Pr,Dr.x,Dr.y)}return Pr},br=mr(),yr=memoize(function(Rr,Pr){var _r=pr(Rr,Pr);if(gr){var kr=Math.abs(lr.spacingFactor);_r=vr(kr,br,_r)}return lr.transform!=null&&(_r=lr.transform(Rr,_r)),_r},fr);if(lr.animate){for(var xr=0;xr<cr.length;xr++){var Cr=cr[xr],Sr=yr(Cr,xr),wr=lr.animateFilter==null||lr.animateFilter(Cr,xr);if(wr){var Er=Cr.animation({position:Sr,duration:lr.animationDuration,easing:lr.animationEasing});ar.animations.push(Er)}else Cr.position(Sr)}if(lr.fit){var Ar=hr.animation({fit:{boundingBox:dr.boundingBoxAt(yr),padding:lr.padding},duration:lr.animationDuration,easing:lr.animationEasing});ar.animations.push(Ar)}else if(lr.zoom!==void 0&&lr.pan!==void 0){var Tr=hr.animation({zoom:lr.zoom,pan:lr.pan,duration:lr.animationDuration,easing:lr.animationEasing});ar.animations.push(Tr)}ar.animations.forEach(function(Rr){return Rr.play()}),ar.one("layoutready",lr.ready),ar.emit({type:"layoutready",layout:ar}),Promise$1.all(ar.animations.map(function(Rr){return Rr.promise()})).then(function(){ar.one("layoutstop",lr.stop),ar.emit({type:"layoutstop",layout:ar})})}else cr.positions(yr),lr.fit&&hr.fit(lr.eles,lr.padding),lr.zoom!=null&&hr.zoom(lr.zoom),lr.pan&&hr.pan(lr.pan),ar.one("layoutready",lr.ready),ar.emit({type:"layoutready",layout:ar}),ar.one("layoutstop",lr.stop),ar.emit({type:"layoutstop",layout:ar});return this},layout:function or(ar){var lr=this.cy();return lr.makeLayout(extend({},ar,{eles:this}))}};elesfn$5.createLayout=elesfn$5.makeLayout=elesfn$5.layout;function styleCache(or,ar,lr){var ur=lr._private,cr=ur.styleCache=ur.styleCache||[],hr;return(hr=cr[or])!=null||(hr=cr[or]=ar(lr)),hr}function cacheStyleFunction(or,ar){return or=hashString(or),function(ur){return styleCache(or,ar,ur)}}function cachePrototypeStyleFunction(or,ar){or=hashString(or);var lr=function(cr){return ar.call(cr)};return function(){var cr=this[0];if(cr)return styleCache(or,lr,cr)}}var elesfn$4={recalculateRenderedStyle:function or(ar){var lr=this.cy(),ur=lr.renderer(),cr=lr.styleEnabled();return ur&&cr&&ur.recalculateRenderedStyle(this,ar),this},dirtyStyleCache:function or(){var ar=this.cy(),lr=function(hr){return hr._private.styleCache=null};if(ar.hasCompoundNodes()){var ur;ur=this.spawnSelf().merge(this.descendants()).merge(this.parents()),ur.merge(ur.connectedEdges()),ur.forEach(lr)}else this.forEach(function(cr){lr(cr),cr.connectedEdges().forEach(lr)});return this},updateStyle:function or(ar){var lr=this._private.cy;if(!lr.styleEnabled())return this;if(lr.batching()){var ur=lr._private.batchStyleEles;return ur.merge(this),this}var cr=lr.hasCompoundNodes(),hr=this;ar=!!(ar||ar===void 0),cr&&(hr=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var dr=hr;return ar?dr.emitAndNotify("style"):dr.emit("style"),hr.forEach(function(fr){return fr._private.styleDirty=!0}),this},cleanStyle:function or(){var ar=this.cy();if(ar.styleEnabled())for(var lr=0;lr<this.length;lr++){var ur=this[lr];ur._private.styleDirty&&(ur._private.styleDirty=!1,ar.style().apply(ur))}},parsedStyle:function or(ar){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ur=this[0],cr=ur.cy();if(cr.styleEnabled()&&ur){ur._private.styleDirty&&(ur._private.styleDirty=!1,cr.style().apply(ur));var hr=ur._private.style[ar];return hr??(lr?cr.style().getDefaultProperty(ar):null)}},numericStyle:function or(ar){var lr=this[0];if(lr.cy().styleEnabled()&&lr){var ur=lr.pstyle(ar);return ur.pfValue!==void 0?ur.pfValue:ur.value}},numericStyleUnits:function or(ar){var lr=this[0];if(lr.cy().styleEnabled()&&lr)return lr.pstyle(ar).units},renderedStyle:function or(ar){var lr=this.cy();if(!lr.styleEnabled())return this;var ur=this[0];if(ur)return lr.style().getRenderedStyle(ur,ar)},style:function or(ar,lr){var ur=this.cy();if(!ur.styleEnabled())return this;var cr=!1,hr=ur.style();if(plainObject(ar)){var dr=ar;hr.applyBypass(this,dr,cr),this.emitAndNotify("style")}else if(string(ar))if(lr===void 0){var fr=this[0];return fr?hr.getStylePropertyValue(fr,ar):void 0}else hr.applyBypass(this,ar,lr,cr),this.emitAndNotify("style");else if(ar===void 0){var pr=this[0];return pr?hr.getRawStyle(pr):void 0}return this},removeStyle:function or(ar){var lr=this.cy();if(!lr.styleEnabled())return this;var ur=!1,cr=lr.style(),hr=this;if(ar===void 0)for(var dr=0;dr<hr.length;dr++){var fr=hr[dr];cr.removeAllBypasses(fr,ur)}else{ar=ar.split(/\s+/);for(var pr=0;pr<hr.length;pr++){var vr=hr[pr];cr.removeBypasses(vr,ar,ur)}}return this.emitAndNotify("style"),this},show:function or(){return this.css("display","element"),this},hide:function or(){return this.css("display","none"),this},effectiveOpacity:function or(){var ar=this.cy();if(!ar.styleEnabled())return 1;var lr=ar.hasCompoundNodes(),ur=this[0];if(ur){var cr=ur._private,hr=ur.pstyle("opacity").value;if(!lr)return hr;var dr=cr.data.parent?ur.parents():null;if(dr)for(var fr=0;fr<dr.length;fr++){var pr=dr[fr],vr=pr.pstyle("opacity").value;hr=vr*hr}return hr}},transparent:function or(){var ar=this.cy();if(!ar.styleEnabled())return!1;var lr=this[0],ur=lr.cy().hasCompoundNodes();if(lr)return ur?lr.effectiveOpacity()===0:lr.pstyle("opacity").value===0},backgrounding:function or(){var ar=this.cy();if(!ar.styleEnabled())return!1;var lr=this[0];return!!lr._private.backgrounding}};function checkCompound(or,ar){var lr=or._private,ur=lr.data.parent?or.parents():null;if(ur)for(var cr=0;cr<ur.length;cr++){var hr=ur[cr];if(!ar(hr))return!1}return!0}function defineDerivedStateFunction(or){var ar=or.ok,lr=or.edgeOkViaNode||or.ok,ur=or.parentOk||or.ok;return function(){var cr=this.cy();if(!cr.styleEnabled())return!0;var hr=this[0],dr=cr.hasCompoundNodes();if(hr){var fr=hr._private;if(!ar(hr))return!1;if(hr.isNode())return!dr||checkCompound(hr,ur);var pr=fr.source,vr=fr.target;return lr(pr)&&(!dr||checkCompound(pr,lr))&&(pr===vr||lr(vr)&&(!dr||checkCompound(vr,lr)))}}}var eleTakesUpSpace=cacheStyleFunction("eleTakesUpSpace",function(or){return or.pstyle("display").value==="element"&&or.width()!==0&&(or.isNode()?or.height()!==0:!0)});elesfn$4.takesUpSpace=cachePrototypeStyleFunction("takesUpSpace",defineDerivedStateFunction({ok:eleTakesUpSpace}));var eleInteractive=cacheStyleFunction("eleInteractive",function(or){return or.pstyle("events").value==="yes"&&or.pstyle("visibility").value==="visible"&&eleTakesUpSpace(or)}),parentInteractive=cacheStyleFunction("parentInteractive",function(or){return or.pstyle("visibility").value==="visible"&&eleTakesUpSpace(or)});elesfn$4.interactive=cachePrototypeStyleFunction("interactive",defineDerivedStateFunction({ok:eleInteractive,parentOk:parentInteractive,edgeOkViaNode:eleTakesUpSpace}));elesfn$4.noninteractive=function(){var or=this[0];if(or)return!or.interactive()};var eleVisible=cacheStyleFunction("eleVisible",function(or){return or.pstyle("visibility").value==="visible"&&or.pstyle("opacity").pfValue!==0&&eleTakesUpSpace(or)}),edgeVisibleViaNode=eleTakesUpSpace;elesfn$4.visible=cachePrototypeStyleFunction("visible",defineDerivedStateFunction({ok:eleVisible,edgeOkViaNode:edgeVisibleViaNode}));elesfn$4.hidden=function(){var or=this[0];if(or)return!or.visible()};elesfn$4.isBundledBezier=cachePrototypeStyleFunction("isBundledBezier",function(){return this.cy().styleEnabled()?!this.removed()&&this.pstyle("curve-style").value==="bezier"&&this.takesUpSpace():!1});elesfn$4.bypass=elesfn$4.css=elesfn$4.style;elesfn$4.renderedCss=elesfn$4.renderedStyle;elesfn$4.removeBypass=elesfn$4.removeCss=elesfn$4.removeStyle;elesfn$4.pstyle=elesfn$4.parsedStyle;var elesfn$3={};function defineSwitchFunction(or){return function(){var ar=arguments,lr=[];if(ar.length===2){var ur=ar[0],cr=ar[1];this.on(or.event,ur,cr)}else if(ar.length===1&&fn$6(ar[0])){var hr=ar[0];this.on(or.event,hr)}else if(ar.length===0||ar.length===1&&array(ar[0])){for(var dr=ar.length===1?ar[0]:null,fr=0;fr<this.length;fr++){var pr=this[fr],vr=!or.ableField||pr._private[or.ableField],gr=pr._private[or.field]!=or.value;if(or.overrideAble){var mr=or.overrideAble(pr);if(mr!==void 0&&(vr=mr,!mr))return this}vr&&(pr._private[or.field]=or.value,gr&&lr.push(pr))}var br=this.spawn(lr);br.updateStyle(),br.emit(or.event),dr&&br.emit(dr)}return this}}function defineSwitchSet(or){elesfn$3[or.field]=function(){var ar=this[0];if(ar){if(or.overrideField){var lr=or.overrideField(ar);if(lr!==void 0)return lr}return ar._private[or.field]}},elesfn$3[or.on]=defineSwitchFunction({event:or.on,field:or.field,ableField:or.ableField,overrideAble:or.overrideAble,value:!0}),elesfn$3[or.off]=defineSwitchFunction({event:or.off,field:or.field,ableField:or.ableField,overrideAble:or.overrideAble,value:!1})}defineSwitchSet({field:"locked",overrideField:function or(ar){return ar.cy().autolock()?!0:void 0},on:"lock",off:"unlock"});defineSwitchSet({field:"grabbable",overrideField:function or(ar){return ar.cy().autoungrabify()||ar.pannable()?!1:void 0},on:"grabify",off:"ungrabify"});defineSwitchSet({field:"selected",ableField:"selectable",overrideAble:function or(ar){return ar.cy().autounselectify()?!1:void 0},on:"select",off:"unselect"});defineSwitchSet({field:"selectable",overrideField:function or(ar){return ar.cy().autounselectify()?!1:void 0},on:"selectify",off:"unselectify"});elesfn$3.deselect=elesfn$3.unselect;elesfn$3.grabbed=function(){var or=this[0];if(or)return or._private.grabbed};defineSwitchSet({field:"active",on:"activate",off:"unactivate"});defineSwitchSet({field:"pannable",on:"panify",off:"unpanify"});elesfn$3.inactive=function(){var or=this[0];if(or)return!or._private.active};var elesfn$2={},defineDagExtremity=function or(ar){return function(ur){for(var cr=this,hr=[],dr=0;dr<cr.length;dr++){var fr=cr[dr];if(fr.isNode()){for(var pr=!1,vr=fr.connectedEdges(),gr=0;gr<vr.length;gr++){var mr=vr[gr],br=mr.source(),yr=mr.target();if(ar.noIncomingEdges&&yr===fr&&br!==fr||ar.noOutgoingEdges&&br===fr&&yr!==fr){pr=!0;break}}pr||hr.push(fr)}}return this.spawn(hr,!0).filter(ur)}},defineDagOneHop=function or(ar){return function(lr){for(var ur=this,cr=[],hr=0;hr<ur.length;hr++){var dr=ur[hr];if(dr.isNode())for(var fr=dr.connectedEdges(),pr=0;pr<fr.length;pr++){var vr=fr[pr],gr=vr.source(),mr=vr.target();ar.outgoing&&gr===dr?(cr.push(vr),cr.push(mr)):ar.incoming&&mr===dr&&(cr.push(vr),cr.push(gr))}}return this.spawn(cr,!0).filter(lr)}},defineDagAllHops=function or(ar){return function(lr){for(var ur=this,cr=[],hr={};;){var dr=ar.outgoing?ur.outgoers():ur.incomers();if(dr.length===0)break;for(var fr=!1,pr=0;pr<dr.length;pr++){var vr=dr[pr],gr=vr.id();hr[gr]||(hr[gr]=!0,cr.push(vr),fr=!0)}if(!fr)break;ur=dr}return this.spawn(cr,!0).filter(lr)}};elesfn$2.clearTraversalCache=function(){for(var or=0;or<this.length;or++)this[or]._private.traversalCache=null};extend(elesfn$2,{roots:defineDagExtremity({noIncomingEdges:!0}),leaves:defineDagExtremity({noOutgoingEdges:!0}),outgoers:cache(defineDagOneHop({outgoing:!0}),"outgoers"),successors:defineDagAllHops({outgoing:!0}),incomers:cache(defineDagOneHop({incoming:!0}),"incomers"),predecessors:defineDagAllHops({})});extend(elesfn$2,{neighborhood:cache(function(or){for(var ar=[],lr=this.nodes(),ur=0;ur<lr.length;ur++)for(var cr=lr[ur],hr=cr.connectedEdges(),dr=0;dr<hr.length;dr++){var fr=hr[dr],pr=fr.source(),vr=fr.target(),gr=cr===pr?vr:pr;gr.length>0&&ar.push(gr[0]),ar.push(fr[0])}return this.spawn(ar,!0).filter(or)},"neighborhood"),closedNeighborhood:function or(ar){return this.neighborhood().add(this).filter(ar)},openNeighborhood:function or(ar){return this.neighborhood(ar)}});elesfn$2.neighbourhood=elesfn$2.neighborhood;elesfn$2.closedNeighbourhood=elesfn$2.closedNeighborhood;elesfn$2.openNeighbourhood=elesfn$2.openNeighborhood;extend(elesfn$2,{source:cache(function or(ar){var lr=this[0],ur;return lr&&(ur=lr._private.source||lr.cy().collection()),ur&&ar?ur.filter(ar):ur},"source"),target:cache(function or(ar){var lr=this[0],ur;return lr&&(ur=lr._private.target||lr.cy().collection()),ur&&ar?ur.filter(ar):ur},"target"),sources:defineSourceFunction({attr:"source"}),targets:defineSourceFunction({attr:"target"})});function defineSourceFunction(or){return function(lr){for(var ur=[],cr=0;cr<this.length;cr++){var hr=this[cr],dr=hr._private[or.attr];dr&&ur.push(dr)}return this.spawn(ur,!0).filter(lr)}}extend(elesfn$2,{edgesWith:cache(defineEdgesWithFunction(),"edgesWith"),edgesTo:cache(defineEdgesWithFunction({thisIsSrc:!0}),"edgesTo")});function defineEdgesWithFunction(or){return function(lr){var ur=[],cr=this._private.cy,hr=or||{};string(lr)&&(lr=cr.$(lr));for(var dr=0;dr<lr.length;dr++)for(var fr=lr[dr]._private.edges,pr=0;pr<fr.length;pr++){var vr=fr[pr],gr=vr._private.data,mr=this.hasElementWithId(gr.source)&&lr.hasElementWithId(gr.target),br=lr.hasElementWithId(gr.source)&&this.hasElementWithId(gr.target),yr=mr||br;yr&&((hr.thisIsSrc||hr.thisIsTgt)&&(hr.thisIsSrc&&!mr||hr.thisIsTgt&&!br)||ur.push(vr))}return this.spawn(ur,!0)}}extend(elesfn$2,{connectedEdges:cache(function(or){for(var ar=[],lr=this,ur=0;ur<lr.length;ur++){var cr=lr[ur];if(cr.isNode())for(var hr=cr._private.edges,dr=0;dr<hr.length;dr++){var fr=hr[dr];ar.push(fr)}}return this.spawn(ar,!0).filter(or)},"connectedEdges"),connectedNodes:cache(function(or){for(var ar=[],lr=this,ur=0;ur<lr.length;ur++){var cr=lr[ur];cr.isEdge()&&(ar.push(cr.source()[0]),ar.push(cr.target()[0]))}return this.spawn(ar,!0).filter(or)},"connectedNodes"),parallelEdges:cache(defineParallelEdgesFunction(),"parallelEdges"),codirectedEdges:cache(defineParallelEdgesFunction({codirected:!0}),"codirectedEdges")});function defineParallelEdgesFunction(or){var ar={codirected:!1};return or=extend({},ar,or),function(ur){for(var cr=[],hr=this.edges(),dr=or,fr=0;fr<hr.length;fr++)for(var pr=hr[fr],vr=pr._private,gr=vr.source,mr=gr._private.data.id,br=vr.data.target,yr=gr._private.edges,xr=0;xr<yr.length;xr++){var Cr=yr[xr],Sr=Cr._private.data,wr=Sr.target,Er=Sr.source,Ar=wr===br&&Er===mr,Tr=mr===wr&&br===Er;(dr.codirected&&Ar||!dr.codirected&&(Ar||Tr))&&cr.push(Cr)}return this.spawn(cr,!0).filter(ur)}}extend(elesfn$2,{components:function or(ar){var lr=this,ur=lr.cy(),cr=ur.collection(),hr=ar==null?lr.nodes():ar.nodes(),dr=[];ar!=null&&hr.empty()&&(hr=ar.sources());var fr=function(gr,mr){cr.merge(gr),hr.unmerge(gr),mr.merge(gr)};if(hr.empty())return lr.spawn();var pr=function(){var gr=ur.collection();dr.push(gr);var mr=hr[0];fr(mr,gr),lr.bfs({directed:!1,roots:mr,visit:function(yr){return fr(yr,gr)}}),gr.forEach(function(br){br.connectedEdges().forEach(function(yr){lr.has(yr)&&gr.has(yr.source())&&gr.has(yr.target())&&gr.merge(yr)})})};do pr();while(hr.length>0);return dr},component:function or(){var ar=this[0];return ar.cy().mutableElements().components(ar)[0]}});elesfn$2.componentsOf=elesfn$2.components;var Collection=function or(ar,lr){var ur=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,cr=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(ar===void 0){error("A collection must have a reference to the core");return}var hr=new Map$1,dr=!1;if(!lr)lr=[];else if(lr.length>0&&plainObject(lr[0])&&!element(lr[0])){dr=!0;for(var fr=[],pr=new Set$1,vr=0,gr=lr.length;vr<gr;vr++){var mr=lr[vr];mr.data==null&&(mr.data={});var br=mr.data;if(br.id==null)br.id=uuid();else if(ar.hasElementWithId(br.id)||pr.has(br.id))continue;var yr=new Element$1(ar,mr,!1);fr.push(yr),pr.add(br.id)}lr=fr}this.length=0;for(var xr=0,Cr=lr.length;xr<Cr;xr++){var Sr=lr[xr][0];if(Sr!=null){var wr=Sr._private.data.id;(!ur||!hr.has(wr))&&(ur&&hr.set(wr,{index:this.length,ele:Sr}),this[this.length]=Sr,this.length++)}}this._private={eles:this,cy:ar,get map(){return this.lazyMap==null&&this.rebuildMap(),this.lazyMap},set map(Er){this.lazyMap=Er},rebuildMap:function(){for(var Ar=this.lazyMap=new Map$1,Tr=this.eles,Rr=0;Rr<Tr.length;Rr++){var Pr=Tr[Rr];Ar.set(Pr.id(),{index:Rr,ele:Pr})}}},ur&&(this._private.map=hr),dr&&!cr&&this.restore()},elesfn$1=Element$1.prototype=Collection.prototype=Object.create(Array.prototype);elesfn$1.instanceString=function(){return"collection"};elesfn$1.spawn=function(or,ar){return new Collection(this.cy(),or,ar)};elesfn$1.spawnSelf=function(){return this.spawn(this)};elesfn$1.cy=function(){return this._private.cy};elesfn$1.renderer=function(){return this._private.cy.renderer()};elesfn$1.element=function(){return this[0]};elesfn$1.collection=function(){return collection(this)?this:new Collection(this._private.cy,[this])};elesfn$1.unique=function(){return new Collection(this._private.cy,this,!0)};elesfn$1.hasElementWithId=function(or){return or=""+or,this._private.map.has(or)};elesfn$1.getElementById=function(or){or=""+or;var ar=this._private.cy,lr=this._private.map.get(or);return lr?lr.ele:new Collection(ar)};elesfn$1.$id=elesfn$1.getElementById;elesfn$1.poolIndex=function(){var or=this._private.cy,ar=or._private.elements,lr=this[0]._private.data.id;return ar._private.map.get(lr).index};elesfn$1.indexOf=function(or){var ar=or[0]._private.data.id;return this._private.map.get(ar).index};elesfn$1.indexOfId=function(or){return or=""+or,this._private.map.get(or).index};elesfn$1.json=function(or){var ar=this.element(),lr=this.cy();if(ar==null&&or)return this;if(ar!=null){var ur=ar._private;if(plainObject(or)){if(lr.startBatch(),or.data){ar.data(or.data);var cr=ur.data;if(ar.isEdge()){var hr=!1,dr={},fr=or.data.source,pr=or.data.target;fr!=null&&fr!=cr.source&&(dr.source=""+fr,hr=!0),pr!=null&&pr!=cr.target&&(dr.target=""+pr,hr=!0),hr&&(ar=ar.move(dr))}else{var vr="parent"in or.data,gr=or.data.parent;vr&&(gr!=null||cr.parent!=null)&&gr!=cr.parent&&(gr===void 0&&(gr=null),gr!=null&&(gr=""+gr),ar=ar.move({parent:gr}))}}or.position&&ar.position(or.position);var mr=function(Cr,Sr,wr){var Er=or[Cr];Er!=null&&Er!==ur[Cr]&&(Er?ar[Sr]():ar[wr]())};return mr("removed","remove","restore"),mr("selected","select","unselect"),mr("selectable","selectify","unselectify"),mr("locked","lock","unlock"),mr("grabbable","grabify","ungrabify"),mr("pannable","panify","unpanify"),or.classes!=null&&ar.classes(or.classes),lr.endBatch(),this}else if(or===void 0){var br={data:copy(ur.data),position:copy(ur.position),group:ur.group,removed:ur.removed,selected:ur.selected,selectable:ur.selectable,locked:ur.locked,grabbable:ur.grabbable,pannable:ur.pannable,classes:null};br.classes="";var yr=0;return ur.classes.forEach(function(xr){return br.classes+=yr++===0?xr:" "+xr}),br}}};elesfn$1.jsons=function(){for(var or=[],ar=0;ar<this.length;ar++){var lr=this[ar],ur=lr.json();or.push(ur)}return or};elesfn$1.clone=function(){for(var or=this.cy(),ar=[],lr=0;lr<this.length;lr++){var ur=this[lr],cr=ur.json(),hr=new Element$1(or,cr,!1);ar.push(hr)}return new Collection(or,ar)};elesfn$1.copy=elesfn$1.clone;elesfn$1.restore=function(){for(var or=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,ar=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,lr=this,ur=lr.cy(),cr=ur._private,hr=[],dr=[],fr,pr=0,vr=lr.length;pr<vr;pr++){var gr=lr[pr];ar&&!gr.removed()||(gr.isNode()?hr.push(gr):dr.push(gr))}fr=hr.concat(dr);var mr,br=function(){fr.splice(mr,1),mr--};for(mr=0;mr<fr.length;mr++){var yr=fr[mr],xr=yr._private,Cr=xr.data;if(yr.clearTraversalCache(),!(!ar&&!xr.removed)){if(Cr.id===void 0)Cr.id=uuid();else if(number$1(Cr.id))Cr.id=""+Cr.id;else if(emptyString(Cr.id)||!string(Cr.id)){error("Can not create element with invalid string ID `"+Cr.id+"`"),br();continue}else if(ur.hasElementWithId(Cr.id)){error("Can not create second element with ID `"+Cr.id+"`"),br();continue}}var Sr=Cr.id;if(yr.isNode()){var wr=xr.position;wr.x==null&&(wr.x=0),wr.y==null&&(wr.y=0)}if(yr.isEdge()){for(var Er=yr,Ar=["source","target"],Tr=Ar.length,Rr=!1,Pr=0;Pr<Tr;Pr++){var _r=Ar[Pr],kr=Cr[_r];number$1(kr)&&(kr=Cr[_r]=""+Cr[_r]),kr==null||kr===""?(error("Can not create edge `"+Sr+"` with unspecified "+_r),Rr=!0):ur.hasElementWithId(kr)||(error("Can not create edge `"+Sr+"` with nonexistant "+_r+" `"+kr+"`"),Rr=!0)}if(Rr){br();continue}var Dr=ur.getElementById(Cr.source),Nr=ur.getElementById(Cr.target);Dr.same(Nr)?Dr._private.edges.push(Er):(Dr._private.edges.push(Er),Nr._private.edges.push(Er)),Er._private.source=Dr,Er._private.target=Nr}xr.map=new Map$1,xr.map.set(Sr,{ele:yr,index:0}),xr.removed=!1,ar&&ur.addToPool(yr)}for(var Lr=0;Lr<hr.length;Lr++){var Or=hr[Lr],Ir=Or._private.data;number$1(Ir.parent)&&(Ir.parent=""+Ir.parent);var Mr=Ir.parent,$r=Mr!=null;if($r||Or._private.parent){var jr=Or._private.parent?ur.collection().merge(Or._private.parent):ur.getElementById(Mr);if(jr.empty())Ir.parent=void 0;else if(jr[0].removed())warn("Node added with missing parent, reference to parent removed"),Ir.parent=void 0,Or._private.parent=null;else{for(var Fr=!1,zr=jr;!zr.empty();){if(Or.same(zr)){Fr=!0,Ir.parent=void 0;break}zr=zr.parent()}Fr||(jr[0]._private.children.push(Or),Or._private.parent=jr[0],cr.hasCompoundNodes=!0)}}}if(fr.length>0){for(var Hr=fr.length===lr.length?lr:new Collection(ur,fr),Wr=0;Wr<Hr.length;Wr++){var Yr=Hr[Wr];Yr.isNode()||(Yr.parallelEdges().clearTraversalCache(),Yr.source().clearTraversalCache(),Yr.target().clearTraversalCache())}var qr;cr.hasCompoundNodes?qr=ur.collection().merge(Hr).merge(Hr.connectedNodes()).merge(Hr.parent()):qr=Hr,qr.dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(or),or?Hr.emitAndNotify("add"):ar&&Hr.emit("add")}return lr};elesfn$1.removed=function(){var or=this[0];return or&&or._private.removed};elesfn$1.inside=function(){var or=this[0];return or&&!or._private.removed};elesfn$1.remove=function(){var or=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,ar=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,lr=this,ur=[],cr={},hr=lr._private.cy;function dr(Mr){for(var $r=Mr._private.edges,jr=0;jr<$r.length;jr++)pr($r[jr])}function fr(Mr){for(var $r=Mr._private.children,jr=0;jr<$r.length;jr++)pr($r[jr])}function pr(Mr){var $r=cr[Mr.id()];ar&&Mr.removed()||$r||(cr[Mr.id()]=!0,Mr.isNode()?(ur.push(Mr),dr(Mr),fr(Mr)):ur.unshift(Mr))}for(var vr=0,gr=lr.length;vr<gr;vr++){var mr=lr[vr];pr(mr)}function br(Mr,$r){var jr=Mr._private.edges;removeFromArray(jr,$r),Mr.clearTraversalCache()}function yr(Mr){Mr.clearTraversalCache()}var xr=[];xr.ids={};function Cr(Mr,$r){$r=$r[0],Mr=Mr[0];var jr=Mr._private.children,Fr=Mr.id();removeFromArray(jr,$r),$r._private.parent=null,xr.ids[Fr]||(xr.ids[Fr]=!0,xr.push(Mr))}lr.dirtyCompoundBoundsCache(),ar&&hr.removeFromPool(ur);for(var Sr=0;Sr<ur.length;Sr++){var wr=ur[Sr];if(wr.isEdge()){var Er=wr.source()[0],Ar=wr.target()[0];br(Er,wr),br(Ar,wr);for(var Tr=wr.parallelEdges(),Rr=0;Rr<Tr.length;Rr++){var Pr=Tr[Rr];yr(Pr),Pr.isBundledBezier()&&Pr.dirtyBoundingBoxCache()}}else{var _r=wr.parent();_r.length!==0&&Cr(_r,wr)}ar&&(wr._private.removed=!0)}var kr=hr._private.elements;hr._private.hasCompoundNodes=!1;for(var Dr=0;Dr<kr.length;Dr++){var Nr=kr[Dr];if(Nr.isParent()){hr._private.hasCompoundNodes=!0;break}}var Lr=new Collection(this.cy(),ur);Lr.size()>0&&(or?Lr.emitAndNotify("remove"):ar&&Lr.emit("remove"));for(var Or=0;Or<xr.length;Or++){var Ir=xr[Or];(!ar||!Ir.removed())&&Ir.updateStyle()}return Lr};elesfn$1.move=function(or){var ar=this._private.cy,lr=this,ur=!1,cr=!1,hr=function(xr){return xr==null?xr:""+xr};if(or.source!==void 0||or.target!==void 0){var dr=hr(or.source),fr=hr(or.target),pr=dr!=null&&ar.hasElementWithId(dr),vr=fr!=null&&ar.hasElementWithId(fr);(pr||vr)&&(ar.batch(function(){lr.remove(ur,cr),lr.emitAndNotify("moveout");for(var yr=0;yr<lr.length;yr++){var xr=lr[yr],Cr=xr._private.data;xr.isEdge()&&(pr&&(Cr.source=dr),vr&&(Cr.target=fr))}lr.restore(ur,cr)}),lr.emitAndNotify("move"))}else if(or.parent!==void 0){var gr=hr(or.parent),mr=gr===null||ar.hasElementWithId(gr);if(mr){var br=gr===null?void 0:gr;ar.batch(function(){var yr=lr.remove(ur,cr);yr.emitAndNotify("moveout");for(var xr=0;xr<lr.length;xr++){var Cr=lr[xr],Sr=Cr._private.data;Cr.isNode()&&(Sr.parent=br)}yr.restore(ur,cr)}),lr.emitAndNotify("move")}}return this};[elesfn$j,elesfn$i,elesfn$h,elesfn$g,elesfn$f,data,elesfn$d,dimensions,elesfn$9,elesfn$8,elesfn$7,elesfn$6,elesfn$5,elesfn$4,elesfn$3,elesfn$2].forEach(function(or){extend(elesfn$1,or)});var corefn$9={add:function or(ar){var lr,ur=this;if(elementOrCollection(ar)){var cr=ar;if(cr._private.cy===ur)lr=cr.restore();else{for(var hr=[],dr=0;dr<cr.length;dr++){var fr=cr[dr];hr.push(fr.json())}lr=new Collection(ur,hr)}}else if(array(ar)){var pr=ar;lr=new Collection(ur,pr)}else if(plainObject(ar)&&(array(ar.nodes)||array(ar.edges))){for(var vr=ar,gr=[],mr=["nodes","edges"],br=0,yr=mr.length;br<yr;br++){var xr=mr[br],Cr=vr[xr];if(array(Cr))for(var Sr=0,wr=Cr.length;Sr<wr;Sr++){var Er=extend({group:xr},Cr[Sr]);gr.push(Er)}}lr=new Collection(ur,gr)}else{var Ar=ar;lr=new Element$1(ur,Ar).collection()}return lr},remove:function or(ar){if(!elementOrCollection(ar)){if(string(ar)){var lr=ar;ar=this.$(lr)}}return ar.remove()}};/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */function generateCubicBezier(or,ar,lr,ur){var cr=4,hr=.001,dr=1e-7,fr=10,pr=11,vr=1/(pr-1),gr=typeof Float32Array<"u";if(arguments.length!==4)return!1;for(var mr=0;mr<4;++mr)if(typeof arguments[mr]!="number"||isNaN(arguments[mr])||!isFinite(arguments[mr]))return!1;or=Math.min(or,1),lr=Math.min(lr,1),or=Math.max(or,0),lr=Math.max(lr,0);var br=gr?new Float32Array(pr):new Array(pr);function yr(Nr,Lr){return 1-3*Lr+3*Nr}function xr(Nr,Lr){return 3*Lr-6*Nr}function Cr(Nr){return 3*Nr}function Sr(Nr,Lr,Or){return((yr(Lr,Or)*Nr+xr(Lr,Or))*Nr+Cr(Lr))*Nr}function wr(Nr,Lr,Or){return 3*yr(Lr,Or)*Nr*Nr+2*xr(Lr,Or)*Nr+Cr(Lr)}function Er(Nr,Lr){for(var Or=0;Or<cr;++Or){var Ir=wr(Lr,or,lr);if(Ir===0)return Lr;var Mr=Sr(Lr,or,lr)-Nr;Lr-=Mr/Ir}return Lr}function Ar(){for(var Nr=0;Nr<pr;++Nr)br[Nr]=Sr(Nr*vr,or,lr)}function Tr(Nr,Lr,Or){var Ir,Mr,$r=0;do Mr=Lr+(Or-Lr)/2,Ir=Sr(Mr,or,lr)-Nr,Ir>0?Or=Mr:Lr=Mr;while(Math.abs(Ir)>dr&&++$r<fr);return Mr}function Rr(Nr){for(var Lr=0,Or=1,Ir=pr-1;Or!==Ir&&br[Or]<=Nr;++Or)Lr+=vr;--Or;var Mr=(Nr-br[Or])/(br[Or+1]-br[Or]),$r=Lr+Mr*vr,jr=wr($r,or,lr);return jr>=hr?Er(Nr,$r):jr===0?$r:Tr(Nr,Lr,Lr+vr)}var Pr=!1;function _r(){Pr=!0,(or!==ar||lr!==ur)&&Ar()}var kr=function(Lr){return Pr||_r(),or===ar&&lr===ur?Lr:Lr===0?0:Lr===1?1:Sr(Rr(Lr),ar,ur)};kr.getControlPoints=function(){return[{x:or,y:ar},{x:lr,y:ur}]};var Dr="generateBezier("+[or,ar,lr,ur]+")";return kr.toString=function(){return Dr},kr}/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */var generateSpringRK4=function(){function or(ur){return-ur.tension*ur.x-ur.friction*ur.v}function ar(ur,cr,hr){var dr={x:ur.x+hr.dx*cr,v:ur.v+hr.dv*cr,tension:ur.tension,friction:ur.friction};return{dx:dr.v,dv:or(dr)}}function lr(ur,cr){var hr={dx:ur.v,dv:or(ur)},dr=ar(ur,cr*.5,hr),fr=ar(ur,cr*.5,dr),pr=ar(ur,cr,fr),vr=1/6*(hr.dx+2*(dr.dx+fr.dx)+pr.dx),gr=1/6*(hr.dv+2*(dr.dv+fr.dv)+pr.dv);return ur.x=ur.x+vr*cr,ur.v=ur.v+gr*cr,ur}return function ur(cr,hr,dr){var fr={x:-1,v:0,tension:null,friction:null},pr=[0],vr=0,gr=1/1e4,mr=16/1e3,br,yr,xr;for(cr=parseFloat(cr)||500,hr=parseFloat(hr)||20,dr=dr||null,fr.tension=cr,fr.friction=hr,br=dr!==null,br?(vr=ur(cr,hr),yr=vr/dr*mr):yr=mr;xr=lr(xr||fr,yr),pr.push(1+xr.x),vr+=16,Math.abs(xr.x)>gr&&Math.abs(xr.v)>gr;);return br?function(Cr){return pr[Cr*(pr.length-1)|0]}:vr}}(),cubicBezier=function or(ar,lr,ur,cr){var hr=generateCubicBezier(ar,lr,ur,cr);return function(dr,fr,pr){return dr+(fr-dr)*hr(pr)}},easings={linear:function or(ar,lr,ur){return ar+(lr-ar)*ur},ease:cubicBezier(.25,.1,.25,1),"ease-in":cubicBezier(.42,0,1,1),"ease-out":cubicBezier(0,0,.58,1),"ease-in-out":cubicBezier(.42,0,.58,1),"ease-in-sine":cubicBezier(.47,0,.745,.715),"ease-out-sine":cubicBezier(.39,.575,.565,1),"ease-in-out-sine":cubicBezier(.445,.05,.55,.95),"ease-in-quad":cubicBezier(.55,.085,.68,.53),"ease-out-quad":cubicBezier(.25,.46,.45,.94),"ease-in-out-quad":cubicBezier(.455,.03,.515,.955),"ease-in-cubic":cubicBezier(.55,.055,.675,.19),"ease-out-cubic":cubicBezier(.215,.61,.355,1),"ease-in-out-cubic":cubicBezier(.645,.045,.355,1),"ease-in-quart":cubicBezier(.895,.03,.685,.22),"ease-out-quart":cubicBezier(.165,.84,.44,1),"ease-in-out-quart":cubicBezier(.77,0,.175,1),"ease-in-quint":cubicBezier(.755,.05,.855,.06),"ease-out-quint":cubicBezier(.23,1,.32,1),"ease-in-out-quint":cubicBezier(.86,0,.07,1),"ease-in-expo":cubicBezier(.95,.05,.795,.035),"ease-out-expo":cubicBezier(.19,1,.22,1),"ease-in-out-expo":cubicBezier(1,0,0,1),"ease-in-circ":cubicBezier(.6,.04,.98,.335),"ease-out-circ":cubicBezier(.075,.82,.165,1),"ease-in-out-circ":cubicBezier(.785,.135,.15,.86),spring:function or(ar,lr,ur){if(ur===0)return easings.linear;var cr=generateSpringRK4(ar,lr,ur);return function(hr,dr,fr){return hr+(dr-hr)*cr(fr)}},"cubic-bezier":cubicBezier};function getEasedValue(or,ar,lr,ur,cr){if(ur===1||ar===lr)return lr;var hr=cr(ar,lr,ur);return or==null||((or.roundValue||or.color)&&(hr=Math.round(hr)),or.min!==void 0&&(hr=Math.max(hr,or.min)),or.max!==void 0&&(hr=Math.min(hr,or.max))),hr}function getValue(or,ar){return or.pfValue!=null||or.value!=null?or.pfValue!=null&&(ar==null||ar.type.units!=="%")?or.pfValue:or.value:or}function ease(or,ar,lr,ur,cr){var hr=cr!=null?cr.type:null;lr<0?lr=0:lr>1&&(lr=1);var dr=getValue(or,cr),fr=getValue(ar,cr);if(number$1(dr)&&number$1(fr))return getEasedValue(hr,dr,fr,lr,ur);if(array(dr)&&array(fr)){for(var pr=[],vr=0;vr<fr.length;vr++){var gr=dr[vr],mr=fr[vr];if(gr!=null&&mr!=null){var br=getEasedValue(hr,gr,mr,lr,ur);pr.push(br)}else pr.push(mr)}return pr}}function step$1(or,ar,lr,ur){var cr=!ur,hr=or._private,dr=ar._private,fr=dr.easing,pr=dr.startTime,vr=ur?or:or.cy(),gr=vr.style();if(!dr.easingImpl)if(fr==null)dr.easingImpl=easings.linear;else{var mr;if(string(fr)){var br=gr.parse("transition-timing-function",fr);mr=br.value}else mr=fr;var yr,xr;string(mr)?(yr=mr,xr=[]):(yr=mr[1],xr=mr.slice(2).map(function(Hr){return+Hr})),xr.length>0?(yr==="spring"&&xr.push(dr.duration),dr.easingImpl=easings[yr].apply(null,xr)):dr.easingImpl=easings[yr]}var Cr=dr.easingImpl,Sr;if(dr.duration===0?Sr=1:Sr=(lr-pr)/dr.duration,dr.applying&&(Sr=dr.progress),Sr<0?Sr=0:Sr>1&&(Sr=1),dr.delay==null){var wr=dr.startPosition,Er=dr.position;if(Er&&cr&&!or.locked()){var Ar={};valid(wr.x,Er.x)&&(Ar.x=ease(wr.x,Er.x,Sr,Cr)),valid(wr.y,Er.y)&&(Ar.y=ease(wr.y,Er.y,Sr,Cr)),or.position(Ar)}var Tr=dr.startPan,Rr=dr.pan,Pr=hr.pan,_r=Rr!=null&&ur;_r&&(valid(Tr.x,Rr.x)&&(Pr.x=ease(Tr.x,Rr.x,Sr,Cr)),valid(Tr.y,Rr.y)&&(Pr.y=ease(Tr.y,Rr.y,Sr,Cr)),or.emit("pan"));var kr=dr.startZoom,Dr=dr.zoom,Nr=Dr!=null&&ur;Nr&&(valid(kr,Dr)&&(hr.zoom=bound(hr.minZoom,ease(kr,Dr,Sr,Cr),hr.maxZoom)),or.emit("zoom")),(_r||Nr)&&or.emit("viewport");var Lr=dr.style;if(Lr&&Lr.length>0&&cr){for(var Or=0;Or<Lr.length;Or++){var Ir=Lr[Or],Mr=Ir.name,$r=Ir,jr=dr.startStyle[Mr],Fr=gr.properties[jr.name],zr=ease(jr,$r,Sr,Cr,Fr);gr.overrideBypass(or,Mr,zr)}or.emit("style")}}return dr.progress=Sr,Sr}function valid(or,ar){return or==null||ar==null?!1:number$1(or)&&number$1(ar)?!0:!!(or&&ar)}function startAnimation(or,ar,lr,ur){var cr=ar._private;cr.started=!0,cr.startTime=lr-cr.progress*cr.duration}function stepAll(or,ar){var lr=ar._private.aniEles,ur=[];function cr(gr,mr){var br=gr._private,yr=br.animation.current,xr=br.animation.queue,Cr=!1;if(yr.length===0){var Sr=xr.shift();Sr&&yr.push(Sr)}for(var wr=function(Pr){for(var _r=Pr.length-1;_r>=0;_r--){var kr=Pr[_r];kr()}Pr.splice(0,Pr.length)},Er=yr.length-1;Er>=0;Er--){var Ar=yr[Er],Tr=Ar._private;if(Tr.stopped){yr.splice(Er,1),Tr.hooked=!1,Tr.playing=!1,Tr.started=!1,wr(Tr.frames);continue}!Tr.playing&&!Tr.applying||(Tr.playing&&Tr.applying&&(Tr.applying=!1),Tr.started||startAnimation(gr,Ar,or),step$1(gr,Ar,or,mr),Tr.applying&&(Tr.applying=!1),wr(Tr.frames),Tr.step!=null&&Tr.step(or),Ar.completed()&&(yr.splice(Er,1),Tr.hooked=!1,Tr.playing=!1,Tr.started=!1,wr(Tr.completes)),Cr=!0)}return!mr&&yr.length===0&&xr.length===0&&ur.push(gr),Cr}for(var hr=!1,dr=0;dr<lr.length;dr++){var fr=lr[dr],pr=cr(fr);hr=hr||pr}var vr=cr(ar,!0);(hr||vr)&&(lr.length>0?ar.notify("draw",lr):ar.notify("draw")),lr.unmerge(ur),ar.emit("step")}var corefn$8={animate:define.animate(),animation:define.animation(),animated:define.animated(),clearQueue:define.clearQueue(),delay:define.delay(),delayAnimation:define.delayAnimation(),stop:define.stop(),addToAnimationPool:function or(ar){var lr=this;lr.styleEnabled()&&lr._private.aniEles.merge(ar)},stopAnimationLoop:function or(){this._private.animationsRunning=!1},startAnimationLoop:function or(){var ar=this;if(ar._private.animationsRunning=!0,!ar.styleEnabled())return;function lr(){ar._private.animationsRunning&&requestAnimationFrame(function(hr){stepAll(hr,ar),lr()})}var ur=ar.renderer();ur&&ur.beforeRender?ur.beforeRender(function(hr,dr){stepAll(dr,ar)},ur.beforeRenderPriorities.animations):lr()}},emitterOptions={qualifierCompare:function or(ar,lr){return ar==null||lr==null?ar==null&&lr==null:ar.sameText(lr)},eventMatches:function or(ar,lr,ur){var cr=lr.qualifier;return cr!=null?ar!==ur.target&&element(ur.target)&&cr.matches(ur.target):!0},addEventFields:function or(ar,lr){lr.cy=ar,lr.target=ar},callbackContext:function or(ar,lr,ur){return lr.qualifier!=null?ur.target:ar}},argSelector=function or(ar){return string(ar)?new Selector(ar):ar},elesfn={createEmitter:function or(){var ar=this._private;return ar.emitter||(ar.emitter=new Emitter(emitterOptions,this)),this},emitter:function or(){return this._private.emitter},on:function or(ar,lr,ur){return this.emitter().on(ar,argSelector(lr),ur),this},removeListener:function or(ar,lr,ur){return this.emitter().removeListener(ar,argSelector(lr),ur),this},removeAllListeners:function or(){return this.emitter().removeAllListeners(),this},one:function or(ar,lr,ur){return this.emitter().one(ar,argSelector(lr),ur),this},once:function or(ar,lr,ur){return this.emitter().one(ar,argSelector(lr),ur),this},emit:function or(ar,lr){return this.emitter().emit(ar,lr),this},emitAndNotify:function or(ar,lr){return this.emit(ar),this.notify(ar,lr),this}};define.eventAliasesOn(elesfn);var corefn$7={png:function or(ar){var lr=this._private.renderer;return ar=ar||{},lr.png(ar)},jpg:function or(ar){var lr=this._private.renderer;return ar=ar||{},ar.bg=ar.bg||"#fff",lr.jpg(ar)}};corefn$7.jpeg=corefn$7.jpg;var corefn$6={layout:function or(ar){var lr=this;if(ar==null){error("Layout options must be specified to make a layout");return}if(ar.name==null){error("A `name` must be specified to make a layout");return}var ur=ar.name,cr=lr.extension("layout",ur);if(cr==null){error("No such layout `"+ur+"` found.  Did you forget to import it and `cytoscape.use()` it?");return}var hr;string(ar.eles)?hr=lr.$(ar.eles):hr=ar.eles!=null?ar.eles:lr.$();var dr=new cr(extend({},ar,{cy:lr,eles:hr}));return dr}};corefn$6.createLayout=corefn$6.makeLayout=corefn$6.layout;var corefn$5={notify:function or(ar,lr){var ur=this._private;if(this.batching()){ur.batchNotifications=ur.batchNotifications||{};var cr=ur.batchNotifications[ar]=ur.batchNotifications[ar]||this.collection();lr!=null&&cr.merge(lr);return}if(ur.notificationsEnabled){var hr=this.renderer();this.destroyed()||!hr||hr.notify(ar,lr)}},notifications:function or(ar){var lr=this._private;return ar===void 0?lr.notificationsEnabled:(lr.notificationsEnabled=!!ar,this)},noNotifications:function or(ar){this.notifications(!1),ar(),this.notifications(!0)},batching:function or(){return this._private.batchCount>0},startBatch:function or(){var ar=this._private;return ar.batchCount==null&&(ar.batchCount=0),ar.batchCount===0&&(ar.batchStyleEles=this.collection(),ar.batchNotifications={}),ar.batchCount++,this},endBatch:function or(){var ar=this._private;if(ar.batchCount===0)return this;if(ar.batchCount--,ar.batchCount===0){ar.batchStyleEles.updateStyle();var lr=this.renderer();Object.keys(ar.batchNotifications).forEach(function(ur){var cr=ar.batchNotifications[ur];cr.empty()?lr.notify(ur):lr.notify(ur,cr)})}return this},batch:function or(ar){return this.startBatch(),ar(),this.endBatch(),this},batchData:function or(ar){var lr=this;return this.batch(function(){for(var ur=Object.keys(ar),cr=0;cr<ur.length;cr++){var hr=ur[cr],dr=ar[hr],fr=lr.getElementById(hr);fr.data(dr)}})}},rendererDefaults=defaults$g({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1,webgl:!1,webglDebug:!1,webglDebugShowAtlases:!1,webglTexSize:2048,webglTexRows:36,webglTexRowsNodes:18,webglBatchSize:2048,webglTexPerBatch:14,webglBgColor:[255,255,255]}),corefn$4={renderTo:function or(ar,lr,ur,cr){var hr=this._private.renderer;return hr.renderTo(ar,lr,ur,cr),this},renderer:function or(){return this._private.renderer},forceRender:function or(){return this.notify("draw"),this},resize:function or(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function or(ar){var lr=this,ur=lr.extension("renderer",ar.name);if(ur==null){error("Can not initialise: No such renderer `".concat(ar.name,"` found. Did you forget to import it and `cytoscape.use()` it?"));return}ar.wheelSensitivity!==void 0&&warn("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var cr=rendererDefaults(ar);cr.cy=lr,lr._private.renderer=new ur(cr),this.notify("init")},destroyRenderer:function or(){var ar=this;ar.notify("destroy");var lr=ar.container();if(lr)for(lr._cyreg=null;lr.childNodes.length>0;)lr.removeChild(lr.childNodes[0]);ar._private.renderer=null,ar.mutableElements().forEach(function(ur){var cr=ur._private;cr.rscratch={},cr.rstyle={},cr.animation.current=[],cr.animation.queue=[]})},onRender:function or(ar){return this.on("render",ar)},offRender:function or(ar){return this.off("render",ar)}};corefn$4.invalidateDimensions=corefn$4.resize;var corefn$3={collection:function or(ar,lr){return string(ar)?this.$(ar):elementOrCollection(ar)?ar.collection():array(ar)?(lr||(lr={}),new Collection(this,ar,lr.unique,lr.removed)):new Collection(this)},nodes:function or(ar){var lr=this.$(function(ur){return ur.isNode()});return ar?lr.filter(ar):lr},edges:function or(ar){var lr=this.$(function(ur){return ur.isEdge()});return ar?lr.filter(ar):lr},$:function or(ar){var lr=this._private.elements;return ar?lr.filter(ar):lr.spawnSelf()},mutableElements:function or(){return this._private.elements}};corefn$3.elements=corefn$3.filter=corefn$3.$;var styfn$8={},TRUE="t",FALSE="f";styfn$8.apply=function(or){for(var ar=this,lr=ar._private,ur=lr.cy,cr=ur.collection(),hr=0;hr<or.length;hr++){var dr=or[hr],fr=ar.getContextMeta(dr);if(!fr.empty){var pr=ar.getContextStyle(fr),vr=ar.applyContextStyle(fr,pr,dr);dr._private.appliedInitStyle?ar.updateTransitions(dr,vr.diffProps):dr._private.appliedInitStyle=!0;var gr=ar.updateStyleHints(dr);gr&&cr.push(dr)}}return cr};styfn$8.getPropertiesDiff=function(or,ar){var lr=this,ur=lr._private.propDiffs=lr._private.propDiffs||{},cr=or+"-"+ar,hr=ur[cr];if(hr)return hr;for(var dr=[],fr={},pr=0;pr<lr.length;pr++){var vr=lr[pr],gr=or[pr]===TRUE,mr=ar[pr]===TRUE,br=gr!==mr,yr=vr.mappedProperties.length>0;if(br||mr&&yr){var xr=void 0;br&&yr||br?xr=vr.properties:yr&&(xr=vr.mappedProperties);for(var Cr=0;Cr<xr.length;Cr++){for(var Sr=xr[Cr],wr=Sr.name,Er=!1,Ar=pr+1;Ar<lr.length;Ar++){var Tr=lr[Ar],Rr=ar[Ar]===TRUE;if(Rr&&(Er=Tr.properties[Sr.name]!=null,Er))break}!fr[wr]&&!Er&&(fr[wr]=!0,dr.push(wr))}}}return ur[cr]=dr,dr};styfn$8.getContextMeta=function(or){for(var ar=this,lr="",ur,cr=or._private.styleCxtKey||"",hr=0;hr<ar.length;hr++){var dr=ar[hr],fr=dr.selector&&dr.selector.matches(or);fr?lr+=TRUE:lr+=FALSE}return ur=ar.getPropertiesDiff(cr,lr),or._private.styleCxtKey=lr,{key:lr,diffPropNames:ur,empty:ur.length===0}};styfn$8.getContextStyle=function(or){var ar=or.key,lr=this,ur=this._private.contextStyles=this._private.contextStyles||{};if(ur[ar])return ur[ar];for(var cr={_private:{key:ar}},hr=0;hr<lr.length;hr++){var dr=lr[hr],fr=ar[hr]===TRUE;if(fr)for(var pr=0;pr<dr.properties.length;pr++){var vr=dr.properties[pr];cr[vr.name]=vr}}return ur[ar]=cr,cr};styfn$8.applyContextStyle=function(or,ar,lr){for(var ur=this,cr=or.diffPropNames,hr={},dr=ur.types,fr=0;fr<cr.length;fr++){var pr=cr[fr],vr=ar[pr],gr=lr.pstyle(pr);if(!vr)if(gr)gr.bypass?vr={name:pr,deleteBypassed:!0}:vr={name:pr,delete:!0};else continue;if(gr!==vr){if(vr.mapped===dr.fn&&gr!=null&&gr.mapping!=null&&gr.mapping.value===vr.value){var mr=gr.mapping,br=mr.fnValue=vr.value(lr);if(br===mr.prevFnValue)continue}var yr=hr[pr]={prev:gr};ur.applyParsedProperty(lr,vr),yr.next=lr.pstyle(pr),yr.next&&yr.next.bypass&&(yr.next=yr.next.bypassed)}}return{diffProps:hr}};styfn$8.updateStyleHints=function(or){var ar=or._private,lr=this,ur=lr.propertyGroupNames,cr=lr.propertyGroupKeys,hr=function(_i,os,ls){return lr.getPropertiesHash(_i,os,ls)},dr=ar.styleKey;if(or.removed())return!1;var fr=ar.group==="nodes",pr=or._private.style;ur=Object.keys(pr);for(var vr=0;vr<cr.length;vr++){var gr=cr[vr];ar.styleKeys[gr]=[DEFAULT_HASH_SEED,DEFAULT_HASH_SEED_ALT]}for(var mr=function(_i,os){return ar.styleKeys[os][0]=hashInt(_i,ar.styleKeys[os][0])},br=function(_i,os){return ar.styleKeys[os][1]=hashIntAlt(_i,ar.styleKeys[os][1])},yr=function(_i,os){mr(_i,os),br(_i,os)},xr=function(_i,os){for(var ls=0;ls<_i.length;ls++){var ys=_i.charCodeAt(ls);mr(ys,os),br(ys,os)}},Cr=2e9,Sr=function(_i){return-128<_i&&_i<128&&Math.floor(_i)!==_i?Cr-(_i*1024|0):_i},wr=0;wr<ur.length;wr++){var Er=ur[wr],Ar=pr[Er];if(Ar!=null){var Tr=this.properties[Er],Rr=Tr.type,Pr=Tr.groupKey,_r=void 0;Tr.hashOverride!=null?_r=Tr.hashOverride(or,Ar):Ar.pfValue!=null&&(_r=Ar.pfValue);var kr=Tr.enums==null?Ar.value:null,Dr=_r!=null,Nr=kr!=null,Lr=Dr||Nr,Or=Ar.units;if(Rr.number&&Lr&&!Rr.multiple){var Ir=Dr?_r:kr;yr(Sr(Ir),Pr),!Dr&&Or!=null&&xr(Or,Pr)}else xr(Ar.strValue,Pr)}}for(var Mr=[DEFAULT_HASH_SEED,DEFAULT_HASH_SEED_ALT],$r=0;$r<cr.length;$r++){var jr=cr[$r],Fr=ar.styleKeys[jr];Mr[0]=hashInt(Fr[0],Mr[0]),Mr[1]=hashIntAlt(Fr[1],Mr[1])}ar.styleKey=combineHashes(Mr[0],Mr[1]);var zr=ar.styleKeys;ar.labelDimsKey=combineHashesArray(zr.labelDimensions);var Hr=hr(or,["label"],zr.labelDimensions);if(ar.labelKey=combineHashesArray(Hr),ar.labelStyleKey=combineHashesArray(hashArrays(zr.commonLabel,Hr)),!fr){var Wr=hr(or,["source-label"],zr.labelDimensions);ar.sourceLabelKey=combineHashesArray(Wr),ar.sourceLabelStyleKey=combineHashesArray(hashArrays(zr.commonLabel,Wr));var Yr=hr(or,["target-label"],zr.labelDimensions);ar.targetLabelKey=combineHashesArray(Yr),ar.targetLabelStyleKey=combineHashesArray(hashArrays(zr.commonLabel,Yr))}if(fr){var qr=ar.styleKeys,Br=qr.nodeBody,Ur=qr.nodeBorder,Vr=qr.nodeOutline,Xr=qr.backgroundImage,Zr=qr.compound,Jr=qr.pie,Qr=qr.stripe,ga=[Br,Ur,Vr,Xr,Zr,Jr,Qr].filter(function(ba){return ba!=null}).reduce(hashArrays,[DEFAULT_HASH_SEED,DEFAULT_HASH_SEED_ALT]);ar.nodeKey=combineHashesArray(ga),ar.hasPie=Jr!=null&&Jr[0]!==DEFAULT_HASH_SEED&&Jr[1]!==DEFAULT_HASH_SEED_ALT,ar.hasStripe=Qr!=null&&Qr[0]!==DEFAULT_HASH_SEED&&Qr[1]!==DEFAULT_HASH_SEED_ALT}return dr!==ar.styleKey};styfn$8.clearStyleHints=function(or){var ar=or._private;ar.styleCxtKey="",ar.styleKeys={},ar.styleKey=null,ar.labelKey=null,ar.labelStyleKey=null,ar.sourceLabelKey=null,ar.sourceLabelStyleKey=null,ar.targetLabelKey=null,ar.targetLabelStyleKey=null,ar.nodeKey=null,ar.hasPie=null,ar.hasStripe=null};styfn$8.applyParsedProperty=function(or,ar){var lr=this,ur=ar,cr=or._private.style,hr,dr=lr.types,fr=lr.properties[ur.name].type,pr=ur.bypass,vr=cr[ur.name],gr=vr&&vr.bypass,mr=or._private,br="mapping",yr=function(Br){return Br==null?null:Br.pfValue!=null?Br.pfValue:Br.value},xr=function(){var Br=yr(vr),Ur=yr(ur);lr.checkTriggers(or,ur.name,Br,Ur)};if(ar.name==="curve-style"&&or.isEdge()&&(ar.value!=="bezier"&&or.isLoop()||ar.value==="haystack"&&(or.source().isParent()||or.target().isParent()))&&(ur=ar=this.parse(ar.name,"bezier",pr)),ur.delete)return cr[ur.name]=void 0,xr(),!0;if(ur.deleteBypassed)return vr?vr.bypass?(vr.bypassed=void 0,xr(),!0):!1:(xr(),!0);if(ur.deleteBypass)return vr?vr.bypass?(cr[ur.name]=vr.bypassed,xr(),!0):!1:(xr(),!0);var Cr=function(){warn("Do not assign mappings to elements without corresponding data (i.e. ele `"+or.id()+"` has no mapping for property `"+ur.name+"` with data field `"+ur.field+"`); try a `["+ur.field+"]` selector to limit scope to elements with `"+ur.field+"` defined")};switch(ur.mapped){case dr.mapData:{for(var Sr=ur.field.split("."),wr=mr.data,Er=0;Er<Sr.length&&wr;Er++){var Ar=Sr[Er];wr=wr[Ar]}if(wr==null)return Cr(),!1;var Tr;if(number$1(wr)){var Rr=ur.fieldMax-ur.fieldMin;Rr===0?Tr=0:Tr=(wr-ur.fieldMin)/Rr}else return warn("Do not use continuous mappers without specifying numeric data (i.e. `"+ur.field+": "+wr+"` for `"+or.id()+"` is non-numeric)"),!1;if(Tr<0?Tr=0:Tr>1&&(Tr=1),fr.color){var Pr=ur.valueMin[0],_r=ur.valueMax[0],kr=ur.valueMin[1],Dr=ur.valueMax[1],Nr=ur.valueMin[2],Lr=ur.valueMax[2],Or=ur.valueMin[3]==null?1:ur.valueMin[3],Ir=ur.valueMax[3]==null?1:ur.valueMax[3],Mr=[Math.round(Pr+(_r-Pr)*Tr),Math.round(kr+(Dr-kr)*Tr),Math.round(Nr+(Lr-Nr)*Tr),Math.round(Or+(Ir-Or)*Tr)];hr={bypass:ur.bypass,name:ur.name,value:Mr,strValue:"rgb("+Mr[0]+", "+Mr[1]+", "+Mr[2]+")"}}else if(fr.number){var $r=ur.valueMin+(ur.valueMax-ur.valueMin)*Tr;hr=this.parse(ur.name,$r,ur.bypass,br)}else return!1;if(!hr)return Cr(),!1;hr.mapping=ur,ur=hr;break}case dr.data:{for(var jr=ur.field.split("."),Fr=mr.data,zr=0;zr<jr.length&&Fr;zr++){var Hr=jr[zr];Fr=Fr[Hr]}if(Fr!=null&&(hr=this.parse(ur.name,Fr,ur.bypass,br)),!hr)return Cr(),!1;hr.mapping=ur,ur=hr;break}case dr.fn:{var Wr=ur.value,Yr=ur.fnValue!=null?ur.fnValue:Wr(or);if(ur.prevFnValue=Yr,Yr==null)return warn("Custom function mappers may not return null (i.e. `"+ur.name+"` for ele `"+or.id()+"` is null)"),!1;if(hr=this.parse(ur.name,Yr,ur.bypass,br),!hr)return warn("Custom function mappers may not return invalid values for the property type (i.e. `"+ur.name+"` for ele `"+or.id()+"` is invalid)"),!1;hr.mapping=copy(ur),ur=hr;break}case void 0:break;default:return!1}return pr?(gr?ur.bypassed=vr.bypassed:ur.bypassed=vr,cr[ur.name]=ur):gr?vr.bypassed=ur:cr[ur.name]=ur,xr(),!0};styfn$8.cleanElements=function(or,ar){for(var lr=0;lr<or.length;lr++){var ur=or[lr];if(this.clearStyleHints(ur),ur.dirtyCompoundBoundsCache(),ur.dirtyBoundingBoxCache(),!ar)ur._private.style={};else for(var cr=ur._private.style,hr=Object.keys(cr),dr=0;dr<hr.length;dr++){var fr=hr[dr],pr=cr[fr];pr!=null&&(pr.bypass?pr.bypassed=null:cr[fr]=null)}}};styfn$8.update=function(){var or=this._private.cy,ar=or.mutableElements();ar.updateStyle()};styfn$8.updateTransitions=function(or,ar){var lr=this,ur=or._private,cr=or.pstyle("transition-property").value,hr=or.pstyle("transition-duration").pfValue,dr=or.pstyle("transition-delay").pfValue;if(cr.length>0&&hr>0){for(var fr={},pr=!1,vr=0;vr<cr.length;vr++){var gr=cr[vr],mr=or.pstyle(gr),br=ar[gr];if(br){var yr=br.prev,xr=yr,Cr=br.next!=null?br.next:mr,Sr=!1,wr=void 0,Er=1e-6;xr&&(number$1(xr.pfValue)&&number$1(Cr.pfValue)?(Sr=Cr.pfValue-xr.pfValue,wr=xr.pfValue+Er*Sr):number$1(xr.value)&&number$1(Cr.value)?(Sr=Cr.value-xr.value,wr=xr.value+Er*Sr):array(xr.value)&&array(Cr.value)&&(Sr=xr.value[0]!==Cr.value[0]||xr.value[1]!==Cr.value[1]||xr.value[2]!==Cr.value[2],wr=xr.strValue),Sr&&(fr[gr]=Cr.strValue,this.applyBypass(or,gr,wr),pr=!0))}}if(!pr)return;ur.transitioning=!0,new Promise$1(function(Ar){dr>0?or.delayAnimation(dr).play().promise().then(Ar):Ar()}).then(function(){return or.animation({style:fr,duration:hr,easing:or.pstyle("transition-timing-function").value,queue:!1}).play().promise()}).then(function(){lr.removeBypasses(or,cr),or.emitAndNotify("style"),ur.transitioning=!1})}else ur.transitioning&&(this.removeBypasses(or,cr),or.emitAndNotify("style"),ur.transitioning=!1)};styfn$8.checkTrigger=function(or,ar,lr,ur,cr,hr){var dr=this.properties[ar],fr=cr(dr);or.removed()||fr!=null&&fr(lr,ur,or)&&hr(dr)};styfn$8.checkZOrderTrigger=function(or,ar,lr,ur){var cr=this;this.checkTrigger(or,ar,lr,ur,function(hr){return hr.triggersZOrder},function(){cr._private.cy.notify("zorder",or)})};styfn$8.checkBoundsTrigger=function(or,ar,lr,ur){this.checkTrigger(or,ar,lr,ur,function(cr){return cr.triggersBounds},function(cr){or.dirtyCompoundBoundsCache(),or.dirtyBoundingBoxCache()})};styfn$8.checkConnectedEdgesBoundsTrigger=function(or,ar,lr,ur){this.checkTrigger(or,ar,lr,ur,function(cr){return cr.triggersBoundsOfConnectedEdges},function(cr){or.connectedEdges().forEach(function(hr){hr.dirtyBoundingBoxCache()})})};styfn$8.checkParallelEdgesBoundsTrigger=function(or,ar,lr,ur){this.checkTrigger(or,ar,lr,ur,function(cr){return cr.triggersBoundsOfParallelEdges},function(cr){or.parallelEdges().forEach(function(hr){hr.dirtyBoundingBoxCache()})})};styfn$8.checkTriggers=function(or,ar,lr,ur){or.dirtyStyleCache(),this.checkZOrderTrigger(or,ar,lr,ur),this.checkBoundsTrigger(or,ar,lr,ur),this.checkConnectedEdgesBoundsTrigger(or,ar,lr,ur),this.checkParallelEdgesBoundsTrigger(or,ar,lr,ur)};var styfn$7={};styfn$7.applyBypass=function(or,ar,lr,ur){var cr=this,hr=[],dr=!0;if(ar==="*"||ar==="**"){if(lr!==void 0)for(var fr=0;fr<cr.properties.length;fr++){var pr=cr.properties[fr],vr=pr.name,gr=this.parse(vr,lr,!0);gr&&hr.push(gr)}}else if(string(ar)){var mr=this.parse(ar,lr,!0);mr&&hr.push(mr)}else if(plainObject(ar)){var br=ar;ur=lr;for(var yr=Object.keys(br),xr=0;xr<yr.length;xr++){var Cr=yr[xr],Sr=br[Cr];if(Sr===void 0&&(Sr=br[dash2camel(Cr)]),Sr!==void 0){var wr=this.parse(Cr,Sr,!0);wr&&hr.push(wr)}}}else return!1;if(hr.length===0)return!1;for(var Er=!1,Ar=0;Ar<or.length;Ar++){for(var Tr=or[Ar],Rr={},Pr=void 0,_r=0;_r<hr.length;_r++){var kr=hr[_r];if(ur){var Dr=Tr.pstyle(kr.name);Pr=Rr[kr.name]={prev:Dr}}Er=this.applyParsedProperty(Tr,copy(kr))||Er,ur&&(Pr.next=Tr.pstyle(kr.name))}Er&&this.updateStyleHints(Tr),ur&&this.updateTransitions(Tr,Rr,dr)}return Er};styfn$7.overrideBypass=function(or,ar,lr){ar=camel2dash(ar);for(var ur=0;ur<or.length;ur++){var cr=or[ur],hr=cr._private.style[ar],dr=this.properties[ar].type,fr=dr.color,pr=dr.mutiple,vr=hr?hr.pfValue!=null?hr.pfValue:hr.value:null;!hr||!hr.bypass?this.applyBypass(cr,ar,lr):(hr.value=lr,hr.pfValue!=null&&(hr.pfValue=lr),fr?hr.strValue="rgb("+lr.join(",")+")":pr?hr.strValue=lr.join(" "):hr.strValue=""+lr,this.updateStyleHints(cr)),this.checkTriggers(cr,ar,vr,lr)}};styfn$7.removeAllBypasses=function(or,ar){return this.removeBypasses(or,this.propertyNames,ar)};styfn$7.removeBypasses=function(or,ar,lr){for(var ur=!0,cr=0;cr<or.length;cr++){for(var hr=or[cr],dr={},fr=0;fr<ar.length;fr++){var pr=ar[fr],vr=this.properties[pr],gr=hr.pstyle(vr.name);if(!(!gr||!gr.bypass)){var mr="",br=this.parse(pr,mr,!0),yr=dr[vr.name]={prev:gr};this.applyParsedProperty(hr,br),yr.next=hr.pstyle(vr.name)}}this.updateStyleHints(hr),lr&&this.updateTransitions(hr,dr,ur)}};var styfn$6={};styfn$6.getEmSizeInPixels=function(){var or=this.containerCss("font-size");return or!=null?parseFloat(or):1};styfn$6.containerCss=function(or){var ar=this._private.cy,lr=ar.container(),ur=ar.window();if(ur&&lr&&ur.getComputedStyle)return ur.getComputedStyle(lr).getPropertyValue(or)};var styfn$5={};styfn$5.getRenderedStyle=function(or,ar){return ar?this.getStylePropertyValue(or,ar,!0):this.getRawStyle(or,!0)};styfn$5.getRawStyle=function(or,ar){var lr=this;if(or=or[0],or){for(var ur={},cr=0;cr<lr.properties.length;cr++){var hr=lr.properties[cr],dr=lr.getStylePropertyValue(or,hr.name,ar);dr!=null&&(ur[hr.name]=dr,ur[dash2camel(hr.name)]=dr)}return ur}};styfn$5.getIndexedStyle=function(or,ar,lr,ur){var cr=or.pstyle(ar)[lr][ur];return cr??or.cy().style().getDefaultProperty(ar)[lr][0]};styfn$5.getStylePropertyValue=function(or,ar,lr){var ur=this;if(or=or[0],or){var cr=ur.properties[ar];cr.alias&&(cr=cr.pointsTo);var hr=cr.type,dr=or.pstyle(cr.name);if(dr){var fr=dr.value,pr=dr.units,vr=dr.strValue;if(lr&&hr.number&&fr!=null&&number$1(fr)){var gr=or.cy().zoom(),mr=function(Sr){return Sr*gr},br=function(Sr,wr){return mr(Sr)+wr},yr=array(fr),xr=yr?pr.every(function(Cr){return Cr!=null}):pr!=null;return xr?yr?fr.map(function(Cr,Sr){return br(Cr,pr[Sr])}).join(" "):br(fr,pr):yr?fr.map(function(Cr){return string(Cr)?Cr:""+mr(Cr)}).join(" "):""+mr(fr)}else if(vr!=null)return vr}return null}};styfn$5.getAnimationStartStyle=function(or,ar){for(var lr={},ur=0;ur<ar.length;ur++){var cr=ar[ur],hr=cr.name,dr=or.pstyle(hr);dr!==void 0&&(plainObject(dr)?dr=this.parse(hr,dr.strValue):dr=this.parse(hr,dr)),dr&&(lr[hr]=dr)}return lr};styfn$5.getPropsList=function(or){var ar=this,lr=[],ur=or,cr=ar.properties;if(ur)for(var hr=Object.keys(ur),dr=0;dr<hr.length;dr++){var fr=hr[dr],pr=ur[fr],vr=cr[fr]||cr[camel2dash(fr)],gr=this.parse(vr.name,pr);gr&&lr.push(gr)}return lr};styfn$5.getNonDefaultPropertiesHash=function(or,ar,lr){var ur=lr.slice(),cr,hr,dr,fr,pr,vr;for(pr=0;pr<ar.length;pr++)if(cr=ar[pr],hr=or.pstyle(cr,!1),hr!=null)if(hr.pfValue!=null)ur[0]=hashInt(fr,ur[0]),ur[1]=hashIntAlt(fr,ur[1]);else for(dr=hr.strValue,vr=0;vr<dr.length;vr++)fr=dr.charCodeAt(vr),ur[0]=hashInt(fr,ur[0]),ur[1]=hashIntAlt(fr,ur[1]);return ur};styfn$5.getPropertiesHash=styfn$5.getNonDefaultPropertiesHash;var styfn$4={};styfn$4.appendFromJson=function(or){for(var ar=this,lr=0;lr<or.length;lr++){var ur=or[lr],cr=ur.selector,hr=ur.style||ur.css,dr=Object.keys(hr);ar.selector(cr);for(var fr=0;fr<dr.length;fr++){var pr=dr[fr],vr=hr[pr];ar.css(pr,vr)}}return ar};styfn$4.fromJson=function(or){var ar=this;return ar.resetToDefault(),ar.appendFromJson(or),ar};styfn$4.json=function(){for(var or=[],ar=this.defaultLength;ar<this.length;ar++){for(var lr=this[ar],ur=lr.selector,cr=lr.properties,hr={},dr=0;dr<cr.length;dr++){var fr=cr[dr];hr[fr.name]=fr.strValue}or.push({selector:ur?ur.toString():"core",style:hr})}return or};var styfn$3={};styfn$3.appendFromString=function(or){var ar=this,lr=this,ur=""+or,cr,hr,dr;ur=ur.replace(/[/][*](\s|.)+?[*][/]/g,"");function fr(){ur.length>cr.length?ur=ur.substr(cr.length):ur=""}function pr(){hr.length>dr.length?hr=hr.substr(dr.length):hr=""}for(;;){var vr=ur.match(/^\s*$/);if(vr)break;var gr=ur.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!gr){warn("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+ur);break}cr=gr[0];var mr=gr[1];if(mr!=="core"){var br=new Selector(mr);if(br.invalid){warn("Skipping parsing of block: Invalid selector found in string stylesheet: "+mr),fr();continue}}var yr=gr[2],xr=!1;hr=yr;for(var Cr=[];;){var Sr=hr.match(/^\s*$/);if(Sr)break;var wr=hr.match(/^\s*(.+?)\s*:\s*(.+?)(?:\s*;|\s*$)/);if(!wr){warn("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+yr),xr=!0;break}dr=wr[0];var Er=wr[1],Ar=wr[2],Tr=ar.properties[Er];if(!Tr){warn("Skipping property: Invalid property name in: "+dr),pr();continue}var Rr=lr.parse(Er,Ar);if(!Rr){warn("Skipping property: Invalid property definition in: "+dr),pr();continue}Cr.push({name:Er,val:Ar}),pr()}if(xr){fr();break}lr.selector(mr);for(var Pr=0;Pr<Cr.length;Pr++){var _r=Cr[Pr];lr.css(_r.name,_r.val)}fr()}return lr};styfn$3.fromString=function(or){var ar=this;return ar.resetToDefault(),ar.appendFromString(or),ar};var styfn$2={};(function(){var or=number,ar=rgbaNoBackRefs,lr=hslaNoBackRefs,ur=hex3,cr=hex6,hr=function(ba){return"^"+ba+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},dr=function(ba){var _i=or+"|\\w+|"+ar+"|"+lr+"|"+ur+"|"+cr;return"^"+ba+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+or+")\\s*\\,\\s*("+or+")\\s*,\\s*("+_i+")\\s*\\,\\s*("+_i+")\\)$"},fr=[`^url\\s*\\(\\s*['"]?(.+?)['"]?\\s*\\)$`,"^(none)$","^(.+)$"];styfn$2.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},nonNegativeNumber:{number:!0,min:0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizeMaybePercent:{number:!0,allowPercent:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},axisDirectionExplicit:{enums:["leftward","rightward","upward","downward"]},axisDirectionPrimary:{enums:["horizontal","vertical"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials","null"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},bgContainment:{enums:["inside","over"],multiple:!0},boxSelection:{enums:["contain","overlap","none"]},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},bools:{enums:["yes","no"],multiple:!0},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},linePosition:{enums:["center","inside","outside"]},lineJoin:{enums:["round","bevel","miter"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","straight-triangle","taxi","round-segments","round-taxi"]},radiusType:{enums:["arc-radius","influence-radius"],multiple:!0},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle","circle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","round-triangle","square","pentagon","round-pentagon","hexagon","round-hexagon","concavehexagon","concave-hexagon","heptagon","round-heptagon","octagon","round-octagon","tag","round-tag","star","diamond","round-diamond","vee","rhomboid","right-rhomboid","polygon"]},overlayShape:{enums:["roundrectangle","round-rectangle","ellipse"]},cornerRadius:{number:!0,min:0,units:"px|em",implicitUnits:"px",enums:["auto"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","circle-triangle","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},arrowWidth:{number:!0,units:"%|px|em",implicitUnits:"px",enums:["match-line"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:hr("data")},layoutData:{mapping:!0,regex:hr("layoutData")},scratch:{mapping:!0,regex:hr("scratch")},mapData:{mapping:!0,regex:dr("mapData")},mapLayoutData:{mapping:!0,regex:dr("mapLayoutData")},mapScratch:{mapping:!0,regex:dr("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:fr,singleRegexMatchValue:!0},urls:{regexes:fr,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position","endpoints"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(ba,_i){switch(ba.length){case 2:return _i[0]!=="deg"&&_i[0]!=="rad"&&_i[1]!=="deg"&&_i[1]!=="rad";case 1:return string(ba[0])||_i[0]==="deg"||_i[0]==="rad";default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+or+")\\s*,\\s*("+or+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+or+")\\s*,\\s*("+or+")\\s*,\\s*("+or+")\\s*,\\s*("+or+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(ba){var _i=ba.length;return _i===1||_i===2||_i===4}}};var pr={zeroNonZero:function(ba,_i){return(ba==null||_i==null)&&ba!==_i||ba==0&&_i!=0?!0:ba!=0&&_i==0},any:function(ba,_i){return ba!=_i},emptyNonEmpty:function(ba,_i){var os=emptyString(ba),ls=emptyString(_i);return os&&!ls||!os&&ls}},vr=styfn$2.types,gr=[{name:"label",type:vr.text,triggersBounds:pr.any,triggersZOrder:pr.emptyNonEmpty},{name:"text-rotation",type:vr.textRotation,triggersBounds:pr.any},{name:"text-margin-x",type:vr.bidirectionalSize,triggersBounds:pr.any},{name:"text-margin-y",type:vr.bidirectionalSize,triggersBounds:pr.any}],mr=[{name:"source-label",type:vr.text,triggersBounds:pr.any},{name:"source-text-rotation",type:vr.textRotation,triggersBounds:pr.any},{name:"source-text-margin-x",type:vr.bidirectionalSize,triggersBounds:pr.any},{name:"source-text-margin-y",type:vr.bidirectionalSize,triggersBounds:pr.any},{name:"source-text-offset",type:vr.size,triggersBounds:pr.any}],br=[{name:"target-label",type:vr.text,triggersBounds:pr.any},{name:"target-text-rotation",type:vr.textRotation,triggersBounds:pr.any},{name:"target-text-margin-x",type:vr.bidirectionalSize,triggersBounds:pr.any},{name:"target-text-margin-y",type:vr.bidirectionalSize,triggersBounds:pr.any},{name:"target-text-offset",type:vr.size,triggersBounds:pr.any}],yr=[{name:"font-family",type:vr.fontFamily,triggersBounds:pr.any},{name:"font-style",type:vr.fontStyle,triggersBounds:pr.any},{name:"font-weight",type:vr.fontWeight,triggersBounds:pr.any},{name:"font-size",type:vr.size,triggersBounds:pr.any},{name:"text-transform",type:vr.textTransform,triggersBounds:pr.any},{name:"text-wrap",type:vr.textWrap,triggersBounds:pr.any},{name:"text-overflow-wrap",type:vr.textOverflowWrap,triggersBounds:pr.any},{name:"text-max-width",type:vr.size,triggersBounds:pr.any},{name:"text-outline-width",type:vr.size,triggersBounds:pr.any},{name:"line-height",type:vr.positiveNumber,triggersBounds:pr.any}],xr=[{name:"text-valign",type:vr.valign,triggersBounds:pr.any},{name:"text-halign",type:vr.halign,triggersBounds:pr.any},{name:"color",type:vr.color},{name:"text-outline-color",type:vr.color},{name:"text-outline-opacity",type:vr.zeroOneNumber},{name:"text-background-color",type:vr.color},{name:"text-background-opacity",type:vr.zeroOneNumber},{name:"text-background-padding",type:vr.size,triggersBounds:pr.any},{name:"text-border-opacity",type:vr.zeroOneNumber},{name:"text-border-color",type:vr.color},{name:"text-border-width",type:vr.size,triggersBounds:pr.any},{name:"text-border-style",type:vr.borderStyle,triggersBounds:pr.any},{name:"text-background-shape",type:vr.textBackgroundShape,triggersBounds:pr.any},{name:"text-justification",type:vr.justification},{name:"box-select-labels",type:vr.bool,triggersBounds:pr.any}],Cr=[{name:"events",type:vr.bool,triggersZOrder:pr.any},{name:"text-events",type:vr.bool,triggersZOrder:pr.any},{name:"box-selection",type:vr.boxSelection,triggersZOrder:pr.any}],Sr=[{name:"display",type:vr.display,triggersZOrder:pr.any,triggersBounds:pr.any,triggersBoundsOfConnectedEdges:pr.any,triggersBoundsOfParallelEdges:function(ba,_i,os){return ba===_i?!1:os.pstyle("curve-style").value==="bezier"}},{name:"visibility",type:vr.visibility,triggersZOrder:pr.any},{name:"opacity",type:vr.zeroOneNumber,triggersZOrder:pr.zeroNonZero},{name:"text-opacity",type:vr.zeroOneNumber},{name:"min-zoomed-font-size",type:vr.size},{name:"z-compound-depth",type:vr.zCompoundDepth,triggersZOrder:pr.any},{name:"z-index-compare",type:vr.zIndexCompare,triggersZOrder:pr.any},{name:"z-index",type:vr.number,triggersZOrder:pr.any}],wr=[{name:"overlay-padding",type:vr.size,triggersBounds:pr.any},{name:"overlay-color",type:vr.color},{name:"overlay-opacity",type:vr.zeroOneNumber,triggersBounds:pr.zeroNonZero},{name:"overlay-shape",type:vr.overlayShape,triggersBounds:pr.any},{name:"overlay-corner-radius",type:vr.cornerRadius}],Er=[{name:"underlay-padding",type:vr.size,triggersBounds:pr.any},{name:"underlay-color",type:vr.color},{name:"underlay-opacity",type:vr.zeroOneNumber,triggersBounds:pr.zeroNonZero},{name:"underlay-shape",type:vr.overlayShape,triggersBounds:pr.any},{name:"underlay-corner-radius",type:vr.cornerRadius}],Ar=[{name:"transition-property",type:vr.propList},{name:"transition-duration",type:vr.time},{name:"transition-delay",type:vr.time},{name:"transition-timing-function",type:vr.easing}],Tr=function(ba,_i){return _i.value==="label"?-ba.poolIndex():_i.pfValue},Rr=[{name:"height",type:vr.nodeSize,triggersBounds:pr.any,hashOverride:Tr},{name:"width",type:vr.nodeSize,triggersBounds:pr.any,hashOverride:Tr},{name:"shape",type:vr.nodeShape,triggersBounds:pr.any},{name:"shape-polygon-points",type:vr.polygonPointList,triggersBounds:pr.any},{name:"corner-radius",type:vr.cornerRadius},{name:"background-color",type:vr.color},{name:"background-fill",type:vr.fill},{name:"background-opacity",type:vr.zeroOneNumber},{name:"background-blacken",type:vr.nOneOneNumber},{name:"background-gradient-stop-colors",type:vr.colors},{name:"background-gradient-stop-positions",type:vr.percentages},{name:"background-gradient-direction",type:vr.gradientDirection},{name:"padding",type:vr.sizeMaybePercent,triggersBounds:pr.any},{name:"padding-relative-to",type:vr.paddingRelativeTo,triggersBounds:pr.any},{name:"bounds-expansion",type:vr.boundsExpansion,triggersBounds:pr.any}],Pr=[{name:"border-color",type:vr.color},{name:"border-opacity",type:vr.zeroOneNumber},{name:"border-width",type:vr.size,triggersBounds:pr.any},{name:"border-style",type:vr.borderStyle},{name:"border-cap",type:vr.lineCap},{name:"border-join",type:vr.lineJoin},{name:"border-dash-pattern",type:vr.numbers},{name:"border-dash-offset",type:vr.number},{name:"border-position",type:vr.linePosition}],_r=[{name:"outline-color",type:vr.color},{name:"outline-opacity",type:vr.zeroOneNumber},{name:"outline-width",type:vr.size,triggersBounds:pr.any},{name:"outline-style",type:vr.borderStyle},{name:"outline-offset",type:vr.size,triggersBounds:pr.any}],kr=[{name:"background-image",type:vr.urls},{name:"background-image-crossorigin",type:vr.bgCrossOrigin},{name:"background-image-opacity",type:vr.zeroOneNumbers},{name:"background-image-containment",type:vr.bgContainment},{name:"background-image-smoothing",type:vr.bools},{name:"background-position-x",type:vr.bgPos},{name:"background-position-y",type:vr.bgPos},{name:"background-width-relative-to",type:vr.bgRelativeTo},{name:"background-height-relative-to",type:vr.bgRelativeTo},{name:"background-repeat",type:vr.bgRepeat},{name:"background-fit",type:vr.bgFit},{name:"background-clip",type:vr.bgClip},{name:"background-width",type:vr.bgWH},{name:"background-height",type:vr.bgWH},{name:"background-offset-x",type:vr.bgPos},{name:"background-offset-y",type:vr.bgPos}],Dr=[{name:"position",type:vr.position,triggersBounds:pr.any},{name:"compound-sizing-wrt-labels",type:vr.compoundIncludeLabels,triggersBounds:pr.any},{name:"min-width",type:vr.size,triggersBounds:pr.any},{name:"min-width-bias-left",type:vr.sizeMaybePercent,triggersBounds:pr.any},{name:"min-width-bias-right",type:vr.sizeMaybePercent,triggersBounds:pr.any},{name:"min-height",type:vr.size,triggersBounds:pr.any},{name:"min-height-bias-top",type:vr.sizeMaybePercent,triggersBounds:pr.any},{name:"min-height-bias-bottom",type:vr.sizeMaybePercent,triggersBounds:pr.any}],Nr=[{name:"line-style",type:vr.lineStyle},{name:"line-color",type:vr.color},{name:"line-fill",type:vr.fill},{name:"line-cap",type:vr.lineCap},{name:"line-opacity",type:vr.zeroOneNumber},{name:"line-dash-pattern",type:vr.numbers},{name:"line-dash-offset",type:vr.number},{name:"line-outline-width",type:vr.size},{name:"line-outline-color",type:vr.color},{name:"line-gradient-stop-colors",type:vr.colors},{name:"line-gradient-stop-positions",type:vr.percentages},{name:"curve-style",type:vr.curveStyle,triggersBounds:pr.any,triggersBoundsOfParallelEdges:function(ba,_i){return ba===_i?!1:ba==="bezier"||_i==="bezier"}},{name:"haystack-radius",type:vr.zeroOneNumber,triggersBounds:pr.any},{name:"source-endpoint",type:vr.edgeEndpoint,triggersBounds:pr.any},{name:"target-endpoint",type:vr.edgeEndpoint,triggersBounds:pr.any},{name:"control-point-step-size",type:vr.size,triggersBounds:pr.any},{name:"control-point-distances",type:vr.bidirectionalSizes,triggersBounds:pr.any},{name:"control-point-weights",type:vr.numbers,triggersBounds:pr.any},{name:"segment-distances",type:vr.bidirectionalSizes,triggersBounds:pr.any},{name:"segment-weights",type:vr.numbers,triggersBounds:pr.any},{name:"segment-radii",type:vr.numbers,triggersBounds:pr.any},{name:"radius-type",type:vr.radiusType,triggersBounds:pr.any},{name:"taxi-turn",type:vr.bidirectionalSizeMaybePercent,triggersBounds:pr.any},{name:"taxi-turn-min-distance",type:vr.size,triggersBounds:pr.any},{name:"taxi-direction",type:vr.axisDirection,triggersBounds:pr.any},{name:"taxi-radius",type:vr.number,triggersBounds:pr.any},{name:"edge-distances",type:vr.edgeDistances,triggersBounds:pr.any},{name:"arrow-scale",type:vr.positiveNumber,triggersBounds:pr.any},{name:"loop-direction",type:vr.angle,triggersBounds:pr.any},{name:"loop-sweep",type:vr.angle,triggersBounds:pr.any},{name:"source-distance-from-node",type:vr.size,triggersBounds:pr.any},{name:"target-distance-from-node",type:vr.size,triggersBounds:pr.any}],Lr=[{name:"ghost",type:vr.bool,triggersBounds:pr.any},{name:"ghost-offset-x",type:vr.bidirectionalSize,triggersBounds:pr.any},{name:"ghost-offset-y",type:vr.bidirectionalSize,triggersBounds:pr.any},{name:"ghost-opacity",type:vr.zeroOneNumber}],Or=[{name:"selection-box-color",type:vr.color},{name:"selection-box-opacity",type:vr.zeroOneNumber},{name:"selection-box-border-color",type:vr.color},{name:"selection-box-border-width",type:vr.size},{name:"active-bg-color",type:vr.color},{name:"active-bg-opacity",type:vr.zeroOneNumber},{name:"active-bg-size",type:vr.size},{name:"outside-texture-bg-color",type:vr.color},{name:"outside-texture-bg-opacity",type:vr.zeroOneNumber}],Ir=[];styfn$2.pieBackgroundN=16,Ir.push({name:"pie-size",type:vr.sizeMaybePercent}),Ir.push({name:"pie-hole",type:vr.sizeMaybePercent}),Ir.push({name:"pie-start-angle",type:vr.angle});for(var Mr=1;Mr<=styfn$2.pieBackgroundN;Mr++)Ir.push({name:"pie-"+Mr+"-background-color",type:vr.color}),Ir.push({name:"pie-"+Mr+"-background-size",type:vr.percent}),Ir.push({name:"pie-"+Mr+"-background-opacity",type:vr.zeroOneNumber});var $r=[];styfn$2.stripeBackgroundN=16,$r.push({name:"stripe-size",type:vr.sizeMaybePercent}),$r.push({name:"stripe-direction",type:vr.axisDirectionPrimary});for(var jr=1;jr<=styfn$2.stripeBackgroundN;jr++)$r.push({name:"stripe-"+jr+"-background-color",type:vr.color}),$r.push({name:"stripe-"+jr+"-background-size",type:vr.percent}),$r.push({name:"stripe-"+jr+"-background-opacity",type:vr.zeroOneNumber});var Fr=[],zr=styfn$2.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:vr.arrowShape,triggersBounds:pr.any},{name:"arrow-color",type:vr.color},{name:"arrow-fill",type:vr.arrowFill},{name:"arrow-width",type:vr.arrowWidth}].forEach(function(ga){zr.forEach(function(ba){var _i=ba+"-"+ga.name,os=ga.type,ls=ga.triggersBounds;Fr.push({name:_i,type:os,triggersBounds:ls})})},{});var Hr=styfn$2.properties=[].concat(Cr,Ar,Sr,wr,Er,Lr,xr,yr,gr,mr,br,Rr,Pr,_r,kr,Ir,$r,Dr,Nr,Fr,Or),Wr=styfn$2.propertyGroups={behavior:Cr,transition:Ar,visibility:Sr,overlay:wr,underlay:Er,ghost:Lr,commonLabel:xr,labelDimensions:yr,mainLabel:gr,sourceLabel:mr,targetLabel:br,nodeBody:Rr,nodeBorder:Pr,nodeOutline:_r,backgroundImage:kr,pie:Ir,stripe:$r,compound:Dr,edgeLine:Nr,edgeArrow:Fr,core:Or},Yr=styfn$2.propertyGroupNames={},qr=styfn$2.propertyGroupKeys=Object.keys(Wr);qr.forEach(function(ga){Yr[ga]=Wr[ga].map(function(ba){return ba.name}),Wr[ga].forEach(function(ba){return ba.groupKey=ga})});var Br=styfn$2.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"segment-distance",pointsTo:"segment-distances"},{name:"segment-weight",pointsTo:"segment-weights"},{name:"segment-radius",pointsTo:"segment-radii"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];styfn$2.propertyNames=Hr.map(function(ga){return ga.name});for(var Ur=0;Ur<Hr.length;Ur++){var Vr=Hr[Ur];Hr[Vr.name]=Vr}for(var Xr=0;Xr<Br.length;Xr++){var Zr=Br[Xr],Jr=Hr[Zr.pointsTo],Qr={name:Zr.name,alias:!0,pointsTo:Jr};Hr.push(Qr),Hr[Zr.name]=Qr}})();styfn$2.getDefaultProperty=function(or){return this.getDefaultProperties()[or]};styfn$2.getDefaultProperties=function(){var or=this._private;if(or.defaultProperties!=null)return or.defaultProperties;for(var ar=extend({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","box-selection":"contain","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"overlay-shape":"round-rectangle","overlay-corner-radius":"auto","underlay-opacity":0,"underlay-color":"#000","underlay-padding":10,"underlay-shape":"round-rectangle","underlay-corner-radius":"auto","transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","box-select-labels":"no","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-image-containment":"inside","background-image-smoothing":"yes","background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid","border-dash-pattern":[4,2],"border-dash-offset":0,"border-cap":"butt","border-join":"miter","border-position":"center","outline-color":"#999","outline-opacity":1,"outline-width":0,"outline-offset":0,"outline-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","corner-radius":"auto","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%","pie-hole":0,"pie-start-angle":"0deg"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce(function(pr,vr){for(var gr=1;gr<=styfn$2.pieBackgroundN;gr++){var mr=vr.name.replace("{{i}}",gr),br=vr.value;pr[mr]=br}return pr},{}),{"stripe-size":"100%","stripe-direction":"horizontal"},[{name:"stripe-{{i}}-background-color",value:"black"},{name:"stripe-{{i}}-background-size",value:"0%"},{name:"stripe-{{i}}-background-opacity",value:1}].reduce(function(pr,vr){for(var gr=1;gr<=styfn$2.stripeBackgroundN;gr++){var mr=vr.name.replace("{{i}}",gr),br=vr.value;pr[mr]=br}return pr},{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-opacity":1,"line-outline-width":0,"line-outline-color":"#000","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"segment-radii":15,"radius-type":"arc-radius","taxi-turn":"50%","taxi-radius":15,"taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"},{name:"arrow-width",value:1}].reduce(function(pr,vr){return styfn$2.arrowPrefixes.forEach(function(gr){var mr=gr+"-"+vr.name,br=vr.value;pr[mr]=br}),pr},{})),lr={},ur=0;ur<this.properties.length;ur++){var cr=this.properties[ur];if(!cr.pointsTo){var hr=cr.name,dr=ar[hr],fr=this.parse(hr,dr);lr[hr]=fr}}return or.defaultProperties=lr,or.defaultProperties};styfn$2.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var styfn$1={};styfn$1.parse=function(or,ar,lr,ur){var cr=this;if(fn$6(ar))return cr.parseImplWarn(or,ar,lr,ur);var hr=ur==="mapping"||ur===!0||ur===!1||ur==null?"dontcare":ur,dr=lr?"t":"f",fr=""+ar,pr=hashStrings(or,fr,dr,hr),vr=cr.propCache=cr.propCache||[],gr;return(gr=vr[pr])||(gr=vr[pr]=cr.parseImplWarn(or,ar,lr,ur)),(lr||ur==="mapping")&&(gr=copy(gr),gr&&(gr.value=copy(gr.value))),gr};styfn$1.parseImplWarn=function(or,ar,lr,ur){var cr=this.parseImpl(or,ar,lr,ur);return!cr&&ar!=null&&warn("The style property `".concat(or,": ").concat(ar,"` is invalid")),cr&&(cr.name==="width"||cr.name==="height")&&ar==="label"&&warn("The style value of `label` is deprecated for `"+cr.name+"`"),cr};styfn$1.parseImpl=function(or,ar,lr,ur){var cr=this;or=camel2dash(or);var hr=cr.properties[or],dr=ar,fr=cr.types;if(!hr||ar===void 0)return null;hr.alias&&(hr=hr.pointsTo,or=hr.name);var pr=string(ar);pr&&(ar=ar.trim());var vr=hr.type;if(!vr)return null;if(lr&&(ar===""||ar===null))return{name:or,value:ar,bypass:!0,deleteBypass:!0};if(fn$6(ar))return{name:or,value:ar,strValue:"fn",mapped:fr.fn,bypass:lr};var gr,mr;if(!(!pr||ur||ar.length<7||ar[1]!=="a")){if(ar.length>=7&&ar[0]==="d"&&(gr=new RegExp(fr.data.regex).exec(ar))){if(lr)return!1;var br=fr.data;return{name:or,value:gr,strValue:""+ar,mapped:br,field:gr[1],bypass:lr}}else if(ar.length>=10&&ar[0]==="m"&&(mr=new RegExp(fr.mapData.regex).exec(ar))){if(lr||vr.multiple)return!1;var yr=fr.mapData;if(!(vr.color||vr.number))return!1;var xr=this.parse(or,mr[4]);if(!xr||xr.mapped)return!1;var Cr=this.parse(or,mr[5]);if(!Cr||Cr.mapped)return!1;if(xr.pfValue===Cr.pfValue||xr.strValue===Cr.strValue)return warn("`"+or+": "+ar+"` is not a valid mapper because the output range is zero; converting to `"+or+": "+xr.strValue+"`"),this.parse(or,xr.strValue);if(vr.color){var Sr=xr.value,wr=Cr.value,Er=Sr[0]===wr[0]&&Sr[1]===wr[1]&&Sr[2]===wr[2]&&(Sr[3]===wr[3]||(Sr[3]==null||Sr[3]===1)&&(wr[3]==null||wr[3]===1));if(Er)return!1}return{name:or,value:mr,strValue:""+ar,mapped:yr,field:mr[1],fieldMin:parseFloat(mr[2]),fieldMax:parseFloat(mr[3]),valueMin:xr.value,valueMax:Cr.value,bypass:lr}}}if(vr.multiple&&ur!=="multiple"){var Ar;if(pr?Ar=ar.split(/\s+/):array(ar)?Ar=ar:Ar=[ar],vr.evenMultiple&&Ar.length%2!==0)return null;for(var Tr=[],Rr=[],Pr=[],_r="",kr=!1,Dr=0;Dr<Ar.length;Dr++){var Nr=cr.parse(or,Ar[Dr],lr,"multiple");kr=kr||string(Nr.value),Tr.push(Nr.value),Pr.push(Nr.pfValue!=null?Nr.pfValue:Nr.value),Rr.push(Nr.units),_r+=(Dr>0?" ":"")+Nr.strValue}return vr.validate&&!vr.validate(Tr,Rr)?null:vr.singleEnum&&kr?Tr.length===1&&string(Tr[0])?{name:or,value:Tr[0],strValue:Tr[0],bypass:lr}:null:{name:or,value:Tr,pfValue:Pr,strValue:_r,bypass:lr,units:Rr}}var Lr=function(){for(var Qr=0;Qr<vr.enums.length;Qr++){var ga=vr.enums[Qr];if(ga===ar)return{name:or,value:ar,strValue:""+ar,bypass:lr}}return null};if(vr.number){var Or,Ir="px";if(vr.units&&(Or=vr.units),vr.implicitUnits&&(Ir=vr.implicitUnits),!vr.unitless)if(pr){var Mr="px|em"+(vr.allowPercent?"|\\%":"");Or&&(Mr=Or);var $r=ar.match("^("+number+")("+Mr+")?$");$r&&(ar=$r[1],Or=$r[2]||Ir)}else(!Or||vr.implicitUnits)&&(Or=Ir);if(ar=parseFloat(ar),isNaN(ar)&&vr.enums===void 0)return null;if(isNaN(ar)&&vr.enums!==void 0)return ar=dr,Lr();if(vr.integer&&!integer(ar)||vr.min!==void 0&&(ar<vr.min||vr.strictMin&&ar===vr.min)||vr.max!==void 0&&(ar>vr.max||vr.strictMax&&ar===vr.max))return null;var jr={name:or,value:ar,strValue:""+ar+(Or||""),units:Or,bypass:lr};return vr.unitless||Or!=="px"&&Or!=="em"?jr.pfValue=ar:jr.pfValue=Or==="px"||!Or?ar:this.getEmSizeInPixels()*ar,(Or==="ms"||Or==="s")&&(jr.pfValue=Or==="ms"?ar:1e3*ar),(Or==="deg"||Or==="rad")&&(jr.pfValue=Or==="rad"?ar:deg2rad(ar)),Or==="%"&&(jr.pfValue=ar/100),jr}else if(vr.propList){var Fr=[],zr=""+ar;if(zr!=="none"){for(var Hr=zr.split(/\s*,\s*|\s+/),Wr=0;Wr<Hr.length;Wr++){var Yr=Hr[Wr].trim();cr.properties[Yr]?Fr.push(Yr):warn("`"+Yr+"` is not a valid property name")}if(Fr.length===0)return null}return{name:or,value:Fr,strValue:Fr.length===0?"none":Fr.join(" "),bypass:lr}}else if(vr.color){var qr=color2tuple(ar);return qr?{name:or,value:qr,pfValue:qr,strValue:"rgb("+qr[0]+","+qr[1]+","+qr[2]+")",bypass:lr}:null}else if(vr.regex||vr.regexes){if(vr.enums){var Br=Lr();if(Br)return Br}for(var Ur=vr.regexes?vr.regexes:[vr.regex],Vr=0;Vr<Ur.length;Vr++){var Xr=new RegExp(Ur[Vr]),Zr=Xr.exec(ar);if(Zr)return{name:or,value:vr.singleRegexMatchValue?Zr[1]:Zr,strValue:""+ar,bypass:lr}}return null}else return vr.string?{name:or,value:""+ar,strValue:""+ar,bypass:lr}:vr.enums?Lr():null};var _Style=function or(ar){if(!(this instanceof _Style))return new _Style(ar);if(!core(ar)){error("A style must have a core reference");return}this._private={cy:ar,coreStyle:{}},this.length=0,this.resetToDefault()},styfn=_Style.prototype;styfn.instanceString=function(){return"style"};styfn.clear=function(){for(var or=this._private,ar=or.cy,lr=ar.elements(),ur=0;ur<this.length;ur++)this[ur]=void 0;return this.length=0,or.contextStyles={},or.propDiffs={},this.cleanElements(lr,!0),lr.forEach(function(cr){var hr=cr[0]._private;hr.styleDirty=!0,hr.appliedInitStyle=!1}),this};styfn.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this};styfn.core=function(or){return this._private.coreStyle[or]||this.getDefaultProperty(or)};styfn.selector=function(or){var ar=or==="core"?null:new Selector(or),lr=this.length++;return this[lr]={selector:ar,properties:[],mappedProperties:[],index:lr},this};styfn.css=function(){var or=this,ar=arguments;if(ar.length===1)for(var lr=ar[0],ur=0;ur<or.properties.length;ur++){var cr=or.properties[ur],hr=lr[cr.name];hr===void 0&&(hr=lr[dash2camel(cr.name)]),hr!==void 0&&this.cssRule(cr.name,hr)}else ar.length===2&&this.cssRule(ar[0],ar[1]);return this};styfn.style=styfn.css;styfn.cssRule=function(or,ar){var lr=this.parse(or,ar);if(lr){var ur=this.length-1;this[ur].properties.push(lr),this[ur].properties[lr.name]=lr,lr.name.match(/pie-(\d+)-background-size/)&&lr.value&&(this._private.hasPie=!0),lr.name.match(/stripe-(\d+)-background-size/)&&lr.value&&(this._private.hasStripe=!0),lr.mapped&&this[ur].mappedProperties.push(lr);var cr=!this[ur].selector;cr&&(this._private.coreStyle[lr.name]=lr)}return this};styfn.append=function(or){return stylesheet(or)?or.appendToStyle(this):array(or)?this.appendFromJson(or):string(or)&&this.appendFromString(or),this};_Style.fromJson=function(or,ar){var lr=new _Style(or);return lr.fromJson(ar),lr};_Style.fromString=function(or,ar){return new _Style(or).fromString(ar)};[styfn$8,styfn$7,styfn$6,styfn$5,styfn$4,styfn$3,styfn$2,styfn$1].forEach(function(or){extend(styfn,or)});_Style.types=styfn.types;_Style.properties=styfn.properties;_Style.propertyGroups=styfn.propertyGroups;_Style.propertyGroupNames=styfn.propertyGroupNames;_Style.propertyGroupKeys=styfn.propertyGroupKeys;var corefn$2={style:function or(ar){if(ar){var lr=this.setStyle(ar);lr.update()}return this._private.style},setStyle:function or(ar){var lr=this._private;return stylesheet(ar)?lr.style=ar.generateStyle(this):array(ar)?lr.style=_Style.fromJson(this,ar):string(ar)?lr.style=_Style.fromString(this,ar):lr.style=_Style(this),lr.style},updateStyle:function or(){this.mutableElements().updateStyle()}},defaultSelectionType="single",corefn$1={autolock:function or(ar){if(ar!==void 0)this._private.autolock=!!ar;else return this._private.autolock;return this},autoungrabify:function or(ar){if(ar!==void 0)this._private.autoungrabify=!!ar;else return this._private.autoungrabify;return this},autounselectify:function or(ar){if(ar!==void 0)this._private.autounselectify=!!ar;else return this._private.autounselectify;return this},selectionType:function or(ar){var lr=this._private;if(lr.selectionType==null&&(lr.selectionType=defaultSelectionType),ar!==void 0)(ar==="additive"||ar==="single")&&(lr.selectionType=ar);else return lr.selectionType;return this},panningEnabled:function or(ar){if(ar!==void 0)this._private.panningEnabled=!!ar;else return this._private.panningEnabled;return this},userPanningEnabled:function or(ar){if(ar!==void 0)this._private.userPanningEnabled=!!ar;else return this._private.userPanningEnabled;return this},zoomingEnabled:function or(ar){if(ar!==void 0)this._private.zoomingEnabled=!!ar;else return this._private.zoomingEnabled;return this},userZoomingEnabled:function or(ar){if(ar!==void 0)this._private.userZoomingEnabled=!!ar;else return this._private.userZoomingEnabled;return this},boxSelectionEnabled:function or(ar){if(ar!==void 0)this._private.boxSelectionEnabled=!!ar;else return this._private.boxSelectionEnabled;return this},pan:function or(){var ar=arguments,lr=this._private.pan,ur,cr,hr,dr,fr;switch(ar.length){case 0:return lr;case 1:if(string(ar[0]))return ur=ar[0],lr[ur];if(plainObject(ar[0])){if(!this._private.panningEnabled)return this;hr=ar[0],dr=hr.x,fr=hr.y,number$1(dr)&&(lr.x=dr),number$1(fr)&&(lr.y=fr),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;ur=ar[0],cr=ar[1],(ur==="x"||ur==="y")&&number$1(cr)&&(lr[ur]=cr),this.emit("pan viewport");break}return this.notify("viewport"),this},panBy:function or(ar,lr){var ur=arguments,cr=this._private.pan,hr,dr,fr,pr,vr;if(!this._private.panningEnabled)return this;switch(ur.length){case 1:plainObject(ar)&&(fr=ur[0],pr=fr.x,vr=fr.y,number$1(pr)&&(cr.x+=pr),number$1(vr)&&(cr.y+=vr),this.emit("pan viewport"));break;case 2:hr=ar,dr=lr,(hr==="x"||hr==="y")&&number$1(dr)&&(cr[hr]+=dr),this.emit("pan viewport");break}return this.notify("viewport"),this},gc:function or(){this.notify("gc")},fit:function or(ar,lr){var ur=this.getFitViewport(ar,lr);if(ur){var cr=this._private;cr.zoom=ur.zoom,cr.pan=ur.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function or(ar,lr){if(number$1(ar)&&lr===void 0&&(lr=ar,ar=void 0),!(!this._private.panningEnabled||!this._private.zoomingEnabled)){var ur;if(string(ar)){var cr=ar;ar=this.$(cr)}else if(boundingBox(ar)){var hr=ar;ur={x1:hr.x1,y1:hr.y1,x2:hr.x2,y2:hr.y2},ur.w=ur.x2-ur.x1,ur.h=ur.y2-ur.y1}else elementOrCollection(ar)||(ar=this.mutableElements());if(!(elementOrCollection(ar)&&ar.empty())){ur=ur||ar.boundingBox();var dr=this.width(),fr=this.height(),pr;if(lr=number$1(lr)?lr:0,!isNaN(dr)&&!isNaN(fr)&&dr>0&&fr>0&&!isNaN(ur.w)&&!isNaN(ur.h)&&ur.w>0&&ur.h>0){pr=Math.min((dr-2*lr)/ur.w,(fr-2*lr)/ur.h),pr=pr>this._private.maxZoom?this._private.maxZoom:pr,pr=pr<this._private.minZoom?this._private.minZoom:pr;var vr={x:(dr-pr*(ur.x1+ur.x2))/2,y:(fr-pr*(ur.y1+ur.y2))/2};return{zoom:pr,pan:vr}}}}},zoomRange:function or(ar,lr){var ur=this._private;if(lr==null){var cr=ar;ar=cr.min,lr=cr.max}return number$1(ar)&&number$1(lr)&&ar<=lr?(ur.minZoom=ar,ur.maxZoom=lr):number$1(ar)&&lr===void 0&&ar<=ur.maxZoom?ur.minZoom=ar:number$1(lr)&&ar===void 0&&lr>=ur.minZoom&&(ur.maxZoom=lr),this},minZoom:function or(ar){return ar===void 0?this._private.minZoom:this.zoomRange({min:ar})},maxZoom:function or(ar){return ar===void 0?this._private.maxZoom:this.zoomRange({max:ar})},getZoomedViewport:function or(ar){var lr=this._private,ur=lr.pan,cr=lr.zoom,hr,dr,fr=!1;if(lr.zoomingEnabled||(fr=!0),number$1(ar)?dr=ar:plainObject(ar)&&(dr=ar.level,ar.position!=null?hr=modelToRenderedPosition$1(ar.position,cr,ur):ar.renderedPosition!=null&&(hr=ar.renderedPosition),hr!=null&&!lr.panningEnabled&&(fr=!0)),dr=dr>lr.maxZoom?lr.maxZoom:dr,dr=dr<lr.minZoom?lr.minZoom:dr,fr||!number$1(dr)||dr===cr||hr!=null&&(!number$1(hr.x)||!number$1(hr.y)))return null;if(hr!=null){var pr=ur,vr=cr,gr=dr,mr={x:-gr/vr*(hr.x-pr.x)+hr.x,y:-gr/vr*(hr.y-pr.y)+hr.y};return{zoomed:!0,panned:!0,zoom:gr,pan:mr}}else return{zoomed:!0,panned:!1,zoom:dr,pan:ur}},zoom:function or(ar){if(ar===void 0)return this._private.zoom;var lr=this.getZoomedViewport(ar),ur=this._private;return lr==null||!lr.zoomed?this:(ur.zoom=lr.zoom,lr.panned&&(ur.pan.x=lr.pan.x,ur.pan.y=lr.pan.y),this.emit("zoom"+(lr.panned?" pan":"")+" viewport"),this.notify("viewport"),this)},viewport:function or(ar){var lr=this._private,ur=!0,cr=!0,hr=[],dr=!1,fr=!1;if(!ar)return this;if(number$1(ar.zoom)||(ur=!1),plainObject(ar.pan)||(cr=!1),!ur&&!cr)return this;if(ur){var pr=ar.zoom;pr<lr.minZoom||pr>lr.maxZoom||!lr.zoomingEnabled?dr=!0:(lr.zoom=pr,hr.push("zoom"))}if(cr&&(!dr||!ar.cancelOnFailedZoom)&&lr.panningEnabled){var vr=ar.pan;number$1(vr.x)&&(lr.pan.x=vr.x,fr=!1),number$1(vr.y)&&(lr.pan.y=vr.y,fr=!1),fr||hr.push("pan")}return hr.length>0&&(hr.push("viewport"),this.emit(hr.join(" ")),this.notify("viewport")),this},center:function or(ar){var lr=this.getCenterPan(ar);return lr&&(this._private.pan=lr,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function or(ar,lr){if(this._private.panningEnabled){if(string(ar)){var ur=ar;ar=this.mutableElements().filter(ur)}else elementOrCollection(ar)||(ar=this.mutableElements());if(ar.length!==0){var cr=ar.boundingBox(),hr=this.width(),dr=this.height();lr=lr===void 0?this._private.zoom:lr;var fr={x:(hr-lr*(cr.x1+cr.x2))/2,y:(dr-lr*(cr.y1+cr.y2))/2};return fr}}},reset:function or(){return!this._private.panningEnabled||!this._private.zoomingEnabled?this:(this.viewport({pan:{x:0,y:0},zoom:1}),this)},invalidateSize:function or(){this._private.sizeCache=null},size:function or(){var ar=this._private,lr=ar.container,ur=this;return ar.sizeCache=ar.sizeCache||(lr?function(){var cr=ur.window().getComputedStyle(lr),hr=function(fr){return parseFloat(cr.getPropertyValue(fr))};return{width:lr.clientWidth-hr("padding-left")-hr("padding-right"),height:lr.clientHeight-hr("padding-top")-hr("padding-bottom")}}():{width:1,height:1})},width:function or(){return this.size().width},height:function or(){return this.size().height},extent:function or(){var ar=this._private.pan,lr=this._private.zoom,ur=this.renderedExtent(),cr={x1:(ur.x1-ar.x)/lr,x2:(ur.x2-ar.x)/lr,y1:(ur.y1-ar.y)/lr,y2:(ur.y2-ar.y)/lr};return cr.w=cr.x2-cr.x1,cr.h=cr.y2-cr.y1,cr},renderedExtent:function or(){var ar=this.width(),lr=this.height();return{x1:0,y1:0,x2:ar,y2:lr,w:ar,h:lr}},multiClickDebounceTime:function or(ar){if(ar)this._private.multiClickDebounceTime=ar;else return this._private.multiClickDebounceTime;return this}};corefn$1.centre=corefn$1.center;corefn$1.autolockNodes=corefn$1.autolock;corefn$1.autoungrabifyNodes=corefn$1.autoungrabify;var fn={data:define.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeData:define.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),scratch:define.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:define.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0})};fn.attr=fn.data;fn.removeAttr=fn.removeData;var Core=function or(ar){var lr=this;ar=extend({},ar);var ur=ar.container;ur&&!htmlElement(ur)&&htmlElement(ur[0])&&(ur=ur[0]);var cr=ur?ur._cyreg:null;cr=cr||{},cr&&cr.cy&&(cr.cy.destroy(),cr={});var hr=cr.readies=cr.readies||[];ur&&(ur._cyreg=cr),cr.cy=lr;var dr=_window!==void 0&&ur!==void 0&&!ar.headless,fr=ar;fr.layout=extend({name:dr?"grid":"null"},fr.layout),fr.renderer=extend({name:dr?"canvas":"null"},fr.renderer);var pr=function(xr,Cr,Sr){return Cr!==void 0?Cr:Sr!==void 0?Sr:xr},vr=this._private={container:ur,ready:!1,options:fr,elements:new Collection(this),listeners:[],aniEles:new Collection(this),data:fr.data||{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:pr(!0,fr.zoomingEnabled),userZoomingEnabled:pr(!0,fr.userZoomingEnabled),panningEnabled:pr(!0,fr.panningEnabled),userPanningEnabled:pr(!0,fr.userPanningEnabled),boxSelectionEnabled:pr(!0,fr.boxSelectionEnabled),autolock:pr(!1,fr.autolock,fr.autolockNodes),autoungrabify:pr(!1,fr.autoungrabify,fr.autoungrabifyNodes),autounselectify:pr(!1,fr.autounselectify),styleEnabled:fr.styleEnabled===void 0?dr:fr.styleEnabled,zoom:number$1(fr.zoom)?fr.zoom:1,pan:{x:plainObject(fr.pan)&&number$1(fr.pan.x)?fr.pan.x:0,y:plainObject(fr.pan)&&number$1(fr.pan.y)?fr.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,multiClickDebounceTime:pr(250,fr.multiClickDebounceTime)};this.createEmitter(),this.selectionType(fr.selectionType),this.zoomRange({min:fr.minZoom,max:fr.maxZoom});var gr=function(xr,Cr){var Sr=xr.some(promise);if(Sr)return Promise$1.all(xr).then(Cr);Cr(xr)};vr.styleEnabled&&lr.setStyle([]);var mr=extend({},fr,fr.renderer);lr.initRenderer(mr);var br=function(xr,Cr,Sr){lr.notifications(!1);var wr=lr.mutableElements();wr.length>0&&wr.remove(),xr!=null&&(plainObject(xr)||array(xr))&&lr.add(xr),lr.one("layoutready",function(Ar){lr.notifications(!0),lr.emit(Ar),lr.one("load",Cr),lr.emitAndNotify("load")}).one("layoutstop",function(){lr.one("done",Sr),lr.emit("done")});var Er=extend({},lr._private.options.layout);Er.eles=lr.elements(),lr.layout(Er).run()};gr([fr.style,fr.elements],function(yr){var xr=yr[0],Cr=yr[1];vr.styleEnabled&&lr.style().append(xr),br(Cr,function(){lr.startAnimationLoop(),vr.ready=!0,fn$6(fr.ready)&&lr.on("ready",fr.ready);for(var Sr=0;Sr<hr.length;Sr++){var wr=hr[Sr];lr.on("ready",wr)}cr&&(cr.readies=[]),lr.emit("ready")},fr.done)})},corefn=Core.prototype;extend(corefn,{instanceString:function or(){return"core"},isReady:function or(){return this._private.ready},destroyed:function or(){return this._private.destroyed},ready:function or(ar){return this.isReady()?this.emitter().emit("ready",[],ar):this.on("ready",ar),this},destroy:function or(){var ar=this;if(!ar.destroyed())return ar.stopAnimationLoop(),ar.destroyRenderer(),this.emit("destroy"),ar._private.destroyed=!0,ar},hasElementWithId:function or(ar){return this._private.elements.hasElementWithId(ar)},getElementById:function or(ar){return this._private.elements.getElementById(ar)},hasCompoundNodes:function or(){return this._private.hasCompoundNodes},headless:function or(){return this._private.renderer.isHeadless()},styleEnabled:function or(){return this._private.styleEnabled},addToPool:function or(ar){return this._private.elements.merge(ar),this},removeFromPool:function or(ar){return this._private.elements.unmerge(ar),this},container:function or(){return this._private.container||null},window:function or(){var ar=this._private.container;if(ar==null)return _window;var lr=this._private.container.ownerDocument;return lr===void 0||lr==null?_window:lr.defaultView||_window},mount:function or(ar){if(ar!=null){var lr=this,ur=lr._private,cr=ur.options;return!htmlElement(ar)&&htmlElement(ar[0])&&(ar=ar[0]),lr.stopAnimationLoop(),lr.destroyRenderer(),ur.container=ar,ur.styleEnabled=!0,lr.invalidateSize(),lr.initRenderer(extend({},cr,cr.renderer,{name:cr.renderer.name==="null"?"canvas":cr.renderer.name})),lr.startAnimationLoop(),lr.style(cr.style),lr.emit("mount"),lr}},unmount:function or(){var ar=this;return ar.stopAnimationLoop(),ar.destroyRenderer(),ar.initRenderer({name:"null"}),ar.emit("unmount"),ar},options:function or(){return copy(this._private.options)},json:function or(ar){var lr=this,ur=lr._private,cr=lr.mutableElements(),hr=function(Tr){return lr.getElementById(Tr.id())};if(plainObject(ar)){if(lr.startBatch(),ar.elements){var dr={},fr=function(Tr,Rr){for(var Pr=[],_r=[],kr=0;kr<Tr.length;kr++){var Dr=Tr[kr];if(!Dr.data.id){warn("cy.json() cannot handle elements without an ID attribute");continue}var Nr=""+Dr.data.id,Lr=lr.getElementById(Nr);dr[Nr]=!0,Lr.length!==0?_r.push({ele:Lr,json:Dr}):(Rr&&(Dr.group=Rr),Pr.push(Dr))}lr.add(Pr);for(var Or=0;Or<_r.length;Or++){var Ir=_r[Or],Mr=Ir.ele,$r=Ir.json;Mr.json($r)}};if(array(ar.elements))fr(ar.elements);else for(var pr=["nodes","edges"],vr=0;vr<pr.length;vr++){var gr=pr[vr],mr=ar.elements[gr];array(mr)&&fr(mr,gr)}var br=lr.collection();cr.filter(function(Ar){return!dr[Ar.id()]}).forEach(function(Ar){Ar.isParent()?br.merge(Ar):Ar.remove()}),br.forEach(function(Ar){return Ar.children().move({parent:null})}),br.forEach(function(Ar){return hr(Ar).remove()})}ar.style&&lr.style(ar.style),ar.zoom!=null&&ar.zoom!==ur.zoom&&lr.zoom(ar.zoom),ar.pan&&(ar.pan.x!==ur.pan.x||ar.pan.y!==ur.pan.y)&&lr.pan(ar.pan),ar.data&&lr.data(ar.data);for(var yr=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify","multiClickDebounceTime"],xr=0;xr<yr.length;xr++){var Cr=yr[xr];ar[Cr]!=null&&lr[Cr](ar[Cr])}return lr.endBatch(),this}else{var Sr=!!ar,wr={};Sr?wr.elements=this.elements().map(function(Ar){return Ar.json()}):(wr.elements={},cr.forEach(function(Ar){var Tr=Ar.group();wr.elements[Tr]||(wr.elements[Tr]=[]),wr.elements[Tr].push(Ar.json())})),this._private.styleEnabled&&(wr.style=lr.style().json()),wr.data=copy(lr.data());var Er=ur.options;return wr.zoomingEnabled=ur.zoomingEnabled,wr.userZoomingEnabled=ur.userZoomingEnabled,wr.zoom=ur.zoom,wr.minZoom=ur.minZoom,wr.maxZoom=ur.maxZoom,wr.panningEnabled=ur.panningEnabled,wr.userPanningEnabled=ur.userPanningEnabled,wr.pan=copy(ur.pan),wr.boxSelectionEnabled=ur.boxSelectionEnabled,wr.renderer=copy(Er.renderer),wr.hideEdgesOnViewport=Er.hideEdgesOnViewport,wr.textureOnViewport=Er.textureOnViewport,wr.wheelSensitivity=Er.wheelSensitivity,wr.motionBlur=Er.motionBlur,wr.multiClickDebounceTime=Er.multiClickDebounceTime,wr}}});corefn.$id=corefn.getElementById;[corefn$9,corefn$8,elesfn,corefn$7,corefn$6,corefn$5,corefn$4,corefn$3,corefn$2,corefn$1,fn].forEach(function(or){extend(corefn,or)});var defaults$7={fit:!0,directed:!1,direction:"downward",padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,depthSort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function or(ar,lr){return!0},ready:void 0,stop:void 0,transform:function or(ar,lr){return lr}},deprecatedOptionDefaults={maximal:!1,acyclic:!1},getInfo=function or(ar){return ar.scratch("breadthfirst")},setInfo=function or(ar,lr){return ar.scratch("breadthfirst",lr)};function BreadthFirstLayout(or){this.options=extend({},defaults$7,deprecatedOptionDefaults,or)}BreadthFirstLayout.prototype.run=function(){var or=this.options,ar=or.cy,lr=or.eles,ur=lr.nodes().filter(function($a){return $a.isChildless()}),cr=lr,hr=or.directed,dr=or.acyclic||or.maximal||or.maximalAdjustments>0,fr=!!or.boundingBox,pr=makeBoundingBox(fr?or.boundingBox:structuredClone(ar.extent())),vr;if(elementOrCollection(or.roots))vr=or.roots;else if(array(or.roots)){for(var gr=[],mr=0;mr<or.roots.length;mr++){var br=or.roots[mr],yr=ar.getElementById(br);gr.push(yr)}vr=ar.collection(gr)}else if(string(or.roots))vr=ar.$(or.roots);else if(hr)vr=ur.roots();else{var xr=lr.components();vr=ar.collection();for(var Cr=function(){var ss=xr[Sr],hs=ss.maxDegree(!1),vs=ss.filter(function(bs){return bs.degree(!1)===hs});vr=vr.add(vs)},Sr=0;Sr<xr.length;Sr++)Cr()}var wr=[],Er={},Ar=function(ss,hs){wr[hs]==null&&(wr[hs]=[]);var vs=wr[hs].length;wr[hs].push(ss),setInfo(ss,{index:vs,depth:hs})},Tr=function(ss,hs){var vs=getInfo(ss),bs=vs.depth,xs=vs.index;wr[bs][xs]=null,ss.isChildless()&&Ar(ss,hs)};cr.bfs({roots:vr,directed:or.directed,visit:function(ss,hs,vs,bs,xs){var fs=ss[0],Is=fs.id();fs.isChildless()&&Ar(fs,xs),Er[Is]=!0}});for(var Rr=[],Pr=0;Pr<ur.length;Pr++){var _r=ur[Pr];Er[_r.id()]||Rr.push(_r)}var kr=function(ss){for(var hs=wr[ss],vs=0;vs<hs.length;vs++){var bs=hs[vs];if(bs==null){hs.splice(vs,1),vs--;continue}setInfo(bs,{depth:ss,index:vs})}},Dr=function(ss,hs){for(var vs=getInfo(ss),bs=ss.incomers().filter(function(Bs){return Bs.isNode()&&lr.has(Bs)}),xs=-1,fs=ss.id(),Is=0;Is<bs.length;Is++){var Os=bs[Is],Us=getInfo(Os);xs=Math.max(xs,Us.depth)}if(vs.depth<=xs){if(!or.acyclic&&hs[fs])return null;var $s=xs+1;return Tr(ss,$s),hs[fs]=$s,!0}return!1};if(hr&&dr){var Nr=[],Lr={},Or=function(ss){return Nr.push(ss)},Ir=function(){return Nr.shift()};for(ur.forEach(function($a){return Nr.push($a)});Nr.length>0;){var Mr=Ir(),$r=Dr(Mr,Lr);if($r)Mr.outgoers().filter(function($a){return $a.isNode()&&lr.has($a)}).forEach(Or);else if($r===null){warn("Detected double maximal shift for node `"+Mr.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}var jr=0;if(or.avoidOverlap)for(var Fr=0;Fr<ur.length;Fr++){var zr=ur[Fr],Hr=zr.layoutDimensions(or),Wr=Hr.w,Yr=Hr.h;jr=Math.max(jr,Wr,Yr)}var qr={},Br=function(ss){if(qr[ss.id()])return qr[ss.id()];for(var hs=getInfo(ss).depth,vs=ss.neighborhood(),bs=0,xs=0,fs=0;fs<vs.length;fs++){var Is=vs[fs];if(!(Is.isEdge()||Is.isParent()||!ur.has(Is))){var Os=getInfo(Is);if(Os!=null){var Us=Os.index,$s=Os.depth;if(!(Us==null||$s==null)){var Bs=wr[$s].length;$s<hs&&(bs+=Us/Bs,xs++)}}}}return xs=Math.max(1,xs),bs=bs/xs,xs===0&&(bs=0),qr[ss.id()]=bs,bs},Ur=function(ss,hs){var vs=Br(ss),bs=Br(hs),xs=vs-bs;return xs===0?ascending(ss.id(),hs.id()):xs};or.depthSort!==void 0&&(Ur=or.depthSort);for(var Vr=wr.length,Xr=0;Xr<Vr;Xr++)wr[Xr].sort(Ur),kr(Xr);for(var Zr=[],Jr=0;Jr<Rr.length;Jr++)Zr.push(Rr[Jr]);var Qr=function(){for(var ss=0;ss<Vr;ss++)kr(ss)};Zr.length&&(wr.unshift(Zr),Vr=wr.length,Qr());for(var ga=0,ba=0;ba<Vr;ba++)ga=Math.max(wr[ba].length,ga);var _i={x:pr.x1+pr.w/2,y:pr.y1+pr.h/2},os=ur.reduce(function($a,ss){return function(hs){return{w:$a.w===-1?hs.w:($a.w+hs.w)/2,h:$a.h===-1?hs.h:($a.h+hs.h)/2}}(ss.boundingBox({includeLabels:or.nodeDimensionsIncludeLabels}))},{w:-1,h:-1}),ls=Math.max(Vr===1?0:fr?(pr.h-or.padding*2-os.h)/(Vr-1):(pr.h-or.padding*2-os.h)/(Vr+1),jr),ys=wr.reduce(function($a,ss){return Math.max($a,ss.length)},0),ns=function(ss){var hs=getInfo(ss),vs=hs.depth,bs=hs.index;if(or.circle){var xs=Math.min(pr.w/2/Vr,pr.h/2/Vr);xs=Math.max(xs,jr);var fs=xs*vs+xs-(Vr>0&&wr[0].length<=3?xs/2:0),Is=2*Math.PI/wr[vs].length*bs;return vs===0&&wr[0].length===1&&(fs=1),{x:_i.x+fs*Math.cos(Is),y:_i.y+fs*Math.sin(Is)}}else{var Os=wr[vs].length,Us=Math.max(Os===1?0:fr?(pr.w-or.padding*2-os.w)/((or.grid?ys:Os)-1):(pr.w-or.padding*2-os.w)/((or.grid?ys:Os)+1),jr),$s={x:_i.x+(bs+1-(Os+1)/2)*Us,y:_i.y+(vs+1-(Vr+1)/2)*ls};return $s}},as={downward:0,leftward:90,upward:180,rightward:-90};Object.keys(as).indexOf(or.direction)===-1&&error("Invalid direction '".concat(or.direction,"' specified for breadthfirst layout. Valid values are: ").concat(Object.keys(as).join(", ")));var Kr=function(ss){return rotatePosAndSkewByBox(ns(ss),pr,as[or.direction])};return lr.nodes().layoutPositions(this,or,Kr),this};var defaults$6={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function or(ar,lr){return!0},ready:void 0,stop:void 0,transform:function or(ar,lr){return lr}};function CircleLayout(or){this.options=extend({},defaults$6,or)}CircleLayout.prototype.run=function(){var or=this.options,ar=or,lr=or.cy,ur=ar.eles,cr=ar.counterclockwise!==void 0?!ar.counterclockwise:ar.clockwise,hr=ur.nodes().not(":parent");ar.sort&&(hr=hr.sort(ar.sort));for(var dr=makeBoundingBox(ar.boundingBox?ar.boundingBox:{x1:0,y1:0,w:lr.width(),h:lr.height()}),fr={x:dr.x1+dr.w/2,y:dr.y1+dr.h/2},pr=ar.sweep===void 0?2*Math.PI-2*Math.PI/hr.length:ar.sweep,vr=pr/Math.max(1,hr.length-1),gr,mr=0,br=0;br<hr.length;br++){var yr=hr[br],xr=yr.layoutDimensions(ar),Cr=xr.w,Sr=xr.h;mr=Math.max(mr,Cr,Sr)}if(number$1(ar.radius)?gr=ar.radius:hr.length<=1?gr=0:gr=Math.min(dr.h,dr.w)/2-mr,hr.length>1&&ar.avoidOverlap){mr*=1.75;var wr=Math.cos(vr)-Math.cos(0),Er=Math.sin(vr)-Math.sin(0),Ar=Math.sqrt(mr*mr/(wr*wr+Er*Er));gr=Math.max(Ar,gr)}var Tr=function(Pr,_r){var kr=ar.startAngle+_r*vr*(cr?1:-1),Dr=gr*Math.cos(kr),Nr=gr*Math.sin(kr),Lr={x:fr.x+Dr,y:fr.y+Nr};return Lr};return ur.nodes().layoutPositions(this,ar,Tr),this};var defaults$5={fit:!0,padding:30,startAngle:3/2*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function or(ar){return ar.degree()},levelWidth:function or(ar){return ar.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function or(ar,lr){return!0},ready:void 0,stop:void 0,transform:function or(ar,lr){return lr}};function ConcentricLayout(or){this.options=extend({},defaults$5,or)}ConcentricLayout.prototype.run=function(){for(var or=this.options,ar=or,lr=ar.counterclockwise!==void 0?!ar.counterclockwise:ar.clockwise,ur=or.cy,cr=ar.eles,hr=cr.nodes().not(":parent"),dr=makeBoundingBox(ar.boundingBox?ar.boundingBox:{x1:0,y1:0,w:ur.width(),h:ur.height()}),fr={x:dr.x1+dr.w/2,y:dr.y1+dr.h/2},pr=[],vr=0,gr=0;gr<hr.length;gr++){var mr=hr[gr],br=void 0;br=ar.concentric(mr),pr.push({value:br,node:mr}),mr._private.scratch.concentric=br}hr.updateStyle();for(var yr=0;yr<hr.length;yr++){var xr=hr[yr],Cr=xr.layoutDimensions(ar);vr=Math.max(vr,Cr.w,Cr.h)}pr.sort(function(ls,ys){return ys.value-ls.value});for(var Sr=ar.levelWidth(hr),wr=[[]],Er=wr[0],Ar=0;Ar<pr.length;Ar++){var Tr=pr[Ar];if(Er.length>0){var Rr=Math.abs(Er[0].value-Tr.value);Rr>=Sr&&(Er=[],wr.push(Er))}Er.push(Tr)}var Pr=vr+ar.minNodeSpacing;if(!ar.avoidOverlap){var _r=wr.length>0&&wr[0].length>1,kr=Math.min(dr.w,dr.h)/2-Pr,Dr=kr/(wr.length+_r?1:0);Pr=Math.min(Pr,Dr)}for(var Nr=0,Lr=0;Lr<wr.length;Lr++){var Or=wr[Lr],Ir=ar.sweep===void 0?2*Math.PI-2*Math.PI/Or.length:ar.sweep,Mr=Or.dTheta=Ir/Math.max(1,Or.length-1);if(Or.length>1&&ar.avoidOverlap){var $r=Math.cos(Mr)-Math.cos(0),jr=Math.sin(Mr)-Math.sin(0),Fr=Math.sqrt(Pr*Pr/($r*$r+jr*jr));Nr=Math.max(Fr,Nr)}Or.r=Nr,Nr+=Pr}if(ar.equidistant){for(var zr=0,Hr=0,Wr=0;Wr<wr.length;Wr++){var Yr=wr[Wr],qr=Yr.r-Hr;zr=Math.max(zr,qr)}Hr=0;for(var Br=0;Br<wr.length;Br++){var Ur=wr[Br];Br===0&&(Hr=Ur.r),Ur.r=Hr,Hr+=zr}}for(var Vr={},Xr=0;Xr<wr.length;Xr++)for(var Zr=wr[Xr],Jr=Zr.dTheta,Qr=Zr.r,ga=0;ga<Zr.length;ga++){var ba=Zr[ga],_i=ar.startAngle+(lr?1:-1)*Jr*ga,os={x:fr.x+Qr*Math.cos(_i),y:fr.y+Qr*Math.sin(_i)};Vr[ba.node.id()]=os}return cr.nodes().layoutPositions(this,ar,function(ls){var ys=ls.id();return Vr[ys]}),this};var DEBUG,defaults$4={ready:function or(){},stop:function or(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function or(ar,lr){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function or(ar){return 2048},nodeOverlap:4,idealEdgeLength:function or(ar){return 32},edgeElasticity:function or(ar){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function CoseLayout(or){this.options=extend({},defaults$4,or),this.options.layout=this;var ar=this.options.eles.nodes(),lr=this.options.eles.edges(),ur=lr.filter(function(cr){var hr=cr.source().data("id"),dr=cr.target().data("id"),fr=ar.some(function(vr){return vr.data("id")===hr}),pr=ar.some(function(vr){return vr.data("id")===dr});return!fr||!pr});this.options.eles=this.options.eles.not(ur)}CoseLayout.prototype.run=function(){var or=this.options,ar=or.cy,lr=this;lr.stopped=!1,(or.animate===!0||or.animate===!1)&&lr.emit({type:"layoutstart",layout:lr}),or.debug===!0?DEBUG=!0:DEBUG=!1;var ur=createLayoutInfo(ar,lr,or);DEBUG&&printLayoutInfo(ur),or.randomize&&randomizePositions(ur);var cr=performanceNow(),hr=function(){refreshPositions(ur,ar,or),or.fit===!0&&ar.fit(or.padding)},dr=function(br){return!(lr.stopped||br>=or.numIter||(step(ur,or),ur.temperature=ur.temperature*or.coolingFactor,ur.temperature<or.minTemp))},fr=function(){if(or.animate===!0||or.animate===!1)hr(),lr.one("layoutstop",or.stop),lr.emit({type:"layoutstop",layout:lr});else{var br=or.eles.nodes(),yr=getScaleInBoundsFn(ur,or,br);br.layoutPositions(lr,or,yr)}},pr=0,vr=!0;if(or.animate===!0){var gr=function(){for(var br=0;vr&&br<or.refresh;)vr=dr(pr),pr++,br++;if(!vr)separateComponents(ur,or),fr();else{var yr=performanceNow();yr-cr>=or.animationThreshold&&hr(),requestAnimationFrame(gr)}};gr()}else{for(;vr;)vr=dr(pr),pr++;separateComponents(ur,or),fr()}return this};CoseLayout.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this};CoseLayout.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var createLayoutInfo=function or(ar,lr,ur){for(var cr=ur.eles.edges(),hr=ur.eles.nodes(),dr=makeBoundingBox(ur.boundingBox?ur.boundingBox:{x1:0,y1:0,w:ar.width(),h:ar.height()}),fr={isCompound:ar.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:hr.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:cr.size(),temperature:ur.initialTemp,clientWidth:dr.w,clientHeight:dr.h,boundingBox:dr},pr=ur.eles.components(),vr={},gr=0;gr<pr.length;gr++)for(var mr=pr[gr],br=0;br<mr.length;br++){var yr=mr[br];vr[yr.id()]=gr}for(var gr=0;gr<fr.nodeSize;gr++){var xr=hr[gr],Cr=xr.layoutDimensions(ur),Sr={};Sr.isLocked=xr.locked(),Sr.id=xr.data("id"),Sr.parentId=xr.data("parent"),Sr.cmptId=vr[xr.id()],Sr.children=[],Sr.positionX=xr.position("x"),Sr.positionY=xr.position("y"),Sr.offsetX=0,Sr.offsetY=0,Sr.height=Cr.w,Sr.width=Cr.h,Sr.maxX=Sr.positionX+Sr.width/2,Sr.minX=Sr.positionX-Sr.width/2,Sr.maxY=Sr.positionY+Sr.height/2,Sr.minY=Sr.positionY-Sr.height/2,Sr.padLeft=parseFloat(xr.style("padding")),Sr.padRight=parseFloat(xr.style("padding")),Sr.padTop=parseFloat(xr.style("padding")),Sr.padBottom=parseFloat(xr.style("padding")),Sr.nodeRepulsion=fn$6(ur.nodeRepulsion)?ur.nodeRepulsion(xr):ur.nodeRepulsion,fr.layoutNodes.push(Sr),fr.idToIndex[Sr.id]=gr}for(var wr=[],Er=0,Ar=-1,Tr=[],gr=0;gr<fr.nodeSize;gr++){var xr=fr.layoutNodes[gr],Rr=xr.parentId;Rr!=null?fr.layoutNodes[fr.idToIndex[Rr]].children.push(xr.id):(wr[++Ar]=xr.id,Tr.push(xr.id))}for(fr.graphSet.push(Tr);Er<=Ar;){var Pr=wr[Er++],_r=fr.idToIndex[Pr],yr=fr.layoutNodes[_r],kr=yr.children;if(kr.length>0){fr.graphSet.push(kr);for(var gr=0;gr<kr.length;gr++)wr[++Ar]=kr[gr]}}for(var gr=0;gr<fr.graphSet.length;gr++)for(var Dr=fr.graphSet[gr],br=0;br<Dr.length;br++){var Nr=fr.idToIndex[Dr[br]];fr.indexToGraph[Nr]=gr}for(var gr=0;gr<fr.edgeSize;gr++){var Lr=cr[gr],Or={};Or.id=Lr.data("id"),Or.sourceId=Lr.data("source"),Or.targetId=Lr.data("target");var Ir=fn$6(ur.idealEdgeLength)?ur.idealEdgeLength(Lr):ur.idealEdgeLength,Mr=fn$6(ur.edgeElasticity)?ur.edgeElasticity(Lr):ur.edgeElasticity,$r=fr.idToIndex[Or.sourceId],jr=fr.idToIndex[Or.targetId],Fr=fr.indexToGraph[$r],zr=fr.indexToGraph[jr];if(Fr!=zr){for(var Hr=findLCA(Or.sourceId,Or.targetId,fr),Wr=fr.graphSet[Hr],Yr=0,Sr=fr.layoutNodes[$r];Wr.indexOf(Sr.id)===-1;)Sr=fr.layoutNodes[fr.idToIndex[Sr.parentId]],Yr++;for(Sr=fr.layoutNodes[jr];Wr.indexOf(Sr.id)===-1;)Sr=fr.layoutNodes[fr.idToIndex[Sr.parentId]],Yr++;Ir*=Yr*ur.nestingFactor}Or.idealLength=Ir,Or.elasticity=Mr,fr.layoutEdges.push(Or)}return fr},findLCA=function or(ar,lr,ur){var cr=_findLCA_aux(ar,lr,0,ur);return 2>cr.count?0:cr.graph},_findLCA_aux=function or(ar,lr,ur,cr){var hr=cr.graphSet[ur];if(-1<hr.indexOf(ar)&&-1<hr.indexOf(lr))return{count:2,graph:ur};for(var dr=0,fr=0;fr<hr.length;fr++){var pr=hr[fr],vr=cr.idToIndex[pr],gr=cr.layoutNodes[vr].children;if(gr.length!==0){var mr=cr.indexToGraph[cr.idToIndex[gr[0]]],br=_findLCA_aux(ar,lr,mr,cr);if(br.count!==0)if(br.count===1){if(dr++,dr===2)break}else return br}}return{count:dr,graph:ur}},printLayoutInfo,randomizePositions=function or(ar,lr){for(var ur=ar.clientWidth,cr=ar.clientHeight,hr=0;hr<ar.nodeSize;hr++){var dr=ar.layoutNodes[hr];dr.children.length===0&&!dr.isLocked&&(dr.positionX=Math.random()*ur,dr.positionY=Math.random()*cr)}},getScaleInBoundsFn=function or(ar,lr,ur){var cr=ar.boundingBox,hr={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return lr.boundingBox&&(ur.forEach(function(dr){var fr=ar.layoutNodes[ar.idToIndex[dr.data("id")]];hr.x1=Math.min(hr.x1,fr.positionX),hr.x2=Math.max(hr.x2,fr.positionX),hr.y1=Math.min(hr.y1,fr.positionY),hr.y2=Math.max(hr.y2,fr.positionY)}),hr.w=hr.x2-hr.x1,hr.h=hr.y2-hr.y1),function(dr,fr){var pr=ar.layoutNodes[ar.idToIndex[dr.data("id")]];if(lr.boundingBox){var vr=hr.w===0?.5:(pr.positionX-hr.x1)/hr.w,gr=hr.h===0?.5:(pr.positionY-hr.y1)/hr.h;return{x:cr.x1+vr*cr.w,y:cr.y1+gr*cr.h}}else return{x:pr.positionX,y:pr.positionY}}},refreshPositions=function or(ar,lr,ur){var cr=ur.layout,hr=ur.eles.nodes(),dr=getScaleInBoundsFn(ar,ur,hr);hr.positions(dr),ar.ready!==!0&&(ar.ready=!0,cr.one("layoutready",ur.ready),cr.emit({type:"layoutready",layout:this}))},step=function or(ar,lr,ur){calculateNodeForces(ar,lr),calculateEdgeForces(ar),calculateGravityForces(ar,lr),propagateForces(ar),updatePositions(ar)},calculateNodeForces=function or(ar,lr){for(var ur=0;ur<ar.graphSet.length;ur++)for(var cr=ar.graphSet[ur],hr=cr.length,dr=0;dr<hr;dr++)for(var fr=ar.layoutNodes[ar.idToIndex[cr[dr]]],pr=dr+1;pr<hr;pr++){var vr=ar.layoutNodes[ar.idToIndex[cr[pr]]];nodeRepulsion(fr,vr,ar,lr)}},randomDistance=function or(ar){return-1+2*ar*Math.random()},nodeRepulsion=function or(ar,lr,ur,cr){var hr=ar.cmptId,dr=lr.cmptId;if(!(hr!==dr&&!ur.isCompound)){var fr=lr.positionX-ar.positionX,pr=lr.positionY-ar.positionY,vr=1;fr===0&&pr===0&&(fr=randomDistance(vr),pr=randomDistance(vr));var gr=nodesOverlap(ar,lr,fr,pr);if(gr>0)var mr=cr.nodeOverlap*gr,br=Math.sqrt(fr*fr+pr*pr),yr=mr*fr/br,xr=mr*pr/br;else var Cr=findClippingPoint(ar,fr,pr),Sr=findClippingPoint(lr,-1*fr,-1*pr),wr=Sr.x-Cr.x,Er=Sr.y-Cr.y,Ar=wr*wr+Er*Er,br=Math.sqrt(Ar),mr=(ar.nodeRepulsion+lr.nodeRepulsion)/Ar,yr=mr*wr/br,xr=mr*Er/br;ar.isLocked||(ar.offsetX-=yr,ar.offsetY-=xr),lr.isLocked||(lr.offsetX+=yr,lr.offsetY+=xr)}},nodesOverlap=function or(ar,lr,ur,cr){if(ur>0)var hr=ar.maxX-lr.minX;else var hr=lr.maxX-ar.minX;if(cr>0)var dr=ar.maxY-lr.minY;else var dr=lr.maxY-ar.minY;return hr>=0&&dr>=0?Math.sqrt(hr*hr+dr*dr):0},findClippingPoint=function or(ar,lr,ur){var cr=ar.positionX,hr=ar.positionY,dr=ar.height||1,fr=ar.width||1,pr=ur/lr,vr=dr/fr,gr={};return lr===0&&0<ur||lr===0&&0>ur?(gr.x=cr,gr.y=hr+dr/2,gr):0<lr&&-1*vr<=pr&&pr<=vr?(gr.x=cr+fr/2,gr.y=hr+fr*ur/2/lr,gr):0>lr&&-1*vr<=pr&&pr<=vr?(gr.x=cr-fr/2,gr.y=hr-fr*ur/2/lr,gr):0<ur&&(pr<=-1*vr||pr>=vr)?(gr.x=cr+dr*lr/2/ur,gr.y=hr+dr/2,gr):(0>ur&&(pr<=-1*vr||pr>=vr)&&(gr.x=cr-dr*lr/2/ur,gr.y=hr-dr/2),gr)},calculateEdgeForces=function or(ar,lr){for(var ur=0;ur<ar.edgeSize;ur++){var cr=ar.layoutEdges[ur],hr=ar.idToIndex[cr.sourceId],dr=ar.layoutNodes[hr],fr=ar.idToIndex[cr.targetId],pr=ar.layoutNodes[fr],vr=pr.positionX-dr.positionX,gr=pr.positionY-dr.positionY;if(!(vr===0&&gr===0)){var mr=findClippingPoint(dr,vr,gr),br=findClippingPoint(pr,-1*vr,-1*gr),yr=br.x-mr.x,xr=br.y-mr.y,Cr=Math.sqrt(yr*yr+xr*xr),Sr=Math.pow(cr.idealLength-Cr,2)/cr.elasticity;if(Cr!==0)var wr=Sr*yr/Cr,Er=Sr*xr/Cr;else var wr=0,Er=0;dr.isLocked||(dr.offsetX+=wr,dr.offsetY+=Er),pr.isLocked||(pr.offsetX-=wr,pr.offsetY-=Er)}}},calculateGravityForces=function or(ar,lr){if(lr.gravity!==0)for(var ur=1,cr=0;cr<ar.graphSet.length;cr++){var hr=ar.graphSet[cr],dr=hr.length;if(cr===0)var fr=ar.clientHeight/2,pr=ar.clientWidth/2;else var vr=ar.layoutNodes[ar.idToIndex[hr[0]]],gr=ar.layoutNodes[ar.idToIndex[vr.parentId]],fr=gr.positionX,pr=gr.positionY;for(var mr=0;mr<dr;mr++){var br=ar.layoutNodes[ar.idToIndex[hr[mr]]];if(!br.isLocked){var yr=fr-br.positionX,xr=pr-br.positionY,Cr=Math.sqrt(yr*yr+xr*xr);if(Cr>ur){var Sr=lr.gravity*yr/Cr,wr=lr.gravity*xr/Cr;br.offsetX+=Sr,br.offsetY+=wr}}}}},propagateForces=function or(ar,lr){var ur=[],cr=0,hr=-1;for(ur.push.apply(ur,ar.graphSet[0]),hr+=ar.graphSet[0].length;cr<=hr;){var dr=ur[cr++],fr=ar.idToIndex[dr],pr=ar.layoutNodes[fr],vr=pr.children;if(0<vr.length&&!pr.isLocked){for(var gr=pr.offsetX,mr=pr.offsetY,br=0;br<vr.length;br++){var yr=ar.layoutNodes[ar.idToIndex[vr[br]]];yr.offsetX+=gr,yr.offsetY+=mr,ur[++hr]=vr[br]}pr.offsetX=0,pr.offsetY=0}}},updatePositions=function or(ar,lr){for(var ur=0;ur<ar.nodeSize;ur++){var cr=ar.layoutNodes[ur];0<cr.children.length&&(cr.maxX=void 0,cr.minX=void 0,cr.maxY=void 0,cr.minY=void 0)}for(var ur=0;ur<ar.nodeSize;ur++){var cr=ar.layoutNodes[ur];if(!(0<cr.children.length||cr.isLocked)){var hr=limitForce(cr.offsetX,cr.offsetY,ar.temperature);cr.positionX+=hr.x,cr.positionY+=hr.y,cr.offsetX=0,cr.offsetY=0,cr.minX=cr.positionX-cr.width,cr.maxX=cr.positionX+cr.width,cr.minY=cr.positionY-cr.height,cr.maxY=cr.positionY+cr.height,_updateAncestryBoundaries(cr,ar)}}for(var ur=0;ur<ar.nodeSize;ur++){var cr=ar.layoutNodes[ur];0<cr.children.length&&!cr.isLocked&&(cr.positionX=(cr.maxX+cr.minX)/2,cr.positionY=(cr.maxY+cr.minY)/2,cr.width=cr.maxX-cr.minX,cr.height=cr.maxY-cr.minY)}},limitForce=function or(ar,lr,ur){var cr=Math.sqrt(ar*ar+lr*lr);if(cr>ur)var hr={x:ur*ar/cr,y:ur*lr/cr};else var hr={x:ar,y:lr};return hr},_updateAncestryBoundaries=function or(ar,lr){var ur=ar.parentId;if(ur!=null){var cr=lr.layoutNodes[lr.idToIndex[ur]],hr=!1;if((cr.maxX==null||ar.maxX+cr.padRight>cr.maxX)&&(cr.maxX=ar.maxX+cr.padRight,hr=!0),(cr.minX==null||ar.minX-cr.padLeft<cr.minX)&&(cr.minX=ar.minX-cr.padLeft,hr=!0),(cr.maxY==null||ar.maxY+cr.padBottom>cr.maxY)&&(cr.maxY=ar.maxY+cr.padBottom,hr=!0),(cr.minY==null||ar.minY-cr.padTop<cr.minY)&&(cr.minY=ar.minY-cr.padTop,hr=!0),hr)return _updateAncestryBoundaries(cr,lr)}},separateComponents=function or(ar,lr){for(var ur=ar.layoutNodes,cr=[],hr=0;hr<ur.length;hr++){var dr=ur[hr],fr=dr.cmptId,pr=cr[fr]=cr[fr]||[];pr.push(dr)}for(var vr=0,hr=0;hr<cr.length;hr++){var gr=cr[hr];if(gr){gr.x1=1/0,gr.x2=-1/0,gr.y1=1/0,gr.y2=-1/0;for(var mr=0;mr<gr.length;mr++){var br=gr[mr];gr.x1=Math.min(gr.x1,br.positionX-br.width/2),gr.x2=Math.max(gr.x2,br.positionX+br.width/2),gr.y1=Math.min(gr.y1,br.positionY-br.height/2),gr.y2=Math.max(gr.y2,br.positionY+br.height/2)}gr.w=gr.x2-gr.x1,gr.h=gr.y2-gr.y1,vr+=gr.w*gr.h}}cr.sort(function(Er,Ar){return Ar.w*Ar.h-Er.w*Er.h});for(var yr=0,xr=0,Cr=0,Sr=0,wr=Math.sqrt(vr)*ar.clientWidth/ar.clientHeight,hr=0;hr<cr.length;hr++){var gr=cr[hr];if(gr){for(var mr=0;mr<gr.length;mr++){var br=gr[mr];br.isLocked||(br.positionX+=yr-gr.x1,br.positionY+=xr-gr.y1)}yr+=gr.w+lr.componentSpacing,Cr+=gr.w+lr.componentSpacing,Sr=Math.max(Sr,gr.h),Cr>wr&&(xr+=Sr+lr.componentSpacing,yr=0,Cr=0,Sr=0)}}},defaults$3={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function or(ar){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function or(ar,lr){return!0},ready:void 0,stop:void 0,transform:function or(ar,lr){return lr}};function GridLayout(or){this.options=extend({},defaults$3,or)}GridLayout.prototype.run=function(){var or=this.options,ar=or,lr=or.cy,ur=ar.eles,cr=ur.nodes().not(":parent");ar.sort&&(cr=cr.sort(ar.sort));var hr=makeBoundingBox(ar.boundingBox?ar.boundingBox:{x1:0,y1:0,w:lr.width(),h:lr.height()});if(hr.h===0||hr.w===0)ur.nodes().layoutPositions(this,ar,function(Br){return{x:hr.x1,y:hr.y1}});else{var dr=cr.size(),fr=Math.sqrt(dr*hr.h/hr.w),pr=Math.round(fr),vr=Math.round(hr.w/hr.h*fr),gr=function(Ur){if(Ur==null)return Math.min(pr,vr);var Vr=Math.min(pr,vr);Vr==pr?pr=Ur:vr=Ur},mr=function(Ur){if(Ur==null)return Math.max(pr,vr);var Vr=Math.max(pr,vr);Vr==pr?pr=Ur:vr=Ur},br=ar.rows,yr=ar.cols!=null?ar.cols:ar.columns;if(br!=null&&yr!=null)pr=br,vr=yr;else if(br!=null&&yr==null)pr=br,vr=Math.ceil(dr/pr);else if(br==null&&yr!=null)vr=yr,pr=Math.ceil(dr/vr);else if(vr*pr>dr){var xr=gr(),Cr=mr();(xr-1)*Cr>=dr?gr(xr-1):(Cr-1)*xr>=dr&&mr(Cr-1)}else for(;vr*pr<dr;){var Sr=gr(),wr=mr();(wr+1)*Sr>=dr?mr(wr+1):gr(Sr+1)}var Er=hr.w/vr,Ar=hr.h/pr;if(ar.condense&&(Er=0,Ar=0),ar.avoidOverlap)for(var Tr=0;Tr<cr.length;Tr++){var Rr=cr[Tr],Pr=Rr._private.position;(Pr.x==null||Pr.y==null)&&(Pr.x=0,Pr.y=0);var _r=Rr.layoutDimensions(ar),kr=ar.avoidOverlapPadding,Dr=_r.w+kr,Nr=_r.h+kr;Er=Math.max(Er,Dr),Ar=Math.max(Ar,Nr)}for(var Lr={},Or=function(Ur,Vr){return!!Lr["c-"+Ur+"-"+Vr]},Ir=function(Ur,Vr){Lr["c-"+Ur+"-"+Vr]=!0},Mr=0,$r=0,jr=function(){$r++,$r>=vr&&($r=0,Mr++)},Fr={},zr=0;zr<cr.length;zr++){var Hr=cr[zr],Wr=ar.position(Hr);if(Wr&&(Wr.row!==void 0||Wr.col!==void 0)){var Yr={row:Wr.row,col:Wr.col};if(Yr.col===void 0)for(Yr.col=0;Or(Yr.row,Yr.col);)Yr.col++;else if(Yr.row===void 0)for(Yr.row=0;Or(Yr.row,Yr.col);)Yr.row++;Fr[Hr.id()]=Yr,Ir(Yr.row,Yr.col)}}var qr=function(Ur,Vr){var Xr,Zr;if(Ur.locked()||Ur.isParent())return!1;var Jr=Fr[Ur.id()];if(Jr)Xr=Jr.col*Er+Er/2+hr.x1,Zr=Jr.row*Ar+Ar/2+hr.y1;else{for(;Or(Mr,$r);)jr();Xr=$r*Er+Er/2+hr.x1,Zr=Mr*Ar+Ar/2+hr.y1,Ir(Mr,$r),jr()}return{x:Xr,y:Zr}};cr.layoutPositions(this,ar,qr)}return this};var defaults$2={ready:function or(){},stop:function or(){}};function NullLayout(or){this.options=extend({},defaults$2,or)}NullLayout.prototype.run=function(){var or=this.options,ar=or.eles,lr=this;return or.cy,lr.emit("layoutstart"),ar.nodes().positions(function(){return{x:0,y:0}}),lr.one("layoutready",or.ready),lr.emit("layoutready"),lr.one("layoutstop",or.stop),lr.emit("layoutstop"),this};NullLayout.prototype.stop=function(){return this};var defaults$1={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,spacingFactor:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function or(ar,lr){return!0},ready:void 0,stop:void 0,transform:function or(ar,lr){return lr}};function PresetLayout(or){this.options=extend({},defaults$1,or)}PresetLayout.prototype.run=function(){var or=this.options,ar=or.eles,lr=ar.nodes(),ur=fn$6(or.positions);function cr(hr){if(or.positions==null)return copyPosition(hr.position());if(ur)return or.positions(hr);var dr=or.positions[hr._private.data.id];return dr??null}return lr.layoutPositions(this,or,function(hr,dr){var fr=cr(hr);return hr.locked()||fr==null?!1:fr}),this};var defaults={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function or(ar,lr){return!0},ready:void 0,stop:void 0,transform:function or(ar,lr){return lr}};function RandomLayout(or){this.options=extend({},defaults,or)}RandomLayout.prototype.run=function(){var or=this.options,ar=or.cy,lr=or.eles,ur=makeBoundingBox(or.boundingBox?or.boundingBox:{x1:0,y1:0,w:ar.width(),h:ar.height()}),cr=function(dr,fr){return{x:ur.x1+Math.round(Math.random()*ur.w),y:ur.y1+Math.round(Math.random()*ur.h)}};return lr.nodes().layoutPositions(this,or,cr),this};var layout=[{name:"breadthfirst",impl:BreadthFirstLayout},{name:"circle",impl:CircleLayout},{name:"concentric",impl:ConcentricLayout},{name:"cose",impl:CoseLayout},{name:"grid",impl:GridLayout},{name:"null",impl:NullLayout},{name:"preset",impl:PresetLayout},{name:"random",impl:RandomLayout}];function NullRenderer(or){this.options=or,this.notifications=0}var noop=function or(){},throwImgErr=function or(){throw new Error("A headless instance can not render images")};NullRenderer.prototype={recalculateRenderedStyle:noop,notify:function or(){this.notifications++},init:noop,isHeadless:function or(){return!0},png:throwImgErr,jpg:throwImgErr};var BRp$f={};BRp$f.arrowShapeWidth=.3;BRp$f.registerArrowShapes=function(){var or=this.arrowShapes={},ar=this,lr=function(vr,gr,mr,br,yr,xr,Cr){var Sr=yr.x-mr/2-Cr,wr=yr.x+mr/2+Cr,Er=yr.y-mr/2-Cr,Ar=yr.y+mr/2+Cr,Tr=Sr<=vr&&vr<=wr&&Er<=gr&&gr<=Ar;return Tr},ur=function(vr,gr,mr,br,yr){var xr=vr*Math.cos(br)-gr*Math.sin(br),Cr=vr*Math.sin(br)+gr*Math.cos(br),Sr=xr*mr,wr=Cr*mr,Er=Sr+yr.x,Ar=wr+yr.y;return{x:Er,y:Ar}},cr=function(vr,gr,mr,br){for(var yr=[],xr=0;xr<vr.length;xr+=2){var Cr=vr[xr],Sr=vr[xr+1];yr.push(ur(Cr,Sr,gr,mr,br))}return yr},hr=function(vr){for(var gr=[],mr=0;mr<vr.length;mr++){var br=vr[mr];gr.push(br.x,br.y)}return gr},dr=function(vr){return vr.pstyle("width").pfValue*vr.pstyle("arrow-scale").pfValue*2},fr=function(vr,gr){string(gr)&&(gr=or[gr]),or[vr]=extend({name:vr,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(br,yr,xr,Cr,Sr,wr){var Er=hr(cr(this.points,xr+2*wr,Cr,Sr)),Ar=pointInsidePolygonPoints(br,yr,Er);return Ar},roughCollide:lr,draw:function(br,yr,xr,Cr){var Sr=cr(this.points,yr,xr,Cr);ar.arrowShapeImpl("polygon")(br,Sr)},spacing:function(br){return 0},gap:dr},gr)};fr("none",{collide:falsify,roughCollide:falsify,draw:noop$1,spacing:zeroify,gap:zeroify}),fr("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),fr("arrow","triangle"),fr("triangle-backcurve",{points:or.triangle.points,controlPoint:[0,-.15],roughCollide:lr,draw:function(vr,gr,mr,br,yr){var xr=cr(this.points,gr,mr,br),Cr=this.controlPoint,Sr=ur(Cr[0],Cr[1],gr,mr,br);ar.arrowShapeImpl(this.name)(vr,xr,Sr)},gap:function(vr){return dr(vr)*.8}}),fr("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(vr,gr,mr,br,yr,xr,Cr){var Sr=hr(cr(this.points,mr+2*Cr,br,yr)),wr=hr(cr(this.pointsTee,mr+2*Cr,br,yr)),Er=pointInsidePolygonPoints(vr,gr,Sr)||pointInsidePolygonPoints(vr,gr,wr);return Er},draw:function(vr,gr,mr,br,yr){var xr=cr(this.points,gr,mr,br),Cr=cr(this.pointsTee,gr,mr,br);ar.arrowShapeImpl(this.name)(vr,xr,Cr)}}),fr("circle-triangle",{radius:.15,pointsTr:[0,-.15,.15,-.45,-.15,-.45,0,-.15],collide:function(vr,gr,mr,br,yr,xr,Cr){var Sr=yr,wr=Math.pow(Sr.x-vr,2)+Math.pow(Sr.y-gr,2)<=Math.pow((mr+2*Cr)*this.radius,2),Er=hr(cr(this.points,mr+2*Cr,br,yr));return pointInsidePolygonPoints(vr,gr,Er)||wr},draw:function(vr,gr,mr,br,yr){var xr=cr(this.pointsTr,gr,mr,br);ar.arrowShapeImpl(this.name)(vr,xr,br.x,br.y,this.radius*gr)},spacing:function(vr){return ar.getArrowWidth(vr.pstyle("width").pfValue,vr.pstyle("arrow-scale").value)*this.radius}}),fr("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(vr,gr){var mr=this.baseCrossLinePts.slice(),br=gr/vr,yr=3,xr=5;return mr[yr]=mr[yr]-br,mr[xr]=mr[xr]-br,mr},collide:function(vr,gr,mr,br,yr,xr,Cr){var Sr=hr(cr(this.points,mr+2*Cr,br,yr)),wr=hr(cr(this.crossLinePts(mr,xr),mr+2*Cr,br,yr)),Er=pointInsidePolygonPoints(vr,gr,Sr)||pointInsidePolygonPoints(vr,gr,wr);return Er},draw:function(vr,gr,mr,br,yr){var xr=cr(this.points,gr,mr,br),Cr=cr(this.crossLinePts(gr,yr),gr,mr,br);ar.arrowShapeImpl(this.name)(vr,xr,Cr)}}),fr("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(vr){return dr(vr)*.525}}),fr("circle",{radius:.15,collide:function(vr,gr,mr,br,yr,xr,Cr){var Sr=yr,wr=Math.pow(Sr.x-vr,2)+Math.pow(Sr.y-gr,2)<=Math.pow((mr+2*Cr)*this.radius,2);return wr},draw:function(vr,gr,mr,br,yr){ar.arrowShapeImpl(this.name)(vr,br.x,br.y,this.radius*gr)},spacing:function(vr){return ar.getArrowWidth(vr.pstyle("width").pfValue,vr.pstyle("arrow-scale").value)*this.radius}}),fr("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(vr){return 1},gap:function(vr){return 1}}),fr("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),fr("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(vr){return vr.pstyle("width").pfValue*vr.pstyle("arrow-scale").value}}),fr("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(vr){return .95*vr.pstyle("width").pfValue*vr.pstyle("arrow-scale").value}})};var BRp$e={};BRp$e.projectIntoViewport=function(or,ar){var lr=this.cy,ur=this.findContainerClientCoords(),cr=ur[0],hr=ur[1],dr=ur[4],fr=lr.pan(),pr=lr.zoom(),vr=((or-cr)/dr-fr.x)/pr,gr=((ar-hr)/dr-fr.y)/pr;return[vr,gr]};BRp$e.findContainerClientCoords=function(){if(this.containerBB)return this.containerBB;var or=this.container,ar=or.getBoundingClientRect(),lr=this.cy.window().getComputedStyle(or),ur=function(wr){return parseFloat(lr.getPropertyValue(wr))},cr={left:ur("padding-left"),right:ur("padding-right"),top:ur("padding-top"),bottom:ur("padding-bottom")},hr={left:ur("border-left-width"),right:ur("border-right-width"),top:ur("border-top-width"),bottom:ur("border-bottom-width")},dr=or.clientWidth,fr=or.clientHeight,pr=cr.left+cr.right,vr=cr.top+cr.bottom,gr=hr.left+hr.right,mr=ar.width/(dr+gr),br=dr-pr,yr=fr-vr,xr=ar.left+cr.left+hr.left,Cr=ar.top+cr.top+hr.top;return this.containerBB=[xr,Cr,br,yr,mr]};BRp$e.invalidateContainerClientCoordsCache=function(){this.containerBB=null};BRp$e.findNearestElement=function(or,ar,lr,ur){return this.findNearestElements(or,ar,lr,ur)[0]};BRp$e.findNearestElements=function(or,ar,lr,ur){var cr=this,hr=this,dr=hr.getCachedZSortedEles(),fr=[],pr=hr.cy.zoom(),vr=hr.cy.hasCompoundNodes(),gr=(ur?24:8)/pr,mr=(ur?8:2)/pr,br=(ur?8:2)/pr,yr=1/0,xr,Cr;lr&&(dr=dr.interactive);function Sr(_r,kr){if(_r.isNode()){if(Cr)return;Cr=_r,fr.push(_r)}if(_r.isEdge()&&(kr==null||kr<yr))if(xr){if(xr.pstyle("z-compound-depth").value===_r.pstyle("z-compound-depth").value&&xr.pstyle("z-compound-depth").value===_r.pstyle("z-compound-depth").value){for(var Dr=0;Dr<fr.length;Dr++)if(fr[Dr].isEdge()){fr[Dr]=_r,xr=_r,yr=kr??yr;break}}}else fr.push(_r),xr=_r,yr=kr??yr}function wr(_r){var kr=_r.outerWidth()+2*mr,Dr=_r.outerHeight()+2*mr,Nr=kr/2,Lr=Dr/2,Or=_r.position(),Ir=_r.pstyle("corner-radius").value==="auto"?"auto":_r.pstyle("corner-radius").pfValue,Mr=_r._private.rscratch;if(Or.x-Nr<=or&&or<=Or.x+Nr&&Or.y-Lr<=ar&&ar<=Or.y+Lr){var $r=hr.nodeShapes[cr.getNodeShape(_r)];if($r.checkPoint(or,ar,0,kr,Dr,Or.x,Or.y,Ir,Mr))return Sr(_r,0),!0}}function Er(_r){var kr=_r._private,Dr=kr.rscratch,Nr=_r.pstyle("width").pfValue,Lr=_r.pstyle("arrow-scale").value,Or=Nr/2+gr,Ir=Or*Or,Mr=Or*2,zr=kr.source,Hr=kr.target,$r;if(Dr.edgeType==="segments"||Dr.edgeType==="straight"||Dr.edgeType==="haystack"){for(var jr=Dr.allpts,Fr=0;Fr+3<jr.length;Fr+=2)if(inLineVicinity(or,ar,jr[Fr],jr[Fr+1],jr[Fr+2],jr[Fr+3],Mr)&&Ir>($r=sqdistToFiniteLine(or,ar,jr[Fr],jr[Fr+1],jr[Fr+2],jr[Fr+3])))return Sr(_r,$r),!0}else if(Dr.edgeType==="bezier"||Dr.edgeType==="multibezier"||Dr.edgeType==="self"||Dr.edgeType==="compound"){for(var jr=Dr.allpts,Fr=0;Fr+5<Dr.allpts.length;Fr+=4)if(inBezierVicinity(or,ar,jr[Fr],jr[Fr+1],jr[Fr+2],jr[Fr+3],jr[Fr+4],jr[Fr+5],Mr)&&Ir>($r=sqdistToQuadraticBezier(or,ar,jr[Fr],jr[Fr+1],jr[Fr+2],jr[Fr+3],jr[Fr+4],jr[Fr+5])))return Sr(_r,$r),!0}for(var zr=zr||kr.source,Hr=Hr||kr.target,Wr=cr.getArrowWidth(Nr,Lr),Yr=[{name:"source",x:Dr.arrowStartX,y:Dr.arrowStartY,angle:Dr.srcArrowAngle},{name:"target",x:Dr.arrowEndX,y:Dr.arrowEndY,angle:Dr.tgtArrowAngle},{name:"mid-source",x:Dr.midX,y:Dr.midY,angle:Dr.midsrcArrowAngle},{name:"mid-target",x:Dr.midX,y:Dr.midY,angle:Dr.midtgtArrowAngle}],Fr=0;Fr<Yr.length;Fr++){var qr=Yr[Fr],Br=hr.arrowShapes[_r.pstyle(qr.name+"-arrow-shape").value],Ur=_r.pstyle("width").pfValue;if(Br.roughCollide(or,ar,Wr,qr.angle,{x:qr.x,y:qr.y},Ur,gr)&&Br.collide(or,ar,Wr,qr.angle,{x:qr.x,y:qr.y},Ur,gr))return Sr(_r),!0}vr&&fr.length>0&&(wr(zr),wr(Hr))}function Ar(_r,kr,Dr){return getPrefixedProperty(_r,kr,Dr)}function Tr(_r,kr){var Dr=_r._private,Nr=br,Lr;kr?Lr=kr+"-":Lr="",_r.boundingBox();var Or=Dr.labelBounds[kr||"main"],Ir=_r.pstyle(Lr+"label").value,Mr=_r.pstyle("text-events").strValue==="yes";if(!(!Mr||!Ir)){var $r=Ar(Dr.rscratch,"labelX",kr),jr=Ar(Dr.rscratch,"labelY",kr),Fr=Ar(Dr.rscratch,"labelAngle",kr),zr=_r.pstyle(Lr+"text-margin-x").pfValue,Hr=_r.pstyle(Lr+"text-margin-y").pfValue,Wr=Or.x1-Nr-zr,Yr=Or.x2+Nr-zr,qr=Or.y1-Nr-Hr,Br=Or.y2+Nr-Hr;if(Fr){var Ur=Math.cos(Fr),Vr=Math.sin(Fr),Xr=function(os,ls){return os=os-$r,ls=ls-jr,{x:os*Ur-ls*Vr+$r,y:os*Vr+ls*Ur+jr}},Zr=Xr(Wr,qr),Jr=Xr(Wr,Br),Qr=Xr(Yr,qr),ga=Xr(Yr,Br),ba=[Zr.x+zr,Zr.y+Hr,Qr.x+zr,Qr.y+Hr,ga.x+zr,ga.y+Hr,Jr.x+zr,Jr.y+Hr];if(pointInsidePolygonPoints(or,ar,ba))return Sr(_r),!0}else if(inBoundingBox(Or,or,ar))return Sr(_r),!0}}for(var Rr=dr.length-1;Rr>=0;Rr--){var Pr=dr[Rr];Pr.isNode()?wr(Pr)||Tr(Pr):Er(Pr)||Tr(Pr)||Tr(Pr,"source")||Tr(Pr,"target")}return fr};BRp$e.getAllInBox=function(or,ar,lr,ur){var cr=this.getCachedZSortedEles().interactive,hr=this.cy.zoom(),dr=2/hr,fr=[],pr=Math.min(or,lr),vr=Math.max(or,lr),gr=Math.min(ar,ur),mr=Math.max(ar,ur);or=pr,lr=vr,ar=gr,ur=mr;var br=makeBoundingBox({x1:or,y1:ar,x2:lr,y2:ur}),yr=[{x:br.x1,y:br.y1},{x:br.x2,y:br.y1},{x:br.x2,y:br.y2},{x:br.x1,y:br.y2}],xr=[[yr[0],yr[1]],[yr[1],yr[2]],[yr[2],yr[3]],[yr[3],yr[0]]];function Cr(os,ls,ys){return getPrefixedProperty(os,ls,ys)}function Sr(os,ls){var ys=os._private,ns=dr,as="";os.boundingBox();var Kr=ys.labelBounds.main;if(!Kr)return null;var $a=Cr(ys.rscratch,"labelX",ls),ss=Cr(ys.rscratch,"labelY",ls),hs=Cr(ys.rscratch,"labelAngle",ls),vs=os.pstyle(as+"text-margin-x").pfValue,bs=os.pstyle(as+"text-margin-y").pfValue,xs=Kr.x1-ns-vs,fs=Kr.x2+ns-vs,Is=Kr.y1-ns-bs,Os=Kr.y2+ns-bs;if(hs){var Us=Math.cos(hs),$s=Math.sin(hs),Bs=function(us,na){return us=us-$a,na=na-ss,{x:us*Us-na*$s+$a,y:us*$s+na*Us+ss}};return[Bs(xs,Is),Bs(fs,Is),Bs(fs,Os),Bs(xs,Os)]}else return[{x:xs,y:Is},{x:fs,y:Is},{x:fs,y:Os},{x:xs,y:Os}]}function wr(os,ls,ys,ns){function as(Kr,$a,ss){return(ss.y-Kr.y)*($a.x-Kr.x)>($a.y-Kr.y)*(ss.x-Kr.x)}return as(os,ys,ns)!==as(ls,ys,ns)&&as(os,ls,ys)!==as(os,ls,ns)}for(var Er=0;Er<cr.length;Er++){var Ar=cr[Er];if(Ar.isNode()){var Tr=Ar,Rr=Tr.pstyle("text-events").strValue==="yes",Pr=Tr.pstyle("box-selection").strValue,_r=Tr.pstyle("box-select-labels").strValue==="yes";if(Pr==="none")continue;var kr=(Pr==="overlap"||_r)&&Rr,Dr=Tr.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:kr});if(Pr==="contain"){var Nr=!1;if(_r&&Rr){var Lr=Sr(Tr);Lr&&satPolygonIntersection(Lr,yr)&&(fr.push(Tr),Nr=!0)}!Nr&&boundingBoxInBoundingBox(br,Dr)&&fr.push(Tr)}else if(Pr==="overlap"&&boundingBoxesIntersect(br,Dr)){var Or=Tr.boundingBox({includeNodes:!0,includeEdges:!0,includeLabels:!1,includeMainLabels:!1,includeSourceLabels:!1,includeTargetLabels:!1}),Ir=[{x:Or.x1,y:Or.y1},{x:Or.x2,y:Or.y1},{x:Or.x2,y:Or.y2},{x:Or.x1,y:Or.y2}];if(satPolygonIntersection(Ir,yr))fr.push(Tr);else{var Mr=Sr(Tr);Mr&&satPolygonIntersection(Mr,yr)&&fr.push(Tr)}}}else{var $r=Ar,jr=$r._private,Fr=jr.rscratch,zr=$r.pstyle("box-selection").strValue;if(zr==="none")continue;if(zr==="contain"){if(Fr.startX!=null&&Fr.startY!=null&&!inBoundingBox(br,Fr.startX,Fr.startY)||Fr.endX!=null&&Fr.endY!=null&&!inBoundingBox(br,Fr.endX,Fr.endY))continue;if(Fr.edgeType==="bezier"||Fr.edgeType==="multibezier"||Fr.edgeType==="self"||Fr.edgeType==="compound"||Fr.edgeType==="segments"||Fr.edgeType==="haystack"){for(var Hr=jr.rstyle.bezierPts||jr.rstyle.linePts||jr.rstyle.haystackPts,Wr=!0,Yr=0;Yr<Hr.length;Yr++)if(!pointInBoundingBox(br,Hr[Yr])){Wr=!1;break}Wr&&fr.push($r)}else Fr.edgeType==="straight"&&fr.push($r)}else if(zr==="overlap"){var qr=!1;if(Fr.startX!=null&&Fr.startY!=null&&Fr.endX!=null&&Fr.endY!=null&&(inBoundingBox(br,Fr.startX,Fr.startY)||inBoundingBox(br,Fr.endX,Fr.endY)))fr.push($r),qr=!0;else if(!qr&&Fr.edgeType==="haystack"){for(var Br=jr.rstyle.haystackPts,Ur=0;Ur<Br.length;Ur++)if(pointInBoundingBox(br,Br[Ur])){fr.push($r),qr=!0;break}}if(!qr){var Vr=jr.rstyle.bezierPts||jr.rstyle.linePts||jr.rstyle.haystackPts;if((!Vr||Vr.length<2)&&Fr.edgeType==="straight"&&Fr.startX!=null&&Fr.startY!=null&&Fr.endX!=null&&Fr.endY!=null&&(Vr=[{x:Fr.startX,y:Fr.startY},{x:Fr.endX,y:Fr.endY}]),!Vr||Vr.length<2)continue;for(var Xr=0;Xr<Vr.length-1;Xr++){for(var Zr=Vr[Xr],Jr=Vr[Xr+1],Qr=0;Qr<xr.length;Qr++){var ga=_slicedToArray(xr[Qr],2),ba=ga[0],_i=ga[1];if(wr(Zr,Jr,ba,_i)){fr.push($r),qr=!0;break}}if(qr)break}}}}}return fr};var BRp$d={};BRp$d.calculateArrowAngles=function(or){var ar=or._private.rscratch,lr=ar.edgeType==="haystack",ur=ar.edgeType==="bezier",cr=ar.edgeType==="multibezier",hr=ar.edgeType==="segments",dr=ar.edgeType==="compound",fr=ar.edgeType==="self",pr,vr,gr,mr,br,yr,wr,Er;if(lr?(gr=ar.haystackPts[0],mr=ar.haystackPts[1],br=ar.haystackPts[2],yr=ar.haystackPts[3]):(gr=ar.arrowStartX,mr=ar.arrowStartY,br=ar.arrowEndX,yr=ar.arrowEndY),wr=ar.midX,Er=ar.midY,hr)pr=gr-ar.segpts[0],vr=mr-ar.segpts[1];else if(cr||dr||fr||ur){var xr=ar.allpts,Cr=qbezierAt(xr[0],xr[2],xr[4],.1),Sr=qbezierAt(xr[1],xr[3],xr[5],.1);pr=gr-Cr,vr=mr-Sr}else pr=gr-wr,vr=mr-Er;ar.srcArrowAngle=getAngleFromDisp(pr,vr);var wr=ar.midX,Er=ar.midY;if(lr&&(wr=(gr+br)/2,Er=(mr+yr)/2),pr=br-gr,vr=yr-mr,hr){var xr=ar.allpts;if(xr.length/2%2===0){var Ar=xr.length/2,Tr=Ar-2;pr=xr[Ar]-xr[Tr],vr=xr[Ar+1]-xr[Tr+1]}else if(ar.isRound)pr=ar.midVector[1],vr=-ar.midVector[0];else{var Ar=xr.length/2-1,Tr=Ar-2;pr=xr[Ar]-xr[Tr],vr=xr[Ar+1]-xr[Tr+1]}}else if(cr||dr||fr){var xr=ar.allpts,Rr=ar.ctrlpts,Pr,_r,kr,Dr;if(Rr.length/2%2===0){var Nr=xr.length/2-1,Lr=Nr+2,Or=Lr+2;Pr=qbezierAt(xr[Nr],xr[Lr],xr[Or],0),_r=qbezierAt(xr[Nr+1],xr[Lr+1],xr[Or+1],0),kr=qbezierAt(xr[Nr],xr[Lr],xr[Or],1e-4),Dr=qbezierAt(xr[Nr+1],xr[Lr+1],xr[Or+1],1e-4)}else{var Lr=xr.length/2-1,Nr=Lr-2,Or=Lr+2;Pr=qbezierAt(xr[Nr],xr[Lr],xr[Or],.4999),_r=qbezierAt(xr[Nr+1],xr[Lr+1],xr[Or+1],.4999),kr=qbezierAt(xr[Nr],xr[Lr],xr[Or],.5),Dr=qbezierAt(xr[Nr+1],xr[Lr+1],xr[Or+1],.5)}pr=kr-Pr,vr=Dr-_r}if(ar.midtgtArrowAngle=getAngleFromDisp(pr,vr),ar.midDispX=pr,ar.midDispY=vr,pr*=-1,vr*=-1,hr){var xr=ar.allpts;if(xr.length/2%2!==0){if(!ar.isRound){var Ar=xr.length/2-1,Ir=Ar+2;pr=-(xr[Ir]-xr[Ar]),vr=-(xr[Ir+1]-xr[Ar+1])}}}if(ar.midsrcArrowAngle=getAngleFromDisp(pr,vr),hr)pr=br-ar.segpts[ar.segpts.length-2],vr=yr-ar.segpts[ar.segpts.length-1];else if(cr||dr||fr||ur){var xr=ar.allpts,Mr=xr.length,Cr=qbezierAt(xr[Mr-6],xr[Mr-4],xr[Mr-2],.9),Sr=qbezierAt(xr[Mr-5],xr[Mr-3],xr[Mr-1],.9);pr=br-Cr,vr=yr-Sr}else pr=br-wr,vr=yr-Er;ar.tgtArrowAngle=getAngleFromDisp(pr,vr)};BRp$d.getArrowWidth=BRp$d.getArrowHeight=function(or,ar){var lr=this.arrowWidthCache=this.arrowWidthCache||{},ur=lr[or+", "+ar];return ur||(ur=Math.max(Math.pow(or*13.37,.9),29)*ar,lr[or+", "+ar]=ur,ur)};var x,y,v1={},v2={},sinA,sinA90,radDirection,drawDirection,angle,halfAngle,cRadius,lenOut,radius,limit,startX,startY,stopX,stopY,lastPoint,asVec=function or(ar,lr,ur){ur.x=lr.x-ar.x,ur.y=lr.y-ar.y,ur.len=Math.sqrt(ur.x*ur.x+ur.y*ur.y),ur.nx=ur.x/ur.len,ur.ny=ur.y/ur.len,ur.ang=Math.atan2(ur.ny,ur.nx)},invertVec=function or(ar,lr){lr.x=ar.x*-1,lr.y=ar.y*-1,lr.nx=ar.nx*-1,lr.ny=ar.ny*-1,lr.ang=ar.ang>0?-(Math.PI-ar.ang):Math.PI+ar.ang},calcCornerArc=function or(ar,lr,ur,cr,hr){if(ar!==lastPoint?asVec(lr,ar,v1):invertVec(v2,v1),asVec(lr,ur,v2),sinA=v1.nx*v2.ny-v1.ny*v2.nx,sinA90=v1.nx*v2.nx-v1.ny*-v2.ny,angle=Math.asin(Math.max(-1,Math.min(1,sinA))),Math.abs(angle)<1e-6){x=lr.x,y=lr.y,cRadius=radius=0;return}radDirection=1,drawDirection=!1,sinA90<0?angle<0?angle=Math.PI+angle:(angle=Math.PI-angle,radDirection=-1,drawDirection=!0):angle>0&&(radDirection=-1,drawDirection=!0),lr.radius!==void 0?radius=lr.radius:radius=cr,halfAngle=angle/2,limit=Math.min(v1.len/2,v2.len/2),hr?(lenOut=Math.abs(Math.cos(halfAngle)*radius/Math.sin(halfAngle)),lenOut>limit?(lenOut=limit,cRadius=Math.abs(lenOut*Math.sin(halfAngle)/Math.cos(halfAngle))):cRadius=radius):(lenOut=Math.min(limit,radius),cRadius=Math.abs(lenOut*Math.sin(halfAngle)/Math.cos(halfAngle))),stopX=lr.x+v2.nx*lenOut,stopY=lr.y+v2.ny*lenOut,x=stopX-v2.ny*cRadius*radDirection,y=stopY+v2.nx*cRadius*radDirection,startX=lr.x+v1.nx*lenOut,startY=lr.y+v1.ny*lenOut,lastPoint=lr};function drawPreparedRoundCorner(or,ar){ar.radius===0?or.lineTo(ar.cx,ar.cy):or.arc(ar.cx,ar.cy,ar.radius,ar.startAngle,ar.endAngle,ar.counterClockwise)}function getRoundCorner(or,ar,lr,ur){var cr=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0;return ur===0||ar.radius===0?{cx:ar.x,cy:ar.y,radius:0,startX:ar.x,startY:ar.y,stopX:ar.x,stopY:ar.y,startAngle:void 0,endAngle:void 0,counterClockwise:void 0}:(calcCornerArc(or,ar,lr,ur,cr),{cx:x,cy:y,radius:cRadius,startX,startY,stopX,stopY,startAngle:v1.ang+Math.PI/2*radDirection,endAngle:v2.ang-Math.PI/2*radDirection,counterClockwise:drawDirection})}var AVOID_IMPOSSIBLE_BEZIER_CONSTANT=.01,AVOID_IMPOSSIBLE_BEZIER_CONSTANT_L=Math.sqrt(2*AVOID_IMPOSSIBLE_BEZIER_CONSTANT),BRp$c={};BRp$c.findMidptPtsEtc=function(or,ar){var lr=ar.posPts,ur=ar.intersectionPts,cr=ar.vectorNormInverse,hr,dr=or.pstyle("source-endpoint"),fr=or.pstyle("target-endpoint"),pr=dr.units!=null&&fr.units!=null,vr=function(Rr,Pr,_r,kr){var Dr=kr-Pr,Nr=_r-Rr,Lr=Math.sqrt(Nr*Nr+Dr*Dr);return{x:-Dr/Lr,y:Nr/Lr}},gr=or.pstyle("edge-distances").value;switch(gr){case"node-position":hr=lr;break;case"intersection":hr=ur;break;case"endpoints":{if(pr){var mr=this.manualEndptToPx(or.source()[0],dr),br=_slicedToArray(mr,2),yr=br[0],xr=br[1],Cr=this.manualEndptToPx(or.target()[0],fr),Sr=_slicedToArray(Cr,2),wr=Sr[0],Er=Sr[1],Ar={x1:yr,y1:xr,x2:wr,y2:Er};cr=vr(yr,xr,wr,Er),hr=Ar}else warn("Edge ".concat(or.id()," has edge-distances:endpoints specified without manual endpoints specified via source-endpoint and target-endpoint.  Falling back on edge-distances:intersection (default).")),hr=ur;break}}return{midptPts:hr,vectorNormInverse:cr}};BRp$c.findHaystackPoints=function(or){for(var ar=0;ar<or.length;ar++){var lr=or[ar],ur=lr._private,cr=ur.rscratch;if(!cr.haystack){var hr=Math.random()*2*Math.PI;cr.source={x:Math.cos(hr),y:Math.sin(hr)},hr=Math.random()*2*Math.PI,cr.target={x:Math.cos(hr),y:Math.sin(hr)}}var dr=ur.source,fr=ur.target,pr=dr.position(),vr=fr.position(),gr=dr.width(),mr=fr.width(),br=dr.height(),yr=fr.height(),xr=lr.pstyle("haystack-radius").value,Cr=xr/2;cr.haystackPts=cr.allpts=[cr.source.x*gr*Cr+pr.x,cr.source.y*br*Cr+pr.y,cr.target.x*mr*Cr+vr.x,cr.target.y*yr*Cr+vr.y],cr.midX=(cr.allpts[0]+cr.allpts[2])/2,cr.midY=(cr.allpts[1]+cr.allpts[3])/2,cr.edgeType="haystack",cr.haystack=!0,this.storeEdgeProjections(lr),this.calculateArrowAngles(lr),this.recalculateEdgeLabelProjections(lr),this.calculateLabelAngles(lr)}};BRp$c.findSegmentsPoints=function(or,ar){var lr=or._private.rscratch,ur=or.pstyle("segment-weights"),cr=or.pstyle("segment-distances"),hr=or.pstyle("segment-radii"),dr=or.pstyle("radius-type"),fr=Math.min(ur.pfValue.length,cr.pfValue.length),pr=hr.pfValue[hr.pfValue.length-1],vr=dr.pfValue[dr.pfValue.length-1];lr.edgeType="segments",lr.segpts=[],lr.radii=[],lr.isArcRadius=[];for(var gr=0;gr<fr;gr++){var mr=ur.pfValue[gr],br=cr.pfValue[gr],yr=1-mr,xr=mr,Cr=this.findMidptPtsEtc(or,ar),Sr=Cr.midptPts,wr=Cr.vectorNormInverse,Er={x:Sr.x1*yr+Sr.x2*xr,y:Sr.y1*yr+Sr.y2*xr};lr.segpts.push(Er.x+wr.x*br,Er.y+wr.y*br),lr.radii.push(hr.pfValue[gr]!==void 0?hr.pfValue[gr]:pr),lr.isArcRadius.push((dr.pfValue[gr]!==void 0?dr.pfValue[gr]:vr)==="arc-radius")}};BRp$c.findLoopPoints=function(or,ar,lr,ur){var cr=or._private.rscratch,hr=ar.dirCounts,dr=ar.srcPos,fr=or.pstyle("control-point-distances"),pr=fr?fr.pfValue[0]:void 0,vr=or.pstyle("loop-direction").pfValue,gr=or.pstyle("loop-sweep").pfValue,mr=or.pstyle("control-point-step-size").pfValue;cr.edgeType="self";var br=lr,yr=mr;ur&&(br=0,yr=pr);var xr=vr-Math.PI/2,Cr=xr-gr/2,Sr=xr+gr/2,wr=vr+"_"+gr;br=hr[wr]===void 0?hr[wr]=0:++hr[wr],cr.ctrlpts=[dr.x+Math.cos(Cr)*1.4*yr*(br/3+1),dr.y+Math.sin(Cr)*1.4*yr*(br/3+1),dr.x+Math.cos(Sr)*1.4*yr*(br/3+1),dr.y+Math.sin(Sr)*1.4*yr*(br/3+1)]};BRp$c.findCompoundLoopPoints=function(or,ar,lr,ur){var cr=or._private.rscratch;cr.edgeType="compound";var hr=ar.srcPos,dr=ar.tgtPos,fr=ar.srcW,pr=ar.srcH,vr=ar.tgtW,gr=ar.tgtH,mr=or.pstyle("control-point-step-size").pfValue,br=or.pstyle("control-point-distances"),yr=br?br.pfValue[0]:void 0,xr=lr,Cr=mr;ur&&(xr=0,Cr=yr);var Sr=50,wr={x:hr.x-fr/2,y:hr.y-pr/2},Er={x:dr.x-vr/2,y:dr.y-gr/2},Ar={x:Math.min(wr.x,Er.x),y:Math.min(wr.y,Er.y)},Tr=.5,Rr=Math.max(Tr,Math.log(fr*AVOID_IMPOSSIBLE_BEZIER_CONSTANT)),Pr=Math.max(Tr,Math.log(vr*AVOID_IMPOSSIBLE_BEZIER_CONSTANT));cr.ctrlpts=[Ar.x,Ar.y-(1+Math.pow(Sr,1.12)/100)*Cr*(xr/3+1)*Rr,Ar.x-(1+Math.pow(Sr,1.12)/100)*Cr*(xr/3+1)*Pr,Ar.y]};BRp$c.findStraightEdgePoints=function(or){or._private.rscratch.edgeType="straight"};BRp$c.findBezierPoints=function(or,ar,lr,ur,cr){var hr=or._private.rscratch,dr=or.pstyle("control-point-step-size").pfValue,fr=or.pstyle("control-point-distances"),pr=or.pstyle("control-point-weights"),vr=fr&&pr?Math.min(fr.value.length,pr.value.length):1,gr=fr?fr.pfValue[0]:void 0,mr=pr.value[0],br=ur;hr.edgeType=br?"multibezier":"bezier",hr.ctrlpts=[];for(var yr=0;yr<vr;yr++){var xr=(.5-ar.eles.length/2+lr)*dr*(cr?-1:1),Cr=void 0,Sr=signum(xr);br&&(gr=fr?fr.pfValue[yr]:dr,mr=pr.value[yr]),ur?Cr=gr:Cr=gr!==void 0?Sr*gr:void 0;var wr=Cr!==void 0?Cr:xr,Er=1-mr,Ar=mr,Tr=this.findMidptPtsEtc(or,ar),Rr=Tr.midptPts,Pr=Tr.vectorNormInverse,_r={x:Rr.x1*Er+Rr.x2*Ar,y:Rr.y1*Er+Rr.y2*Ar};hr.ctrlpts.push(_r.x+Pr.x*wr,_r.y+Pr.y*wr)}};BRp$c.findTaxiPoints=function(or,ar){var lr=or._private.rscratch;lr.edgeType="segments";var ur="vertical",cr="horizontal",hr="leftward",dr="rightward",fr="downward",pr="upward",vr="auto",gr=ar.posPts,mr=ar.srcW,br=ar.srcH,yr=ar.tgtW,xr=ar.tgtH,Cr=or.pstyle("edge-distances").value,Sr=Cr!=="node-position",wr=or.pstyle("taxi-direction").value,Er=wr,Ar=or.pstyle("taxi-turn"),Tr=Ar.units==="%",Rr=Ar.pfValue,Pr=Rr<0,_r=or.pstyle("taxi-turn-min-distance").pfValue,kr=Sr?(mr+yr)/2:0,Dr=Sr?(br+xr)/2:0,Nr=gr.x2-gr.x1,Lr=gr.y2-gr.y1,Or=function(na,ds){return na>0?Math.max(na-ds,0):Math.min(na+ds,0)},Ir=Or(Nr,kr),Mr=Or(Lr,Dr),$r=!1;Er===vr?wr=Math.abs(Ir)>Math.abs(Mr)?cr:ur:Er===pr||Er===fr?(wr=ur,$r=!0):(Er===hr||Er===dr)&&(wr=cr,$r=!0);var jr=wr===ur,Fr=jr?Mr:Ir,zr=jr?Lr:Nr,Hr=signum(zr),Wr=!1;!($r&&(Tr||Pr))&&(Er===fr&&zr<0||Er===pr&&zr>0||Er===hr&&zr>0||Er===dr&&zr<0)&&(Hr*=-1,Fr=Hr*Math.abs(Fr),Wr=!0);var Yr;if(Tr){var qr=Rr<0?1+Rr:Rr;Yr=qr*Fr}else{var Br=Rr<0?Fr:0;Yr=Br+Rr*Hr}var Ur=function(na){return Math.abs(na)<_r||Math.abs(na)>=Math.abs(Fr)},Vr=Ur(Yr),Xr=Ur(Math.abs(Fr)-Math.abs(Yr)),Zr=Vr||Xr;if(Zr&&!Wr)if(jr){var Jr=Math.abs(zr)<=br/2,Qr=Math.abs(Nr)<=yr/2;if(Jr){var ga=(gr.x1+gr.x2)/2,ba=gr.y1,_i=gr.y2;lr.segpts=[ga,ba,ga,_i]}else if(Qr){var os=(gr.y1+gr.y2)/2,ls=gr.x1,ys=gr.x2;lr.segpts=[ls,os,ys,os]}else lr.segpts=[gr.x1,gr.y2]}else{var ns=Math.abs(zr)<=mr/2,as=Math.abs(Lr)<=xr/2;if(ns){var Kr=(gr.y1+gr.y2)/2,$a=gr.x1,ss=gr.x2;lr.segpts=[$a,Kr,ss,Kr]}else if(as){var hs=(gr.x1+gr.x2)/2,vs=gr.y1,bs=gr.y2;lr.segpts=[hs,vs,hs,bs]}else lr.segpts=[gr.x2,gr.y1]}else if(jr){var xs=gr.y1+Yr+(Sr?br/2*Hr:0),fs=gr.x1,Is=gr.x2;lr.segpts=[fs,xs,Is,xs]}else{var Os=gr.x1+Yr+(Sr?mr/2*Hr:0),Us=gr.y1,$s=gr.y2;lr.segpts=[Os,Us,Os,$s]}if(lr.isRound){var Bs=or.pstyle("taxi-radius").value,Ns=or.pstyle("radius-type").value[0]==="arc-radius";lr.radii=new Array(lr.segpts.length/2).fill(Bs),lr.isArcRadius=new Array(lr.segpts.length/2).fill(Ns)}};BRp$c.tryToCorrectInvalidPoints=function(or,ar){var lr=or._private.rscratch;if(lr.edgeType==="bezier"){var ur=ar.srcPos,cr=ar.tgtPos,hr=ar.srcW,dr=ar.srcH,fr=ar.tgtW,pr=ar.tgtH,vr=ar.srcShape,gr=ar.tgtShape,mr=ar.srcCornerRadius,br=ar.tgtCornerRadius,yr=ar.srcRs,xr=ar.tgtRs,Cr=!number$1(lr.startX)||!number$1(lr.startY),Sr=!number$1(lr.arrowStartX)||!number$1(lr.arrowStartY),wr=!number$1(lr.endX)||!number$1(lr.endY),Er=!number$1(lr.arrowEndX)||!number$1(lr.arrowEndY),Ar=3,Tr=this.getArrowWidth(or.pstyle("width").pfValue,or.pstyle("arrow-scale").value)*this.arrowShapeWidth,Rr=Ar*Tr,Pr=dist({x:lr.ctrlpts[0],y:lr.ctrlpts[1]},{x:lr.startX,y:lr.startY}),_r=Pr<Rr,kr=dist({x:lr.ctrlpts[0],y:lr.ctrlpts[1]},{x:lr.endX,y:lr.endY}),Dr=kr<Rr,Nr=!1;if(Cr||Sr||_r){Nr=!0;var Lr={x:lr.ctrlpts[0]-ur.x,y:lr.ctrlpts[1]-ur.y},Or=Math.sqrt(Lr.x*Lr.x+Lr.y*Lr.y),Ir={x:Lr.x/Or,y:Lr.y/Or},Mr=Math.max(hr,dr),$r={x:lr.ctrlpts[0]+Ir.x*2*Mr,y:lr.ctrlpts[1]+Ir.y*2*Mr},jr=vr.intersectLine(ur.x,ur.y,hr,dr,$r.x,$r.y,0,mr,yr);_r?(lr.ctrlpts[0]=lr.ctrlpts[0]+Ir.x*(Rr-Pr),lr.ctrlpts[1]=lr.ctrlpts[1]+Ir.y*(Rr-Pr)):(lr.ctrlpts[0]=jr[0]+Ir.x*Rr,lr.ctrlpts[1]=jr[1]+Ir.y*Rr)}if(wr||Er||Dr){Nr=!0;var Fr={x:lr.ctrlpts[0]-cr.x,y:lr.ctrlpts[1]-cr.y},zr=Math.sqrt(Fr.x*Fr.x+Fr.y*Fr.y),Hr={x:Fr.x/zr,y:Fr.y/zr},Wr=Math.max(hr,dr),Yr={x:lr.ctrlpts[0]+Hr.x*2*Wr,y:lr.ctrlpts[1]+Hr.y*2*Wr},qr=gr.intersectLine(cr.x,cr.y,fr,pr,Yr.x,Yr.y,0,br,xr);Dr?(lr.ctrlpts[0]=lr.ctrlpts[0]+Hr.x*(Rr-kr),lr.ctrlpts[1]=lr.ctrlpts[1]+Hr.y*(Rr-kr)):(lr.ctrlpts[0]=qr[0]+Hr.x*Rr,lr.ctrlpts[1]=qr[1]+Hr.y*Rr)}Nr&&this.findEndpoints(or)}};BRp$c.storeAllpts=function(or){var ar=or._private.rscratch;if(ar.edgeType==="multibezier"||ar.edgeType==="bezier"||ar.edgeType==="self"||ar.edgeType==="compound"){ar.allpts=[],ar.allpts.push(ar.startX,ar.startY);for(var lr=0;lr+1<ar.ctrlpts.length;lr+=2)ar.allpts.push(ar.ctrlpts[lr],ar.ctrlpts[lr+1]),lr+3<ar.ctrlpts.length&&ar.allpts.push((ar.ctrlpts[lr]+ar.ctrlpts[lr+2])/2,(ar.ctrlpts[lr+1]+ar.ctrlpts[lr+3])/2);ar.allpts.push(ar.endX,ar.endY);var ur,cr;ar.ctrlpts.length/2%2===0?(ur=ar.allpts.length/2-1,ar.midX=ar.allpts[ur],ar.midY=ar.allpts[ur+1]):(ur=ar.allpts.length/2-3,cr=.5,ar.midX=qbezierAt(ar.allpts[ur],ar.allpts[ur+2],ar.allpts[ur+4],cr),ar.midY=qbezierAt(ar.allpts[ur+1],ar.allpts[ur+3],ar.allpts[ur+5],cr))}else if(ar.edgeType==="straight")ar.allpts=[ar.startX,ar.startY,ar.endX,ar.endY],ar.midX=(ar.startX+ar.endX+ar.arrowStartX+ar.arrowEndX)/4,ar.midY=(ar.startY+ar.endY+ar.arrowStartY+ar.arrowEndY)/4;else if(ar.edgeType==="segments"){if(ar.allpts=[],ar.allpts.push(ar.startX,ar.startY),ar.allpts.push.apply(ar.allpts,ar.segpts),ar.allpts.push(ar.endX,ar.endY),ar.isRound){ar.roundCorners=[];for(var hr=2;hr+3<ar.allpts.length;hr+=2){var dr=ar.radii[hr/2-1],fr=ar.isArcRadius[hr/2-1];ar.roundCorners.push(getRoundCorner({x:ar.allpts[hr-2],y:ar.allpts[hr-1]},{x:ar.allpts[hr],y:ar.allpts[hr+1],radius:dr},{x:ar.allpts[hr+2],y:ar.allpts[hr+3]},dr,fr))}}if(ar.segpts.length%4===0){var pr=ar.segpts.length/2,vr=pr-2;ar.midX=(ar.segpts[vr]+ar.segpts[pr])/2,ar.midY=(ar.segpts[vr+1]+ar.segpts[pr+1])/2}else{var gr=ar.segpts.length/2-1;if(!ar.isRound)ar.midX=ar.segpts[gr],ar.midY=ar.segpts[gr+1];else{var mr={x:ar.segpts[gr],y:ar.segpts[gr+1]},br=ar.roundCorners[gr/2];if(br.radius===0){var yr={x:ar.segpts[gr+2],y:ar.segpts[gr+3]};ar.midX=mr.x,ar.midY=mr.y,ar.midVector=[mr.y-yr.y,yr.x-mr.x]}else{var xr=[mr.x-br.cx,mr.y-br.cy],Cr=br.radius/Math.sqrt(Math.pow(xr[0],2)+Math.pow(xr[1],2));xr=xr.map(function(Sr){return Sr*Cr}),ar.midX=br.cx+xr[0],ar.midY=br.cy+xr[1],ar.midVector=xr}}}}};BRp$c.checkForInvalidEdgeWarning=function(or){var ar=or[0]._private.rscratch;ar.nodesOverlap||number$1(ar.startX)&&number$1(ar.startY)&&number$1(ar.endX)&&number$1(ar.endY)?ar.loggedErr=!1:ar.loggedErr||(ar.loggedErr=!0,warn("Edge `"+or.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))};BRp$c.findEdgeControlPoints=function(or){var ar=this;if(!(!or||or.length===0)){for(var lr=this,ur=lr.cy,cr=ur.hasCompoundNodes(),hr=new Map$1,dr=function(Dr,Nr){return[].concat(_toConsumableArray(Dr),[Nr?1:0]).join("-")},fr=[],pr=[],vr=0;vr<or.length;vr++){var gr=or[vr],mr=gr._private,br=gr.pstyle("curve-style").value;if(!(gr.removed()||!gr.takesUpSpace())){if(br==="haystack"){pr.push(gr);continue}var yr=br==="unbundled-bezier"||endsWith(br,"segments")||br==="straight"||br==="straight-triangle"||endsWith(br,"taxi"),xr=br==="unbundled-bezier"||br==="bezier",Cr=mr.source,Sr=mr.target,wr=Cr.poolIndex(),Er=Sr.poolIndex(),Ar=[wr,Er].sort(),Tr=dr(Ar,yr),Rr=hr.get(Tr);Rr==null&&(Rr={eles:[]},fr.push({pairId:Ar,edgeIsUnbundled:yr}),hr.set(Tr,Rr)),Rr.eles.push(gr),yr&&(Rr.hasUnbundled=!0),xr&&(Rr.hasBezier=!0)}}for(var Pr=function(){var Dr=fr[_r],Nr=Dr.pairId,Lr=Dr.edgeIsUnbundled,Or=dr(Nr,Lr),Ir=hr.get(Or),Mr;if(!Ir.hasUnbundled){var $r=Ir.eles[0].parallelEdges().filter(function(Ns){return Ns.isBundledBezier()});clearArray(Ir.eles),$r.forEach(function(Ns){return Ir.eles.push(Ns)}),Ir.eles.sort(function(Ns,us){return Ns.poolIndex()-us.poolIndex()})}var jr=Ir.eles[0],Fr=jr.source(),zr=jr.target();if(Fr.poolIndex()>zr.poolIndex()){var Hr=Fr;Fr=zr,zr=Hr}var Wr=Ir.srcPos=Fr.position(),Yr=Ir.tgtPos=zr.position(),qr=Ir.srcW=Fr.outerWidth(),Br=Ir.srcH=Fr.outerHeight(),Ur=Ir.tgtW=zr.outerWidth(),Vr=Ir.tgtH=zr.outerHeight(),Xr=Ir.srcShape=lr.nodeShapes[ar.getNodeShape(Fr)],Zr=Ir.tgtShape=lr.nodeShapes[ar.getNodeShape(zr)],Jr=Ir.srcCornerRadius=Fr.pstyle("corner-radius").value==="auto"?"auto":Fr.pstyle("corner-radius").pfValue,Qr=Ir.tgtCornerRadius=zr.pstyle("corner-radius").value==="auto"?"auto":zr.pstyle("corner-radius").pfValue,ga=Ir.tgtRs=zr._private.rscratch,ba=Ir.srcRs=Fr._private.rscratch;Ir.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var _i=0;_i<Ir.eles.length;_i++){var os=Ir.eles[_i],ls=os[0]._private.rscratch,ys=os.pstyle("curve-style").value,ns=ys==="unbundled-bezier"||endsWith(ys,"segments")||endsWith(ys,"taxi"),as=!Fr.same(os.source());if(!Ir.calculatedIntersection&&Fr!==zr&&(Ir.hasBezier||Ir.hasUnbundled)){Ir.calculatedIntersection=!0;var Kr=Xr.intersectLine(Wr.x,Wr.y,qr,Br,Yr.x,Yr.y,0,Jr,ba),$a=Ir.srcIntn=Kr,ss=Zr.intersectLine(Yr.x,Yr.y,Ur,Vr,Wr.x,Wr.y,0,Qr,ga),hs=Ir.tgtIntn=ss,vs=Ir.intersectionPts={x1:Kr[0],x2:ss[0],y1:Kr[1],y2:ss[1]},bs=Ir.posPts={x1:Wr.x,x2:Yr.x,y1:Wr.y,y2:Yr.y},xs=ss[1]-Kr[1],fs=ss[0]-Kr[0],Is=Math.sqrt(fs*fs+xs*xs);number$1(Is)&&Is>=AVOID_IMPOSSIBLE_BEZIER_CONSTANT_L||(Is=Math.sqrt(Math.max(fs*fs,AVOID_IMPOSSIBLE_BEZIER_CONSTANT)+Math.max(xs*xs,AVOID_IMPOSSIBLE_BEZIER_CONSTANT)));var Os=Ir.vector={x:fs,y:xs},Us=Ir.vectorNorm={x:Os.x/Is,y:Os.y/Is},$s={x:-Us.y,y:Us.x};Ir.nodesOverlap=!number$1(Is)||Zr.checkPoint(Kr[0],Kr[1],0,Ur,Vr,Yr.x,Yr.y,Qr,ga)||Xr.checkPoint(ss[0],ss[1],0,qr,Br,Wr.x,Wr.y,Jr,ba),Ir.vectorNormInverse=$s,Mr={nodesOverlap:Ir.nodesOverlap,dirCounts:Ir.dirCounts,calculatedIntersection:!0,hasBezier:Ir.hasBezier,hasUnbundled:Ir.hasUnbundled,eles:Ir.eles,srcPos:Yr,srcRs:ga,tgtPos:Wr,tgtRs:ba,srcW:Ur,srcH:Vr,tgtW:qr,tgtH:Br,srcIntn:hs,tgtIntn:$a,srcShape:Zr,tgtShape:Xr,posPts:{x1:bs.x2,y1:bs.y2,x2:bs.x1,y2:bs.y1},intersectionPts:{x1:vs.x2,y1:vs.y2,x2:vs.x1,y2:vs.y1},vector:{x:-Os.x,y:-Os.y},vectorNorm:{x:-Us.x,y:-Us.y},vectorNormInverse:{x:-$s.x,y:-$s.y}}}var Bs=as?Mr:Ir;ls.nodesOverlap=Bs.nodesOverlap,ls.srcIntn=Bs.srcIntn,ls.tgtIntn=Bs.tgtIntn,ls.isRound=ys.startsWith("round"),cr&&(Fr.isParent()||Fr.isChild()||zr.isParent()||zr.isChild())&&(Fr.parents().anySame(zr)||zr.parents().anySame(Fr)||Fr.same(zr)&&Fr.isParent())?ar.findCompoundLoopPoints(os,Bs,_i,ns):Fr===zr?ar.findLoopPoints(os,Bs,_i,ns):ys.endsWith("segments")?ar.findSegmentsPoints(os,Bs):ys.endsWith("taxi")?ar.findTaxiPoints(os,Bs):ys==="straight"||!ns&&Ir.eles.length%2===1&&_i===Math.floor(Ir.eles.length/2)?ar.findStraightEdgePoints(os):ar.findBezierPoints(os,Bs,_i,ns,as),ar.findEndpoints(os),ar.tryToCorrectInvalidPoints(os,Bs),ar.checkForInvalidEdgeWarning(os),ar.storeAllpts(os),ar.storeEdgeProjections(os),ar.calculateArrowAngles(os),ar.recalculateEdgeLabelProjections(os),ar.calculateLabelAngles(os)}},_r=0;_r<fr.length;_r++)Pr();this.findHaystackPoints(pr)}};function getPts(or){var ar=[];if(or!=null){for(var lr=0;lr<or.length;lr+=2){var ur=or[lr],cr=or[lr+1];ar.push({x:ur,y:cr})}return ar}}BRp$c.getSegmentPoints=function(or){var ar=or[0]._private.rscratch;this.recalculateRenderedStyle(or);var lr=ar.edgeType;if(lr==="segments")return getPts(ar.segpts)};BRp$c.getControlPoints=function(or){var ar=or[0]._private.rscratch;this.recalculateRenderedStyle(or);var lr=ar.edgeType;if(lr==="bezier"||lr==="multibezier"||lr==="self"||lr==="compound")return getPts(ar.ctrlpts)};BRp$c.getEdgeMidpoint=function(or){var ar=or[0]._private.rscratch;return this.recalculateRenderedStyle(or),{x:ar.midX,y:ar.midY}};var BRp$b={};BRp$b.manualEndptToPx=function(or,ar){var lr=this,ur=or.position(),cr=or.outerWidth(),hr=or.outerHeight(),dr=or._private.rscratch;if(ar.value.length===2){var fr=[ar.pfValue[0],ar.pfValue[1]];return ar.units[0]==="%"&&(fr[0]=fr[0]*cr),ar.units[1]==="%"&&(fr[1]=fr[1]*hr),fr[0]+=ur.x,fr[1]+=ur.y,fr}else{var pr=ar.pfValue[0];pr=-Math.PI/2+pr;var vr=2*Math.max(cr,hr),gr=[ur.x+Math.cos(pr)*vr,ur.y+Math.sin(pr)*vr];return lr.nodeShapes[this.getNodeShape(or)].intersectLine(ur.x,ur.y,cr,hr,gr[0],gr[1],0,or.pstyle("corner-radius").value==="auto"?"auto":or.pstyle("corner-radius").pfValue,dr)}};BRp$b.findEndpoints=function(or){var ar,lr,ur,cr,hr=this,dr,fr=or.source()[0],pr=or.target()[0],vr=fr.position(),gr=pr.position(),mr=or.pstyle("target-arrow-shape").value,br=or.pstyle("source-arrow-shape").value,yr=or.pstyle("target-distance-from-node").pfValue,xr=or.pstyle("source-distance-from-node").pfValue,Cr=fr._private.rscratch,Sr=pr._private.rscratch,wr=or.pstyle("curve-style").value,Er=or._private.rscratch,Ar=Er.edgeType,Tr=endsWith(wr,"taxi"),Rr=Ar==="self"||Ar==="compound",Pr=Ar==="bezier"||Ar==="multibezier"||Rr,_r=Ar!=="bezier",kr=Ar==="straight"||Ar==="segments",Dr=Ar==="segments",Nr=Pr||_r||kr,Lr=Rr||Tr,Or=or.pstyle("source-endpoint"),Ir=Lr?"outside-to-node":Or.value,Mr=fr.pstyle("corner-radius").value==="auto"?"auto":fr.pstyle("corner-radius").pfValue,$r=or.pstyle("target-endpoint"),jr=Lr?"outside-to-node":$r.value,Fr=pr.pstyle("corner-radius").value==="auto"?"auto":pr.pstyle("corner-radius").pfValue;Er.srcManEndpt=Or,Er.tgtManEndpt=$r;var zr,Hr,Wr,Yr,qr=(ar=($r==null||(lr=$r.pfValue)===null||lr===void 0?void 0:lr.length)===2?$r.pfValue:null)!==null&&ar!==void 0?ar:[0,0],Br=(ur=(Or==null||(cr=Or.pfValue)===null||cr===void 0?void 0:cr.length)===2?Or.pfValue:null)!==null&&ur!==void 0?ur:[0,0];if(Pr){var Ur=[Er.ctrlpts[0],Er.ctrlpts[1]],Vr=_r?[Er.ctrlpts[Er.ctrlpts.length-2],Er.ctrlpts[Er.ctrlpts.length-1]]:Ur;zr=Vr,Hr=Ur}else if(kr){var Xr=Dr?Er.segpts.slice(0,2):[gr.x+qr[0],gr.y+qr[1]],Zr=Dr?Er.segpts.slice(Er.segpts.length-2):[vr.x+Br[0],vr.y+Br[1]];zr=Zr,Hr=Xr}if(jr==="inside-to-node")dr=[gr.x,gr.y];else if($r.units)dr=this.manualEndptToPx(pr,$r);else if(jr==="outside-to-line")dr=Er.tgtIntn;else if(jr==="outside-to-node"||jr==="outside-to-node-or-label"?Wr=zr:(jr==="outside-to-line"||jr==="outside-to-line-or-label")&&(Wr=[vr.x,vr.y]),dr=hr.nodeShapes[this.getNodeShape(pr)].intersectLine(gr.x,gr.y,pr.outerWidth(),pr.outerHeight(),Wr[0],Wr[1],0,Fr,Sr),jr==="outside-to-node-or-label"||jr==="outside-to-line-or-label"){var Jr=pr._private.rscratch,Qr=Jr.labelWidth,ga=Jr.labelHeight,ba=Jr.labelX,_i=Jr.labelY,os=Qr/2,ls=ga/2,ys=pr.pstyle("text-valign").value;ys==="top"?_i-=ls:ys==="bottom"&&(_i+=ls);var ns=pr.pstyle("text-halign").value;ns==="left"?ba-=os:ns==="right"&&(ba+=os);var as=polygonIntersectLine(Wr[0],Wr[1],[ba-os,_i-ls,ba+os,_i-ls,ba+os,_i+ls,ba-os,_i+ls],gr.x,gr.y);if(as.length>0){var Kr=vr,$a=sqdist(Kr,array2point(dr)),ss=sqdist(Kr,array2point(as)),hs=$a;if(ss<$a&&(dr=as,hs=ss),as.length>2){var vs=sqdist(Kr,{x:as[2],y:as[3]});vs<hs&&(dr=[as[2],as[3]])}}}var bs=shortenIntersection(dr,zr,hr.arrowShapes[mr].spacing(or)+yr),xs=shortenIntersection(dr,zr,hr.arrowShapes[mr].gap(or)+yr);if(Er.endX=xs[0],Er.endY=xs[1],Er.arrowEndX=bs[0],Er.arrowEndY=bs[1],Ir==="inside-to-node")dr=[vr.x,vr.y];else if(Or.units)dr=this.manualEndptToPx(fr,Or);else if(Ir==="outside-to-line")dr=Er.srcIntn;else if(Ir==="outside-to-node"||Ir==="outside-to-node-or-label"?Yr=Hr:(Ir==="outside-to-line"||Ir==="outside-to-line-or-label")&&(Yr=[gr.x,gr.y]),dr=hr.nodeShapes[this.getNodeShape(fr)].intersectLine(vr.x,vr.y,fr.outerWidth(),fr.outerHeight(),Yr[0],Yr[1],0,Mr,Cr),Ir==="outside-to-node-or-label"||Ir==="outside-to-line-or-label"){var fs=fr._private.rscratch,Is=fs.labelWidth,Os=fs.labelHeight,Us=fs.labelX,$s=fs.labelY,Bs=Is/2,Ns=Os/2,us=fr.pstyle("text-valign").value;us==="top"?$s-=Ns:us==="bottom"&&($s+=Ns);var na=fr.pstyle("text-halign").value;na==="left"?Us-=Bs:na==="right"&&(Us+=Bs);var ds=polygonIntersectLine(Yr[0],Yr[1],[Us-Bs,$s-Ns,Us+Bs,$s-Ns,Us+Bs,$s+Ns,Us-Bs,$s+Ns],vr.x,vr.y);if(ds.length>0){var is=gr,_a=sqdist(is,array2point(dr)),rs=sqdist(is,array2point(ds)),Cs=_a;if(rs<_a&&(dr=[ds[0],ds[1]],Cs=rs),ds.length>2){var Es=sqdist(is,{x:ds[2],y:ds[3]});Es<Cs&&(dr=[ds[2],ds[3]])}}}var Rs=shortenIntersection(dr,Hr,hr.arrowShapes[br].spacing(or)+xr),xa=shortenIntersection(dr,Hr,hr.arrowShapes[br].gap(or)+xr);Er.startX=xa[0],Er.startY=xa[1],Er.arrowStartX=Rs[0],Er.arrowStartY=Rs[1],Nr&&(!number$1(Er.startX)||!number$1(Er.startY)||!number$1(Er.endX)||!number$1(Er.endY)?Er.badLine=!0:Er.badLine=!1)};BRp$b.getSourceEndpoint=function(or){var ar=or[0]._private.rscratch;switch(this.recalculateRenderedStyle(or),ar.edgeType){case"haystack":return{x:ar.haystackPts[0],y:ar.haystackPts[1]};default:return{x:ar.arrowStartX,y:ar.arrowStartY}}};BRp$b.getTargetEndpoint=function(or){var ar=or[0]._private.rscratch;switch(this.recalculateRenderedStyle(or),ar.edgeType){case"haystack":return{x:ar.haystackPts[2],y:ar.haystackPts[3]};default:return{x:ar.arrowEndX,y:ar.arrowEndY}}};var BRp$a={};function pushBezierPts(or,ar,lr){for(var ur=function(vr,gr,mr,br){return qbezierAt(vr,gr,mr,br)},cr=ar._private,hr=cr.rstyle.bezierPts,dr=0;dr<or.bezierProjPcts.length;dr++){var fr=or.bezierProjPcts[dr];hr.push({x:ur(lr[0],lr[2],lr[4],fr),y:ur(lr[1],lr[3],lr[5],fr)})}}BRp$a.storeEdgeProjections=function(or){var ar=or._private,lr=ar.rscratch,ur=lr.edgeType;if(ar.rstyle.bezierPts=null,ar.rstyle.linePts=null,ar.rstyle.haystackPts=null,ur==="multibezier"||ur==="bezier"||ur==="self"||ur==="compound"){ar.rstyle.bezierPts=[];for(var cr=0;cr+5<lr.allpts.length;cr+=4)pushBezierPts(this,or,lr.allpts.slice(cr,cr+6))}else if(ur==="segments")for(var hr=ar.rstyle.linePts=[],cr=0;cr+1<lr.allpts.length;cr+=2)hr.push({x:lr.allpts[cr],y:lr.allpts[cr+1]});else if(ur==="haystack"){var dr=lr.haystackPts;ar.rstyle.haystackPts=[{x:dr[0],y:dr[1]},{x:dr[2],y:dr[3]}]}ar.rstyle.arrowWidth=this.getArrowWidth(or.pstyle("width").pfValue,or.pstyle("arrow-scale").value)*this.arrowShapeWidth};BRp$a.recalculateEdgeProjections=function(or){this.findEdgeControlPoints(or)};var BRp$9={};BRp$9.recalculateNodeLabelProjection=function(or){var ar=or.pstyle("label").strValue;if(!emptyString(ar)){var lr,ur,cr=or._private,hr=or.width(),dr=or.height(),fr=or.padding(),pr=or.position(),vr=or.pstyle("text-halign").strValue,gr=or.pstyle("text-valign").strValue,mr=cr.rscratch,br=cr.rstyle;switch(vr){case"left":lr=pr.x-hr/2-fr;break;case"right":lr=pr.x+hr/2+fr;break;default:lr=pr.x}switch(gr){case"top":ur=pr.y-dr/2-fr;break;case"bottom":ur=pr.y+dr/2+fr;break;default:ur=pr.y}mr.labelX=lr,mr.labelY=ur,br.labelX=lr,br.labelY=ur,this.calculateLabelAngles(or),this.applyLabelDimensions(or)}};var lineAngleFromDelta=function or(ar,lr){var ur=Math.atan(lr/ar);return ar===0&&ur<0&&(ur=ur*-1),ur},lineAngle=function or(ar,lr){var ur=lr.x-ar.x,cr=lr.y-ar.y;return lineAngleFromDelta(ur,cr)},bezierAngle=function or(ar,lr,ur,cr){var hr=bound(0,cr-.001,1),dr=bound(0,cr+.001,1),fr=qbezierPtAt(ar,lr,ur,hr),pr=qbezierPtAt(ar,lr,ur,dr);return lineAngle(fr,pr)};BRp$9.recalculateEdgeLabelProjections=function(or){var ar,lr=or._private,ur=lr.rscratch,cr=this,hr={mid:or.pstyle("label").strValue,source:or.pstyle("source-label").strValue,target:or.pstyle("target-label").strValue};if(hr.mid||hr.source||hr.target){ar={x:ur.midX,y:ur.midY};var dr=function(mr,br,yr){setPrefixedProperty(lr.rscratch,mr,br,yr),setPrefixedProperty(lr.rstyle,mr,br,yr)};dr("labelX",null,ar.x),dr("labelY",null,ar.y);var fr=lineAngleFromDelta(ur.midDispX,ur.midDispY);dr("labelAutoAngle",null,fr);var pr=function(){if(pr.cache)return pr.cache;for(var mr=[],br=0;br+5<ur.allpts.length;br+=4){var yr={x:ur.allpts[br],y:ur.allpts[br+1]},xr={x:ur.allpts[br+2],y:ur.allpts[br+3]},Cr={x:ur.allpts[br+4],y:ur.allpts[br+5]};mr.push({p0:yr,p1:xr,p2:Cr,startDist:0,length:0,segments:[]})}var Sr=lr.rstyle.bezierPts,wr=cr.bezierProjPcts.length;function Er(_r,kr,Dr,Nr,Lr){var Or=dist(kr,Dr),Ir=_r.segments[_r.segments.length-1],Mr={p0:kr,p1:Dr,t0:Nr,t1:Lr,startDist:Ir?Ir.startDist+Ir.length:0,length:Or};_r.segments.push(Mr),_r.length+=Or}for(var Ar=0;Ar<mr.length;Ar++){var Tr=mr[Ar],Rr=mr[Ar-1];Rr&&(Tr.startDist=Rr.startDist+Rr.length),Er(Tr,Tr.p0,Sr[Ar*wr],0,cr.bezierProjPcts[0]);for(var Pr=0;Pr<wr-1;Pr++)Er(Tr,Sr[Ar*wr+Pr],Sr[Ar*wr+Pr+1],cr.bezierProjPcts[Pr],cr.bezierProjPcts[Pr+1]);Er(Tr,Sr[Ar*wr+wr-1],Tr.p2,cr.bezierProjPcts[wr-1],1)}return pr.cache=mr},vr=function(mr){var br,yr=mr==="source";if(hr[mr]){var xr=or.pstyle(mr+"-text-offset").pfValue;switch(ur.edgeType){case"self":case"compound":case"bezier":case"multibezier":{for(var Cr=pr(),Sr,wr=0,Er=0,Ar=0;Ar<Cr.length;Ar++){for(var Tr=Cr[yr?Ar:Cr.length-1-Ar],Rr=0;Rr<Tr.segments.length;Rr++){var Pr=Tr.segments[yr?Rr:Tr.segments.length-1-Rr],_r=Ar===Cr.length-1&&Rr===Tr.segments.length-1;if(wr=Er,Er+=Pr.length,Er>=xr||_r){Sr={cp:Tr,segment:Pr};break}}if(Sr)break}var kr=Sr.cp,Dr=Sr.segment,Nr=(xr-wr)/Dr.length,Lr=Dr.t1-Dr.t0,Or=yr?Dr.t0+Lr*Nr:Dr.t1-Lr*Nr;Or=bound(0,Or,1),ar=qbezierPtAt(kr.p0,kr.p1,kr.p2,Or),br=bezierAngle(kr.p0,kr.p1,kr.p2,Or);break}case"straight":case"segments":case"haystack":{for(var Ir=0,Mr,$r,jr,Fr,zr=ur.allpts.length,Hr=0;Hr+3<zr&&(yr?(jr={x:ur.allpts[Hr],y:ur.allpts[Hr+1]},Fr={x:ur.allpts[Hr+2],y:ur.allpts[Hr+3]}):(jr={x:ur.allpts[zr-2-Hr],y:ur.allpts[zr-1-Hr]},Fr={x:ur.allpts[zr-4-Hr],y:ur.allpts[zr-3-Hr]}),Mr=dist(jr,Fr),$r=Ir,Ir+=Mr,!(Ir>=xr));Hr+=2);var Wr=xr-$r,Yr=Wr/Mr;Yr=bound(0,Yr,1),ar=lineAt(jr,Fr,Yr),br=lineAngle(jr,Fr);break}}dr("labelX",mr,ar.x),dr("labelY",mr,ar.y),dr("labelAutoAngle",mr,br)}};vr("source"),vr("target"),this.applyLabelDimensions(or)}};BRp$9.applyLabelDimensions=function(or){this.applyPrefixedLabelDimensions(or),or.isEdge()&&(this.applyPrefixedLabelDimensions(or,"source"),this.applyPrefixedLabelDimensions(or,"target"))};BRp$9.applyPrefixedLabelDimensions=function(or,ar){var lr=or._private,ur=this.getLabelText(or,ar),cr=hashString(ur,or._private.labelDimsKey);if(getPrefixedProperty(lr.rscratch,"prefixedLabelDimsKey",ar)!==cr){setPrefixedProperty(lr.rscratch,"prefixedLabelDimsKey",ar,cr);var hr=this.calculateLabelDimensions(or,ur),dr=or.pstyle("line-height").pfValue,fr=or.pstyle("text-wrap").strValue,pr=getPrefixedProperty(lr.rscratch,"labelWrapCachedLines",ar)||[],vr=fr!=="wrap"?1:Math.max(pr.length,1),gr=hr.height/vr,mr=gr*dr,br=hr.width,yr=hr.height+(vr-1)*(dr-1)*gr;setPrefixedProperty(lr.rstyle,"labelWidth",ar,br),setPrefixedProperty(lr.rscratch,"labelWidth",ar,br),setPrefixedProperty(lr.rstyle,"labelHeight",ar,yr),setPrefixedProperty(lr.rscratch,"labelHeight",ar,yr),setPrefixedProperty(lr.rscratch,"labelLineHeight",ar,mr)}};BRp$9.getLabelText=function(or,ar){var lr=or._private,ur=ar?ar+"-":"",cr=or.pstyle(ur+"label").strValue,hr=or.pstyle("text-transform").value,dr=function(Br,Ur){return Ur?(setPrefixedProperty(lr.rscratch,Br,ar,Ur),Ur):getPrefixedProperty(lr.rscratch,Br,ar)};if(!cr)return"";hr=="none"||(hr=="uppercase"?cr=cr.toUpperCase():hr=="lowercase"&&(cr=cr.toLowerCase()));var fr=or.pstyle("text-wrap").value;if(fr==="wrap"){var pr=dr("labelKey");if(pr!=null&&dr("labelWrapKey")===pr)return dr("labelWrapCachedText");for(var vr="",gr=cr.split(`
`),mr=or.pstyle("text-max-width").pfValue,br=or.pstyle("text-overflow-wrap").value,yr=br==="anywhere",xr=[],Cr=/[\s\u200b]+|$/g,Sr=0;Sr<gr.length;Sr++){var wr=gr[Sr],Er=this.calculateLabelDimensions(or,wr),Ar=Er.width;if(yr){var Tr=wr.split("").join(vr);wr=Tr}if(Ar>mr){var Rr=wr.matchAll(Cr),Pr="",_r=0,kr=_createForOfIteratorHelper(Rr),Dr;try{for(kr.s();!(Dr=kr.n()).done;){var Nr=Dr.value,Lr=Nr[0],Or=wr.substring(_r,Nr.index);_r=Nr.index+Lr.length;var Ir=Pr.length===0?Or:Pr+Or+Lr,Mr=this.calculateLabelDimensions(or,Ir),$r=Mr.width;$r<=mr?Pr+=Or+Lr:(Pr&&xr.push(Pr),Pr=Or+Lr)}}catch(qr){kr.e(qr)}finally{kr.f()}Pr.match(/^[\s\u200b]+$/)||xr.push(Pr)}else xr.push(wr)}dr("labelWrapCachedLines",xr),cr=dr("labelWrapCachedText",xr.join(`
`)),dr("labelWrapKey",pr)}else if(fr==="ellipsis"){var jr=or.pstyle("text-max-width").pfValue,Fr="",zr="",Hr=!1;if(this.calculateLabelDimensions(or,cr).width<jr)return cr;for(var Wr=0;Wr<cr.length;Wr++){var Yr=this.calculateLabelDimensions(or,Fr+cr[Wr]+zr).width;if(Yr>jr)break;Fr+=cr[Wr],Wr===cr.length-1&&(Hr=!0)}return Hr||(Fr+=zr),Fr}return cr};BRp$9.getLabelJustification=function(or){var ar=or.pstyle("text-justification").strValue,lr=or.pstyle("text-halign").strValue;if(ar==="auto")if(or.isNode())switch(lr){case"left":return"right";case"right":return"left";default:return"center"}else return"center";else return ar};BRp$9.calculateLabelDimensions=function(or,ar){var lr=this,ur=lr.cy.window(),cr=ur.document,hr=0,dr=or.pstyle("font-style").strValue,fr=or.pstyle("font-size").pfValue,pr=or.pstyle("font-family").strValue,vr=or.pstyle("font-weight").strValue,gr=this.labelCalcCanvas,mr=this.labelCalcCanvasContext;if(!gr){gr=this.labelCalcCanvas=cr.createElement("canvas"),mr=this.labelCalcCanvasContext=gr.getContext("2d");var br=gr.style;br.position="absolute",br.left="-9999px",br.top="-9999px",br.zIndex="-1",br.visibility="hidden",br.pointerEvents="none"}mr.font="".concat(dr," ").concat(vr," ").concat(fr,"px ").concat(pr);for(var yr=0,xr=0,Cr=ar.split(`
`),Sr=0;Sr<Cr.length;Sr++){var wr=Cr[Sr],Er=mr.measureText(wr),Ar=Math.ceil(Er.width),Tr=fr;yr=Math.max(Ar,yr),xr+=Tr}return yr+=hr,xr+=hr,{width:yr,height:xr}};BRp$9.calculateLabelAngle=function(or,ar){var lr=or._private,ur=lr.rscratch,cr=or.isEdge(),hr=ar?ar+"-":"",dr=or.pstyle(hr+"text-rotation"),fr=dr.strValue;return fr==="none"?0:cr&&fr==="autorotate"?ur.labelAutoAngle:fr==="autorotate"?0:dr.pfValue};BRp$9.calculateLabelAngles=function(or){var ar=this,lr=or.isEdge(),ur=or._private,cr=ur.rscratch;cr.labelAngle=ar.calculateLabelAngle(or),lr&&(cr.sourceLabelAngle=ar.calculateLabelAngle(or,"source"),cr.targetLabelAngle=ar.calculateLabelAngle(or,"target"))};var BRp$8={},TOO_SMALL_CUT_RECT=28,warnedCutRect=!1;BRp$8.getNodeShape=function(or){var ar=this,lr=or.pstyle("shape").value;if(lr==="cutrectangle"&&(or.width()<TOO_SMALL_CUT_RECT||or.height()<TOO_SMALL_CUT_RECT))return warnedCutRect||(warn("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),warnedCutRect=!0),"rectangle";if(or.isParent())return lr==="rectangle"||lr==="roundrectangle"||lr==="round-rectangle"||lr==="cutrectangle"||lr==="cut-rectangle"||lr==="barrel"?lr:"rectangle";if(lr==="polygon"){var ur=or.pstyle("shape-polygon-points").value;return ar.nodeShapes.makePolygon(ur).name}return lr};var BRp$7={};BRp$7.registerCalculationListeners=function(){var or=this.cy,ar=or.collection(),lr=this,ur=function(dr){var fr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(ar.merge(dr),fr)for(var pr=0;pr<dr.length;pr++){var vr=dr[pr],gr=vr._private,mr=gr.rstyle;mr.clean=!1,mr.cleanConnected=!1}};lr.binder(or).on("bounds.* dirty.*",function(dr){var fr=dr.target;ur(fr)}).on("style.* background.*",function(dr){var fr=dr.target;ur(fr,!1)});var cr=function(dr){if(dr){var fr=lr.onUpdateEleCalcsFns;ar.cleanStyle();for(var pr=0;pr<ar.length;pr++){var vr=ar[pr],gr=vr._private.rstyle;vr.isNode()&&!gr.cleanConnected&&(ur(vr.connectedEdges()),gr.cleanConnected=!0)}if(fr)for(var mr=0;mr<fr.length;mr++){var br=fr[mr];br(dr,ar)}lr.recalculateRenderedStyle(ar),ar=or.collection()}};lr.flushRenderedStyleQueue=function(){cr(!0)},lr.beforeRender(cr,lr.beforeRenderPriorities.eleCalcs)};BRp$7.onUpdateEleCalcs=function(or){var ar=this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[];ar.push(or)};BRp$7.recalculateRenderedStyle=function(or,ar){var lr=function(Tr){return Tr._private.rstyle.cleanConnected};if(or.length!==0){var ur=[],cr=[];if(!this.destroyed){ar===void 0&&(ar=!0);for(var hr=0;hr<or.length;hr++){var dr=or[hr],fr=dr._private,pr=fr.rstyle;dr.isEdge()&&(!lr(dr.source())||!lr(dr.target()))&&(pr.clean=!1),dr.isEdge()&&dr.isBundledBezier()&&dr.parallelEdges().some(function(Ar){return!Ar._private.rstyle.clean&&Ar.isBundledBezier()})&&(pr.clean=!1),!(ar&&pr.clean||dr.removed())&&dr.pstyle("display").value!=="none"&&(fr.group==="nodes"?cr.push(dr):ur.push(dr),pr.clean=!0)}for(var vr=0;vr<cr.length;vr++){var gr=cr[vr],mr=gr._private,br=mr.rstyle,yr=gr.position();this.recalculateNodeLabelProjection(gr),br.nodeX=yr.x,br.nodeY=yr.y,br.nodeW=gr.pstyle("width").pfValue,br.nodeH=gr.pstyle("height").pfValue}this.recalculateEdgeProjections(ur);for(var xr=0;xr<ur.length;xr++){var Cr=ur[xr],Sr=Cr._private,wr=Sr.rstyle,Er=Sr.rscratch;wr.srcX=Er.arrowStartX,wr.srcY=Er.arrowStartY,wr.tgtX=Er.arrowEndX,wr.tgtY=Er.arrowEndY,wr.midX=Er.midX,wr.midY=Er.midY,wr.labelAngle=Er.labelAngle,wr.sourceLabelAngle=Er.sourceLabelAngle,wr.targetLabelAngle=Er.targetLabelAngle}}}};var BRp$6={};BRp$6.updateCachedGrabbedEles=function(){var or=this.cachedZSortedEles;if(or){or.drag=[],or.nondrag=[];for(var ar=[],lr=0;lr<or.length;lr++){var ur=or[lr],cr=ur._private.rscratch;ur.grabbed()&&!ur.isParent()?ar.push(ur):cr.inDragLayer?or.drag.push(ur):or.nondrag.push(ur)}for(var lr=0;lr<ar.length;lr++){var ur=ar[lr];or.drag.push(ur)}}};BRp$6.invalidateCachedZSortedEles=function(){this.cachedZSortedEles=null};BRp$6.getCachedZSortedEles=function(or){if(or||!this.cachedZSortedEles){var ar=this.cy.mutableElements().toArray();ar.sort(zIndexSort),ar.interactive=ar.filter(function(lr){return lr.interactive()}),this.cachedZSortedEles=ar,this.updateCachedGrabbedEles()}else ar=this.cachedZSortedEles;return ar};var BRp$5={};[BRp$e,BRp$d,BRp$c,BRp$b,BRp$a,BRp$9,BRp$8,BRp$7,BRp$6].forEach(function(or){extend(BRp$5,or)});var BRp$4={};BRp$4.getCachedImage=function(or,ar,lr){var ur=this,cr=ur.imageCache=ur.imageCache||{},hr=cr[or];if(hr)return hr.image.complete||hr.image.addEventListener("load",lr),hr.image;hr=cr[or]=cr[or]||{};var dr=hr.image=new Image;dr.addEventListener("load",lr),dr.addEventListener("error",function(){dr.error=!0});var fr="data:",pr=or.substring(0,fr.length).toLowerCase()===fr;return pr||(ar=ar==="null"?null:ar,dr.crossOrigin=ar),dr.src=or,dr};var BRp$3={};BRp$3.registerBinding=function(or,ar,lr,ur){var cr=Array.prototype.slice.apply(arguments,[1]);if(Array.isArray(or)){for(var hr=[],dr=0;dr<or.length;dr++){var fr=or[dr];if(fr!==void 0){var pr=this.binder(fr);hr.push(pr.on.apply(pr,cr))}}return hr}var pr=this.binder(or);return pr.on.apply(pr,cr)};BRp$3.binder=function(or){var ar=this,lr=ar.cy.window(),ur=or===lr||or===lr.document||or===lr.document.body||domElement(or);if(ar.supportsPassiveEvents==null){var cr=!1;try{var hr=Object.defineProperty({},"passive",{get:function(){return cr=!0,!0}});lr.addEventListener("test",null,hr)}catch{}ar.supportsPassiveEvents=cr}var dr=function(pr,vr,gr){var mr=Array.prototype.slice.call(arguments);return ur&&ar.supportsPassiveEvents&&(mr[2]={capture:gr??!1,passive:!1,once:!1}),ar.bindings.push({target:or,args:mr}),(or.addEventListener||or.on).apply(or,mr),this};return{on:dr,addEventListener:dr,addListener:dr,bind:dr}};BRp$3.nodeIsDraggable=function(or){return or&&or.isNode()&&!or.locked()&&or.grabbable()};BRp$3.nodeIsGrabbable=function(or){return this.nodeIsDraggable(or)&&or.interactive()};BRp$3.load=function(){var or=this,ar=or.cy.window(),lr=function(na){return na.selected()},ur=function(na){var ds=na.getRootNode();if(ds&&ds.nodeType===11&&ds.host!==void 0)return ds},cr=function(na,ds,is,_a){na==null&&(na=or.cy);for(var rs=0;rs<ds.length;rs++){var Cs=ds[rs];na.emit({originalEvent:is,type:Cs,position:_a})}},hr=function(na){return na.shiftKey||na.metaKey||na.ctrlKey},dr=function(na,ds){var is=!0;if(or.cy.hasCompoundNodes()&&na&&na.pannable())for(var _a=0;ds&&_a<ds.length;_a++){var na=ds[_a];if(na.isNode()&&na.isParent()&&!na.pannable()){is=!1;break}}else is=!0;return is},fr=function(na){na[0]._private.grabbed=!0},pr=function(na){na[0]._private.grabbed=!1},vr=function(na){na[0]._private.rscratch.inDragLayer=!0},gr=function(na){na[0]._private.rscratch.inDragLayer=!1},mr=function(na){na[0]._private.rscratch.isGrabTarget=!0},br=function(na){na[0]._private.rscratch.isGrabTarget=!1},yr=function(na,ds){var is=ds.addToList,_a=is.has(na);!_a&&na.grabbable()&&!na.locked()&&(is.merge(na),fr(na))},xr=function(na,ds){if(na.cy().hasCompoundNodes()&&!(ds.inDragLayer==null&&ds.addToList==null)){var is=na.descendants();ds.inDragLayer&&(is.forEach(vr),is.connectedEdges().forEach(vr)),ds.addToList&&yr(is,ds)}},Cr=function(na,ds){ds=ds||{};var is=na.cy().hasCompoundNodes();ds.inDragLayer&&(na.forEach(vr),na.neighborhood().stdFilter(function(_a){return!is||_a.isEdge()}).forEach(vr)),ds.addToList&&na.forEach(function(_a){yr(_a,ds)}),xr(na,ds),Er(na,{inDragLayer:ds.inDragLayer}),or.updateCachedGrabbedEles()},Sr=Cr,wr=function(na){na&&(or.getCachedZSortedEles().forEach(function(ds){pr(ds),gr(ds),br(ds)}),or.updateCachedGrabbedEles())},Er=function(na,ds){if(!(ds.inDragLayer==null&&ds.addToList==null)&&na.cy().hasCompoundNodes()){var is=na.ancestors().orphans();if(!is.same(na)){var _a=is.descendants().spawnSelf().merge(is).unmerge(na).unmerge(na.descendants()),rs=_a.connectedEdges();ds.inDragLayer&&(rs.forEach(vr),_a.forEach(vr)),ds.addToList&&_a.forEach(function(Cs){yr(Cs,ds)})}}},Ar=function(){document.activeElement!=null&&document.activeElement.blur!=null&&document.activeElement.blur()},Tr=typeof MutationObserver<"u",Rr=typeof ResizeObserver<"u";Tr?(or.removeObserver=new MutationObserver(function(us){for(var na=0;na<us.length;na++){var ds=us[na],is=ds.removedNodes;if(is)for(var _a=0;_a<is.length;_a++){var rs=is[_a];if(rs===or.container){or.destroy();break}}}}),or.container.parentNode&&or.removeObserver.observe(or.container.parentNode,{childList:!0})):or.registerBinding(or.container,"DOMNodeRemoved",function(us){or.destroy()});var Pr=debounce(function(){or.cy.resize()},100);Tr&&(or.styleObserver=new MutationObserver(Pr),or.styleObserver.observe(or.container,{attributes:!0})),or.registerBinding(ar,"resize",Pr),Rr&&(or.resizeObserver=new ResizeObserver(Pr),or.resizeObserver.observe(or.container));var _r=function(na,ds){for(;na!=null;)ds(na),na=na.parentNode},kr=function(){or.invalidateContainerClientCoordsCache()};_r(or.container,function(us){or.registerBinding(us,"transitionend",kr),or.registerBinding(us,"animationend",kr),or.registerBinding(us,"scroll",kr)}),or.registerBinding(or.container,"contextmenu",function(us){us.preventDefault()});var Dr=function(){return or.selection[4]!==0},Nr=function(na){for(var ds=or.findContainerClientCoords(),is=ds[0],_a=ds[1],rs=ds[2],Cs=ds[3],Es=na.touches?na.touches:[na],Rs=!1,xa=0;xa<Es.length;xa++){var ps=Es[xa];if(is<=ps.clientX&&ps.clientX<=is+rs&&_a<=ps.clientY&&ps.clientY<=_a+Cs){Rs=!0;break}}if(!Rs)return!1;for(var Ps=or.container,Ms=na.target,Ls=Ms.parentNode,Ds=!1;Ls;){if(Ls===Ps){Ds=!0;break}Ls=Ls.parentNode}return!!Ds};or.registerBinding(or.container,"mousedown",function(na){if(Nr(na)&&!(or.hoverData.which===1&&na.which!==1)){na.preventDefault(),Ar(),or.hoverData.capture=!0,or.hoverData.which=na.which;var ds=or.cy,is=[na.clientX,na.clientY],_a=or.projectIntoViewport(is[0],is[1]),rs=or.selection,Cs=or.findNearestElements(_a[0],_a[1],!0,!1),Es=Cs[0],Rs=or.dragData.possibleDragElements;or.hoverData.mdownPos=_a,or.hoverData.mdownGPos=is;var xa=function(es){return{originalEvent:na,type:es,position:{x:_a[0],y:_a[1]}}},ps=function(){or.hoverData.tapholdCancelled=!1,clearTimeout(or.hoverData.tapholdTimeout),or.hoverData.tapholdTimeout=setTimeout(function(){if(!or.hoverData.tapholdCancelled){var es=or.hoverData.down;es?es.emit(xa("taphold")):ds.emit(xa("taphold"))}},or.tapholdDuration)};if(na.which==3){or.hoverData.cxtStarted=!0;var Ps={originalEvent:na,type:"cxttapstart",position:{x:_a[0],y:_a[1]}};Es?(Es.activate(),Es.emit(Ps),or.hoverData.down=Es):ds.emit(Ps),or.hoverData.downTime=new Date().getTime(),or.hoverData.cxtDragged=!1}else if(na.which==1){Es&&Es.activate();{if(Es!=null&&or.nodeIsGrabbable(Es)){var Ms=function(es){es.emit(xa("grab"))};if(mr(Es),!Es.selected())Rs=or.dragData.possibleDragElements=ds.collection(),Sr(Es,{addToList:Rs}),Es.emit(xa("grabon")).emit(xa("grab"));else{Rs=or.dragData.possibleDragElements=ds.collection();var Ls=ds.$(function(Ds){return Ds.isNode()&&Ds.selected()&&or.nodeIsGrabbable(Ds)});Cr(Ls,{addToList:Rs}),Es.emit(xa("grabon")),Ls.forEach(Ms)}or.redrawHint("eles",!0),or.redrawHint("drag",!0)}or.hoverData.down=Es,or.hoverData.downs=Cs,or.hoverData.downTime=new Date().getTime()}cr(Es,["mousedown","tapstart","vmousedown"],na,{x:_a[0],y:_a[1]}),Es==null?(rs[4]=1,or.data.bgActivePosistion={x:_a[0],y:_a[1]},or.redrawHint("select",!0),or.redraw()):Es.pannable()&&(rs[4]=1),ps()}rs[0]=rs[2]=_a[0],rs[1]=rs[3]=_a[1]}},!1);var Lr=ur(or.container);or.registerBinding([ar,Lr],"mousemove",function(na){var ds=or.hoverData.capture;if(!(!ds&&!Nr(na))){var is=!1,_a=or.cy,rs=_a.zoom(),Cs=[na.clientX,na.clientY],Es=or.projectIntoViewport(Cs[0],Cs[1]),Rs=or.hoverData.mdownPos,xa=or.hoverData.mdownGPos,ps=or.selection,Ps=null;!or.hoverData.draggingEles&&!or.hoverData.dragging&&!or.hoverData.selecting&&(Ps=or.findNearestElement(Es[0],Es[1],!0,!1));var Ms=or.hoverData.last,Ls=or.hoverData.down,Ds=[Es[0]-ps[2],Es[1]-ps[3]],es=or.dragData.possibleDragElements,ts;if(xa){var cs=Cs[0]-xa[0],gs=cs*cs,Ss=Cs[1]-xa[1],As=Ss*Ss,ks=gs+As;or.hoverData.isOverThresholdDrag=ts=ks>=or.desktopTapThreshold2}var js=hr(na);ts&&(or.hoverData.tapholdCancelled=!0);var zs=function(){var to=or.hoverData.dragDelta=or.hoverData.dragDelta||[];to.length===0?(to.push(Ds[0]),to.push(Ds[1])):(to[0]+=Ds[0],to[1]+=Ds[1])};is=!0,cr(Ps,["mousemove","vmousemove","tapdrag"],na,{x:Es[0],y:Es[1]});var Fs=function(to){return{originalEvent:na,type:to,position:{x:Es[0],y:Es[1]}}},qs=function(){or.data.bgActivePosistion=void 0,or.hoverData.selecting||_a.emit(Fs("boxstart")),ps[4]=1,or.hoverData.selecting=!0,or.redrawHint("select",!0),or.redraw()};if(or.hoverData.which===3){if(ts){var Hs=Fs("cxtdrag");Ls?Ls.emit(Hs):_a.emit(Hs),or.hoverData.cxtDragged=!0,(!or.hoverData.cxtOver||Ps!==or.hoverData.cxtOver)&&(or.hoverData.cxtOver&&or.hoverData.cxtOver.emit(Fs("cxtdragout")),or.hoverData.cxtOver=Ps,Ps&&Ps.emit(Fs("cxtdragover")))}}else if(or.hoverData.dragging){if(is=!0,_a.panningEnabled()&&_a.userPanningEnabled()){var Vs;if(or.hoverData.justStartedPan){var Gs=or.hoverData.mdownPos;Vs={x:(Es[0]-Gs[0])*rs,y:(Es[1]-Gs[1])*rs},or.hoverData.justStartedPan=!1}else Vs={x:Ds[0]*rs,y:Ds[1]*rs};_a.panBy(Vs),_a.emit(Fs("dragpan")),or.hoverData.dragged=!0}Es=or.projectIntoViewport(na.clientX,na.clientY)}else if(ps[4]==1&&(Ls==null||Ls.pannable())){if(ts){if(!or.hoverData.dragging&&_a.boxSelectionEnabled()&&(js||!_a.panningEnabled()||!_a.userPanningEnabled()))qs();else if(!or.hoverData.selecting&&_a.panningEnabled()&&_a.userPanningEnabled()){var Ws=dr(Ls,or.hoverData.downs);Ws&&(or.hoverData.dragging=!0,or.hoverData.justStartedPan=!0,ps[4]=0,or.data.bgActivePosistion=array2point(Rs),or.redrawHint("select",!0),or.redraw())}Ls&&Ls.pannable()&&Ls.active()&&Ls.unactivate()}}else{if(Ls&&Ls.pannable()&&Ls.active()&&Ls.unactivate(),(!Ls||!Ls.grabbed())&&Ps!=Ms&&(Ms&&cr(Ms,["mouseout","tapdragout"],na,{x:Es[0],y:Es[1]}),Ps&&cr(Ps,["mouseover","tapdragover"],na,{x:Es[0],y:Es[1]}),or.hoverData.last=Ps),Ls)if(ts){if(_a.boxSelectionEnabled()&&js)Ls&&Ls.grabbed()&&(wr(es),Ls.emit(Fs("freeon")),es.emit(Fs("free")),or.dragData.didDrag&&(Ls.emit(Fs("dragfreeon")),es.emit(Fs("dragfree")))),qs();else if(Ls&&Ls.grabbed()&&or.nodeIsDraggable(Ls)){var Xs=!or.dragData.didDrag;Xs&&or.redrawHint("eles",!0),or.dragData.didDrag=!0,or.hoverData.draggingEles||Cr(es,{inDragLayer:!0});var Ys={x:0,y:0};if(number$1(Ds[0])&&number$1(Ds[1])&&(Ys.x+=Ds[0],Ys.y+=Ds[1],Xs)){var Qs=or.hoverData.dragDelta;Qs&&number$1(Qs[0])&&number$1(Qs[1])&&(Ys.x+=Qs[0],Ys.y+=Qs[1])}or.hoverData.draggingEles=!0,es.silentShift(Ys).emit(Fs("position")).emit(Fs("drag")),or.redrawHint("drag",!0),or.redraw()}}else zs();is=!0}if(ps[2]=Es[0],ps[3]=Es[1],is)return na.stopPropagation&&na.stopPropagation(),na.preventDefault&&na.preventDefault(),!1}},!1);var Or,Ir,Mr;or.registerBinding(ar,"mouseup",function(na){if(!(or.hoverData.which===1&&na.which!==1&&or.hoverData.capture)){var ds=or.hoverData.capture;if(ds){or.hoverData.capture=!1;var is=or.cy,_a=or.projectIntoViewport(na.clientX,na.clientY),rs=or.selection,Cs=or.findNearestElement(_a[0],_a[1],!0,!1),Es=or.dragData.possibleDragElements,Rs=or.hoverData.down,xa=hr(na);or.data.bgActivePosistion&&(or.redrawHint("select",!0),or.redraw()),or.hoverData.tapholdCancelled=!0,or.data.bgActivePosistion=void 0,Rs&&Rs.unactivate();var ps=function(cs){return{originalEvent:na,type:cs,position:{x:_a[0],y:_a[1]}}};if(or.hoverData.which===3){var Ps=ps("cxttapend");if(Rs?Rs.emit(Ps):is.emit(Ps),!or.hoverData.cxtDragged){var Ms=ps("cxttap");Rs?Rs.emit(Ms):is.emit(Ms)}or.hoverData.cxtDragged=!1,or.hoverData.which=null}else if(or.hoverData.which===1){if(cr(Cs,["mouseup","tapend","vmouseup"],na,{x:_a[0],y:_a[1]}),!or.dragData.didDrag&&!or.hoverData.dragged&&!or.hoverData.selecting&&!or.hoverData.isOverThresholdDrag&&(cr(Rs,["click","tap","vclick"],na,{x:_a[0],y:_a[1]}),Ir=!1,na.timeStamp-Mr<=is.multiClickDebounceTime()?(Or&&clearTimeout(Or),Ir=!0,Mr=null,cr(Rs,["dblclick","dbltap","vdblclick"],na,{x:_a[0],y:_a[1]})):(Or=setTimeout(function(){Ir||cr(Rs,["oneclick","onetap","voneclick"],na,{x:_a[0],y:_a[1]})},is.multiClickDebounceTime()),Mr=na.timeStamp)),Rs==null&&!or.dragData.didDrag&&!or.hoverData.selecting&&!or.hoverData.dragged&&!hr(na)&&(is.$(lr).unselect(["tapunselect"]),Es.length>0&&or.redrawHint("eles",!0),or.dragData.possibleDragElements=Es=is.collection()),Cs==Rs&&!or.dragData.didDrag&&!or.hoverData.selecting&&Cs!=null&&Cs._private.selectable&&(or.hoverData.dragging||(is.selectionType()==="additive"||xa?Cs.selected()?Cs.unselect(["tapunselect"]):Cs.select(["tapselect"]):xa||(is.$(lr).unmerge(Cs).unselect(["tapunselect"]),Cs.select(["tapselect"]))),or.redrawHint("eles",!0)),or.hoverData.selecting){var Ls=is.collection(or.getAllInBox(rs[0],rs[1],rs[2],rs[3]));or.redrawHint("select",!0),Ls.length>0&&or.redrawHint("eles",!0),is.emit(ps("boxend"));var Ds=function(cs){return cs.selectable()&&!cs.selected()};is.selectionType()==="additive"||xa||is.$(lr).unmerge(Ls).unselect(),Ls.emit(ps("box")).stdFilter(Ds).select().emit(ps("boxselect")),or.redraw()}if(or.hoverData.dragging&&(or.hoverData.dragging=!1,or.redrawHint("select",!0),or.redrawHint("eles",!0),or.redraw()),!rs[4]){or.redrawHint("drag",!0),or.redrawHint("eles",!0);var es=Rs&&Rs.grabbed();wr(Es),es&&(Rs.emit(ps("freeon")),Es.emit(ps("free")),or.dragData.didDrag&&(Rs.emit(ps("dragfreeon")),Es.emit(ps("dragfree"))))}}rs[4]=0,or.hoverData.down=null,or.hoverData.cxtStarted=!1,or.hoverData.draggingEles=!1,or.hoverData.selecting=!1,or.hoverData.isOverThresholdDrag=!1,or.dragData.didDrag=!1,or.hoverData.dragged=!1,or.hoverData.dragDelta=[],or.hoverData.mdownPos=null,or.hoverData.mdownGPos=null,or.hoverData.which=null}}},!1);var $r=[],jr=4,Fr,zr=1e5,Hr=function(na,ds){for(var is=0;is<na.length;is++)if(na[is]%ds!==0)return!1;return!0},Wr=function(na){for(var ds=Math.abs(na[0]),is=1;is<na.length;is++)if(Math.abs(na[is])!==ds)return!1;return!0},Yr=function(na){var ds=!1,is=na.deltaY;if(is==null&&(na.wheelDeltaY!=null?is=na.wheelDeltaY/4:na.wheelDelta!=null&&(is=na.wheelDelta/4)),is!==0){if(Fr==null)if($r.length>=jr){var _a=$r;if(Fr=Hr(_a,5),!Fr){var rs=Math.abs(_a[0]);Fr=Wr(_a)&&rs>5}if(Fr)for(var Cs=0;Cs<_a.length;Cs++)zr=Math.min(Math.abs(_a[Cs]),zr)}else $r.push(is),ds=!0;else Fr&&(zr=Math.min(Math.abs(is),zr));if(!or.scrollingPage){var Es=or.cy,Rs=Es.zoom(),xa=Es.pan(),ps=or.projectIntoViewport(na.clientX,na.clientY),Ps=[ps[0]*Rs+xa.x,ps[1]*Rs+xa.y];if(or.hoverData.draggingEles||or.hoverData.dragging||or.hoverData.cxtStarted||Dr()){na.preventDefault();return}if(Es.panningEnabled()&&Es.userPanningEnabled()&&Es.zoomingEnabled()&&Es.userZoomingEnabled()){na.preventDefault(),or.data.wheelZooming=!0,clearTimeout(or.data.wheelTimeout),or.data.wheelTimeout=setTimeout(function(){or.data.wheelZooming=!1,or.redrawHint("eles",!0),or.redraw()},150);var Ms;ds&&Math.abs(is)>5&&(is=signum(is)*5),Ms=is/-250,Fr&&(Ms/=zr,Ms*=3),Ms=Ms*or.wheelSensitivity;var Ls=na.deltaMode===1;Ls&&(Ms*=33);var Ds=Es.zoom()*Math.pow(10,Ms);na.type==="gesturechange"&&(Ds=or.gestureStartZoom*na.scale),Es.zoom({level:Ds,renderedPosition:{x:Ps[0],y:Ps[1]}}),Es.emit({type:na.type==="gesturechange"?"pinchzoom":"scrollzoom",originalEvent:na,position:{x:ps[0],y:ps[1]}})}}}};or.registerBinding(or.container,"wheel",Yr,!0),or.registerBinding(ar,"scroll",function(na){or.scrollingPage=!0,clearTimeout(or.scrollingPageTimeout),or.scrollingPageTimeout=setTimeout(function(){or.scrollingPage=!1},250)},!0),or.registerBinding(or.container,"gesturestart",function(na){or.gestureStartZoom=or.cy.zoom(),or.hasTouchStarted||na.preventDefault()},!0),or.registerBinding(or.container,"gesturechange",function(us){or.hasTouchStarted||Yr(us)},!0),or.registerBinding(or.container,"mouseout",function(na){var ds=or.projectIntoViewport(na.clientX,na.clientY);or.cy.emit({originalEvent:na,type:"mouseout",position:{x:ds[0],y:ds[1]}})},!1),or.registerBinding(or.container,"mouseover",function(na){var ds=or.projectIntoViewport(na.clientX,na.clientY);or.cy.emit({originalEvent:na,type:"mouseover",position:{x:ds[0],y:ds[1]}})},!1);var qr,Br,Ur,Vr,Xr,Zr,Jr,Qr,ga,ba,_i,os,ls,ys=function(na,ds,is,_a){return Math.sqrt((is-na)*(is-na)+(_a-ds)*(_a-ds))},ns=function(na,ds,is,_a){return(is-na)*(is-na)+(_a-ds)*(_a-ds)},as;or.registerBinding(or.container,"touchstart",as=function(na){if(or.hasTouchStarted=!0,!!Nr(na)){Ar(),or.touchData.capture=!0,or.data.bgActivePosistion=void 0;var ds=or.cy,is=or.touchData.now,_a=or.touchData.earlier;if(na.touches[0]){var rs=or.projectIntoViewport(na.touches[0].clientX,na.touches[0].clientY);is[0]=rs[0],is[1]=rs[1]}if(na.touches[1]){var rs=or.projectIntoViewport(na.touches[1].clientX,na.touches[1].clientY);is[2]=rs[0],is[3]=rs[1]}if(na.touches[2]){var rs=or.projectIntoViewport(na.touches[2].clientX,na.touches[2].clientY);is[4]=rs[0],is[5]=rs[1]}var Cs=function(js){return{originalEvent:na,type:js,position:{x:is[0],y:is[1]}}};if(na.touches[1]){or.touchData.singleTouchMoved=!0,wr(or.dragData.touchDragEles);var Es=or.findContainerClientCoords();ga=Es[0],ba=Es[1],_i=Es[2],os=Es[3],qr=na.touches[0].clientX-ga,Br=na.touches[0].clientY-ba,Ur=na.touches[1].clientX-ga,Vr=na.touches[1].clientY-ba,ls=0<=qr&&qr<=_i&&0<=Ur&&Ur<=_i&&0<=Br&&Br<=os&&0<=Vr&&Vr<=os;var Rs=ds.pan(),xa=ds.zoom();Xr=ys(qr,Br,Ur,Vr),Zr=ns(qr,Br,Ur,Vr),Jr=[(qr+Ur)/2,(Br+Vr)/2],Qr=[(Jr[0]-Rs.x)/xa,(Jr[1]-Rs.y)/xa];var ps=200,Ps=ps*ps;if(Zr<Ps&&!na.touches[2]){var Ms=or.findNearestElement(is[0],is[1],!0,!0),Ls=or.findNearestElement(is[2],is[3],!0,!0);Ms&&Ms.isNode()?(Ms.activate().emit(Cs("cxttapstart")),or.touchData.start=Ms):Ls&&Ls.isNode()?(Ls.activate().emit(Cs("cxttapstart")),or.touchData.start=Ls):ds.emit(Cs("cxttapstart")),or.touchData.start&&(or.touchData.start._private.grabbed=!1),or.touchData.cxt=!0,or.touchData.cxtDragged=!1,or.data.bgActivePosistion=void 0,or.redraw();return}}if(na.touches[2])ds.boxSelectionEnabled()&&na.preventDefault();else if(!na.touches[1]){if(na.touches[0]){var Ds=or.findNearestElements(is[0],is[1],!0,!0),es=Ds[0];if(es!=null&&(es.activate(),or.touchData.start=es,or.touchData.starts=Ds,or.nodeIsGrabbable(es))){var ts=or.dragData.touchDragEles=ds.collection(),cs=null;or.redrawHint("eles",!0),or.redrawHint("drag",!0),es.selected()?(cs=ds.$(function(ks){return ks.selected()&&or.nodeIsGrabbable(ks)}),Cr(cs,{addToList:ts})):Sr(es,{addToList:ts}),mr(es),es.emit(Cs("grabon")),cs?cs.forEach(function(ks){ks.emit(Cs("grab"))}):es.emit(Cs("grab"))}cr(es,["touchstart","tapstart","vmousedown"],na,{x:is[0],y:is[1]}),es==null&&(or.data.bgActivePosistion={x:rs[0],y:rs[1]},or.redrawHint("select",!0),or.redraw()),or.touchData.singleTouchMoved=!1,or.touchData.singleTouchStartTime=+new Date,clearTimeout(or.touchData.tapholdTimeout),or.touchData.tapholdTimeout=setTimeout(function(){or.touchData.singleTouchMoved===!1&&!or.pinching&&!or.touchData.selecting&&cr(or.touchData.start,["taphold"],na,{x:is[0],y:is[1]})},or.tapholdDuration)}}if(na.touches.length>=1){for(var gs=or.touchData.startPosition=[null,null,null,null,null,null],Ss=0;Ss<is.length;Ss++)gs[Ss]=_a[Ss]=is[Ss];var As=na.touches[0];or.touchData.startGPosition=[As.clientX,As.clientY]}}},!1);var Kr;or.registerBinding(ar,"touchmove",Kr=function(na){var ds=or.touchData.capture;if(!(!ds&&!Nr(na))){var is=or.selection,_a=or.cy,rs=or.touchData.now,Cs=or.touchData.earlier,Es=_a.zoom();if(na.touches[0]){var Rs=or.projectIntoViewport(na.touches[0].clientX,na.touches[0].clientY);rs[0]=Rs[0],rs[1]=Rs[1]}if(na.touches[1]){var Rs=or.projectIntoViewport(na.touches[1].clientX,na.touches[1].clientY);rs[2]=Rs[0],rs[3]=Rs[1]}if(na.touches[2]){var Rs=or.projectIntoViewport(na.touches[2].clientX,na.touches[2].clientY);rs[4]=Rs[0],rs[5]=Rs[1]}var xa=function(Ou){return{originalEvent:na,type:Ou,position:{x:rs[0],y:rs[1]}}},ps=or.touchData.startGPosition,Ps;if(ds&&na.touches[0]&&ps){for(var Ms=[],Ls=0;Ls<rs.length;Ls++)Ms[Ls]=rs[Ls]-Cs[Ls];var Ds=na.touches[0].clientX-ps[0],es=Ds*Ds,ts=na.touches[0].clientY-ps[1],cs=ts*ts,gs=es+cs;Ps=gs>=or.touchTapThreshold2}if(ds&&or.touchData.cxt){na.preventDefault();var Ss=na.touches[0].clientX-ga,As=na.touches[0].clientY-ba,ks=na.touches[1].clientX-ga,js=na.touches[1].clientY-ba,zs=ns(Ss,As,ks,js),Fs=zs/Zr,qs=150,Hs=qs*qs,Vs=1.5,Gs=Vs*Vs;if(Fs>=Gs||zs>=Hs){or.touchData.cxt=!1,or.data.bgActivePosistion=void 0,or.redrawHint("select",!0);var Ws=xa("cxttapend");or.touchData.start?(or.touchData.start.unactivate().emit(Ws),or.touchData.start=null):_a.emit(Ws)}}if(ds&&or.touchData.cxt){var Ws=xa("cxtdrag");or.data.bgActivePosistion=void 0,or.redrawHint("select",!0),or.touchData.start?or.touchData.start.emit(Ws):_a.emit(Ws),or.touchData.start&&(or.touchData.start._private.grabbed=!1),or.touchData.cxtDragged=!0;var Xs=or.findNearestElement(rs[0],rs[1],!0,!0);(!or.touchData.cxtOver||Xs!==or.touchData.cxtOver)&&(or.touchData.cxtOver&&or.touchData.cxtOver.emit(xa("cxtdragout")),or.touchData.cxtOver=Xs,Xs&&Xs.emit(xa("cxtdragover")))}else if(ds&&na.touches[2]&&_a.boxSelectionEnabled())na.preventDefault(),or.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,or.touchData.selecting||_a.emit(xa("boxstart")),or.touchData.selecting=!0,or.touchData.didSelect=!0,is[4]=1,!is||is.length===0||is[0]===void 0?(is[0]=(rs[0]+rs[2]+rs[4])/3,is[1]=(rs[1]+rs[3]+rs[5])/3,is[2]=(rs[0]+rs[2]+rs[4])/3+1,is[3]=(rs[1]+rs[3]+rs[5])/3+1):(is[2]=(rs[0]+rs[2]+rs[4])/3,is[3]=(rs[1]+rs[3]+rs[5])/3),or.redrawHint("select",!0),or.redraw();else if(ds&&na.touches[1]&&!or.touchData.didSelect&&_a.zoomingEnabled()&&_a.panningEnabled()&&_a.userZoomingEnabled()&&_a.userPanningEnabled()){na.preventDefault(),or.data.bgActivePosistion=void 0,or.redrawHint("select",!0);var Ys=or.dragData.touchDragEles;if(Ys){or.redrawHint("drag",!0);for(var Qs=0;Qs<Ys.length;Qs++){var Js=Ys[Qs]._private;Js.grabbed=!1,Js.rscratch.inDragLayer=!1}}var to=or.touchData.start,Ss=na.touches[0].clientX-ga,As=na.touches[0].clientY-ba,ks=na.touches[1].clientX-ga,js=na.touches[1].clientY-ba,ao=ys(Ss,As,ks,js),so=ao/Xr;if(ls){var co=Ss-qr,Mo=As-Br,wo=ks-Ur,Xo=js-Vr,Eo=(co+wo)/2,Lo=(Mo+Xo)/2,ho=_a.zoom(),fo=ho*so,po=_a.pan(),ro=Qr[0]*ho+po.x,Ks=Qr[1]*ho+po.y,eo={x:-fo/ho*(ro-po.x-Eo)+ro,y:-fo/ho*(Ks-po.y-Lo)+Ks};if(to&&to.active()){var Ys=or.dragData.touchDragEles;wr(Ys),or.redrawHint("drag",!0),or.redrawHint("eles",!0),to.unactivate().emit(xa("freeon")),Ys.emit(xa("free")),or.dragData.didDrag&&(to.emit(xa("dragfreeon")),Ys.emit(xa("dragfree")))}_a.viewport({zoom:fo,pan:eo,cancelOnFailedZoom:!0}),_a.emit(xa("pinchzoom")),Xr=ao,qr=Ss,Br=As,Ur=ks,Vr=js,or.pinching=!0}if(na.touches[0]){var Rs=or.projectIntoViewport(na.touches[0].clientX,na.touches[0].clientY);rs[0]=Rs[0],rs[1]=Rs[1]}if(na.touches[1]){var Rs=or.projectIntoViewport(na.touches[1].clientX,na.touches[1].clientY);rs[2]=Rs[0],rs[3]=Rs[1]}if(na.touches[2]){var Rs=or.projectIntoViewport(na.touches[2].clientX,na.touches[2].clientY);rs[4]=Rs[0],rs[5]=Rs[1]}}else if(na.touches[0]&&!or.touchData.didSelect){var no=or.touchData.start,io=or.touchData.last,Xs;if(!or.hoverData.draggingEles&&!or.swipePanning&&(Xs=or.findNearestElement(rs[0],rs[1],!0,!0)),ds&&no!=null&&na.preventDefault(),ds&&no!=null&&or.nodeIsDraggable(no))if(Ps){var Ys=or.dragData.touchDragEles,Zl=!or.dragData.didDrag;Zl&&Cr(Ys,{inDragLayer:!0}),or.dragData.didDrag=!0;var Co={x:0,y:0};if(number$1(Ms[0])&&number$1(Ms[1])&&(Co.x+=Ms[0],Co.y+=Ms[1],Zl)){or.redrawHint("eles",!0);var lo=or.touchData.dragDelta;lo&&number$1(lo[0])&&number$1(lo[1])&&(Co.x+=lo[0],Co.y+=lo[1])}or.hoverData.draggingEles=!0,Ys.silentShift(Co).emit(xa("position")).emit(xa("drag")),or.redrawHint("drag",!0),or.touchData.startPosition[0]==Cs[0]&&or.touchData.startPosition[1]==Cs[1]&&or.redrawHint("eles",!0),or.redraw()}else{var lo=or.touchData.dragDelta=or.touchData.dragDelta||[];lo.length===0?(lo.push(Ms[0]),lo.push(Ms[1])):(lo[0]+=Ms[0],lo[1]+=Ms[1])}if(cr(no||Xs,["touchmove","tapdrag","vmousemove"],na,{x:rs[0],y:rs[1]}),(!no||!no.grabbed())&&Xs!=io&&(io&&io.emit(xa("tapdragout")),Xs&&Xs.emit(xa("tapdragover"))),or.touchData.last=Xs,ds)for(var Qs=0;Qs<rs.length;Qs++)rs[Qs]&&or.touchData.startPosition[Qs]&&Ps&&(or.touchData.singleTouchMoved=!0);if(ds&&(no==null||no.pannable())&&_a.panningEnabled()&&_a.userPanningEnabled()){var Nu=dr(no,or.touchData.starts);Nu&&(na.preventDefault(),or.data.bgActivePosistion||(or.data.bgActivePosistion=array2point(or.touchData.startPosition)),or.swipePanning?(_a.panBy({x:Ms[0]*Es,y:Ms[1]*Es}),_a.emit(xa("dragpan"))):Ps&&(or.swipePanning=!0,_a.panBy({x:Ds*Es,y:ts*Es}),_a.emit(xa("dragpan")),no&&(no.unactivate(),or.redrawHint("select",!0),or.touchData.start=null)));var Rs=or.projectIntoViewport(na.touches[0].clientX,na.touches[0].clientY);rs[0]=Rs[0],rs[1]=Rs[1]}}for(var Ls=0;Ls<rs.length;Ls++)Cs[Ls]=rs[Ls];ds&&na.touches.length>0&&!or.hoverData.draggingEles&&!or.swipePanning&&or.data.bgActivePosistion!=null&&(or.data.bgActivePosistion=void 0,or.redrawHint("select",!0),or.redraw())}},!1);var $a;or.registerBinding(ar,"touchcancel",$a=function(na){var ds=or.touchData.start;or.touchData.capture=!1,ds&&ds.unactivate()});var ss,hs,vs,bs;if(or.registerBinding(ar,"touchend",ss=function(na){var ds=or.touchData.start,is=or.touchData.capture;if(is)na.touches.length===0&&(or.touchData.capture=!1),na.preventDefault();else return;var _a=or.selection;or.swipePanning=!1,or.hoverData.draggingEles=!1;var rs=or.cy,Cs=rs.zoom(),Es=or.touchData.now,Rs=or.touchData.earlier;if(na.touches[0]){var xa=or.projectIntoViewport(na.touches[0].clientX,na.touches[0].clientY);Es[0]=xa[0],Es[1]=xa[1]}if(na.touches[1]){var xa=or.projectIntoViewport(na.touches[1].clientX,na.touches[1].clientY);Es[2]=xa[0],Es[3]=xa[1]}if(na.touches[2]){var xa=or.projectIntoViewport(na.touches[2].clientX,na.touches[2].clientY);Es[4]=xa[0],Es[5]=xa[1]}var ps=function(Hs){return{originalEvent:na,type:Hs,position:{x:Es[0],y:Es[1]}}};ds&&ds.unactivate();var Ps;if(or.touchData.cxt){if(Ps=ps("cxttapend"),ds?ds.emit(Ps):rs.emit(Ps),!or.touchData.cxtDragged){var Ms=ps("cxttap");ds?ds.emit(Ms):rs.emit(Ms)}or.touchData.start&&(or.touchData.start._private.grabbed=!1),or.touchData.cxt=!1,or.touchData.start=null,or.redraw();return}if(!na.touches[2]&&rs.boxSelectionEnabled()&&or.touchData.selecting){or.touchData.selecting=!1;var Ls=rs.collection(or.getAllInBox(_a[0],_a[1],_a[2],_a[3]));_a[0]=void 0,_a[1]=void 0,_a[2]=void 0,_a[3]=void 0,_a[4]=0,or.redrawHint("select",!0),rs.emit(ps("boxend"));var Ds=function(Hs){return Hs.selectable()&&!Hs.selected()};Ls.emit(ps("box")).stdFilter(Ds).select().emit(ps("boxselect")),Ls.nonempty()&&or.redrawHint("eles",!0),or.redraw()}if(ds!=null&&ds.unactivate(),na.touches[2])or.data.bgActivePosistion=void 0,or.redrawHint("select",!0);else if(!na.touches[1]){if(!na.touches[0]){if(!na.touches[0]){or.data.bgActivePosistion=void 0,or.redrawHint("select",!0);var es=or.dragData.touchDragEles;if(ds!=null){var ts=ds._private.grabbed;wr(es),or.redrawHint("drag",!0),or.redrawHint("eles",!0),ts&&(ds.emit(ps("freeon")),es.emit(ps("free")),or.dragData.didDrag&&(ds.emit(ps("dragfreeon")),es.emit(ps("dragfree")))),cr(ds,["touchend","tapend","vmouseup","tapdragout"],na,{x:Es[0],y:Es[1]}),ds.unactivate(),or.touchData.start=null}else{var cs=or.findNearestElement(Es[0],Es[1],!0,!0);cr(cs,["touchend","tapend","vmouseup","tapdragout"],na,{x:Es[0],y:Es[1]})}var gs=or.touchData.startPosition[0]-Es[0],Ss=gs*gs,As=or.touchData.startPosition[1]-Es[1],ks=As*As,js=Ss+ks,zs=js*Cs*Cs;or.touchData.singleTouchMoved||(ds||rs.$(":selected").unselect(["tapunselect"]),cr(ds,["tap","vclick"],na,{x:Es[0],y:Es[1]}),hs=!1,na.timeStamp-bs<=rs.multiClickDebounceTime()?(vs&&clearTimeout(vs),hs=!0,bs=null,cr(ds,["dbltap","vdblclick"],na,{x:Es[0],y:Es[1]})):(vs=setTimeout(function(){hs||cr(ds,["onetap","voneclick"],na,{x:Es[0],y:Es[1]})},rs.multiClickDebounceTime()),bs=na.timeStamp)),ds!=null&&!or.dragData.didDrag&&ds._private.selectable&&zs<or.touchTapThreshold2&&!or.pinching&&(rs.selectionType()==="single"?(rs.$(lr).unmerge(ds).unselect(["tapunselect"]),ds.select(["tapselect"])):ds.selected()?ds.unselect(["tapunselect"]):ds.select(["tapselect"]),or.redrawHint("eles",!0)),or.touchData.singleTouchMoved=!0}}}for(var Fs=0;Fs<Es.length;Fs++)Rs[Fs]=Es[Fs];or.dragData.didDrag=!1,na.touches.length===0&&(or.touchData.dragDelta=[],or.touchData.startPosition=[null,null,null,null,null,null],or.touchData.startGPosition=null,or.touchData.didSelect=!1),na.touches.length<2&&(na.touches.length===1&&(or.touchData.startGPosition=[na.touches[0].clientX,na.touches[0].clientY]),or.pinching=!1,or.redrawHint("eles",!0),or.redraw())},!1),typeof TouchEvent>"u"){var xs=[],fs=function(na){return{clientX:na.clientX,clientY:na.clientY,force:1,identifier:na.pointerId,pageX:na.pageX,pageY:na.pageY,radiusX:na.width/2,radiusY:na.height/2,screenX:na.screenX,screenY:na.screenY,target:na.target}},Is=function(na){return{event:na,touch:fs(na)}},Os=function(na){xs.push(Is(na))},Us=function(na){for(var ds=0;ds<xs.length;ds++){var is=xs[ds];if(is.event.pointerId===na.pointerId){xs.splice(ds,1);return}}},$s=function(na){var ds=xs.filter(function(is){return is.event.pointerId===na.pointerId})[0];ds.event=na,ds.touch=fs(na)},Bs=function(na){na.touches=xs.map(function(ds){return ds.touch})},Ns=function(na){return na.pointerType==="mouse"||na.pointerType===4};or.registerBinding(or.container,"pointerdown",function(us){Ns(us)||(us.preventDefault(),Os(us),Bs(us),as(us))}),or.registerBinding(or.container,"pointerup",function(us){Ns(us)||(Us(us),Bs(us),ss(us))}),or.registerBinding(or.container,"pointercancel",function(us){Ns(us)||(Us(us),Bs(us),$a(us))}),or.registerBinding(or.container,"pointermove",function(us){Ns(us)||(us.preventDefault(),$s(us),Bs(us),Kr(us))})}};var BRp$2={};BRp$2.generatePolygon=function(or,ar){return this.nodeShapes[or]={renderer:this,name:or,points:ar,draw:function(ur,cr,hr,dr,fr,pr){this.renderer.nodeShapeImpl("polygon",ur,cr,hr,dr,fr,this.points)},intersectLine:function(ur,cr,hr,dr,fr,pr,vr,gr){return polygonIntersectLine(fr,pr,this.points,ur,cr,hr/2,dr/2,vr)},checkPoint:function(ur,cr,hr,dr,fr,pr,vr,gr){return pointInsidePolygon(ur,cr,this.points,pr,vr,dr,fr,[0,-1],hr)},hasMiterBounds:or!=="rectangle",miterBounds:function(ur,cr,hr,dr,fr,pr){return miterBox(this.points,ur,cr,hr,dr,fr)}}};BRp$2.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(ar,lr,ur,cr,hr,dr){this.renderer.nodeShapeImpl(this.name,ar,lr,ur,cr,hr)},intersectLine:function(ar,lr,ur,cr,hr,dr,fr,pr){return intersectLineEllipse(hr,dr,ar,lr,ur/2+fr,cr/2+fr)},checkPoint:function(ar,lr,ur,cr,hr,dr,fr,pr){return checkInEllipse(ar,lr,cr,hr,dr,fr,ur)}}};BRp$2.generateRoundPolygon=function(or,ar){return this.nodeShapes[or]={renderer:this,name:or,points:ar,getOrCreateCorners:function(ur,cr,hr,dr,fr,pr,vr){if(pr[vr]!==void 0&&pr[vr+"-cx"]===ur&&pr[vr+"-cy"]===cr)return pr[vr];pr[vr]=new Array(ar.length/2),pr[vr+"-cx"]=ur,pr[vr+"-cy"]=cr;var gr=hr/2,mr=dr/2;fr=fr==="auto"?getRoundPolygonRadius(hr,dr):fr;for(var br=new Array(ar.length/2),yr=0;yr<ar.length/2;yr++)br[yr]={x:ur+gr*ar[yr*2],y:cr+mr*ar[yr*2+1]};var xr,Cr,Sr,wr,Er=br.length;for(Cr=br[Er-1],xr=0;xr<Er;xr++)Sr=br[xr%Er],wr=br[(xr+1)%Er],pr[vr][xr]=getRoundCorner(Cr,Sr,wr,fr),Cr=Sr,Sr=wr;return pr[vr]},draw:function(ur,cr,hr,dr,fr,pr,vr){this.renderer.nodeShapeImpl("round-polygon",ur,cr,hr,dr,fr,this.points,this.getOrCreateCorners(cr,hr,dr,fr,pr,vr,"drawCorners"))},intersectLine:function(ur,cr,hr,dr,fr,pr,vr,gr,mr){return roundPolygonIntersectLine(fr,pr,this.points,ur,cr,hr,dr,vr,this.getOrCreateCorners(ur,cr,hr,dr,gr,mr,"corners"))},checkPoint:function(ur,cr,hr,dr,fr,pr,vr,gr,mr){return pointInsideRoundPolygon(ur,cr,this.points,pr,vr,dr,fr,this.getOrCreateCorners(pr,vr,dr,fr,gr,mr,"corners"))}}};BRp$2.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(ar,lr,ur,cr,hr,dr){this.renderer.nodeShapeImpl(this.name,ar,lr,ur,cr,hr,this.points,dr)},intersectLine:function(ar,lr,ur,cr,hr,dr,fr,pr){return roundRectangleIntersectLine(hr,dr,ar,lr,ur,cr,fr,pr)},checkPoint:function(ar,lr,ur,cr,hr,dr,fr,pr){var vr=cr/2,gr=hr/2;pr=pr==="auto"?getRoundRectangleRadius(cr,hr):pr,pr=Math.min(vr,gr,pr);var mr=pr*2;return!!(pointInsidePolygon(ar,lr,this.points,dr,fr,cr,hr-mr,[0,-1],ur)||pointInsidePolygon(ar,lr,this.points,dr,fr,cr-mr,hr,[0,-1],ur)||checkInEllipse(ar,lr,mr,mr,dr-vr+pr,fr-gr+pr,ur)||checkInEllipse(ar,lr,mr,mr,dr+vr-pr,fr-gr+pr,ur)||checkInEllipse(ar,lr,mr,mr,dr+vr-pr,fr+gr-pr,ur)||checkInEllipse(ar,lr,mr,mr,dr-vr+pr,fr+gr-pr,ur))}}};BRp$2.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:getCutRectangleCornerLength(),points:generateUnitNgonPointsFitToSquare(4,0),draw:function(ar,lr,ur,cr,hr,dr){this.renderer.nodeShapeImpl(this.name,ar,lr,ur,cr,hr,null,dr)},generateCutTrianglePts:function(ar,lr,ur,cr,hr){var dr=hr==="auto"?this.cornerLength:hr,fr=lr/2,pr=ar/2,vr=ur-pr,gr=ur+pr,mr=cr-fr,br=cr+fr;return{topLeft:[vr,mr+dr,vr+dr,mr,vr+dr,mr+dr],topRight:[gr-dr,mr,gr,mr+dr,gr-dr,mr+dr],bottomRight:[gr,br-dr,gr-dr,br,gr-dr,br-dr],bottomLeft:[vr+dr,br,vr,br-dr,vr+dr,br-dr]}},intersectLine:function(ar,lr,ur,cr,hr,dr,fr,pr){var vr=this.generateCutTrianglePts(ur+2*fr,cr+2*fr,ar,lr,pr),gr=[].concat.apply([],[vr.topLeft.splice(0,4),vr.topRight.splice(0,4),vr.bottomRight.splice(0,4),vr.bottomLeft.splice(0,4)]);return polygonIntersectLine(hr,dr,gr,ar,lr)},checkPoint:function(ar,lr,ur,cr,hr,dr,fr,pr){var vr=pr==="auto"?this.cornerLength:pr;if(pointInsidePolygon(ar,lr,this.points,dr,fr,cr,hr-2*vr,[0,-1],ur)||pointInsidePolygon(ar,lr,this.points,dr,fr,cr-2*vr,hr,[0,-1],ur))return!0;var gr=this.generateCutTrianglePts(cr,hr,dr,fr);return pointInsidePolygonPoints(ar,lr,gr.topLeft)||pointInsidePolygonPoints(ar,lr,gr.topRight)||pointInsidePolygonPoints(ar,lr,gr.bottomRight)||pointInsidePolygonPoints(ar,lr,gr.bottomLeft)}}};BRp$2.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(ar,lr,ur,cr,hr,dr){this.renderer.nodeShapeImpl(this.name,ar,lr,ur,cr,hr)},intersectLine:function(ar,lr,ur,cr,hr,dr,fr,pr){var vr=.15,gr=.5,mr=.85,br=this.generateBarrelBezierPts(ur+2*fr,cr+2*fr,ar,lr),yr=function(Sr){var wr=qbezierPtAt({x:Sr[0],y:Sr[1]},{x:Sr[2],y:Sr[3]},{x:Sr[4],y:Sr[5]},vr),Er=qbezierPtAt({x:Sr[0],y:Sr[1]},{x:Sr[2],y:Sr[3]},{x:Sr[4],y:Sr[5]},gr),Ar=qbezierPtAt({x:Sr[0],y:Sr[1]},{x:Sr[2],y:Sr[3]},{x:Sr[4],y:Sr[5]},mr);return[Sr[0],Sr[1],wr.x,wr.y,Er.x,Er.y,Ar.x,Ar.y,Sr[4],Sr[5]]},xr=[].concat(yr(br.topLeft),yr(br.topRight),yr(br.bottomRight),yr(br.bottomLeft));return polygonIntersectLine(hr,dr,xr,ar,lr)},generateBarrelBezierPts:function(ar,lr,ur,cr){var hr=lr/2,dr=ar/2,fr=ur-dr,pr=ur+dr,vr=cr-hr,gr=cr+hr,mr=getBarrelCurveConstants(ar,lr),br=mr.heightOffset,yr=mr.widthOffset,xr=mr.ctrlPtOffsetPct*ar,Cr={topLeft:[fr,vr+br,fr+xr,vr,fr+yr,vr],topRight:[pr-yr,vr,pr-xr,vr,pr,vr+br],bottomRight:[pr,gr-br,pr-xr,gr,pr-yr,gr],bottomLeft:[fr+yr,gr,fr+xr,gr,fr,gr-br]};return Cr.topLeft.isTop=!0,Cr.topRight.isTop=!0,Cr.bottomLeft.isBottom=!0,Cr.bottomRight.isBottom=!0,Cr},checkPoint:function(ar,lr,ur,cr,hr,dr,fr,pr){var vr=getBarrelCurveConstants(cr,hr),gr=vr.heightOffset,mr=vr.widthOffset;if(pointInsidePolygon(ar,lr,this.points,dr,fr,cr,hr-2*gr,[0,-1],ur)||pointInsidePolygon(ar,lr,this.points,dr,fr,cr-2*mr,hr,[0,-1],ur))return!0;for(var br=this.generateBarrelBezierPts(cr,hr,dr,fr),yr=function(kr,Dr,Nr){var Lr=Nr[4],Or=Nr[2],Ir=Nr[0],Mr=Nr[5],$r=Nr[1],jr=Math.min(Lr,Ir),Fr=Math.max(Lr,Ir),zr=Math.min(Mr,$r),Hr=Math.max(Mr,$r);if(jr<=kr&&kr<=Fr&&zr<=Dr&&Dr<=Hr){var Wr=bezierPtsToQuadCoeff(Lr,Or,Ir),Yr=solveQuadratic(Wr[0],Wr[1],Wr[2],kr),qr=Yr.filter(function(Br){return 0<=Br&&Br<=1});if(qr.length>0)return qr[0]}return null},xr=Object.keys(br),Cr=0;Cr<xr.length;Cr++){var Sr=xr[Cr],wr=br[Sr],Er=yr(ar,lr,wr);if(Er!=null){var Ar=wr[5],Tr=wr[3],Rr=wr[1],Pr=qbezierAt(Ar,Tr,Rr,Er);if(wr.isTop&&Pr<=lr||wr.isBottom&&lr<=Pr)return!0}}return!1}}};BRp$2.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:generateUnitNgonPointsFitToSquare(4,0),draw:function(ar,lr,ur,cr,hr,dr){this.renderer.nodeShapeImpl(this.name,ar,lr,ur,cr,hr,this.points,dr)},intersectLine:function(ar,lr,ur,cr,hr,dr,fr,pr){var vr=ar-(ur/2+fr),gr=lr-(cr/2+fr),mr=gr,br=ar+(ur/2+fr),yr=finiteLinesIntersect(hr,dr,ar,lr,vr,gr,br,mr,!1);return yr.length>0?yr:roundRectangleIntersectLine(hr,dr,ar,lr,ur,cr,fr,pr)},checkPoint:function(ar,lr,ur,cr,hr,dr,fr,pr){pr=pr==="auto"?getRoundRectangleRadius(cr,hr):pr;var vr=2*pr;if(pointInsidePolygon(ar,lr,this.points,dr,fr,cr,hr-vr,[0,-1],ur)||pointInsidePolygon(ar,lr,this.points,dr,fr,cr-vr,hr,[0,-1],ur))return!0;var gr=cr/2+2*ur,mr=hr/2+2*ur,br=[dr-gr,fr-mr,dr-gr,fr,dr+gr,fr,dr+gr,fr-mr];return!!(pointInsidePolygonPoints(ar,lr,br)||checkInEllipse(ar,lr,vr,vr,dr+cr/2-pr,fr+hr/2-pr,ur)||checkInEllipse(ar,lr,vr,vr,dr-cr/2+pr,fr+hr/2-pr,ur))}}};BRp$2.registerNodeShapes=function(){var or=this.nodeShapes={},ar=this;this.generateEllipse(),this.generatePolygon("triangle",generateUnitNgonPointsFitToSquare(3,0)),this.generateRoundPolygon("round-triangle",generateUnitNgonPointsFitToSquare(3,0)),this.generatePolygon("rectangle",generateUnitNgonPointsFitToSquare(4,0)),or.square=or.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle();{var lr=[0,1,1,0,0,-1,-1,0];this.generatePolygon("diamond",lr),this.generateRoundPolygon("round-diamond",lr)}this.generatePolygon("pentagon",generateUnitNgonPointsFitToSquare(5,0)),this.generateRoundPolygon("round-pentagon",generateUnitNgonPointsFitToSquare(5,0)),this.generatePolygon("hexagon",generateUnitNgonPointsFitToSquare(6,0)),this.generateRoundPolygon("round-hexagon",generateUnitNgonPointsFitToSquare(6,0)),this.generatePolygon("heptagon",generateUnitNgonPointsFitToSquare(7,0)),this.generateRoundPolygon("round-heptagon",generateUnitNgonPointsFitToSquare(7,0)),this.generatePolygon("octagon",generateUnitNgonPointsFitToSquare(8,0)),this.generateRoundPolygon("round-octagon",generateUnitNgonPointsFitToSquare(8,0));var ur=new Array(20);{var cr=generateUnitNgonPoints(5,0),hr=generateUnitNgonPoints(5,Math.PI/5),dr=.5*(3-Math.sqrt(5));dr*=1.57;for(var fr=0;fr<hr.length/2;fr++)hr[fr*2]*=dr,hr[fr*2+1]*=dr;for(var fr=0;fr<20/4;fr++)ur[fr*4]=cr[fr*2],ur[fr*4+1]=cr[fr*2+1],ur[fr*4+2]=hr[fr*2],ur[fr*4+3]=hr[fr*2+1]}ur=fitPolygonToSquare(ur),this.generatePolygon("star",ur),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.generatePolygon("right-rhomboid",[-.333,-1,1,-1,.333,1,-1,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]);{var pr=[-1,-1,.25,-1,1,0,.25,1,-1,1];this.generatePolygon("tag",pr),this.generateRoundPolygon("round-tag",pr)}or.makePolygon=function(vr){var gr=vr.join("$"),mr="polygon-"+gr,br;return(br=this[mr])?br:ar.generatePolygon(mr,vr)}};var BRp$1={};BRp$1.timeToRender=function(){return this.redrawTotalTime/this.redrawCount};BRp$1.redraw=function(or){or=or||staticEmptyObject();var ar=this;ar.averageRedrawTime===void 0&&(ar.averageRedrawTime=0),ar.lastRedrawTime===void 0&&(ar.lastRedrawTime=0),ar.lastDrawTime===void 0&&(ar.lastDrawTime=0),ar.requestedFrame=!0,ar.renderOptions=or};BRp$1.beforeRender=function(or,ar){if(!this.destroyed){ar==null&&error("Priority is not optional for beforeRender");var lr=this.beforeRenderCallbacks;lr.push({fn:or,priority:ar}),lr.sort(function(ur,cr){return cr.priority-ur.priority})}};var beforeRenderCallbacks=function or(ar,lr,ur){for(var cr=ar.beforeRenderCallbacks,hr=0;hr<cr.length;hr++)cr[hr].fn(lr,ur)};BRp$1.startRenderLoop=function(){var or=this,ar=or.cy;if(!or.renderLoopStarted){or.renderLoopStarted=!0;var lr=function(cr){if(!or.destroyed){if(!ar.batching())if(or.requestedFrame&&!or.skipFrame){beforeRenderCallbacks(or,!0,cr);var hr=performanceNow();or.render(or.renderOptions);var dr=or.lastDrawTime=performanceNow();or.averageRedrawTime===void 0&&(or.averageRedrawTime=dr-hr),or.redrawCount===void 0&&(or.redrawCount=0),or.redrawCount++,or.redrawTotalTime===void 0&&(or.redrawTotalTime=0);var fr=dr-hr;or.redrawTotalTime+=fr,or.lastRedrawTime=fr,or.averageRedrawTime=or.averageRedrawTime/2+fr/2,or.requestedFrame=!1}else beforeRenderCallbacks(or,!1,cr);or.skipFrame=!1,requestAnimationFrame(lr)}};requestAnimationFrame(lr)}};var BaseRenderer=function or(ar){this.init(ar)},BR=BaseRenderer,BRp=BR.prototype;BRp.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"];BRp.init=function(or){var ar=this;ar.options=or,ar.cy=or.cy;var lr=ar.container=or.cy.container(),ur=ar.cy.window();if(ur){var cr=ur.document,hr=cr.head,dr="__________cytoscape_stylesheet",fr="__________cytoscape_container",pr=cr.getElementById(dr)!=null;if(lr.className.indexOf(fr)<0&&(lr.className=(lr.className||"")+" "+fr),!pr){var vr=cr.createElement("style");vr.id=dr,vr.textContent="."+fr+" { position: relative; }",hr.insertBefore(vr,hr.children[0])}var gr=ur.getComputedStyle(lr),mr=gr.getPropertyValue("position");mr==="static"&&warn("A Cytoscape container has style position:static and so can not use UI extensions properly")}ar.selection=[void 0,void 0,void 0,void 0,0],ar.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],ar.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},ar.dragData={possibleDragElements:[]},ar.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},ar.redraws=0,ar.showFps=or.showFps,ar.debug=or.debug,ar.webgl=or.webgl,ar.hideEdgesOnViewport=or.hideEdgesOnViewport,ar.textureOnViewport=or.textureOnViewport,ar.wheelSensitivity=or.wheelSensitivity,ar.motionBlurEnabled=or.motionBlur,ar.forcedPixelRatio=number$1(or.pixelRatio)?or.pixelRatio:null,ar.motionBlur=or.motionBlur,ar.motionBlurOpacity=or.motionBlurOpacity,ar.motionBlurTransparency=1-ar.motionBlurOpacity,ar.motionBlurPxRatio=1,ar.mbPxRBlurry=1,ar.minMbLowQualFrames=4,ar.fullQualityMb=!1,ar.clearedForMotionBlur=[],ar.desktopTapThreshold=or.desktopTapThreshold,ar.desktopTapThreshold2=or.desktopTapThreshold*or.desktopTapThreshold,ar.touchTapThreshold=or.touchTapThreshold,ar.touchTapThreshold2=or.touchTapThreshold*or.touchTapThreshold,ar.tapholdDuration=500,ar.bindings=[],ar.beforeRenderCallbacks=[],ar.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},ar.registerNodeShapes(),ar.registerArrowShapes(),ar.registerCalculationListeners()};BRp.notify=function(or,ar){var lr=this,ur=lr.cy;if(!this.destroyed){if(or==="init"){lr.load();return}if(or==="destroy"){lr.destroy();return}(or==="add"||or==="remove"||or==="move"&&ur.hasCompoundNodes()||or==="load"||or==="zorder"||or==="mount")&&lr.invalidateCachedZSortedEles(),or==="viewport"&&lr.redrawHint("select",!0),or==="gc"&&lr.redrawHint("gc",!0),(or==="load"||or==="resize"||or==="mount")&&(lr.invalidateContainerClientCoordsCache(),lr.matchCanvasSize(lr.container)),lr.redrawHint("eles",!0),lr.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()}};BRp.destroy=function(){var or=this;or.destroyed=!0,or.cy.stopAnimationLoop();for(var ar=0;ar<or.bindings.length;ar++){var lr=or.bindings[ar],ur=lr,cr=ur.target;(cr.off||cr.removeEventListener).apply(cr,ur.args)}if(or.bindings=[],or.beforeRenderCallbacks=[],or.onUpdateEleCalcsFns=[],or.removeObserver&&or.removeObserver.disconnect(),or.styleObserver&&or.styleObserver.disconnect(),or.resizeObserver&&or.resizeObserver.disconnect(),or.labelCalcDiv)try{document.body.removeChild(or.labelCalcDiv)}catch{}};BRp.isHeadless=function(){return!1};[BRp$f,BRp$5,BRp$4,BRp$3,BRp$2,BRp$1].forEach(function(or){extend(BRp,or)});var fullFpsTime=1e3/60,defs={setupDequeueing:function or(ar){return function(){var ur=this,cr=this.renderer;if(!ur.dequeueingSetup){ur.dequeueingSetup=!0;var hr=debounce(function(){cr.redrawHint("eles",!0),cr.redrawHint("drag",!0),cr.redraw()},ar.deqRedrawThreshold),dr=function(vr,gr){var mr=performanceNow(),br=cr.averageRedrawTime,yr=cr.lastRedrawTime,xr=[],Cr=cr.cy.extent(),Sr=cr.getPixelRatio();for(vr||cr.flushRenderedStyleQueue();;){var wr=performanceNow(),Er=wr-mr,Ar=wr-gr;if(yr<fullFpsTime){var Tr=fullFpsTime-(vr?br:0);if(Ar>=ar.deqFastCost*Tr)break}else if(vr){if(Er>=ar.deqCost*yr||Er>=ar.deqAvgCost*br)break}else if(Ar>=ar.deqNoDrawCost*fullFpsTime)break;var Rr=ar.deq(ur,Sr,Cr);if(Rr.length>0)for(var Pr=0;Pr<Rr.length;Pr++)xr.push(Rr[Pr]);else break}xr.length>0&&(ar.onDeqd(ur,xr),!vr&&ar.shouldRedraw(ur,xr,Sr,Cr)&&hr())},fr=ar.priority||noop$1;cr.beforeRender(dr,fr(ur))}}}},ElementTextureCacheLookup=function(){function or(ar){var lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:falsify;_classCallCheck(this,or),this.idsByKey=new Map$1,this.keyForId=new Map$1,this.cachesByLvl=new Map$1,this.lvls=[],this.getKey=ar,this.doesEleInvalidateKey=lr}return _createClass(or,[{key:"getIdsFor",value:function(lr){lr==null&&error("Can not get id list for null key");var ur=this.idsByKey,cr=this.idsByKey.get(lr);return cr||(cr=new Set$1,ur.set(lr,cr)),cr}},{key:"addIdForKey",value:function(lr,ur){lr!=null&&this.getIdsFor(lr).add(ur)}},{key:"deleteIdForKey",value:function(lr,ur){lr!=null&&this.getIdsFor(lr).delete(ur)}},{key:"getNumberOfIdsForKey",value:function(lr){return lr==null?0:this.getIdsFor(lr).size}},{key:"updateKeyMappingFor",value:function(lr){var ur=lr.id(),cr=this.keyForId.get(ur),hr=this.getKey(lr);this.deleteIdForKey(cr,ur),this.addIdForKey(hr,ur),this.keyForId.set(ur,hr)}},{key:"deleteKeyMappingFor",value:function(lr){var ur=lr.id(),cr=this.keyForId.get(ur);this.deleteIdForKey(cr,ur),this.keyForId.delete(ur)}},{key:"keyHasChangedFor",value:function(lr){var ur=lr.id(),cr=this.keyForId.get(ur),hr=this.getKey(lr);return cr!==hr}},{key:"isInvalid",value:function(lr){return this.keyHasChangedFor(lr)||this.doesEleInvalidateKey(lr)}},{key:"getCachesAt",value:function(lr){var ur=this.cachesByLvl,cr=this.lvls,hr=ur.get(lr);return hr||(hr=new Map$1,ur.set(lr,hr),cr.push(lr)),hr}},{key:"getCache",value:function(lr,ur){return this.getCachesAt(ur).get(lr)}},{key:"get",value:function(lr,ur){var cr=this.getKey(lr),hr=this.getCache(cr,ur);return hr!=null&&this.updateKeyMappingFor(lr),hr}},{key:"getForCachedKey",value:function(lr,ur){var cr=this.keyForId.get(lr.id()),hr=this.getCache(cr,ur);return hr}},{key:"hasCache",value:function(lr,ur){return this.getCachesAt(ur).has(lr)}},{key:"has",value:function(lr,ur){var cr=this.getKey(lr);return this.hasCache(cr,ur)}},{key:"setCache",value:function(lr,ur,cr){cr.key=lr,this.getCachesAt(ur).set(lr,cr)}},{key:"set",value:function(lr,ur,cr){var hr=this.getKey(lr);this.setCache(hr,ur,cr),this.updateKeyMappingFor(lr)}},{key:"deleteCache",value:function(lr,ur){this.getCachesAt(ur).delete(lr)}},{key:"delete",value:function(lr,ur){var cr=this.getKey(lr);this.deleteCache(cr,ur)}},{key:"invalidateKey",value:function(lr){var ur=this;this.lvls.forEach(function(cr){return ur.deleteCache(lr,cr)})}},{key:"invalidate",value:function(lr){var ur=lr.id(),cr=this.keyForId.get(ur);this.deleteKeyMappingFor(lr);var hr=this.doesEleInvalidateKey(lr);return hr&&this.invalidateKey(cr),hr||this.getNumberOfIdsForKey(cr)===0}}])}(),minTxrH=25,txrStepH=50,minLvl$1=-4,maxLvl$1=3,maxZoom$1=7.99,eleTxrSpacing=8,defTxrWidth=1024,maxTxrW=1024,maxTxrH=1024,minUtility=.2,maxFullness=.8,maxFullnessChecks=10,deqCost$1=.15,deqAvgCost$1=.1,deqNoDrawCost$1=.9,deqFastCost$1=.9,deqRedrawThreshold$1=100,maxDeqSize$1=1,getTxrReasons={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},initDefaults=defaults$g({getKey:null,doesEleInvalidateKey:falsify,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:trueify,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),ElementTextureCache=function or(ar,lr){var ur=this;ur.renderer=ar,ur.onDequeues=[];var cr=initDefaults(lr);extend(ur,cr),ur.lookup=new ElementTextureCacheLookup(cr.getKey,cr.doesEleInvalidateKey),ur.setupDequeueing()},ETCp=ElementTextureCache.prototype;ETCp.reasons=getTxrReasons;ETCp.getTextureQueue=function(or){var ar=this;return ar.eleImgCaches=ar.eleImgCaches||{},ar.eleImgCaches[or]=ar.eleImgCaches[or]||[]};ETCp.getRetiredTextureQueue=function(or){var ar=this,lr=ar.eleImgCaches.retired=ar.eleImgCaches.retired||{},ur=lr[or]=lr[or]||[];return ur};ETCp.getElementQueue=function(){var or=this,ar=or.eleCacheQueue=or.eleCacheQueue||new Heap(function(lr,ur){return ur.reqs-lr.reqs});return ar};ETCp.getElementKeyToQueue=function(){var or=this,ar=or.eleKeyToCacheQueue=or.eleKeyToCacheQueue||{};return ar};ETCp.getElement=function(or,ar,lr,ur,cr){var hr=this,dr=this.renderer,fr=dr.cy.zoom(),pr=this.lookup;if(!ar||ar.w===0||ar.h===0||isNaN(ar.w)||isNaN(ar.h)||!or.visible()||or.removed()||!hr.allowEdgeTxrCaching&&or.isEdge()||!hr.allowParentTxrCaching&&or.isParent())return null;if(ur==null&&(ur=Math.ceil(log2(fr*lr))),ur<minLvl$1)ur=minLvl$1;else if(fr>=maxZoom$1||ur>maxLvl$1)return null;var vr=Math.pow(2,ur),gr=ar.h*vr,mr=ar.w*vr,br=dr.eleTextBiggerThanMin(or,vr);if(!this.isVisible(or,br))return null;var yr=pr.get(or,ur);if(yr&&yr.invalidated&&(yr.invalidated=!1,yr.texture.invalidatedWidth-=yr.width),yr)return yr;var xr;if(gr<=minTxrH?xr=minTxrH:gr<=txrStepH?xr=txrStepH:xr=Math.ceil(gr/txrStepH)*txrStepH,gr>maxTxrH||mr>maxTxrW)return null;var Cr=hr.getTextureQueue(xr),Sr=Cr[Cr.length-2],wr=function(){return hr.recycleTexture(xr,mr)||hr.addTexture(xr,mr)};Sr||(Sr=Cr[Cr.length-1]),Sr||(Sr=wr()),Sr.width-Sr.usedWidth<mr&&(Sr=wr());for(var Er=function(jr){return jr&&jr.scaledLabelShown===br},Ar=cr&&cr===getTxrReasons.dequeue,Tr=cr&&cr===getTxrReasons.highQuality,Rr=cr&&cr===getTxrReasons.downscale,Pr,_r=ur+1;_r<=maxLvl$1;_r++){var kr=pr.get(or,_r);if(kr){Pr=kr;break}}var Dr=Pr&&Pr.level===ur+1?Pr:null,Nr=function(){Sr.context.drawImage(Dr.texture.canvas,Dr.x,0,Dr.width,Dr.height,Sr.usedWidth,0,mr,gr)};if(Sr.context.setTransform(1,0,0,1,0,0),Sr.context.clearRect(Sr.usedWidth,0,mr,xr),Er(Dr))Nr();else if(Er(Pr))if(Tr){for(var Lr=Pr.level;Lr>ur;Lr--)Dr=hr.getElement(or,ar,lr,Lr,getTxrReasons.downscale);Nr()}else return hr.queueElement(or,Pr.level-1),Pr;else{var Or;if(!Ar&&!Tr&&!Rr)for(var Ir=ur-1;Ir>=minLvl$1;Ir--){var Mr=pr.get(or,Ir);if(Mr){Or=Mr;break}}if(Er(Or))return hr.queueElement(or,ur),Or;Sr.context.translate(Sr.usedWidth,0),Sr.context.scale(vr,vr),this.drawElement(Sr.context,or,ar,br,!1),Sr.context.scale(1/vr,1/vr),Sr.context.translate(-Sr.usedWidth,0)}return yr={x:Sr.usedWidth,texture:Sr,level:ur,scale:vr,width:mr,height:gr,scaledLabelShown:br},Sr.usedWidth+=Math.ceil(mr+eleTxrSpacing),Sr.eleCaches.push(yr),pr.set(or,ur,yr),hr.checkTextureFullness(Sr),yr};ETCp.invalidateElements=function(or){for(var ar=0;ar<or.length;ar++)this.invalidateElement(or[ar])};ETCp.invalidateElement=function(or){var ar=this,lr=ar.lookup,ur=[],cr=lr.isInvalid(or);if(cr){for(var hr=minLvl$1;hr<=maxLvl$1;hr++){var dr=lr.getForCachedKey(or,hr);dr&&ur.push(dr)}var fr=lr.invalidate(or);if(fr)for(var pr=0;pr<ur.length;pr++){var vr=ur[pr],gr=vr.texture;gr.invalidatedWidth+=vr.width,vr.invalidated=!0,ar.checkTextureUtility(gr)}ar.removeFromQueue(or)}};ETCp.checkTextureUtility=function(or){or.invalidatedWidth>=minUtility*or.width&&this.retireTexture(or)};ETCp.checkTextureFullness=function(or){var ar=this,lr=ar.getTextureQueue(or.height);or.usedWidth/or.width>maxFullness&&or.fullnessChecks>=maxFullnessChecks?removeFromArray(lr,or):or.fullnessChecks++};ETCp.retireTexture=function(or){var ar=this,lr=or.height,ur=ar.getTextureQueue(lr),cr=this.lookup;removeFromArray(ur,or),or.retired=!0;for(var hr=or.eleCaches,dr=0;dr<hr.length;dr++){var fr=hr[dr];cr.deleteCache(fr.key,fr.level)}clearArray(hr);var pr=ar.getRetiredTextureQueue(lr);pr.push(or)};ETCp.addTexture=function(or,ar){var lr=this,ur=lr.getTextureQueue(or),cr={};return ur.push(cr),cr.eleCaches=[],cr.height=or,cr.width=Math.max(defTxrWidth,ar),cr.usedWidth=0,cr.invalidatedWidth=0,cr.fullnessChecks=0,cr.canvas=lr.renderer.makeOffscreenCanvas(cr.width,cr.height),cr.context=cr.canvas.getContext("2d"),cr};ETCp.recycleTexture=function(or,ar){for(var lr=this,ur=lr.getTextureQueue(or),cr=lr.getRetiredTextureQueue(or),hr=0;hr<cr.length;hr++){var dr=cr[hr];if(dr.width>=ar)return dr.retired=!1,dr.usedWidth=0,dr.invalidatedWidth=0,dr.fullnessChecks=0,clearArray(dr.eleCaches),dr.context.setTransform(1,0,0,1,0,0),dr.context.clearRect(0,0,dr.width,dr.height),removeFromArray(cr,dr),ur.push(dr),dr}};ETCp.queueElement=function(or,ar){var lr=this,ur=lr.getElementQueue(),cr=lr.getElementKeyToQueue(),hr=this.getKey(or),dr=cr[hr];if(dr)dr.level=Math.max(dr.level,ar),dr.eles.merge(or),dr.reqs++,ur.updateItem(dr);else{var fr={eles:or.spawn().merge(or),level:ar,reqs:1,key:hr};ur.push(fr),cr[hr]=fr}};ETCp.dequeue=function(or){for(var ar=this,lr=ar.getElementQueue(),ur=ar.getElementKeyToQueue(),cr=[],hr=ar.lookup,dr=0;dr<maxDeqSize$1&&lr.size()>0;dr++){var fr=lr.pop(),pr=fr.key,vr=fr.eles[0],gr=hr.hasCache(vr,fr.level);if(ur[pr]=null,gr)continue;cr.push(fr);var mr=ar.getBoundingBox(vr);ar.getElement(vr,mr,or,fr.level,getTxrReasons.dequeue)}return cr};ETCp.removeFromQueue=function(or){var ar=this,lr=ar.getElementQueue(),ur=ar.getElementKeyToQueue(),cr=this.getKey(or),hr=ur[cr];hr!=null&&(hr.eles.length===1?(hr.reqs=MAX_INT$1,lr.updateItem(hr),lr.pop(),ur[cr]=null):hr.eles.unmerge(or))};ETCp.onDequeue=function(or){this.onDequeues.push(or)};ETCp.offDequeue=function(or){removeFromArray(this.onDequeues,or)};ETCp.setupDequeueing=defs.setupDequeueing({deqRedrawThreshold:deqRedrawThreshold$1,deqCost:deqCost$1,deqAvgCost:deqAvgCost$1,deqNoDrawCost:deqNoDrawCost$1,deqFastCost:deqFastCost$1,deq:function or(ar,lr,ur){return ar.dequeue(lr,ur)},onDeqd:function or(ar,lr){for(var ur=0;ur<ar.onDequeues.length;ur++){var cr=ar.onDequeues[ur];cr(lr)}},shouldRedraw:function or(ar,lr,ur,cr){for(var hr=0;hr<lr.length;hr++)for(var dr=lr[hr].eles,fr=0;fr<dr.length;fr++){var pr=dr[fr].boundingBox();if(boundingBoxesIntersect(pr,cr))return!0}return!1},priority:function or(ar){return ar.renderer.beforeRenderPriorities.eleTxrDeq}});var defNumLayers=1,minLvl=-4,maxLvl=2,maxZoom=3.99,deqRedrawThreshold=50,refineEleDebounceTime=50,deqCost=.15,deqAvgCost=.1,deqNoDrawCost=.9,deqFastCost=.9,maxDeqSize=1,invalidThreshold=250,maxLayerArea=4e3*4e3,maxLayerDim=32767,useHighQualityEleTxrReqs=!0,LayeredTextureCache=function or(ar){var lr=this,ur=lr.renderer=ar,cr=ur.cy;lr.layersByLevel={},lr.firstGet=!0,lr.lastInvalidationTime=performanceNow()-2*invalidThreshold,lr.skipping=!1,lr.eleTxrDeqs=cr.collection(),lr.scheduleElementRefinement=debounce(function(){lr.refineElementTextures(lr.eleTxrDeqs),lr.eleTxrDeqs.unmerge(lr.eleTxrDeqs)},refineEleDebounceTime),ur.beforeRender(function(dr,fr){fr-lr.lastInvalidationTime<=invalidThreshold?lr.skipping=!0:lr.skipping=!1},ur.beforeRenderPriorities.lyrTxrSkip);var hr=function(fr,pr){return pr.reqs-fr.reqs};lr.layersQueue=new Heap(hr),lr.setupDequeueing()},LTCp=LayeredTextureCache.prototype,layerIdPool=0,MAX_INT=Math.pow(2,53)-1;LTCp.makeLayer=function(or,ar){var lr=Math.pow(2,ar),ur=Math.ceil(or.w*lr),cr=Math.ceil(or.h*lr),hr=this.renderer.makeOffscreenCanvas(ur,cr),dr={id:layerIdPool=++layerIdPool%MAX_INT,bb:or,level:ar,width:ur,height:cr,canvas:hr,context:hr.getContext("2d"),eles:[],elesQueue:[],reqs:0},fr=dr.context,pr=-dr.bb.x1,vr=-dr.bb.y1;return fr.scale(lr,lr),fr.translate(pr,vr),dr};LTCp.getLayers=function(or,ar,lr){var ur=this,cr=ur.renderer,hr=cr.cy,dr=hr.zoom(),fr=ur.firstGet;if(ur.firstGet=!1,lr==null){if(lr=Math.ceil(log2(dr*ar)),lr<minLvl)lr=minLvl;else if(dr>=maxZoom||lr>maxLvl)return null}ur.validateLayersElesOrdering(lr,or);var pr=ur.layersByLevel,vr=Math.pow(2,lr),gr=pr[lr]=pr[lr]||[],mr,br=ur.levelIsComplete(lr,or),yr,xr=function(){var Nr=function($r){if(ur.validateLayersElesOrdering($r,or),ur.levelIsComplete($r,or))return yr=pr[$r],!0},Lr=function($r){if(!yr)for(var jr=lr+$r;minLvl<=jr&&jr<=maxLvl&&!Nr(jr);jr+=$r);};Lr(1),Lr(-1);for(var Or=gr.length-1;Or>=0;Or--){var Ir=gr[Or];Ir.invalid&&removeFromArray(gr,Ir)}};if(!br)xr();else return gr;var Cr=function(){if(!mr){mr=makeBoundingBox();for(var Nr=0;Nr<or.length;Nr++)updateBoundingBox(mr,or[Nr].boundingBox())}return mr},Sr=function(Nr){Nr=Nr||{};var Lr=Nr.after;Cr();var Or=Math.ceil(mr.w*vr),Ir=Math.ceil(mr.h*vr);if(Or>maxLayerDim||Ir>maxLayerDim)return null;var Mr=Or*Ir;if(Mr>maxLayerArea)return null;var $r=ur.makeLayer(mr,lr);if(Lr!=null){var jr=gr.indexOf(Lr)+1;gr.splice(jr,0,$r)}else(Nr.insert===void 0||Nr.insert)&&gr.unshift($r);return $r};if(ur.skipping&&!fr)return null;for(var wr=null,Er=or.length/defNumLayers,Ar=!fr,Tr=0;Tr<or.length;Tr++){var Rr=or[Tr],Pr=Rr._private.rscratch,_r=Pr.imgLayerCaches=Pr.imgLayerCaches||{},kr=_r[lr];if(kr){wr=kr;continue}if((!wr||wr.eles.length>=Er||!boundingBoxInBoundingBox(wr.bb,Rr.boundingBox()))&&(wr=Sr({insert:!0,after:wr}),!wr))return null;yr||Ar?ur.queueLayer(wr,Rr):ur.drawEleInLayer(wr,Rr,lr,ar),wr.eles.push(Rr),_r[lr]=wr}return yr||(Ar?null:gr)};LTCp.getEleLevelForLayerLevel=function(or,ar){return or};LTCp.drawEleInLayer=function(or,ar,lr,ur){var cr=this,hr=this.renderer,dr=or.context,fr=ar.boundingBox();fr.w===0||fr.h===0||!ar.visible()||(lr=cr.getEleLevelForLayerLevel(lr,ur),hr.setImgSmoothing(dr,!1),hr.drawCachedElement(dr,ar,null,null,lr,useHighQualityEleTxrReqs),hr.setImgSmoothing(dr,!0))};LTCp.levelIsComplete=function(or,ar){var lr=this,ur=lr.layersByLevel[or];if(!ur||ur.length===0)return!1;for(var cr=0,hr=0;hr<ur.length;hr++){var dr=ur[hr];if(dr.reqs>0||dr.invalid)return!1;cr+=dr.eles.length}return cr===ar.length};LTCp.validateLayersElesOrdering=function(or,ar){var lr=this.layersByLevel[or];if(lr)for(var ur=0;ur<lr.length;ur++){for(var cr=lr[ur],hr=-1,dr=0;dr<ar.length;dr++)if(cr.eles[0]===ar[dr]){hr=dr;break}if(hr<0){this.invalidateLayer(cr);continue}for(var fr=hr,dr=0;dr<cr.eles.length;dr++)if(cr.eles[dr]!==ar[fr+dr]){this.invalidateLayer(cr);break}}};LTCp.updateElementsInLayers=function(or,ar){for(var lr=this,ur=element(or[0]),cr=0;cr<or.length;cr++)for(var hr=ur?null:or[cr],dr=ur?or[cr]:or[cr].ele,fr=dr._private.rscratch,pr=fr.imgLayerCaches=fr.imgLayerCaches||{},vr=minLvl;vr<=maxLvl;vr++){var gr=pr[vr];gr&&(hr&&lr.getEleLevelForLayerLevel(gr.level)!==hr.level||ar(gr,dr,hr))}};LTCp.haveLayers=function(){for(var or=this,ar=!1,lr=minLvl;lr<=maxLvl;lr++){var ur=or.layersByLevel[lr];if(ur&&ur.length>0){ar=!0;break}}return ar};LTCp.invalidateElements=function(or){var ar=this;or.length!==0&&(ar.lastInvalidationTime=performanceNow(),!(or.length===0||!ar.haveLayers())&&ar.updateElementsInLayers(or,function(ur,cr,hr){ar.invalidateLayer(ur)}))};LTCp.invalidateLayer=function(or){if(this.lastInvalidationTime=performanceNow(),!or.invalid){var ar=or.level,lr=or.eles,ur=this.layersByLevel[ar];removeFromArray(ur,or),or.elesQueue=[],or.invalid=!0,or.replacement&&(or.replacement.invalid=!0);for(var cr=0;cr<lr.length;cr++){var hr=lr[cr]._private.rscratch.imgLayerCaches;hr&&(hr[ar]=null)}}};LTCp.refineElementTextures=function(or){var ar=this;ar.updateElementsInLayers(or,function(ur,cr,hr){var dr=ur.replacement;if(dr||(dr=ur.replacement=ar.makeLayer(ur.bb,ur.level),dr.replaces=ur,dr.eles=ur.eles),!dr.reqs)for(var fr=0;fr<dr.eles.length;fr++)ar.queueLayer(dr,dr.eles[fr])})};LTCp.enqueueElementRefinement=function(or){this.eleTxrDeqs.merge(or),this.scheduleElementRefinement()};LTCp.queueLayer=function(or,ar){var lr=this,ur=lr.layersQueue,cr=or.elesQueue,hr=cr.hasId=cr.hasId||{};if(!or.replacement){if(ar){if(hr[ar.id()])return;cr.push(ar),hr[ar.id()]=!0}or.reqs?(or.reqs++,ur.updateItem(or)):(or.reqs=1,ur.push(or))}};LTCp.dequeue=function(or){for(var ar=this,lr=ar.layersQueue,ur=[],cr=0;cr<maxDeqSize&&lr.size()!==0;){var hr=lr.peek();if(hr.replacement){lr.pop();continue}if(hr.replaces&&hr!==hr.replaces.replacement){lr.pop();continue}if(hr.invalid){lr.pop();continue}var dr=hr.elesQueue.shift();dr&&(ar.drawEleInLayer(hr,dr,hr.level,or),cr++),ur.length===0&&ur.push(!0),hr.elesQueue.length===0&&(lr.pop(),hr.reqs=0,hr.replaces&&ar.applyLayerReplacement(hr),ar.requestRedraw())}return ur};LTCp.applyLayerReplacement=function(or){var ar=this,lr=ar.layersByLevel[or.level],ur=or.replaces,cr=lr.indexOf(ur);if(!(cr<0||ur.invalid)){lr[cr]=or;for(var hr=0;hr<or.eles.length;hr++){var dr=or.eles[hr]._private,fr=dr.imgLayerCaches=dr.imgLayerCaches||{};fr&&(fr[or.level]=or)}ar.requestRedraw()}};LTCp.requestRedraw=debounce(function(){var or=this.renderer;or.redrawHint("eles",!0),or.redrawHint("drag",!0),or.redraw()},100);LTCp.setupDequeueing=defs.setupDequeueing({deqRedrawThreshold,deqCost,deqAvgCost,deqNoDrawCost,deqFastCost,deq:function or(ar,lr){return ar.dequeue(lr)},onDeqd:noop$1,shouldRedraw:trueify,priority:function or(ar){return ar.renderer.beforeRenderPriorities.lyrTxrDeq}});var CRp$b={},impl;function polygon(or,ar){for(var lr=0;lr<ar.length;lr++){var ur=ar[lr];or.lineTo(ur.x,ur.y)}}function triangleBackcurve(or,ar,lr){for(var ur,cr=0;cr<ar.length;cr++){var hr=ar[cr];cr===0&&(ur=hr),or.lineTo(hr.x,hr.y)}or.quadraticCurveTo(lr.x,lr.y,ur.x,ur.y)}function triangleTee(or,ar,lr){or.beginPath&&or.beginPath();for(var ur=ar,cr=0;cr<ur.length;cr++){var hr=ur[cr];or.lineTo(hr.x,hr.y)}var dr=lr,fr=lr[0];or.moveTo(fr.x,fr.y);for(var cr=1;cr<dr.length;cr++){var hr=dr[cr];or.lineTo(hr.x,hr.y)}or.closePath&&or.closePath()}function circleTriangle(or,ar,lr,ur,cr){or.beginPath&&or.beginPath(),or.arc(lr,ur,cr,0,Math.PI*2,!1);var hr=ar,dr=hr[0];or.moveTo(dr.x,dr.y);for(var fr=0;fr<hr.length;fr++){var pr=hr[fr];or.lineTo(pr.x,pr.y)}or.closePath&&or.closePath()}function circle$1(or,ar,lr,ur){or.arc(ar,lr,ur,0,Math.PI*2,!1)}CRp$b.arrowShapeImpl=function(or){return(impl||(impl={polygon,"triangle-backcurve":triangleBackcurve,"triangle-tee":triangleTee,"circle-triangle":circleTriangle,"triangle-cross":triangleTee,circle:circle$1}))[or]};var CRp$a={};CRp$a.drawElement=function(or,ar,lr,ur,cr,hr){var dr=this;ar.isNode()?dr.drawNode(or,ar,lr,ur,cr,hr):dr.drawEdge(or,ar,lr,ur,cr,hr)};CRp$a.drawElementOverlay=function(or,ar){var lr=this;ar.isNode()?lr.drawNodeOverlay(or,ar):lr.drawEdgeOverlay(or,ar)};CRp$a.drawElementUnderlay=function(or,ar){var lr=this;ar.isNode()?lr.drawNodeUnderlay(or,ar):lr.drawEdgeUnderlay(or,ar)};CRp$a.drawCachedElementPortion=function(or,ar,lr,ur,cr,hr,dr,fr){var pr=this,vr=lr.getBoundingBox(ar);if(!(vr.w===0||vr.h===0)){var gr=lr.getElement(ar,vr,ur,cr,hr);if(gr!=null){var mr=fr(pr,ar);if(mr===0)return;var br=dr(pr,ar),yr=vr.x1,xr=vr.y1,Cr=vr.w,Sr=vr.h,wr,Er,Ar,Tr,Rr;if(br!==0){var Pr=lr.getRotationPoint(ar);Ar=Pr.x,Tr=Pr.y,or.translate(Ar,Tr),or.rotate(br),Rr=pr.getImgSmoothing(or),Rr||pr.setImgSmoothing(or,!0);var _r=lr.getRotationOffset(ar);wr=_r.x,Er=_r.y}else wr=yr,Er=xr;var kr;mr!==1&&(kr=or.globalAlpha,or.globalAlpha=kr*mr),or.drawImage(gr.texture.canvas,gr.x,0,gr.width,gr.height,wr,Er,Cr,Sr),mr!==1&&(or.globalAlpha=kr),br!==0&&(or.rotate(-br),or.translate(-Ar,-Tr),Rr||pr.setImgSmoothing(or,!1))}else lr.drawElement(or,ar)}};var getZeroRotation=function or(){return 0},getLabelRotation=function or(ar,lr){return ar.getTextAngle(lr,null)},getSourceLabelRotation=function or(ar,lr){return ar.getTextAngle(lr,"source")},getTargetLabelRotation=function or(ar,lr){return ar.getTextAngle(lr,"target")},getOpacity=function or(ar,lr){return lr.effectiveOpacity()},getTextOpacity=function or(ar,lr){return lr.pstyle("text-opacity").pfValue*lr.effectiveOpacity()};CRp$a.drawCachedElement=function(or,ar,lr,ur,cr,hr){var dr=this,fr=dr.data,pr=fr.eleTxrCache,vr=fr.lblTxrCache,gr=fr.slbTxrCache,mr=fr.tlbTxrCache,br=ar.boundingBox(),yr=hr===!0?pr.reasons.highQuality:null;if(!(br.w===0||br.h===0||!ar.visible())&&(!ur||boundingBoxesIntersect(br,ur))){var xr=ar.isEdge(),Cr=ar.element()._private.rscratch.badLine;dr.drawElementUnderlay(or,ar),dr.drawCachedElementPortion(or,ar,pr,lr,cr,yr,getZeroRotation,getOpacity),(!xr||!Cr)&&dr.drawCachedElementPortion(or,ar,vr,lr,cr,yr,getLabelRotation,getTextOpacity),xr&&!Cr&&(dr.drawCachedElementPortion(or,ar,gr,lr,cr,yr,getSourceLabelRotation,getTextOpacity),dr.drawCachedElementPortion(or,ar,mr,lr,cr,yr,getTargetLabelRotation,getTextOpacity)),dr.drawElementOverlay(or,ar)}};CRp$a.drawElements=function(or,ar){for(var lr=this,ur=0;ur<ar.length;ur++){var cr=ar[ur];lr.drawElement(or,cr)}};CRp$a.drawCachedElements=function(or,ar,lr,ur){for(var cr=this,hr=0;hr<ar.length;hr++){var dr=ar[hr];cr.drawCachedElement(or,dr,lr,ur)}};CRp$a.drawCachedNodes=function(or,ar,lr,ur){for(var cr=this,hr=0;hr<ar.length;hr++){var dr=ar[hr];dr.isNode()&&cr.drawCachedElement(or,dr,lr,ur)}};CRp$a.drawLayeredElements=function(or,ar,lr,ur){var cr=this,hr=cr.data.lyrTxrCache.getLayers(ar,lr);if(hr)for(var dr=0;dr<hr.length;dr++){var fr=hr[dr],pr=fr.bb;pr.w===0||pr.h===0||or.drawImage(fr.canvas,pr.x1,pr.y1,pr.w,pr.h)}else cr.drawCachedElements(or,ar,lr,ur)};var CRp$9={};CRp$9.drawEdge=function(or,ar,lr){var ur=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,cr=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,hr=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,dr=this,fr=ar._private.rscratch;if(!(hr&&!ar.visible())&&!(fr.badLine||fr.allpts==null||isNaN(fr.allpts[0]))){var pr;lr&&(pr=lr,or.translate(-pr.x1,-pr.y1));var vr=hr?ar.pstyle("opacity").value:1,gr=hr?ar.pstyle("line-opacity").value:1,mr=ar.pstyle("curve-style").value,br=ar.pstyle("line-style").value,yr=ar.pstyle("width").pfValue,xr=ar.pstyle("line-cap").value,Cr=ar.pstyle("line-outline-width").value,Sr=ar.pstyle("line-outline-color").value,wr=vr*gr,Er=vr*gr,Ar=function(){var $r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wr;mr==="straight-triangle"?(dr.eleStrokeStyle(or,ar,$r),dr.drawEdgeTrianglePath(ar,or,fr.allpts)):(or.lineWidth=yr,or.lineCap=xr,dr.eleStrokeStyle(or,ar,$r),dr.drawEdgePath(ar,or,fr.allpts,br),or.lineCap="butt")},Tr=function(){var $r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:wr;if(or.lineWidth=yr+Cr,or.lineCap=xr,Cr>0)dr.colorStrokeStyle(or,Sr[0],Sr[1],Sr[2],$r);else{or.lineCap="butt";return}mr==="straight-triangle"?dr.drawEdgeTrianglePath(ar,or,fr.allpts):(dr.drawEdgePath(ar,or,fr.allpts,br),or.lineCap="butt")},Rr=function(){cr&&dr.drawEdgeOverlay(or,ar)},Pr=function(){cr&&dr.drawEdgeUnderlay(or,ar)},_r=function(){var $r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Er;dr.drawArrowheads(or,ar,$r)},kr=function(){dr.drawElementText(or,ar,null,ur)};or.lineJoin="round";var Dr=ar.pstyle("ghost").value==="yes";if(Dr){var Nr=ar.pstyle("ghost-offset-x").pfValue,Lr=ar.pstyle("ghost-offset-y").pfValue,Or=ar.pstyle("ghost-opacity").value,Ir=wr*Or;or.translate(Nr,Lr),Ar(Ir),_r(Ir),or.translate(-Nr,-Lr)}else Tr();Pr(),Ar(),_r(),Rr(),kr(),lr&&or.translate(pr.x1,pr.y1)}};var drawEdgeOverlayUnderlay=function or(ar){if(!["overlay","underlay"].includes(ar))throw new Error("Invalid state");return function(lr,ur){if(ur.visible()){var cr=ur.pstyle("".concat(ar,"-opacity")).value;if(cr!==0){var hr=this,dr=hr.usePaths(),fr=ur._private.rscratch,pr=ur.pstyle("".concat(ar,"-padding")).pfValue,vr=2*pr,gr=ur.pstyle("".concat(ar,"-color")).value;lr.lineWidth=vr,fr.edgeType==="self"&&!dr?lr.lineCap="butt":lr.lineCap="round",hr.colorStrokeStyle(lr,gr[0],gr[1],gr[2],cr),hr.drawEdgePath(ur,lr,fr.allpts,"solid")}}}};CRp$9.drawEdgeOverlay=drawEdgeOverlayUnderlay("overlay");CRp$9.drawEdgeUnderlay=drawEdgeOverlayUnderlay("underlay");CRp$9.drawEdgePath=function(or,ar,lr,ur){var cr=or._private.rscratch,hr=ar,dr,fr=!1,pr=this.usePaths(),vr=or.pstyle("line-dash-pattern").pfValue,gr=or.pstyle("line-dash-offset").pfValue;if(pr){var mr=lr.join("$"),br=cr.pathCacheKey&&cr.pathCacheKey===mr;br?(dr=ar=cr.pathCache,fr=!0):(dr=ar=new Path2D,cr.pathCacheKey=mr,cr.pathCache=dr)}if(hr.setLineDash)switch(ur){case"dotted":hr.setLineDash([1,1]);break;case"dashed":hr.setLineDash(vr),hr.lineDashOffset=gr;break;case"solid":hr.setLineDash([]);break}if(!fr&&!cr.badLine)switch(ar.beginPath&&ar.beginPath(),ar.moveTo(lr[0],lr[1]),cr.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var yr=2;yr+3<lr.length;yr+=4)ar.quadraticCurveTo(lr[yr],lr[yr+1],lr[yr+2],lr[yr+3]);break;case"straight":case"haystack":for(var xr=2;xr+1<lr.length;xr+=2)ar.lineTo(lr[xr],lr[xr+1]);break;case"segments":if(cr.isRound){var Cr=_createForOfIteratorHelper(cr.roundCorners),Sr;try{for(Cr.s();!(Sr=Cr.n()).done;){var wr=Sr.value;drawPreparedRoundCorner(ar,wr)}}catch(Ar){Cr.e(Ar)}finally{Cr.f()}ar.lineTo(lr[lr.length-2],lr[lr.length-1])}else for(var Er=2;Er+1<lr.length;Er+=2)ar.lineTo(lr[Er],lr[Er+1]);break}ar=hr,pr?ar.stroke(dr):ar.stroke(),ar.setLineDash&&ar.setLineDash([])};CRp$9.drawEdgeTrianglePath=function(or,ar,lr){ar.fillStyle=ar.strokeStyle;for(var ur=or.pstyle("width").pfValue,cr=0;cr+1<lr.length;cr+=2){var hr=[lr[cr+2]-lr[cr],lr[cr+3]-lr[cr+1]],dr=Math.sqrt(hr[0]*hr[0]+hr[1]*hr[1]),fr=[hr[1]/dr,-hr[0]/dr],pr=[fr[0]*ur/2,fr[1]*ur/2];ar.beginPath(),ar.moveTo(lr[cr]-pr[0],lr[cr+1]-pr[1]),ar.lineTo(lr[cr]+pr[0],lr[cr+1]+pr[1]),ar.lineTo(lr[cr+2],lr[cr+3]),ar.closePath(),ar.fill()}};CRp$9.drawArrowheads=function(or,ar,lr){var ur=ar._private.rscratch,cr=ur.edgeType==="haystack";cr||this.drawArrowhead(or,ar,"source",ur.arrowStartX,ur.arrowStartY,ur.srcArrowAngle,lr),this.drawArrowhead(or,ar,"mid-target",ur.midX,ur.midY,ur.midtgtArrowAngle,lr),this.drawArrowhead(or,ar,"mid-source",ur.midX,ur.midY,ur.midsrcArrowAngle,lr),cr||this.drawArrowhead(or,ar,"target",ur.arrowEndX,ur.arrowEndY,ur.tgtArrowAngle,lr)};CRp$9.drawArrowhead=function(or,ar,lr,ur,cr,hr,dr){if(!(isNaN(ur)||ur==null||isNaN(cr)||cr==null||isNaN(hr)||hr==null)){var fr=this,pr=ar.pstyle(lr+"-arrow-shape").value;if(pr!=="none"){var vr=ar.pstyle(lr+"-arrow-fill").value==="hollow"?"both":"filled",gr=ar.pstyle(lr+"-arrow-fill").value,mr=ar.pstyle("width").pfValue,br=ar.pstyle(lr+"-arrow-width"),yr=br.value==="match-line"?mr:br.pfValue;br.units==="%"&&(yr*=mr);var xr=ar.pstyle("opacity").value;dr===void 0&&(dr=xr);var Cr=or.globalCompositeOperation;(dr!==1||gr==="hollow")&&(or.globalCompositeOperation="destination-out",fr.colorFillStyle(or,255,255,255,1),fr.colorStrokeStyle(or,255,255,255,1),fr.drawArrowShape(ar,or,vr,mr,pr,yr,ur,cr,hr),or.globalCompositeOperation=Cr);var Sr=ar.pstyle(lr+"-arrow-color").value;fr.colorFillStyle(or,Sr[0],Sr[1],Sr[2],dr),fr.colorStrokeStyle(or,Sr[0],Sr[1],Sr[2],dr),fr.drawArrowShape(ar,or,gr,mr,pr,yr,ur,cr,hr)}}};CRp$9.drawArrowShape=function(or,ar,lr,ur,cr,hr,dr,fr,pr){var vr=this,gr=this.usePaths()&&cr!=="triangle-cross",mr=!1,br,yr=ar,xr={x:dr,y:fr},Cr=or.pstyle("arrow-scale").value,Sr=this.getArrowWidth(ur,Cr),wr=vr.arrowShapes[cr];if(gr){var Er=vr.arrowPathCache=vr.arrowPathCache||[],Ar=hashString(cr),Tr=Er[Ar];Tr!=null?(br=ar=Tr,mr=!0):(br=ar=new Path2D,Er[Ar]=br)}mr||(ar.beginPath&&ar.beginPath(),gr?wr.draw(ar,1,0,{x:0,y:0},1):wr.draw(ar,Sr,pr,xr,ur),ar.closePath&&ar.closePath()),ar=yr,gr&&(ar.translate(dr,fr),ar.rotate(pr),ar.scale(Sr,Sr)),(lr==="filled"||lr==="both")&&(gr?ar.fill(br):ar.fill()),(lr==="hollow"||lr==="both")&&(ar.lineWidth=hr/(gr?Sr:1),ar.lineJoin="miter",gr?ar.stroke(br):ar.stroke()),gr&&(ar.scale(1/Sr,1/Sr),ar.rotate(-pr),ar.translate(-dr,-fr))};var CRp$8={};CRp$8.safeDrawImage=function(or,ar,lr,ur,cr,hr,dr,fr,pr,vr){if(!(cr<=0||hr<=0||pr<=0||vr<=0))try{or.drawImage(ar,lr,ur,cr,hr,dr,fr,pr,vr)}catch(gr){warn(gr)}};CRp$8.drawInscribedImage=function(or,ar,lr,ur,cr){var hr=this,dr=lr.position(),fr=dr.x,pr=dr.y,vr=lr.cy().style(),gr=vr.getIndexedStyle.bind(vr),mr=gr(lr,"background-fit","value",ur),br=gr(lr,"background-repeat","value",ur),yr=lr.width(),xr=lr.height(),Cr=lr.padding()*2,Sr=yr+(gr(lr,"background-width-relative-to","value",ur)==="inner"?0:Cr),wr=xr+(gr(lr,"background-height-relative-to","value",ur)==="inner"?0:Cr),Er=lr._private.rscratch,Ar=gr(lr,"background-clip","value",ur),Tr=Ar==="node",Rr=gr(lr,"background-image-opacity","value",ur)*cr,Pr=gr(lr,"background-image-smoothing","value",ur),_r=lr.pstyle("corner-radius").value;_r!=="auto"&&(_r=lr.pstyle("corner-radius").pfValue);var kr=ar.width||ar.cachedW,Dr=ar.height||ar.cachedH;(kr==null||Dr==null)&&(document.body.appendChild(ar),kr=ar.cachedW=ar.width||ar.offsetWidth,Dr=ar.cachedH=ar.height||ar.offsetHeight,document.body.removeChild(ar));var Nr=kr,Lr=Dr;if(gr(lr,"background-width","value",ur)!=="auto"&&(gr(lr,"background-width","units",ur)==="%"?Nr=gr(lr,"background-width","pfValue",ur)*Sr:Nr=gr(lr,"background-width","pfValue",ur)),gr(lr,"background-height","value",ur)!=="auto"&&(gr(lr,"background-height","units",ur)==="%"?Lr=gr(lr,"background-height","pfValue",ur)*wr:Lr=gr(lr,"background-height","pfValue",ur)),!(Nr===0||Lr===0)){if(mr==="contain"){var Or=Math.min(Sr/Nr,wr/Lr);Nr*=Or,Lr*=Or}else if(mr==="cover"){var Or=Math.max(Sr/Nr,wr/Lr);Nr*=Or,Lr*=Or}var Ir=fr-Sr/2,Mr=gr(lr,"background-position-x","units",ur),$r=gr(lr,"background-position-x","pfValue",ur);Mr==="%"?Ir+=(Sr-Nr)*$r:Ir+=$r;var jr=gr(lr,"background-offset-x","units",ur),Fr=gr(lr,"background-offset-x","pfValue",ur);jr==="%"?Ir+=(Sr-Nr)*Fr:Ir+=Fr;var zr=pr-wr/2,Hr=gr(lr,"background-position-y","units",ur),Wr=gr(lr,"background-position-y","pfValue",ur);Hr==="%"?zr+=(wr-Lr)*Wr:zr+=Wr;var Yr=gr(lr,"background-offset-y","units",ur),qr=gr(lr,"background-offset-y","pfValue",ur);Yr==="%"?zr+=(wr-Lr)*qr:zr+=qr,Er.pathCache&&(Ir-=fr,zr-=pr,fr=0,pr=0);var Br=or.globalAlpha;or.globalAlpha=Rr;var Ur=hr.getImgSmoothing(or),Vr=!1;if(Pr==="no"&&Ur?(hr.setImgSmoothing(or,!1),Vr=!0):Pr==="yes"&&!Ur&&(hr.setImgSmoothing(or,!0),Vr=!0),br==="no-repeat")Tr&&(or.save(),Er.pathCache?or.clip(Er.pathCache):(hr.nodeShapes[hr.getNodeShape(lr)].draw(or,fr,pr,Sr,wr,_r,Er),or.clip())),hr.safeDrawImage(or,ar,0,0,kr,Dr,Ir,zr,Nr,Lr),Tr&&or.restore();else{var Xr=or.createPattern(ar,br);or.fillStyle=Xr,hr.nodeShapes[hr.getNodeShape(lr)].draw(or,fr,pr,Sr,wr,_r,Er),or.translate(Ir,zr),or.fill(),or.translate(-Ir,-zr)}or.globalAlpha=Br,Vr&&hr.setImgSmoothing(or,Ur)}};var CRp$7={};CRp$7.eleTextBiggerThanMin=function(or,ar){if(!ar){var lr=or.cy().zoom(),ur=this.getPixelRatio(),cr=Math.ceil(log2(lr*ur));ar=Math.pow(2,cr)}var hr=or.pstyle("font-size").pfValue*ar,dr=or.pstyle("min-zoomed-font-size").pfValue;return!(hr<dr)};CRp$7.drawElementText=function(or,ar,lr,ur,cr){var hr=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,dr=this;if(ur==null){if(hr&&!dr.eleTextBiggerThanMin(ar))return}else if(ur===!1)return;if(ar.isNode()){var fr=ar.pstyle("label");if(!fr||!fr.value)return;var pr=dr.getLabelJustification(ar);or.textAlign=pr,or.textBaseline="bottom"}else{var vr=ar.element()._private.rscratch.badLine,gr=ar.pstyle("label"),mr=ar.pstyle("source-label"),br=ar.pstyle("target-label");if(vr||(!gr||!gr.value)&&(!mr||!mr.value)&&(!br||!br.value))return;or.textAlign="center",or.textBaseline="bottom"}var yr=!lr,xr;lr&&(xr=lr,or.translate(-xr.x1,-xr.y1)),cr==null?(dr.drawText(or,ar,null,yr,hr),ar.isEdge()&&(dr.drawText(or,ar,"source",yr,hr),dr.drawText(or,ar,"target",yr,hr))):dr.drawText(or,ar,cr,yr,hr),lr&&or.translate(xr.x1,xr.y1)};CRp$7.getFontCache=function(or){var ar;this.fontCaches=this.fontCaches||[];for(var lr=0;lr<this.fontCaches.length;lr++)if(ar=this.fontCaches[lr],ar.context===or)return ar;return ar={context:or},this.fontCaches.push(ar),ar};CRp$7.setupTextStyle=function(or,ar){var lr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,ur=ar.pstyle("font-style").strValue,cr=ar.pstyle("font-size").pfValue+"px",hr=ar.pstyle("font-family").strValue,dr=ar.pstyle("font-weight").strValue,fr=lr?ar.effectiveOpacity()*ar.pstyle("text-opacity").value:1,pr=ar.pstyle("text-outline-opacity").value*fr,vr=ar.pstyle("color").value,gr=ar.pstyle("text-outline-color").value;or.font=ur+" "+dr+" "+cr+" "+hr,or.lineJoin="round",this.colorFillStyle(or,vr[0],vr[1],vr[2],fr),this.colorStrokeStyle(or,gr[0],gr[1],gr[2],pr)};function circle(or,ar,lr,ur,cr){var hr=Math.min(ur,cr),dr=hr/2,fr=ar+ur/2,pr=lr+cr/2;or.beginPath(),or.arc(fr,pr,dr,0,Math.PI*2),or.closePath()}function roundRect(or,ar,lr,ur,cr){var hr=arguments.length>5&&arguments[5]!==void 0?arguments[5]:5,dr=Math.min(hr,ur/2,cr/2);or.beginPath(),or.moveTo(ar+dr,lr),or.lineTo(ar+ur-dr,lr),or.quadraticCurveTo(ar+ur,lr,ar+ur,lr+dr),or.lineTo(ar+ur,lr+cr-dr),or.quadraticCurveTo(ar+ur,lr+cr,ar+ur-dr,lr+cr),or.lineTo(ar+dr,lr+cr),or.quadraticCurveTo(ar,lr+cr,ar,lr+cr-dr),or.lineTo(ar,lr+dr),or.quadraticCurveTo(ar,lr,ar+dr,lr),or.closePath()}CRp$7.getTextAngle=function(or,ar){var lr,ur=or._private,cr=ur.rscratch,hr=ar?ar+"-":"",dr=or.pstyle(hr+"text-rotation");if(dr.strValue==="autorotate"){var fr=getPrefixedProperty(cr,"labelAngle",ar);lr=or.isEdge()?fr:0}else dr.strValue==="none"?lr=0:lr=dr.pfValue;return lr};CRp$7.drawText=function(or,ar,lr){var ur=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,cr=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,hr=ar._private,dr=hr.rscratch,fr=cr?ar.effectiveOpacity():1;if(!(cr&&(fr===0||ar.pstyle("text-opacity").value===0))){lr==="main"&&(lr=null);var pr=getPrefixedProperty(dr,"labelX",lr),vr=getPrefixedProperty(dr,"labelY",lr),gr,mr,br=this.getLabelText(ar,lr);if(br!=null&&br!==""&&!isNaN(pr)&&!isNaN(vr)){this.setupTextStyle(or,ar,cr);var yr=lr?lr+"-":"",xr=getPrefixedProperty(dr,"labelWidth",lr),Cr=getPrefixedProperty(dr,"labelHeight",lr),Sr=ar.pstyle(yr+"text-margin-x").pfValue,wr=ar.pstyle(yr+"text-margin-y").pfValue,Er=ar.isEdge(),Ar=ar.pstyle("text-halign").value,Tr=ar.pstyle("text-valign").value;Er&&(Ar="center",Tr="center"),pr+=Sr,vr+=wr;var Rr;switch(ur?Rr=this.getTextAngle(ar,lr):Rr=0,Rr!==0&&(gr=pr,mr=vr,or.translate(gr,mr),or.rotate(Rr),pr=0,vr=0),Tr){case"top":break;case"center":vr+=Cr/2;break;case"bottom":vr+=Cr;break}var Pr=ar.pstyle("text-background-opacity").value,_r=ar.pstyle("text-border-opacity").value,kr=ar.pstyle("text-border-width").pfValue,Dr=ar.pstyle("text-background-padding").pfValue,Nr=ar.pstyle("text-background-shape").strValue,Lr=Nr==="round-rectangle"||Nr==="roundrectangle",Or=Nr==="circle",Ir=2;if(Pr>0||kr>0&&_r>0){var Mr=or.fillStyle,$r=or.strokeStyle,jr=or.lineWidth,Fr=ar.pstyle("text-background-color").value,zr=ar.pstyle("text-border-color").value,Hr=ar.pstyle("text-border-style").value,Wr=Pr>0,Yr=kr>0&&_r>0,qr=pr-Dr;switch(Ar){case"left":qr-=xr;break;case"center":qr-=xr/2;break}var Br=vr-Cr-Dr,Ur=xr+2*Dr,Vr=Cr+2*Dr;if(Wr&&(or.fillStyle="rgba(".concat(Fr[0],",").concat(Fr[1],",").concat(Fr[2],",").concat(Pr*fr,")")),Yr&&(or.strokeStyle="rgba(".concat(zr[0],",").concat(zr[1],",").concat(zr[2],",").concat(_r*fr,")"),or.lineWidth=kr,or.setLineDash))switch(Hr){case"dotted":or.setLineDash([1,1]);break;case"dashed":or.setLineDash([4,2]);break;case"double":or.lineWidth=kr/4,or.setLineDash([]);break;case"solid":default:or.setLineDash([]);break}if(Lr?(or.beginPath(),roundRect(or,qr,Br,Ur,Vr,Ir)):Or?(or.beginPath(),circle(or,qr,Br,Ur,Vr)):(or.beginPath(),or.rect(qr,Br,Ur,Vr)),Wr&&or.fill(),Yr&&or.stroke(),Yr&&Hr==="double"){var Xr=kr/2;or.beginPath(),Lr?roundRect(or,qr+Xr,Br+Xr,Ur-2*Xr,Vr-2*Xr,Ir):or.rect(qr+Xr,Br+Xr,Ur-2*Xr,Vr-2*Xr),or.stroke()}or.fillStyle=Mr,or.strokeStyle=$r,or.lineWidth=jr,or.setLineDash&&or.setLineDash([])}var Zr=2*ar.pstyle("text-outline-width").pfValue;if(Zr>0&&(or.lineWidth=Zr),ar.pstyle("text-wrap").value==="wrap"){var Jr=getPrefixedProperty(dr,"labelWrapCachedLines",lr),Qr=getPrefixedProperty(dr,"labelLineHeight",lr),ga=xr/2,ba=this.getLabelJustification(ar);switch(ba==="auto"||(Ar==="left"?ba==="left"?pr+=-xr:ba==="center"&&(pr+=-ga):Ar==="center"?ba==="left"?pr+=-ga:ba==="right"&&(pr+=ga):Ar==="right"&&(ba==="center"?pr+=ga:ba==="right"&&(pr+=xr))),Tr){case"top":vr-=(Jr.length-1)*Qr;break;case"center":case"bottom":vr-=(Jr.length-1)*Qr;break}for(var _i=0;_i<Jr.length;_i++)Zr>0&&or.strokeText(Jr[_i],pr,vr),or.fillText(Jr[_i],pr,vr),vr+=Qr}else Zr>0&&or.strokeText(br,pr,vr),or.fillText(br,pr,vr);Rr!==0&&(or.rotate(-Rr),or.translate(-gr,-mr))}}};var CRp$6={};CRp$6.drawNode=function(or,ar,lr){var ur=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,cr=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,hr=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0,dr=this,fr,pr,vr=ar._private,gr=vr.rscratch,mr=ar.position();if(!(!number$1(mr.x)||!number$1(mr.y))&&!(hr&&!ar.visible())){var br=hr?ar.effectiveOpacity():1,yr=dr.usePaths(),xr,Cr=!1,Sr=ar.padding();fr=ar.width()+2*Sr,pr=ar.height()+2*Sr;var wr;lr&&(wr=lr,or.translate(-wr.x1,-wr.y1));for(var Er=ar.pstyle("background-image"),Ar=Er.value,Tr=new Array(Ar.length),Rr=new Array(Ar.length),Pr=0,_r=0;_r<Ar.length;_r++){var kr=Ar[_r],Dr=Tr[_r]=kr!=null&&kr!=="none";if(Dr){var Nr=ar.cy().style().getIndexedStyle(ar,"background-image-crossorigin","value",_r);Pr++,Rr[_r]=dr.getCachedImage(kr,Nr,function(){vr.backgroundTimestamp=Date.now(),ar.emitAndNotify("background")})}}var Lr=ar.pstyle("background-blacken").value,Or=ar.pstyle("border-width").pfValue,Ir=ar.pstyle("background-opacity").value*br,Mr=ar.pstyle("border-color").value,$r=ar.pstyle("border-style").value,jr=ar.pstyle("border-join").value,Fr=ar.pstyle("border-cap").value,zr=ar.pstyle("border-position").value,Hr=ar.pstyle("border-dash-pattern").pfValue,Wr=ar.pstyle("border-dash-offset").pfValue,Yr=ar.pstyle("border-opacity").value*br,qr=ar.pstyle("outline-width").pfValue,Br=ar.pstyle("outline-color").value,Ur=ar.pstyle("outline-style").value,Vr=ar.pstyle("outline-opacity").value*br,Xr=ar.pstyle("outline-offset").value,Zr=ar.pstyle("corner-radius").value;Zr!=="auto"&&(Zr=ar.pstyle("corner-radius").pfValue);var Jr=function(){var Ns=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ir;dr.eleFillStyle(or,ar,Ns)},Qr=function(){var Ns=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yr;dr.colorStrokeStyle(or,Mr[0],Mr[1],Mr[2],Ns)},ga=function(){var Ns=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Vr;dr.colorStrokeStyle(or,Br[0],Br[1],Br[2],Ns)},ba=function(Ns,us,na,ds){var is=dr.nodePathCache=dr.nodePathCache||[],_a=hashStrings(na==="polygon"?na+","+ds.join(","):na,""+us,""+Ns,""+Zr),rs=is[_a],Cs,Es=!1;return rs!=null?(Cs=rs,Es=!0,gr.pathCache=Cs):(Cs=new Path2D,is[_a]=gr.pathCache=Cs),{path:Cs,cacheHit:Es}},_i=ar.pstyle("shape").strValue,os=ar.pstyle("shape-polygon-points").pfValue;if(yr){or.translate(mr.x,mr.y);var ls=ba(fr,pr,_i,os);xr=ls.path,Cr=ls.cacheHit}var ys=function(){if(!Cr){var Ns=mr;yr&&(Ns={x:0,y:0}),dr.nodeShapes[dr.getNodeShape(ar)].draw(xr||or,Ns.x,Ns.y,fr,pr,Zr,gr)}yr?or.fill(xr):or.fill()},ns=function(){for(var Ns=arguments.length>0&&arguments[0]!==void 0?arguments[0]:br,us=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,na=vr.backgrounding,ds=0,is=0;is<Rr.length;is++){var _a=ar.cy().style().getIndexedStyle(ar,"background-image-containment","value",is);if(us&&_a==="over"||!us&&_a==="inside"){ds++;continue}Tr[is]&&Rr[is].complete&&!Rr[is].error&&(ds++,dr.drawInscribedImage(or,Rr[is],ar,is,Ns))}vr.backgrounding=ds!==Pr,na!==vr.backgrounding&&ar.updateStyle(!1)},as=function(){var Ns=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,us=arguments.length>1&&arguments[1]!==void 0?arguments[1]:br;dr.hasPie(ar)&&(dr.drawPie(or,ar,us),Ns&&(yr||dr.nodeShapes[dr.getNodeShape(ar)].draw(or,mr.x,mr.y,fr,pr,Zr,gr)))},Kr=function(){var Ns=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,us=arguments.length>1&&arguments[1]!==void 0?arguments[1]:br;dr.hasStripe(ar)&&(or.save(),yr?or.clip(gr.pathCache):(dr.nodeShapes[dr.getNodeShape(ar)].draw(or,mr.x,mr.y,fr,pr,Zr,gr),or.clip()),dr.drawStripe(or,ar,us),or.restore(),Ns&&(yr||dr.nodeShapes[dr.getNodeShape(ar)].draw(or,mr.x,mr.y,fr,pr,Zr,gr)))},$a=function(){var Ns=arguments.length>0&&arguments[0]!==void 0?arguments[0]:br,us=(Lr>0?Lr:-Lr)*Ns,na=Lr>0?0:255;Lr!==0&&(dr.colorFillStyle(or,na,na,na,us),yr?or.fill(xr):or.fill())},ss=function(){if(Or>0){if(or.lineWidth=Or,or.lineCap=Fr,or.lineJoin=jr,or.setLineDash)switch($r){case"dotted":or.setLineDash([1,1]);break;case"dashed":or.setLineDash(Hr),or.lineDashOffset=Wr;break;case"solid":case"double":or.setLineDash([]);break}if(zr!=="center"){if(or.save(),or.lineWidth*=2,zr==="inside")yr?or.clip(xr):or.clip();else{var Ns=new Path2D;Ns.rect(-fr/2-Or,-pr/2-Or,fr+2*Or,pr+2*Or),Ns.addPath(xr),or.clip(Ns,"evenodd")}yr?or.stroke(xr):or.stroke(),or.restore()}else yr?or.stroke(xr):or.stroke();if($r==="double"){or.lineWidth=Or/3;var us=or.globalCompositeOperation;or.globalCompositeOperation="destination-out",yr?or.stroke(xr):or.stroke(),or.globalCompositeOperation=us}or.setLineDash&&or.setLineDash([])}},hs=function(){if(qr>0){if(or.lineWidth=qr,or.lineCap="butt",or.setLineDash)switch(Ur){case"dotted":or.setLineDash([1,1]);break;case"dashed":or.setLineDash([4,2]);break;case"solid":case"double":or.setLineDash([]);break}var Ns=mr;yr&&(Ns={x:0,y:0});var us=dr.getNodeShape(ar),na=Or;zr==="inside"&&(na=0),zr==="outside"&&(na*=2);var ds=(fr+na+(qr+Xr))/fr,is=(pr+na+(qr+Xr))/pr,_a=fr*ds,rs=pr*is,Cs=dr.nodeShapes[us].points,Es;if(yr){var Rs=ba(_a,rs,us,Cs);Es=Rs.path}if(us==="ellipse")dr.drawEllipsePath(Es||or,Ns.x,Ns.y,_a,rs);else if(["round-diamond","round-heptagon","round-hexagon","round-octagon","round-pentagon","round-polygon","round-triangle","round-tag"].includes(us)){var xa=0,ps=0,Ps=0;us==="round-diamond"?xa=(na+Xr+qr)*1.4:us==="round-heptagon"?(xa=(na+Xr+qr)*1.075,Ps=-(na/2+Xr+qr)/35):us==="round-hexagon"?xa=(na+Xr+qr)*1.12:us==="round-pentagon"?(xa=(na+Xr+qr)*1.13,Ps=-(na/2+Xr+qr)/15):us==="round-tag"?(xa=(na+Xr+qr)*1.12,ps=(na/2+qr+Xr)*.07):us==="round-triangle"&&(xa=(na+Xr+qr)*(Math.PI/2),Ps=-(na+Xr/2+qr)/Math.PI),xa!==0&&(ds=(fr+xa)/fr,_a=fr*ds,["round-hexagon","round-tag"].includes(us)||(is=(pr+xa)/pr,rs=pr*is)),Zr=Zr==="auto"?getRoundPolygonRadius(_a,rs):Zr;for(var Ms=_a/2,Ls=rs/2,Ds=Zr+(na+qr+Xr)/2,es=new Array(Cs.length/2),ts=new Array(Cs.length/2),cs=0;cs<Cs.length/2;cs++)es[cs]={x:Ns.x+ps+Ms*Cs[cs*2],y:Ns.y+Ps+Ls*Cs[cs*2+1]};var gs,Ss,As,ks,js=es.length;for(Ss=es[js-1],gs=0;gs<js;gs++)As=es[gs%js],ks=es[(gs+1)%js],ts[gs]=getRoundCorner(Ss,As,ks,Ds),Ss=As,As=ks;dr.drawRoundPolygonPath(Es||or,Ns.x+ps,Ns.y+Ps,fr*ds,pr*is,Cs,ts)}else if(["roundrectangle","round-rectangle"].includes(us))Zr=Zr==="auto"?getRoundRectangleRadius(_a,rs):Zr,dr.drawRoundRectanglePath(Es||or,Ns.x,Ns.y,_a,rs,Zr+(na+qr+Xr)/2);else if(["cutrectangle","cut-rectangle"].includes(us))Zr=Zr==="auto"?getCutRectangleCornerLength():Zr,dr.drawCutRectanglePath(Es||or,Ns.x,Ns.y,_a,rs,null,Zr+(na+qr+Xr)/4);else if(["bottomroundrectangle","bottom-round-rectangle"].includes(us))Zr=Zr==="auto"?getRoundRectangleRadius(_a,rs):Zr,dr.drawBottomRoundRectanglePath(Es||or,Ns.x,Ns.y,_a,rs,Zr+(na+qr+Xr)/2);else if(us==="barrel")dr.drawBarrelPath(Es||or,Ns.x,Ns.y,_a,rs);else if(us.startsWith("polygon")||["rhomboid","right-rhomboid","round-tag","tag","vee"].includes(us)){var zs=(na+qr+Xr)/fr;Cs=joinLines(expandPolygon(Cs,zs)),dr.drawPolygonPath(Es||or,Ns.x,Ns.y,fr,pr,Cs)}else{var Fs=(na+qr+Xr)/fr;Cs=joinLines(expandPolygon(Cs,-Fs)),dr.drawPolygonPath(Es||or,Ns.x,Ns.y,fr,pr,Cs)}if(yr?or.stroke(Es):or.stroke(),Ur==="double"){or.lineWidth=na/3;var qs=or.globalCompositeOperation;or.globalCompositeOperation="destination-out",yr?or.stroke(Es):or.stroke(),or.globalCompositeOperation=qs}or.setLineDash&&or.setLineDash([])}},vs=function(){cr&&dr.drawNodeOverlay(or,ar,mr,fr,pr)},bs=function(){cr&&dr.drawNodeUnderlay(or,ar,mr,fr,pr)},xs=function(){dr.drawElementText(or,ar,null,ur)},fs=ar.pstyle("ghost").value==="yes";if(fs){var Is=ar.pstyle("ghost-offset-x").pfValue,Os=ar.pstyle("ghost-offset-y").pfValue,Us=ar.pstyle("ghost-opacity").value,$s=Us*br;or.translate(Is,Os),ga(),hs(),Jr(Us*Ir),ys(),ns($s,!0),Qr(Us*Yr),ss(),as(Lr!==0||Or!==0),Kr(Lr!==0||Or!==0),ns($s,!1),$a($s),or.translate(-Is,-Os)}yr&&or.translate(-mr.x,-mr.y),bs(),yr&&or.translate(mr.x,mr.y),ga(),hs(),Jr(),ys(),ns(br,!0),Qr(),ss(),as(Lr!==0||Or!==0),Kr(Lr!==0||Or!==0),ns(br,!1),$a(),yr&&or.translate(-mr.x,-mr.y),xs(),vs(),lr&&or.translate(wr.x1,wr.y1)}};var drawNodeOverlayUnderlay=function or(ar){if(!["overlay","underlay"].includes(ar))throw new Error("Invalid state");return function(lr,ur,cr,hr,dr){var fr=this;if(ur.visible()){var pr=ur.pstyle("".concat(ar,"-padding")).pfValue,vr=ur.pstyle("".concat(ar,"-opacity")).value,gr=ur.pstyle("".concat(ar,"-color")).value,mr=ur.pstyle("".concat(ar,"-shape")).value,br=ur.pstyle("".concat(ar,"-corner-radius")).value;if(vr>0){if(cr=cr||ur.position(),hr==null||dr==null){var yr=ur.padding();hr=ur.width()+2*yr,dr=ur.height()+2*yr}fr.colorFillStyle(lr,gr[0],gr[1],gr[2],vr),fr.nodeShapes[mr].draw(lr,cr.x,cr.y,hr+pr*2,dr+pr*2,br),lr.fill()}}}};CRp$6.drawNodeOverlay=drawNodeOverlayUnderlay("overlay");CRp$6.drawNodeUnderlay=drawNodeOverlayUnderlay("underlay");CRp$6.hasPie=function(or){return or=or[0],or._private.hasPie};CRp$6.hasStripe=function(or){return or=or[0],or._private.hasStripe};CRp$6.drawPie=function(or,ar,lr,ur){ar=ar[0],ur=ur||ar.position();var cr=ar.cy().style(),hr=ar.pstyle("pie-size"),dr=ar.pstyle("pie-hole"),fr=ar.pstyle("pie-start-angle").pfValue,pr=ur.x,vr=ur.y,gr=ar.width(),mr=ar.height(),br=Math.min(gr,mr)/2,yr,xr=0,Cr=this.usePaths();if(Cr&&(pr=0,vr=0),hr.units==="%"?br=br*hr.pfValue:hr.pfValue!==void 0&&(br=hr.pfValue/2),dr.units==="%"?yr=br*dr.pfValue:dr.pfValue!==void 0&&(yr=dr.pfValue/2),!(yr>=br))for(var Sr=1;Sr<=cr.pieBackgroundN;Sr++){var wr=ar.pstyle("pie-"+Sr+"-background-size").value,Er=ar.pstyle("pie-"+Sr+"-background-color").value,Ar=ar.pstyle("pie-"+Sr+"-background-opacity").value*lr,Tr=wr/100;Tr+xr>1&&(Tr=1-xr);var Rr=1.5*Math.PI+2*Math.PI*xr;Rr+=fr;var Pr=2*Math.PI*Tr,_r=Rr+Pr;wr===0||xr>=1||xr+Tr>1||(yr===0?(or.beginPath(),or.moveTo(pr,vr),or.arc(pr,vr,br,Rr,_r),or.closePath()):(or.beginPath(),or.arc(pr,vr,br,Rr,_r),or.arc(pr,vr,yr,_r,Rr,!0),or.closePath()),this.colorFillStyle(or,Er[0],Er[1],Er[2],Ar),or.fill(),xr+=Tr)}};CRp$6.drawStripe=function(or,ar,lr,ur){ar=ar[0],ur=ur||ar.position();var cr=ar.cy().style(),hr=ur.x,dr=ur.y,fr=ar.width(),pr=ar.height(),vr=0,gr=this.usePaths();or.save();var mr=ar.pstyle("stripe-direction").value,br=ar.pstyle("stripe-size");switch(mr){case"vertical":break;case"righward":or.rotate(-Math.PI/2);break}var yr=fr,xr=pr;br.units==="%"?(yr=yr*br.pfValue,xr=xr*br.pfValue):br.pfValue!==void 0&&(yr=br.pfValue,xr=br.pfValue),gr&&(hr=0,dr=0),dr-=yr/2,hr-=xr/2;for(var Cr=1;Cr<=cr.stripeBackgroundN;Cr++){var Sr=ar.pstyle("stripe-"+Cr+"-background-size").value,wr=ar.pstyle("stripe-"+Cr+"-background-color").value,Er=ar.pstyle("stripe-"+Cr+"-background-opacity").value*lr,Ar=Sr/100;Ar+vr>1&&(Ar=1-vr),!(Sr===0||vr>=1||vr+Ar>1)&&(or.beginPath(),or.rect(hr,dr+xr*vr,yr,xr*Ar),or.closePath(),this.colorFillStyle(or,wr[0],wr[1],wr[2],Er),or.fill(),vr+=Ar)}or.restore()};var CRp$5={},motionBlurDelay=100;CRp$5.getPixelRatio=function(){var or=this.data.contexts[0];if(this.forcedPixelRatio!=null)return this.forcedPixelRatio;var ar=this.cy.window(),lr=or.backingStorePixelRatio||or.webkitBackingStorePixelRatio||or.mozBackingStorePixelRatio||or.msBackingStorePixelRatio||or.oBackingStorePixelRatio||or.backingStorePixelRatio||1;return(ar.devicePixelRatio||1)/lr};CRp$5.paintCache=function(or){for(var ar=this.paintCaches=this.paintCaches||[],lr=!0,ur,cr=0;cr<ar.length;cr++)if(ur=ar[cr],ur.context===or){lr=!1;break}return lr&&(ur={context:or},ar.push(ur)),ur};CRp$5.createGradientStyleFor=function(or,ar,lr,ur,cr){var hr,dr=this.usePaths(),fr=lr.pstyle(ar+"-gradient-stop-colors").value,pr=lr.pstyle(ar+"-gradient-stop-positions").pfValue;if(ur==="radial-gradient")if(lr.isEdge()){var vr=lr.sourceEndpoint(),gr=lr.targetEndpoint(),mr=lr.midpoint(),br=dist(vr,mr),yr=dist(gr,mr);hr=or.createRadialGradient(mr.x,mr.y,0,mr.x,mr.y,Math.max(br,yr))}else{var xr=dr?{x:0,y:0}:lr.position(),Cr=lr.paddedWidth(),Sr=lr.paddedHeight();hr=or.createRadialGradient(xr.x,xr.y,0,xr.x,xr.y,Math.max(Cr,Sr))}else if(lr.isEdge()){var wr=lr.sourceEndpoint(),Er=lr.targetEndpoint();hr=or.createLinearGradient(wr.x,wr.y,Er.x,Er.y)}else{var Ar=dr?{x:0,y:0}:lr.position(),Tr=lr.paddedWidth(),Rr=lr.paddedHeight(),Pr=Tr/2,_r=Rr/2,kr=lr.pstyle("background-gradient-direction").value;switch(kr){case"to-bottom":hr=or.createLinearGradient(Ar.x,Ar.y-_r,Ar.x,Ar.y+_r);break;case"to-top":hr=or.createLinearGradient(Ar.x,Ar.y+_r,Ar.x,Ar.y-_r);break;case"to-left":hr=or.createLinearGradient(Ar.x+Pr,Ar.y,Ar.x-Pr,Ar.y);break;case"to-right":hr=or.createLinearGradient(Ar.x-Pr,Ar.y,Ar.x+Pr,Ar.y);break;case"to-bottom-right":case"to-right-bottom":hr=or.createLinearGradient(Ar.x-Pr,Ar.y-_r,Ar.x+Pr,Ar.y+_r);break;case"to-top-right":case"to-right-top":hr=or.createLinearGradient(Ar.x-Pr,Ar.y+_r,Ar.x+Pr,Ar.y-_r);break;case"to-bottom-left":case"to-left-bottom":hr=or.createLinearGradient(Ar.x+Pr,Ar.y-_r,Ar.x-Pr,Ar.y+_r);break;case"to-top-left":case"to-left-top":hr=or.createLinearGradient(Ar.x+Pr,Ar.y+_r,Ar.x-Pr,Ar.y-_r);break}}if(!hr)return null;for(var Dr=pr.length===fr.length,Nr=fr.length,Lr=0;Lr<Nr;Lr++)hr.addColorStop(Dr?pr[Lr]:Lr/(Nr-1),"rgba("+fr[Lr][0]+","+fr[Lr][1]+","+fr[Lr][2]+","+cr+")");return hr};CRp$5.gradientFillStyle=function(or,ar,lr,ur){var cr=this.createGradientStyleFor(or,"background",ar,lr,ur);if(!cr)return null;or.fillStyle=cr};CRp$5.colorFillStyle=function(or,ar,lr,ur,cr){or.fillStyle="rgba("+ar+","+lr+","+ur+","+cr+")"};CRp$5.eleFillStyle=function(or,ar,lr){var ur=ar.pstyle("background-fill").value;if(ur==="linear-gradient"||ur==="radial-gradient")this.gradientFillStyle(or,ar,ur,lr);else{var cr=ar.pstyle("background-color").value;this.colorFillStyle(or,cr[0],cr[1],cr[2],lr)}};CRp$5.gradientStrokeStyle=function(or,ar,lr,ur){var cr=this.createGradientStyleFor(or,"line",ar,lr,ur);if(!cr)return null;or.strokeStyle=cr};CRp$5.colorStrokeStyle=function(or,ar,lr,ur,cr){or.strokeStyle="rgba("+ar+","+lr+","+ur+","+cr+")"};CRp$5.eleStrokeStyle=function(or,ar,lr){var ur=ar.pstyle("line-fill").value;if(ur==="linear-gradient"||ur==="radial-gradient")this.gradientStrokeStyle(or,ar,ur,lr);else{var cr=ar.pstyle("line-color").value;this.colorStrokeStyle(or,cr[0],cr[1],cr[2],lr)}};CRp$5.matchCanvasSize=function(or){var ar=this,lr=ar.data,ur=ar.findContainerClientCoords(),cr=ur[2],hr=ur[3],dr=ar.getPixelRatio(),fr=ar.motionBlurPxRatio;(or===ar.data.bufferCanvases[ar.MOTIONBLUR_BUFFER_NODE]||or===ar.data.bufferCanvases[ar.MOTIONBLUR_BUFFER_DRAG])&&(dr=fr);var pr=cr*dr,vr=hr*dr,gr;if(!(pr===ar.canvasWidth&&vr===ar.canvasHeight)){ar.fontCaches=null;var mr=lr.canvasContainer;mr.style.width=cr+"px",mr.style.height=hr+"px";for(var br=0;br<ar.CANVAS_LAYERS;br++)gr=lr.canvases[br],gr.width=pr,gr.height=vr,gr.style.width=cr+"px",gr.style.height=hr+"px";for(var br=0;br<ar.BUFFER_COUNT;br++)gr=lr.bufferCanvases[br],gr.width=pr,gr.height=vr,gr.style.width=cr+"px",gr.style.height=hr+"px";ar.textureMult=1,dr<=1&&(gr=lr.bufferCanvases[ar.TEXTURE_BUFFER],ar.textureMult=2,gr.width=pr*ar.textureMult,gr.height=vr*ar.textureMult),ar.canvasWidth=pr,ar.canvasHeight=vr,ar.pixelRatio=dr}};CRp$5.renderTo=function(or,ar,lr,ur){this.render({forcedContext:or,forcedZoom:ar,forcedPan:lr,drawAllLayers:!0,forcedPxRatio:ur})};CRp$5.clearCanvas=function(){var or=this,ar=or.data;function lr(ur){ur.clearRect(0,0,or.canvasWidth,or.canvasHeight)}lr(ar.contexts[or.NODE]),lr(ar.contexts[or.DRAG])};CRp$5.render=function(or){var ar=this;or=or||staticEmptyObject();var lr=ar.cy,ur=or.forcedContext,cr=or.drawAllLayers,hr=or.drawOnlyNodeLayer,dr=or.forcedZoom,fr=or.forcedPan,pr=or.forcedPxRatio===void 0?this.getPixelRatio():or.forcedPxRatio,vr=ar.data,gr=vr.canvasNeedsRedraw,mr=ar.textureOnViewport&&!ur&&(ar.pinching||ar.hoverData.dragging||ar.swipePanning||ar.data.wheelZooming),br=or.motionBlur!==void 0?or.motionBlur:ar.motionBlur,yr=ar.motionBlurPxRatio,xr=lr.hasCompoundNodes(),Cr=ar.hoverData.draggingEles,Sr=!!(ar.hoverData.selecting||ar.touchData.selecting);br=br&&!ur&&ar.motionBlurEnabled&&!Sr;var wr=br;ur||(ar.prevPxRatio!==pr&&(ar.invalidateContainerClientCoordsCache(),ar.matchCanvasSize(ar.container),ar.redrawHint("eles",!0),ar.redrawHint("drag",!0)),ar.prevPxRatio=pr),!ur&&ar.motionBlurTimeout&&clearTimeout(ar.motionBlurTimeout),br&&(ar.mbFrames==null&&(ar.mbFrames=0),ar.mbFrames++,ar.mbFrames<3&&(wr=!1),ar.mbFrames>ar.minMbLowQualFrames&&(ar.motionBlurPxRatio=ar.mbPxRBlurry)),ar.clearingMotionBlur&&(ar.motionBlurPxRatio=1),ar.textureDrawLastFrame&&!mr&&(gr[ar.NODE]=!0,gr[ar.SELECT_BOX]=!0);var Er=lr.style(),Ar=lr.zoom(),Tr=dr!==void 0?dr:Ar,Rr=lr.pan(),Pr={x:Rr.x,y:Rr.y},_r={zoom:Ar,pan:{x:Rr.x,y:Rr.y}},kr=ar.prevViewport,Dr=kr===void 0||_r.zoom!==kr.zoom||_r.pan.x!==kr.pan.x||_r.pan.y!==kr.pan.y;!Dr&&!(Cr&&!xr)&&(ar.motionBlurPxRatio=1),fr&&(Pr=fr),Tr*=pr,Pr.x*=pr,Pr.y*=pr;var Nr=ar.getCachedZSortedEles();function Lr(Qr,ga,ba,_i,os){var ls=Qr.globalCompositeOperation;Qr.globalCompositeOperation="destination-out",ar.colorFillStyle(Qr,255,255,255,ar.motionBlurTransparency),Qr.fillRect(ga,ba,_i,os),Qr.globalCompositeOperation=ls}function Or(Qr,ga){var ba,_i,os,ls;!ar.clearingMotionBlur&&(Qr===vr.bufferContexts[ar.MOTIONBLUR_BUFFER_NODE]||Qr===vr.bufferContexts[ar.MOTIONBLUR_BUFFER_DRAG])?(ba={x:Rr.x*yr,y:Rr.y*yr},_i=Ar*yr,os=ar.canvasWidth*yr,ls=ar.canvasHeight*yr):(ba=Pr,_i=Tr,os=ar.canvasWidth,ls=ar.canvasHeight),Qr.setTransform(1,0,0,1,0,0),ga==="motionBlur"?Lr(Qr,0,0,os,ls):!ur&&(ga===void 0||ga)&&Qr.clearRect(0,0,os,ls),cr||(Qr.translate(ba.x,ba.y),Qr.scale(_i,_i)),fr&&Qr.translate(fr.x,fr.y),dr&&Qr.scale(dr,dr)}if(mr||(ar.textureDrawLastFrame=!1),mr){if(ar.textureDrawLastFrame=!0,!ar.textureCache){ar.textureCache={},ar.textureCache.bb=lr.mutableElements().boundingBox(),ar.textureCache.texture=ar.data.bufferCanvases[ar.TEXTURE_BUFFER];var Ir=ar.data.bufferContexts[ar.TEXTURE_BUFFER];Ir.setTransform(1,0,0,1,0,0),Ir.clearRect(0,0,ar.canvasWidth*ar.textureMult,ar.canvasHeight*ar.textureMult),ar.render({forcedContext:Ir,drawOnlyNodeLayer:!0,forcedPxRatio:pr*ar.textureMult});var _r=ar.textureCache.viewport={zoom:lr.zoom(),pan:lr.pan(),width:ar.canvasWidth,height:ar.canvasHeight};_r.mpan={x:(0-_r.pan.x)/_r.zoom,y:(0-_r.pan.y)/_r.zoom}}gr[ar.DRAG]=!1,gr[ar.NODE]=!1;var Mr=vr.contexts[ar.NODE],$r=ar.textureCache.texture,_r=ar.textureCache.viewport;Mr.setTransform(1,0,0,1,0,0),br?Lr(Mr,0,0,_r.width,_r.height):Mr.clearRect(0,0,_r.width,_r.height);var jr=Er.core("outside-texture-bg-color").value,Fr=Er.core("outside-texture-bg-opacity").value;ar.colorFillStyle(Mr,jr[0],jr[1],jr[2],Fr),Mr.fillRect(0,0,_r.width,_r.height);var Ar=lr.zoom();Or(Mr,!1),Mr.clearRect(_r.mpan.x,_r.mpan.y,_r.width/_r.zoom/pr,_r.height/_r.zoom/pr),Mr.drawImage($r,_r.mpan.x,_r.mpan.y,_r.width/_r.zoom/pr,_r.height/_r.zoom/pr)}else ar.textureOnViewport&&!ur&&(ar.textureCache=null);var zr=lr.extent(),Hr=ar.pinching||ar.hoverData.dragging||ar.swipePanning||ar.data.wheelZooming||ar.hoverData.draggingEles||ar.cy.animated(),Wr=ar.hideEdgesOnViewport&&Hr,Yr=[];if(Yr[ar.NODE]=!gr[ar.NODE]&&br&&!ar.clearedForMotionBlur[ar.NODE]||ar.clearingMotionBlur,Yr[ar.NODE]&&(ar.clearedForMotionBlur[ar.NODE]=!0),Yr[ar.DRAG]=!gr[ar.DRAG]&&br&&!ar.clearedForMotionBlur[ar.DRAG]||ar.clearingMotionBlur,Yr[ar.DRAG]&&(ar.clearedForMotionBlur[ar.DRAG]=!0),gr[ar.NODE]||cr||hr||Yr[ar.NODE]){var qr=br&&!Yr[ar.NODE]&&yr!==1,Mr=ur||(qr?ar.data.bufferContexts[ar.MOTIONBLUR_BUFFER_NODE]:vr.contexts[ar.NODE]),Br=br&&!qr?"motionBlur":void 0;Or(Mr,Br),Wr?ar.drawCachedNodes(Mr,Nr.nondrag,pr,zr):ar.drawLayeredElements(Mr,Nr.nondrag,pr,zr),ar.debug&&ar.drawDebugPoints(Mr,Nr.nondrag),!cr&&!br&&(gr[ar.NODE]=!1)}if(!hr&&(gr[ar.DRAG]||cr||Yr[ar.DRAG])){var qr=br&&!Yr[ar.DRAG]&&yr!==1,Mr=ur||(qr?ar.data.bufferContexts[ar.MOTIONBLUR_BUFFER_DRAG]:vr.contexts[ar.DRAG]);Or(Mr,br&&!qr?"motionBlur":void 0),Wr?ar.drawCachedNodes(Mr,Nr.drag,pr,zr):ar.drawCachedElements(Mr,Nr.drag,pr,zr),ar.debug&&ar.drawDebugPoints(Mr,Nr.drag),!cr&&!br&&(gr[ar.DRAG]=!1)}if(this.drawSelectionRectangle(or,Or),br&&yr!==1){var Ur=vr.contexts[ar.NODE],Vr=ar.data.bufferCanvases[ar.MOTIONBLUR_BUFFER_NODE],Xr=vr.contexts[ar.DRAG],Zr=ar.data.bufferCanvases[ar.MOTIONBLUR_BUFFER_DRAG],Jr=function(ga,ba,_i){ga.setTransform(1,0,0,1,0,0),_i||!wr?ga.clearRect(0,0,ar.canvasWidth,ar.canvasHeight):Lr(ga,0,0,ar.canvasWidth,ar.canvasHeight);var os=yr;ga.drawImage(ba,0,0,ar.canvasWidth*os,ar.canvasHeight*os,0,0,ar.canvasWidth,ar.canvasHeight)};(gr[ar.NODE]||Yr[ar.NODE])&&(Jr(Ur,Vr,Yr[ar.NODE]),gr[ar.NODE]=!1),(gr[ar.DRAG]||Yr[ar.DRAG])&&(Jr(Xr,Zr,Yr[ar.DRAG]),gr[ar.DRAG]=!1)}ar.prevViewport=_r,ar.clearingMotionBlur&&(ar.clearingMotionBlur=!1,ar.motionBlurCleared=!0,ar.motionBlur=!0),br&&(ar.motionBlurTimeout=setTimeout(function(){ar.motionBlurTimeout=null,ar.clearedForMotionBlur[ar.NODE]=!1,ar.clearedForMotionBlur[ar.DRAG]=!1,ar.motionBlur=!1,ar.clearingMotionBlur=!mr,ar.mbFrames=0,gr[ar.NODE]=!0,gr[ar.DRAG]=!0,ar.redraw()},motionBlurDelay)),ur||lr.emit("render")};var fpsHeight;CRp$5.drawSelectionRectangle=function(or,ar){var lr=this,ur=lr.cy,cr=lr.data,hr=ur.style(),dr=or.drawOnlyNodeLayer,fr=or.drawAllLayers,pr=cr.canvasNeedsRedraw,vr=or.forcedContext;if(lr.showFps||!dr&&pr[lr.SELECT_BOX]&&!fr){var gr=vr||cr.contexts[lr.SELECT_BOX];if(ar(gr),lr.selection[4]==1&&(lr.hoverData.selecting||lr.touchData.selecting)){var mr=lr.cy.zoom(),br=hr.core("selection-box-border-width").value/mr;gr.lineWidth=br,gr.fillStyle="rgba("+hr.core("selection-box-color").value[0]+","+hr.core("selection-box-color").value[1]+","+hr.core("selection-box-color").value[2]+","+hr.core("selection-box-opacity").value+")",gr.fillRect(lr.selection[0],lr.selection[1],lr.selection[2]-lr.selection[0],lr.selection[3]-lr.selection[1]),br>0&&(gr.strokeStyle="rgba("+hr.core("selection-box-border-color").value[0]+","+hr.core("selection-box-border-color").value[1]+","+hr.core("selection-box-border-color").value[2]+","+hr.core("selection-box-opacity").value+")",gr.strokeRect(lr.selection[0],lr.selection[1],lr.selection[2]-lr.selection[0],lr.selection[3]-lr.selection[1]))}if(cr.bgActivePosistion&&!lr.hoverData.selecting){var mr=lr.cy.zoom(),yr=cr.bgActivePosistion;gr.fillStyle="rgba("+hr.core("active-bg-color").value[0]+","+hr.core("active-bg-color").value[1]+","+hr.core("active-bg-color").value[2]+","+hr.core("active-bg-opacity").value+")",gr.beginPath(),gr.arc(yr.x,yr.y,hr.core("active-bg-size").pfValue/mr,0,2*Math.PI),gr.fill()}var xr=lr.lastRedrawTime;if(lr.showFps&&xr){xr=Math.round(xr);var Cr=Math.round(1e3/xr),Sr="1 frame = "+xr+" ms = "+Cr+" fps";if(gr.setTransform(1,0,0,1,0,0),gr.fillStyle="rgba(255, 0, 0, 0.75)",gr.strokeStyle="rgba(255, 0, 0, 0.75)",gr.font="30px Arial",!fpsHeight){var wr=gr.measureText(Sr);fpsHeight=wr.actualBoundingBoxAscent}gr.fillText(Sr,0,fpsHeight);var Er=60;gr.strokeRect(0,fpsHeight+10,250,20),gr.fillRect(0,fpsHeight+10,250*Math.min(Cr/Er,1),20)}fr||(pr[lr.SELECT_BOX]=!1)}};function compileShader(or,ar,lr){var ur=or.createShader(ar);if(or.shaderSource(ur,lr),or.compileShader(ur),!or.getShaderParameter(ur,or.COMPILE_STATUS))throw new Error(or.getShaderInfoLog(ur));return ur}function createProgram(or,ar,lr){var ur=compileShader(or,or.VERTEX_SHADER,ar),cr=compileShader(or,or.FRAGMENT_SHADER,lr),hr=or.createProgram();if(or.attachShader(hr,ur),or.attachShader(hr,cr),or.linkProgram(hr),!or.getProgramParameter(hr,or.LINK_STATUS))throw new Error("Could not initialize shaders");return hr}function createTextureCanvas(or,ar,lr){lr===void 0&&(lr=ar);var ur=or.makeOffscreenCanvas(ar,lr),cr=ur.context=ur.getContext("2d");return ur.clear=function(){return cr.clearRect(0,0,ur.width,ur.height)},ur.clear(),ur}function getEffectivePanZoom(or){var ar=or.pixelRatio,lr=or.cy.zoom(),ur=or.cy.pan();return{zoom:lr*ar,pan:{x:ur.x*ar,y:ur.y*ar}}}function getEffectiveZoom(or){var ar=or.pixelRatio,lr=or.cy.zoom();return lr*ar}function modelToRenderedPosition(or,ar,lr,ur,cr){var hr=ur*lr+ar.x,dr=cr*lr+ar.y;return dr=Math.round(or.canvasHeight-dr),[hr,dr]}function isSimpleShape(or){return or.pstyle("background-fill").value!=="solid"||or.pstyle("background-image").strValue!=="none"?!1:or.pstyle("border-width").value===0||or.pstyle("border-opacity").value===0?!0:or.pstyle("border-style").value==="solid"}function arrayEqual(or,ar){if(or.length!==ar.length)return!1;for(var lr=0;lr<or.length;lr++)if(or[lr]!==ar[lr])return!1;return!0}function toWebGLColor(or,ar,lr){var ur=or[0]/255,cr=or[1]/255,hr=or[2]/255,dr=ar,fr=lr||new Array(4);return fr[0]=ur*dr,fr[1]=cr*dr,fr[2]=hr*dr,fr[3]=dr,fr}function indexToVec4(or,ar){var lr=ar||new Array(4);return lr[0]=(or>>0&255)/255,lr[1]=(or>>8&255)/255,lr[2]=(or>>16&255)/255,lr[3]=(or>>24&255)/255,lr}function vec4ToIndex(or){return or[0]+(or[1]<<8)+(or[2]<<16)+(or[3]<<24)}function createTexture(or,ar){var lr=or.createTexture();return lr.buffer=function(ur){or.bindTexture(or.TEXTURE_2D,lr),or.texParameteri(or.TEXTURE_2D,or.TEXTURE_WRAP_S,or.CLAMP_TO_EDGE),or.texParameteri(or.TEXTURE_2D,or.TEXTURE_WRAP_T,or.CLAMP_TO_EDGE),or.texParameteri(or.TEXTURE_2D,or.TEXTURE_MAG_FILTER,or.LINEAR),or.texParameteri(or.TEXTURE_2D,or.TEXTURE_MIN_FILTER,or.LINEAR_MIPMAP_NEAREST),or.pixelStorei(or.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),or.texImage2D(or.TEXTURE_2D,0,or.RGBA,or.RGBA,or.UNSIGNED_BYTE,ur),or.generateMipmap(or.TEXTURE_2D),or.bindTexture(or.TEXTURE_2D,null)},lr.deleteTexture=function(){or.deleteTexture(lr)},lr}function getTypeInfo(or,ar){switch(ar){case"float":return[1,or.FLOAT,4];case"vec2":return[2,or.FLOAT,4];case"vec3":return[3,or.FLOAT,4];case"vec4":return[4,or.FLOAT,4];case"int":return[1,or.INT,4];case"ivec2":return[2,or.INT,4]}}function createTypedArray(or,ar,lr){switch(ar){case or.FLOAT:return new Float32Array(lr);case or.INT:return new Int32Array(lr)}}function createTypedArrayView(or,ar,lr,ur,cr,hr){switch(ar){case or.FLOAT:return new Float32Array(lr.buffer,hr*ur,cr);case or.INT:return new Int32Array(lr.buffer,hr*ur,cr)}}function createBufferStaticDraw(or,ar,lr,ur){var cr=getTypeInfo(or,ar),hr=_slicedToArray(cr,2),dr=hr[0],fr=hr[1],pr=createTypedArray(or,fr,ur),vr=or.createBuffer();return or.bindBuffer(or.ARRAY_BUFFER,vr),or.bufferData(or.ARRAY_BUFFER,pr,or.STATIC_DRAW),fr===or.FLOAT?or.vertexAttribPointer(lr,dr,fr,!1,0,0):fr===or.INT&&or.vertexAttribIPointer(lr,dr,fr,0,0),or.enableVertexAttribArray(lr),or.bindBuffer(or.ARRAY_BUFFER,null),vr}function createBufferDynamicDraw(or,ar,lr,ur){var cr=getTypeInfo(or,lr),hr=_slicedToArray(cr,3),dr=hr[0],fr=hr[1],pr=hr[2],vr=createTypedArray(or,fr,ar*dr),gr=dr*pr,mr=or.createBuffer();or.bindBuffer(or.ARRAY_BUFFER,mr),or.bufferData(or.ARRAY_BUFFER,ar*gr,or.DYNAMIC_DRAW),or.enableVertexAttribArray(ur),fr===or.FLOAT?or.vertexAttribPointer(ur,dr,fr,!1,gr,0):fr===or.INT&&or.vertexAttribIPointer(ur,dr,fr,gr,0),or.vertexAttribDivisor(ur,1),or.bindBuffer(or.ARRAY_BUFFER,null);for(var br=new Array(ar),yr=0;yr<ar;yr++)br[yr]=createTypedArrayView(or,fr,vr,gr,dr,yr);return mr.dataArray=vr,mr.stride=gr,mr.size=dr,mr.getView=function(xr){return br[xr]},mr.setPoint=function(xr,Cr,Sr){var wr=br[xr];wr[0]=Cr,wr[1]=Sr},mr.bufferSubData=function(xr){or.bindBuffer(or.ARRAY_BUFFER,mr),xr?or.bufferSubData(or.ARRAY_BUFFER,0,vr,0,xr*dr):or.bufferSubData(or.ARRAY_BUFFER,0,vr)},mr}function create3x3MatrixBufferDynamicDraw(or,ar,lr){for(var ur=9,cr=new Float32Array(ar*ur),hr=new Array(ar),dr=0;dr<ar;dr++){var fr=dr*ur*4;hr[dr]=new Float32Array(cr.buffer,fr,ur)}var pr=or.createBuffer();or.bindBuffer(or.ARRAY_BUFFER,pr),or.bufferData(or.ARRAY_BUFFER,cr.byteLength,or.DYNAMIC_DRAW);for(var vr=0;vr<3;vr++){var gr=lr+vr;or.enableVertexAttribArray(gr),or.vertexAttribPointer(gr,3,or.FLOAT,!1,3*12,vr*12),or.vertexAttribDivisor(gr,1)}return or.bindBuffer(or.ARRAY_BUFFER,null),pr.getMatrixView=function(mr){return hr[mr]},pr.setData=function(mr,br){hr[br].set(mr,0)},pr.bufferSubData=function(){or.bindBuffer(or.ARRAY_BUFFER,pr),or.bufferSubData(or.ARRAY_BUFFER,0,cr)},pr}function createPickingFrameBuffer(or){var ar=or.createFramebuffer();or.bindFramebuffer(or.FRAMEBUFFER,ar);var lr=or.createTexture();return or.bindTexture(or.TEXTURE_2D,lr),or.texParameteri(or.TEXTURE_2D,or.TEXTURE_MIN_FILTER,or.LINEAR),or.texParameteri(or.TEXTURE_2D,or.TEXTURE_WRAP_S,or.CLAMP_TO_EDGE),or.texParameteri(or.TEXTURE_2D,or.TEXTURE_WRAP_T,or.CLAMP_TO_EDGE),or.framebufferTexture2D(or.FRAMEBUFFER,or.COLOR_ATTACHMENT0,or.TEXTURE_2D,lr,0),or.bindFramebuffer(or.FRAMEBUFFER,null),ar.setFramebufferAttachmentSizes=function(ur,cr){or.bindTexture(or.TEXTURE_2D,lr),or.texImage2D(or.TEXTURE_2D,0,or.RGBA,ur,cr,0,or.RGBA,or.UNSIGNED_BYTE,null)},ar}var ARRAY_TYPE=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var or=0,ar=arguments.length;ar--;)or+=arguments[ar]*arguments[ar];return Math.sqrt(or)});function create(){var or=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(or[1]=0,or[2]=0,or[3]=0,or[5]=0,or[6]=0,or[7]=0),or[0]=1,or[4]=1,or[8]=1,or}function identity(or){return or[0]=1,or[1]=0,or[2]=0,or[3]=0,or[4]=1,or[5]=0,or[6]=0,or[7]=0,or[8]=1,or}function multiply(or,ar,lr){var ur=ar[0],cr=ar[1],hr=ar[2],dr=ar[3],fr=ar[4],pr=ar[5],vr=ar[6],gr=ar[7],mr=ar[8],br=lr[0],yr=lr[1],xr=lr[2],Cr=lr[3],Sr=lr[4],wr=lr[5],Er=lr[6],Ar=lr[7],Tr=lr[8];return or[0]=br*ur+yr*dr+xr*vr,or[1]=br*cr+yr*fr+xr*gr,or[2]=br*hr+yr*pr+xr*mr,or[3]=Cr*ur+Sr*dr+wr*vr,or[4]=Cr*cr+Sr*fr+wr*gr,or[5]=Cr*hr+Sr*pr+wr*mr,or[6]=Er*ur+Ar*dr+Tr*vr,or[7]=Er*cr+Ar*fr+Tr*gr,or[8]=Er*hr+Ar*pr+Tr*mr,or}function translate(or,ar,lr){var ur=ar[0],cr=ar[1],hr=ar[2],dr=ar[3],fr=ar[4],pr=ar[5],vr=ar[6],gr=ar[7],mr=ar[8],br=lr[0],yr=lr[1];return or[0]=ur,or[1]=cr,or[2]=hr,or[3]=dr,or[4]=fr,or[5]=pr,or[6]=br*ur+yr*dr+vr,or[7]=br*cr+yr*fr+gr,or[8]=br*hr+yr*pr+mr,or}function rotate(or,ar,lr){var ur=ar[0],cr=ar[1],hr=ar[2],dr=ar[3],fr=ar[4],pr=ar[5],vr=ar[6],gr=ar[7],mr=ar[8],br=Math.sin(lr),yr=Math.cos(lr);return or[0]=yr*ur+br*dr,or[1]=yr*cr+br*fr,or[2]=yr*hr+br*pr,or[3]=yr*dr-br*ur,or[4]=yr*fr-br*cr,or[5]=yr*pr-br*hr,or[6]=vr,or[7]=gr,or[8]=mr,or}function scale(or,ar,lr){var ur=lr[0],cr=lr[1];return or[0]=ur*ar[0],or[1]=ur*ar[1],or[2]=ur*ar[2],or[3]=cr*ar[3],or[4]=cr*ar[4],or[5]=cr*ar[5],or[6]=ar[6],or[7]=ar[7],or[8]=ar[8],or}function projection(or,ar,lr){return or[0]=2/ar,or[1]=0,or[2]=0,or[3]=0,or[4]=-2/lr,or[5]=0,or[6]=-1,or[7]=1,or[8]=1,or}var Atlas=function(){function or(ar,lr,ur,cr){_classCallCheck(this,or),this.debugID=Math.floor(Math.random()*1e4),this.r=ar,this.texSize=lr,this.texRows=ur,this.texHeight=Math.floor(lr/ur),this.enableWrapping=!0,this.locked=!1,this.texture=null,this.needsBuffer=!0,this.freePointer={x:0,row:0},this.keyToLocation=new Map,this.canvas=cr(ar,lr,lr),this.scratch=cr(ar,lr,this.texHeight,"scratch")}return _createClass(or,[{key:"lock",value:function(){this.locked=!0}},{key:"getKeys",value:function(){return new Set(this.keyToLocation.keys())}},{key:"getScale",value:function(lr){var ur=lr.w,cr=lr.h,hr=this.texHeight,dr=this.texSize,fr=hr/cr,pr=ur*fr,vr=cr*fr;return pr>dr&&(fr=dr/ur,pr=ur*fr,vr=cr*fr),{scale:fr,texW:pr,texH:vr}}},{key:"draw",value:function(lr,ur,cr){var hr=this;if(this.locked)throw new Error("can't draw, atlas is locked");var dr=this.texSize,fr=this.texRows,pr=this.texHeight,vr=this.getScale(ur),gr=vr.scale,mr=vr.texW,br=vr.texH,yr=function(Ar,Tr){if(cr&&Tr){var Rr=Tr.context,Pr=Ar.x,_r=Ar.row,kr=Pr,Dr=pr*_r;Rr.save(),Rr.translate(kr,Dr),Rr.scale(gr,gr),cr(Rr,ur),Rr.restore()}},xr=[null,null],Cr=function(){yr(hr.freePointer,hr.canvas),xr[0]={x:hr.freePointer.x,y:hr.freePointer.row*pr,w:mr,h:br},xr[1]={x:hr.freePointer.x+mr,y:hr.freePointer.row*pr,w:0,h:br},hr.freePointer.x+=mr,hr.freePointer.x==dr&&(hr.freePointer.x=0,hr.freePointer.row++)},Sr=function(){var Ar=hr.scratch,Tr=hr.canvas;Ar.clear(),yr({x:0,row:0},Ar);var Rr=dr-hr.freePointer.x,Pr=mr-Rr,_r=pr;{var kr=hr.freePointer.x,Dr=hr.freePointer.row*pr,Nr=Rr;Tr.context.drawImage(Ar,0,0,Nr,_r,kr,Dr,Nr,_r),xr[0]={x:kr,y:Dr,w:Nr,h:br}}{var Lr=Rr,Or=(hr.freePointer.row+1)*pr,Ir=Pr;Tr&&Tr.context.drawImage(Ar,Lr,0,Ir,_r,0,Or,Ir,_r),xr[1]={x:0,y:Or,w:Ir,h:br}}hr.freePointer.x=Pr,hr.freePointer.row++},wr=function(){hr.freePointer.x=0,hr.freePointer.row++};if(this.freePointer.x+mr<=dr)Cr();else{if(this.freePointer.row>=fr-1)return!1;this.freePointer.x===dr?(wr(),Cr()):this.enableWrapping?Sr():(wr(),Cr())}return this.keyToLocation.set(lr,xr),this.needsBuffer=!0,xr}},{key:"getOffsets",value:function(lr){return this.keyToLocation.get(lr)}},{key:"isEmpty",value:function(){return this.freePointer.x===0&&this.freePointer.row===0}},{key:"canFit",value:function(lr){if(this.locked)return!1;var ur=this.texSize,cr=this.texRows,hr=this.getScale(lr),dr=hr.texW;return this.freePointer.x+dr>ur?this.freePointer.row<cr-1:!0}},{key:"bufferIfNeeded",value:function(lr){this.texture||(this.texture=createTexture(lr,this.debugID)),this.needsBuffer&&(this.texture.buffer(this.canvas),this.needsBuffer=!1,this.locked&&(this.canvas=null,this.scratch=null))}},{key:"dispose",value:function(){this.texture&&(this.texture.deleteTexture(),this.texture=null),this.canvas=null,this.scratch=null,this.locked=!0}}])}(),AtlasCollection=function(){function or(ar,lr,ur,cr){_classCallCheck(this,or),this.r=ar,this.texSize=lr,this.texRows=ur,this.createTextureCanvas=cr,this.atlases=[],this.styleKeyToAtlas=new Map,this.markedKeys=new Set}return _createClass(or,[{key:"getKeys",value:function(){return new Set(this.styleKeyToAtlas.keys())}},{key:"_createAtlas",value:function(){var lr=this.r,ur=this.texSize,cr=this.texRows,hr=this.createTextureCanvas;return new Atlas(lr,ur,cr,hr)}},{key:"_getScratchCanvas",value:function(){if(!this.scratch){var lr=this.r,ur=this.texSize,cr=this.texRows,hr=this.createTextureCanvas,dr=Math.floor(ur/cr);this.scratch=hr(lr,ur,dr,"scratch")}return this.scratch}},{key:"draw",value:function(lr,ur,cr){var hr=this.styleKeyToAtlas.get(lr);return hr||(hr=this.atlases[this.atlases.length-1],(!hr||!hr.canFit(ur))&&(hr&&hr.lock(),hr=this._createAtlas(),this.atlases.push(hr)),hr.draw(lr,ur,cr),this.styleKeyToAtlas.set(lr,hr)),hr}},{key:"getAtlas",value:function(lr){return this.styleKeyToAtlas.get(lr)}},{key:"hasAtlas",value:function(lr){return this.styleKeyToAtlas.has(lr)}},{key:"markKeyForGC",value:function(lr){this.markedKeys.add(lr)}},{key:"gc",value:function(){var lr=this,ur=this.markedKeys;if(ur.size===0){console.log("nothing to garbage collect");return}var cr=[],hr=new Map,dr=null,fr=_createForOfIteratorHelper(this.atlases),pr;try{var vr=function(){var mr=pr.value,br=mr.getKeys(),yr=intersection(ur,br);if(yr.size===0)return cr.push(mr),br.forEach(function(Rr){return hr.set(Rr,mr)}),1;dr||(dr=lr._createAtlas(),cr.push(dr));var xr=_createForOfIteratorHelper(br),Cr;try{for(xr.s();!(Cr=xr.n()).done;){var Sr=Cr.value;if(!yr.has(Sr)){var wr=mr.getOffsets(Sr),Er=_slicedToArray(wr,2),Ar=Er[0],Tr=Er[1];dr.canFit({w:Ar.w+Tr.w,h:Ar.h})||(dr.lock(),dr=lr._createAtlas(),cr.push(dr)),mr.canvas&&(lr._copyTextureToNewAtlas(Sr,mr,dr),hr.set(Sr,dr))}}}catch(Rr){xr.e(Rr)}finally{xr.f()}mr.dispose()};for(fr.s();!(pr=fr.n()).done;)vr()}catch(gr){fr.e(gr)}finally{fr.f()}this.atlases=cr,this.styleKeyToAtlas=hr,this.markedKeys=new Set}},{key:"_copyTextureToNewAtlas",value:function(lr,ur,cr){var hr=ur.getOffsets(lr),dr=_slicedToArray(hr,2),fr=dr[0],pr=dr[1];if(pr.w===0)cr.draw(lr,fr,function(br){br.drawImage(ur.canvas,fr.x,fr.y,fr.w,fr.h,0,0,fr.w,fr.h)});else{var vr=this._getScratchCanvas();vr.clear(),vr.context.drawImage(ur.canvas,fr.x,fr.y,fr.w,fr.h,0,0,fr.w,fr.h),vr.context.drawImage(ur.canvas,pr.x,pr.y,pr.w,pr.h,fr.w,0,pr.w,pr.h);var gr=fr.w+pr.w,mr=fr.h;cr.draw(lr,{w:gr,h:mr},function(br){br.drawImage(vr,0,0,gr,mr,0,0,gr,mr)})}}},{key:"getCounts",value:function(){return{keyCount:this.styleKeyToAtlas.size,atlasCount:new Set(this.styleKeyToAtlas.values()).size}}}])}();function intersection(or,ar){return or.intersection?or.intersection(ar):new Set(_toConsumableArray(or).filter(function(lr){return ar.has(lr)}))}var AtlasManager=function(){function or(ar,lr){_classCallCheck(this,or),this.r=ar,this.globalOptions=lr,this.atlasSize=lr.webglTexSize,this.maxAtlasesPerBatch=lr.webglTexPerBatch,this.renderTypes=new Map,this.collections=new Map,this.typeAndIdToKey=new Map}return _createClass(or,[{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"addAtlasCollection",value:function(lr,ur){var cr=this.globalOptions,hr=cr.webglTexSize,dr=cr.createTextureCanvas,fr=ur.texRows,pr=this._cacheScratchCanvas(dr),vr=new AtlasCollection(this.r,hr,fr,pr);this.collections.set(lr,vr)}},{key:"addRenderType",value:function(lr,ur){var cr=ur.collection;if(!this.collections.has(cr))throw new Error("invalid atlas collection name '".concat(cr,"'"));var hr=this.collections.get(cr),dr=extend({type:lr,atlasCollection:hr},ur);this.renderTypes.set(lr,dr)}},{key:"getRenderTypeOpts",value:function(lr){return this.renderTypes.get(lr)}},{key:"getAtlasCollection",value:function(lr){return this.collections.get(lr)}},{key:"_cacheScratchCanvas",value:function(lr){var ur=-1,cr=-1,hr=null;return function(dr,fr,pr,vr){return vr?((!hr||fr!=ur||pr!=cr)&&(ur=fr,cr=pr,hr=lr(dr,fr,pr)),hr):lr(dr,fr,pr)}}},{key:"_key",value:function(lr,ur){return"".concat(lr,"-").concat(ur)}},{key:"invalidate",value:function(lr){var ur=this,cr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},hr=cr.forceRedraw,dr=hr===void 0?!1:hr,fr=cr.filterEle,pr=fr===void 0?function(){return!0}:fr,vr=cr.filterType,gr=vr===void 0?function(){return!0}:vr,mr=!1,br=!1,yr=_createForOfIteratorHelper(lr),xr;try{for(yr.s();!(xr=yr.n()).done;){var Cr=xr.value;if(pr(Cr)){var Sr=_createForOfIteratorHelper(this.renderTypes.values()),wr;try{var Er=function(){var Tr=wr.value,Rr=Tr.type;if(gr(Rr)){var Pr=ur.collections.get(Tr.collection),_r=Tr.getKey(Cr),kr=Array.isArray(_r)?_r:[_r];if(dr)kr.forEach(function(Or){return Pr.markKeyForGC(Or)}),br=!0;else{var Dr=Tr.getID?Tr.getID(Cr):Cr.id(),Nr=ur._key(Rr,Dr),Lr=ur.typeAndIdToKey.get(Nr);Lr!==void 0&&!arrayEqual(kr,Lr)&&(mr=!0,ur.typeAndIdToKey.delete(Nr),Lr.forEach(function(Or){return Pr.markKeyForGC(Or)}))}}};for(Sr.s();!(wr=Sr.n()).done;)Er()}catch(Ar){Sr.e(Ar)}finally{Sr.f()}}}}catch(Ar){yr.e(Ar)}finally{yr.f()}return br&&(this.gc(),mr=!1),mr}},{key:"gc",value:function(){var lr=_createForOfIteratorHelper(this.collections.values()),ur;try{for(lr.s();!(ur=lr.n()).done;){var cr=ur.value;cr.gc()}}catch(hr){lr.e(hr)}finally{lr.f()}}},{key:"getOrCreateAtlas",value:function(lr,ur,cr,hr){var dr=this.renderTypes.get(ur),fr=this.collections.get(dr.collection),pr=!1,vr=fr.draw(hr,cr,function(br){dr.drawClipped?(br.save(),br.beginPath(),br.rect(0,0,cr.w,cr.h),br.clip(),dr.drawElement(br,lr,cr,!0,!0),br.restore()):dr.drawElement(br,lr,cr,!0,!0),pr=!0});if(pr){var gr=dr.getID?dr.getID(lr):lr.id(),mr=this._key(ur,gr);this.typeAndIdToKey.has(mr)?this.typeAndIdToKey.get(mr).push(hr):this.typeAndIdToKey.set(mr,[hr])}return vr}},{key:"getAtlasInfo",value:function(lr,ur){var cr=this,hr=this.renderTypes.get(ur),dr=hr.getKey(lr),fr=Array.isArray(dr)?dr:[dr];return fr.map(function(pr){var vr=hr.getBoundingBox(lr,pr),gr=cr.getOrCreateAtlas(lr,ur,vr,pr),mr=gr.getOffsets(pr),br=_slicedToArray(mr,2),yr=br[0],xr=br[1];return{atlas:gr,tex:yr,tex1:yr,tex2:xr,bb:vr}})}},{key:"getDebugInfo",value:function(){var lr=[],ur=_createForOfIteratorHelper(this.collections),cr;try{for(ur.s();!(cr=ur.n()).done;){var hr=_slicedToArray(cr.value,2),dr=hr[0],fr=hr[1],pr=fr.getCounts(),vr=pr.keyCount,gr=pr.atlasCount;lr.push({type:dr,keyCount:vr,atlasCount:gr})}}catch(mr){ur.e(mr)}finally{ur.f()}return lr}}])}(),AtlasBatchManager=function(){function or(ar){_classCallCheck(this,or),this.globalOptions=ar,this.atlasSize=ar.webglTexSize,this.maxAtlasesPerBatch=ar.webglTexPerBatch,this.batchAtlases=[]}return _createClass(or,[{key:"getMaxAtlasesPerBatch",value:function(){return this.maxAtlasesPerBatch}},{key:"getAtlasSize",value:function(){return this.atlasSize}},{key:"getIndexArray",value:function(){return Array.from({length:this.maxAtlasesPerBatch},function(lr,ur){return ur})}},{key:"startBatch",value:function(){this.batchAtlases=[]}},{key:"getAtlasCount",value:function(){return this.batchAtlases.length}},{key:"getAtlases",value:function(){return this.batchAtlases}},{key:"canAddToCurrentBatch",value:function(lr){return this.batchAtlases.length===this.maxAtlasesPerBatch?this.batchAtlases.includes(lr):!0}},{key:"getAtlasIndexForBatch",value:function(lr){var ur=this.batchAtlases.indexOf(lr);if(ur<0){if(this.batchAtlases.length===this.maxAtlasesPerBatch)throw new Error("cannot add more atlases to batch");this.batchAtlases.push(lr),ur=this.batchAtlases.length-1}return ur}}])}(),circleSD=`
  float circleSD(vec2 p, float r) {
    return distance(vec2(0), p) - r; // signed distance
  }
`,rectangleSD=`
  float rectangleSD(vec2 p, vec2 b) {
    vec2 d = abs(p)-b;
    return distance(vec2(0),max(d,0.0)) + min(max(d.x,d.y),0.0);
  }
`,roundRectangleSD=`
  float roundRectangleSD(vec2 p, vec2 b, vec4 cr) {
    cr.xy = (p.x > 0.0) ? cr.xy : cr.zw;
    cr.x  = (p.y > 0.0) ? cr.x  : cr.y;
    vec2 q = abs(p) - b + cr.x;
    return min(max(q.x, q.y), 0.0) + distance(vec2(0), max(q, 0.0)) - cr.x;
  }
`,ellipseSD=`
  float ellipseSD(vec2 p, vec2 ab) {
    p = abs( p ); // symmetry

    // find root with Newton solver
    vec2 q = ab*(p-ab);
    float w = (q.x<q.y)? 1.570796327 : 0.0;
    for( int i=0; i<5; i++ ) {
      vec2 cs = vec2(cos(w),sin(w));
      vec2 u = ab*vec2( cs.x,cs.y);
      vec2 v = ab*vec2(-cs.y,cs.x);
      w = w + dot(p-u,v)/(dot(p-u,u)+dot(v,v));
    }
    
    // compute final point and distance
    float d = length(p-ab*vec2(cos(w),sin(w)));
    
    // return signed distance
    return (dot(p/ab,p/ab)>1.0) ? d : -d;
  }
`,RENDER_TARGET={SCREEN:{name:"screen",screen:!0},PICKING:{name:"picking",picking:!0}},TEX_PICKING_MODE={IGNORE:1,USE_BB:2},TEXTURE=0,EDGE_STRAIGHT=1,EDGE_CURVE_SEGMENT=2,EDGE_ARROW=3,RECTANGLE=4,ROUND_RECTANGLE=5,BOTTOM_ROUND_RECTANGLE=6,ELLIPSE=7,ElementDrawingWebGL=function(){function or(ar,lr,ur){_classCallCheck(this,or),this.r=ar,this.gl=lr,this.maxInstances=ur.webglBatchSize,this.atlasSize=ur.webglTexSize,this.bgColor=ur.bgColor,this.debug=ur.webglDebug,this.batchDebugInfo=[],ur.enableWrapping=!0,ur.createTextureCanvas=createTextureCanvas,this.atlasManager=new AtlasManager(ar,ur),this.batchManager=new AtlasBatchManager(ur),this.simpleShapeOptions=new Map,this.program=this._createShaderProgram(RENDER_TARGET.SCREEN),this.pickingProgram=this._createShaderProgram(RENDER_TARGET.PICKING),this.vao=this._createVAO()}return _createClass(or,[{key:"addAtlasCollection",value:function(lr,ur){this.atlasManager.addAtlasCollection(lr,ur)}},{key:"addTextureAtlasRenderType",value:function(lr,ur){this.atlasManager.addRenderType(lr,ur)}},{key:"addSimpleShapeRenderType",value:function(lr,ur){this.simpleShapeOptions.set(lr,ur)}},{key:"invalidate",value:function(lr){var ur=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},cr=ur.type,hr=this.atlasManager;return cr?hr.invalidate(lr,{filterType:function(fr){return fr===cr},forceRedraw:!0}):hr.invalidate(lr)}},{key:"gc",value:function(){this.atlasManager.gc()}},{key:"_createShaderProgram",value:function(lr){var ur=this.gl,cr=`#version 300 es
      precision highp float;

      uniform mat3 uPanZoomMatrix;
      uniform int  uAtlasSize;
      
      // instanced
      in vec2 aPosition; // a vertex from the unit square
      
      in mat3 aTransform; // used to transform verticies, eg into a bounding box
      in int aVertType; // the type of thing we are rendering

      // the z-index that is output when using picking mode
      in vec4 aIndex;
      
      // For textures
      in int aAtlasId; // which shader unit/atlas to use
      in vec4 aTex; // x/y/w/h of texture in atlas

      // for edges
      in vec4 aPointAPointB;
      in vec4 aPointCPointD;
      in vec2 aLineWidth; // also used for node border width

      // simple shapes
      in vec4 aCornerRadius; // for round-rectangle [top-right, bottom-right, top-left, bottom-left]
      in vec4 aColor; // also used for edges
      in vec4 aBorderColor; // aLineWidth is used for border width

      // output values passed to the fragment shader
      out vec2 vTexCoord;
      out vec4 vColor;
      out vec2 vPosition;
      // flat values are not interpolated
      flat out int vAtlasId; 
      flat out int vVertType;
      flat out vec2 vTopRight;
      flat out vec2 vBotLeft;
      flat out vec4 vCornerRadius;
      flat out vec4 vBorderColor;
      flat out vec2 vBorderWidth;
      flat out vec4 vIndex;
      
      void main(void) {
        int vid = gl_VertexID;
        vec2 position = aPosition; // TODO make this a vec3, simplifies some code below

        if(aVertType == `.concat(TEXTURE,`) {
          float texX = aTex.x; // texture coordinates
          float texY = aTex.y;
          float texW = aTex.z;
          float texH = aTex.w;

          if(vid == 1 || vid == 2 || vid == 4) {
            texX += texW;
          }
          if(vid == 2 || vid == 4 || vid == 5) {
            texY += texH;
          }

          float d = float(uAtlasSize);
          vTexCoord = vec2(texX / d, texY / d); // tex coords must be between 0 and 1

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(RECTANGLE," || aVertType == ").concat(ELLIPSE,` 
             || aVertType == `).concat(ROUND_RECTANGLE," || aVertType == ").concat(BOTTOM_ROUND_RECTANGLE,`) { // simple shapes

          // the bounding box is needed by the fragment shader
          vBotLeft  = (aTransform * vec3(0, 0, 1)).xy; // flat
          vTopRight = (aTransform * vec3(1, 1, 1)).xy; // flat
          vPosition = (aTransform * vec3(position, 1)).xy; // will be interpolated

          // calculations are done in the fragment shader, just pass these along
          vColor = aColor;
          vCornerRadius = aCornerRadius;
          vBorderColor = aBorderColor;
          vBorderWidth = aLineWidth;

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
        }
        else if(aVertType == `).concat(EDGE_STRAIGHT,`) {
          vec2 source = aPointAPointB.xy;
          vec2 target = aPointAPointB.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          // stretch the unit square into a long skinny rectangle
          vec2 xBasis = target - source;
          vec2 yBasis = normalize(vec2(-xBasis.y, xBasis.x));
          vec2 point = source + xBasis * position.x + yBasis * aLineWidth[0] * position.y;

          gl_Position = vec4(uPanZoomMatrix * vec3(point, 1.0), 1.0);
          vColor = aColor;
        } 
        else if(aVertType == `).concat(EDGE_CURVE_SEGMENT,`) {
          vec2 pointA = aPointAPointB.xy;
          vec2 pointB = aPointAPointB.zw;
          vec2 pointC = aPointCPointD.xy;
          vec2 pointD = aPointCPointD.zw;

          // adjust the geometry so that the line is centered on the edge
          position.y = position.y - 0.5;

          vec2 p0, p1, p2, pos;
          if(position.x == 0.0) { // The left side of the unit square
            p0 = pointA;
            p1 = pointB;
            p2 = pointC;
            pos = position;
          } else { // The right side of the unit square, use same approach but flip the geometry upside down
            p0 = pointD;
            p1 = pointC;
            p2 = pointB;
            pos = vec2(0.0, -position.y);
          }

          vec2 p01 = p1 - p0;
          vec2 p12 = p2 - p1;
          vec2 p21 = p1 - p2;

          // Find the normal vector.
          vec2 tangent = normalize(normalize(p12) + normalize(p01));
          vec2 normal = vec2(-tangent.y, tangent.x);

          // Find the vector perpendicular to p0 -> p1.
          vec2 p01Norm = normalize(vec2(-p01.y, p01.x));

          // Determine the bend direction.
          float sigma = sign(dot(p01 + p21, normal));
          float width = aLineWidth[0];

          if(sign(pos.y) == -sigma) {
            // This is an intersecting vertex. Adjust the position so that there's no overlap.
            vec2 point = 0.5 * width * normal * -sigma / dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          } else {
            // This is a non-intersecting vertex. Treat it like a mitre join.
            vec2 point = 0.5 * width * normal * sigma * dot(normal, p01Norm);
            gl_Position = vec4(uPanZoomMatrix * vec3(p1 + point, 1.0), 1.0);
          }

          vColor = aColor;
        } 
        else if(aVertType == `).concat(EDGE_ARROW,` && vid < 3) {
          // massage the first triangle into an edge arrow
          if(vid == 0)
            position = vec2(-0.15, -0.3);
          if(vid == 1)
            position = vec2(  0.0,  0.0);
          if(vid == 2)
            position = vec2( 0.15, -0.3);

          gl_Position = vec4(uPanZoomMatrix * aTransform * vec3(position, 1.0), 1.0);
          vColor = aColor;
        }
        else {
          gl_Position = vec4(2.0, 0.0, 0.0, 1.0); // discard vertex by putting it outside webgl clip space
        }

        vAtlasId = aAtlasId;
        vVertType = aVertType;
        vIndex = aIndex;
      }
    `),hr=this.batchManager.getIndexArray(),dr=`#version 300 es
      precision highp float;

      // declare texture unit for each texture atlas in the batch
      `.concat(hr.map(function(vr){return"uniform sampler2D uTexture".concat(vr,";")}).join(`
	`),`

      uniform vec4 uBGColor;
      uniform float uZoom;

      in vec2 vTexCoord;
      in vec4 vColor;
      in vec2 vPosition; // model coordinates

      flat in int vAtlasId;
      flat in vec4 vIndex;
      flat in int vVertType;
      flat in vec2 vTopRight;
      flat in vec2 vBotLeft;
      flat in vec4 vCornerRadius;
      flat in vec4 vBorderColor;
      flat in vec2 vBorderWidth;

      out vec4 outColor;

      `).concat(circleSD,`
      `).concat(rectangleSD,`
      `).concat(roundRectangleSD,`
      `).concat(ellipseSD,`

      vec4 blend(vec4 top, vec4 bot) { // blend colors with premultiplied alpha
        return vec4( 
          top.rgb + (bot.rgb * (1.0 - top.a)),
          top.a   + (bot.a   * (1.0 - top.a)) 
        );
      }

      vec4 distInterp(vec4 cA, vec4 cB, float d) { // interpolate color using Signed Distance
        // scale to the zoom level so that borders don't look blurry when zoomed in
        // note 1.5 is an aribitrary value chosen because it looks good
        return mix(cA, cB, 1.0 - smoothstep(0.0, 1.5 / uZoom, abs(d))); 
      }

      void main(void) {
        if(vVertType == `).concat(TEXTURE,`) {
          // look up the texel from the texture unit
          `).concat(hr.map(function(vr){return"if(vAtlasId == ".concat(vr,") outColor = texture(uTexture").concat(vr,", vTexCoord);")}).join(`
	else `),`
        } 
        else if(vVertType == `).concat(EDGE_ARROW,`) {
          // mimics how canvas renderer uses context.globalCompositeOperation = 'destination-out';
          outColor = blend(vColor, uBGColor);
          outColor.a = 1.0; // make opaque, masks out line under arrow
        }
        else if(vVertType == `).concat(RECTANGLE,` && vBorderWidth == vec2(0.0)) { // simple rectangle with no border
          outColor = vColor; // unit square is already transformed to the rectangle, nothing else needs to be done
        }
        else if(vVertType == `).concat(RECTANGLE," || vVertType == ").concat(ELLIPSE,` 
          || vVertType == `).concat(ROUND_RECTANGLE," || vVertType == ").concat(BOTTOM_ROUND_RECTANGLE,`) { // use SDF

          float outerBorder = vBorderWidth[0];
          float innerBorder = vBorderWidth[1];
          float borderPadding = outerBorder * 2.0;
          float w = vTopRight.x - vBotLeft.x - borderPadding;
          float h = vTopRight.y - vBotLeft.y - borderPadding;
          vec2 b = vec2(w/2.0, h/2.0); // half width, half height
          vec2 p = vPosition - vec2(vTopRight.x - b[0] - outerBorder, vTopRight.y - b[1] - outerBorder); // translate to center

          float d; // signed distance
          if(vVertType == `).concat(RECTANGLE,`) {
            d = rectangleSD(p, b);
          } else if(vVertType == `).concat(ELLIPSE,` && w == h) {
            d = circleSD(p, b.x); // faster than ellipse
          } else if(vVertType == `).concat(ELLIPSE,`) {
            d = ellipseSD(p, b);
          } else {
            d = roundRectangleSD(p, b, vCornerRadius.wzyx);
          }

          // use the distance to interpolate a color to smooth the edges of the shape, doesn't need multisampling
          // we must smooth colors inwards, because we can't change pixels outside the shape's bounding box
          if(d > 0.0) {
            if(d > outerBorder) {
              discard;
            } else {
              outColor = distInterp(vBorderColor, vec4(0), d - outerBorder);
            }
          } else {
            if(d > innerBorder) {
              vec4 outerColor = outerBorder == 0.0 ? vec4(0) : vBorderColor;
              vec4 innerBorderColor = blend(vBorderColor, vColor);
              outColor = distInterp(innerBorderColor, outerColor, d);
            } 
            else {
              vec4 outerColor;
              if(innerBorder == 0.0 && outerBorder == 0.0) {
                outerColor = vec4(0);
              } else if(innerBorder == 0.0) {
                outerColor = vBorderColor;
              } else {
                outerColor = blend(vBorderColor, vColor);
              }
              outColor = distInterp(vColor, outerColor, d - innerBorder);
            }
          }
        }
        else {
          outColor = vColor;
        }

        `).concat(lr.picking?`if(outColor.a == 0.0) discard;
             else outColor = vIndex;`:"",`
      }
    `),fr=createProgram(ur,cr,dr);fr.aPosition=ur.getAttribLocation(fr,"aPosition"),fr.aIndex=ur.getAttribLocation(fr,"aIndex"),fr.aVertType=ur.getAttribLocation(fr,"aVertType"),fr.aTransform=ur.getAttribLocation(fr,"aTransform"),fr.aAtlasId=ur.getAttribLocation(fr,"aAtlasId"),fr.aTex=ur.getAttribLocation(fr,"aTex"),fr.aPointAPointB=ur.getAttribLocation(fr,"aPointAPointB"),fr.aPointCPointD=ur.getAttribLocation(fr,"aPointCPointD"),fr.aLineWidth=ur.getAttribLocation(fr,"aLineWidth"),fr.aColor=ur.getAttribLocation(fr,"aColor"),fr.aCornerRadius=ur.getAttribLocation(fr,"aCornerRadius"),fr.aBorderColor=ur.getAttribLocation(fr,"aBorderColor"),fr.uPanZoomMatrix=ur.getUniformLocation(fr,"uPanZoomMatrix"),fr.uAtlasSize=ur.getUniformLocation(fr,"uAtlasSize"),fr.uBGColor=ur.getUniformLocation(fr,"uBGColor"),fr.uZoom=ur.getUniformLocation(fr,"uZoom"),fr.uTextures=[];for(var pr=0;pr<this.batchManager.getMaxAtlasesPerBatch();pr++)fr.uTextures.push(ur.getUniformLocation(fr,"uTexture".concat(pr)));return fr}},{key:"_createVAO",value:function(){var lr=[0,0,1,0,1,1,0,0,1,1,0,1];this.vertexCount=lr.length/2;var ur=this.maxInstances,cr=this.gl,hr=this.program,dr=cr.createVertexArray();return cr.bindVertexArray(dr),createBufferStaticDraw(cr,"vec2",hr.aPosition,lr),this.transformBuffer=create3x3MatrixBufferDynamicDraw(cr,ur,hr.aTransform),this.indexBuffer=createBufferDynamicDraw(cr,ur,"vec4",hr.aIndex),this.vertTypeBuffer=createBufferDynamicDraw(cr,ur,"int",hr.aVertType),this.atlasIdBuffer=createBufferDynamicDraw(cr,ur,"int",hr.aAtlasId),this.texBuffer=createBufferDynamicDraw(cr,ur,"vec4",hr.aTex),this.pointAPointBBuffer=createBufferDynamicDraw(cr,ur,"vec4",hr.aPointAPointB),this.pointCPointDBuffer=createBufferDynamicDraw(cr,ur,"vec4",hr.aPointCPointD),this.lineWidthBuffer=createBufferDynamicDraw(cr,ur,"vec2",hr.aLineWidth),this.colorBuffer=createBufferDynamicDraw(cr,ur,"vec4",hr.aColor),this.cornerRadiusBuffer=createBufferDynamicDraw(cr,ur,"vec4",hr.aCornerRadius),this.borderColorBuffer=createBufferDynamicDraw(cr,ur,"vec4",hr.aBorderColor),cr.bindVertexArray(null),dr}},{key:"buffers",get:function(){var lr=this;return this._buffers||(this._buffers=Object.keys(this).filter(function(ur){return endsWith(ur,"Buffer")}).map(function(ur){return lr[ur]})),this._buffers}},{key:"startFrame",value:function(lr){var ur=arguments.length>1&&arguments[1]!==void 0?arguments[1]:RENDER_TARGET.SCREEN;this.panZoomMatrix=lr,this.renderTarget=ur,this.batchDebugInfo=[],this.wrappedCount=0,this.simpleCount=0,this.startBatch()}},{key:"startBatch",value:function(){this.instanceCount=0,this.batchManager.startBatch()}},{key:"endFrame",value:function(){this.endBatch()}},{key:"_isVisible",value:function(lr,ur){return lr.visible()?ur&&ur.isVisible?ur.isVisible(lr):!0:!1}},{key:"drawTexture",value:function(lr,ur,cr){var hr=this.atlasManager,dr=this.batchManager,fr=hr.getRenderTypeOpts(cr);if(this._isVisible(lr,fr)&&!(lr.isEdge()&&!this._isValidEdge(lr))){if(this.renderTarget.picking&&fr.getTexPickingMode){var pr=fr.getTexPickingMode(lr);if(pr===TEX_PICKING_MODE.IGNORE)return;if(pr==TEX_PICKING_MODE.USE_BB){this.drawPickingRectangle(lr,ur,cr);return}}var vr=hr.getAtlasInfo(lr,cr),gr=_createForOfIteratorHelper(vr),mr;try{for(gr.s();!(mr=gr.n()).done;){var br=mr.value,yr=br.atlas,xr=br.tex1,Cr=br.tex2;dr.canAddToCurrentBatch(yr)||this.endBatch();for(var Sr=dr.getAtlasIndexForBatch(yr),wr=0,Er=[[xr,!0],[Cr,!1]];wr<Er.length;wr++){var Ar=_slicedToArray(Er[wr],2),Tr=Ar[0],Rr=Ar[1];if(Tr.w!=0){var Pr=this.instanceCount;this.vertTypeBuffer.getView(Pr)[0]=TEXTURE;var _r=this.indexBuffer.getView(Pr);indexToVec4(ur,_r);var kr=this.atlasIdBuffer.getView(Pr);kr[0]=Sr;var Dr=this.texBuffer.getView(Pr);Dr[0]=Tr.x,Dr[1]=Tr.y,Dr[2]=Tr.w,Dr[3]=Tr.h;var Nr=this.transformBuffer.getMatrixView(Pr);this.setTransformMatrix(lr,Nr,fr,br,Rr),this.instanceCount++,Rr||this.wrappedCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}catch(Lr){gr.e(Lr)}finally{gr.f()}}}},{key:"setTransformMatrix",value:function(lr,ur,cr,hr){var dr=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,fr=0;if(cr.shapeProps&&cr.shapeProps.padding&&(fr=lr.pstyle(cr.shapeProps.padding).pfValue),hr){var pr=hr.bb,vr=hr.tex1,gr=hr.tex2,mr=vr.w/(vr.w+gr.w);dr||(mr=1-mr);var br=this._getAdjustedBB(pr,fr,dr,mr);this._applyTransformMatrix(ur,br,cr,lr)}else{var yr=cr.getBoundingBox(lr),xr=this._getAdjustedBB(yr,fr,!0,1);this._applyTransformMatrix(ur,xr,cr,lr)}}},{key:"_applyTransformMatrix",value:function(lr,ur,cr,hr){var dr,fr;identity(lr);var pr=cr.getRotation?cr.getRotation(hr):0;if(pr!==0){var vr=cr.getRotationPoint(hr),gr=vr.x,mr=vr.y;translate(lr,lr,[gr,mr]),rotate(lr,lr,pr);var br=cr.getRotationOffset(hr);dr=br.x+(ur.xOffset||0),fr=br.y+(ur.yOffset||0)}else dr=ur.x1,fr=ur.y1;translate(lr,lr,[dr,fr]),scale(lr,lr,[ur.w,ur.h])}},{key:"_getAdjustedBB",value:function(lr,ur,cr,hr){var dr=lr.x1,fr=lr.y1,pr=lr.w,vr=lr.h,gr=lr.yOffset;ur&&(dr-=ur,fr-=ur,pr+=2*ur,vr+=2*ur);var mr=0,br=pr*hr;return cr&&hr<1?pr=br:!cr&&hr<1&&(mr=pr-br,dr+=mr,pr=br),{x1:dr,y1:fr,w:pr,h:vr,xOffset:mr,yOffset:gr}}},{key:"drawPickingRectangle",value:function(lr,ur,cr){var hr=this.atlasManager.getRenderTypeOpts(cr),dr=this.instanceCount;this.vertTypeBuffer.getView(dr)[0]=RECTANGLE;var fr=this.indexBuffer.getView(dr);indexToVec4(ur,fr);var pr=this.colorBuffer.getView(dr);toWebGLColor([0,0,0],1,pr);var vr=this.transformBuffer.getMatrixView(dr);this.setTransformMatrix(lr,vr,hr),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}},{key:"drawNode",value:function(lr,ur,cr){var hr=this.simpleShapeOptions.get(cr);if(this._isVisible(lr,hr)){var dr=hr.shapeProps,fr=this._getVertTypeForShape(lr,dr.shape);if(fr===void 0||hr.isSimple&&!hr.isSimple(lr)){this.drawTexture(lr,ur,cr);return}var pr=this.instanceCount;if(this.vertTypeBuffer.getView(pr)[0]=fr,fr===ROUND_RECTANGLE||fr===BOTTOM_ROUND_RECTANGLE){var vr=hr.getBoundingBox(lr),gr=this._getCornerRadius(lr,dr.radius,vr),mr=this.cornerRadiusBuffer.getView(pr);mr[0]=gr,mr[1]=gr,mr[2]=gr,mr[3]=gr,fr===BOTTOM_ROUND_RECTANGLE&&(mr[0]=0,mr[2]=0)}var br=this.indexBuffer.getView(pr);indexToVec4(ur,br);var yr=lr.pstyle(dr.color).value,xr=lr.pstyle(dr.opacity).value,Cr=this.colorBuffer.getView(pr);toWebGLColor(yr,xr,Cr);var Sr=this.lineWidthBuffer.getView(pr);if(Sr[0]=0,Sr[1]=0,dr.border){var wr=lr.pstyle("border-width").value;if(wr>0){var Er=lr.pstyle("border-color").value,Ar=lr.pstyle("border-opacity").value,Tr=this.borderColorBuffer.getView(pr);toWebGLColor(Er,Ar,Tr);var Rr=lr.pstyle("border-position").value;if(Rr==="inside")Sr[0]=0,Sr[1]=-wr;else if(Rr==="outside")Sr[0]=wr,Sr[1]=0;else{var Pr=wr/2;Sr[0]=Pr,Sr[1]=-Pr}}}var _r=this.transformBuffer.getMatrixView(pr);this.setTransformMatrix(lr,_r,hr),this.simpleCount++,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}},{key:"_getVertTypeForShape",value:function(lr,ur){var cr=lr.pstyle(ur).value;switch(cr){case"rectangle":return RECTANGLE;case"ellipse":return ELLIPSE;case"roundrectangle":case"round-rectangle":return ROUND_RECTANGLE;case"bottom-round-rectangle":return BOTTOM_ROUND_RECTANGLE;default:return}}},{key:"_getCornerRadius",value:function(lr,ur,cr){var hr=cr.w,dr=cr.h;if(lr.pstyle(ur).value==="auto")return getRoundRectangleRadius(hr,dr);var fr=lr.pstyle(ur).pfValue,pr=hr/2,vr=dr/2;return Math.min(fr,vr,pr)}},{key:"drawEdgeArrow",value:function(lr,ur,cr){if(lr.visible()){var hr=lr._private.rscratch,dr,fr,pr;if(cr==="source"?(dr=hr.arrowStartX,fr=hr.arrowStartY,pr=hr.srcArrowAngle):(dr=hr.arrowEndX,fr=hr.arrowEndY,pr=hr.tgtArrowAngle),!(isNaN(dr)||dr==null||isNaN(fr)||fr==null||isNaN(pr)||pr==null)){var vr=lr.pstyle(cr+"-arrow-shape").value;if(vr!=="none"){var gr=lr.pstyle(cr+"-arrow-color").value,mr=lr.pstyle("opacity").value,br=lr.pstyle("line-opacity").value,yr=mr*br,xr=lr.pstyle("width").pfValue,Cr=lr.pstyle("arrow-scale").value,Sr=this.r.getArrowWidth(xr,Cr),wr=this.instanceCount,Er=this.transformBuffer.getMatrixView(wr);identity(Er),translate(Er,Er,[dr,fr]),scale(Er,Er,[Sr,Sr]),rotate(Er,Er,pr),this.vertTypeBuffer.getView(wr)[0]=EDGE_ARROW;var Ar=this.indexBuffer.getView(wr);indexToVec4(ur,Ar);var Tr=this.colorBuffer.getView(wr);toWebGLColor(gr,yr,Tr),this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"drawEdgeLine",value:function(lr,ur){if(lr.visible()){var cr=this._getEdgePoints(lr);if(cr){var hr=lr.pstyle("opacity").value,dr=lr.pstyle("line-opacity").value,fr=lr.pstyle("width").pfValue,pr=lr.pstyle("line-color").value,vr=hr*dr;if(cr.length/2+this.instanceCount>this.maxInstances&&this.endBatch(),cr.length==4){var gr=this.instanceCount;this.vertTypeBuffer.getView(gr)[0]=EDGE_STRAIGHT;var mr=this.indexBuffer.getView(gr);indexToVec4(ur,mr);var br=this.colorBuffer.getView(gr);toWebGLColor(pr,vr,br);var yr=this.lineWidthBuffer.getView(gr);yr[0]=fr;var xr=this.pointAPointBBuffer.getView(gr);xr[0]=cr[0],xr[1]=cr[1],xr[2]=cr[2],xr[3]=cr[3],this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}else for(var Cr=0;Cr<cr.length-2;Cr+=2){var Sr=this.instanceCount;this.vertTypeBuffer.getView(Sr)[0]=EDGE_CURVE_SEGMENT;var wr=this.indexBuffer.getView(Sr);indexToVec4(ur,wr);var Er=this.colorBuffer.getView(Sr);toWebGLColor(pr,vr,Er);var Ar=this.lineWidthBuffer.getView(Sr);Ar[0]=fr;var Tr=cr[Cr-2],Rr=cr[Cr-1],Pr=cr[Cr],_r=cr[Cr+1],kr=cr[Cr+2],Dr=cr[Cr+3],Nr=cr[Cr+4],Lr=cr[Cr+5];Cr==0&&(Tr=2*Pr-kr+.001,Rr=2*_r-Dr+.001),Cr==cr.length-4&&(Nr=2*kr-Pr+.001,Lr=2*Dr-_r+.001);var Or=this.pointAPointBBuffer.getView(Sr);Or[0]=Tr,Or[1]=Rr,Or[2]=Pr,Or[3]=_r;var Ir=this.pointCPointDBuffer.getView(Sr);Ir[0]=kr,Ir[1]=Dr,Ir[2]=Nr,Ir[3]=Lr,this.instanceCount++,this.instanceCount>=this.maxInstances&&this.endBatch()}}}}},{key:"_isValidEdge",value:function(lr){var ur=lr._private.rscratch;return!(ur.badLine||ur.allpts==null||isNaN(ur.allpts[0]))}},{key:"_getEdgePoints",value:function(lr){var ur=lr._private.rscratch;if(this._isValidEdge(lr)){var cr=ur.allpts;if(cr.length==4)return cr;var hr=this._getNumSegments(lr);return this._getCurveSegmentPoints(cr,hr)}}},{key:"_getNumSegments",value:function(lr){var ur=15;return Math.min(Math.max(ur,5),this.maxInstances)}},{key:"_getCurveSegmentPoints",value:function(lr,ur){if(lr.length==4)return lr;for(var cr=Array((ur+1)*2),hr=0;hr<=ur;hr++)if(hr==0)cr[0]=lr[0],cr[1]=lr[1];else if(hr==ur)cr[hr*2]=lr[lr.length-2],cr[hr*2+1]=lr[lr.length-1];else{var dr=hr/ur;this._setCurvePoint(lr,dr,cr,hr*2)}return cr}},{key:"_setCurvePoint",value:function(lr,ur,cr,hr){if(lr.length<=2)cr[hr]=lr[0],cr[hr+1]=lr[1];else{for(var dr=Array(lr.length-2),fr=0;fr<dr.length;fr+=2){var pr=(1-ur)*lr[fr]+ur*lr[fr+2],vr=(1-ur)*lr[fr+1]+ur*lr[fr+3];dr[fr]=pr,dr[fr+1]=vr}return this._setCurvePoint(dr,ur,cr,hr)}}},{key:"endBatch",value:function(){var lr=this.gl,ur=this.vao,cr=this.vertexCount,hr=this.instanceCount;if(hr!==0){var dr=this.renderTarget.picking?this.pickingProgram:this.program;lr.useProgram(dr),lr.bindVertexArray(ur);var fr=_createForOfIteratorHelper(this.buffers),pr;try{for(fr.s();!(pr=fr.n()).done;){var vr=pr.value;vr.bufferSubData(hr)}}catch(xr){fr.e(xr)}finally{fr.f()}for(var gr=this.batchManager.getAtlases(),mr=0;mr<gr.length;mr++)gr[mr].bufferIfNeeded(lr);for(var br=0;br<gr.length;br++)lr.activeTexture(lr.TEXTURE0+br),lr.bindTexture(lr.TEXTURE_2D,gr[br].texture),lr.uniform1i(dr.uTextures[br],br);lr.uniform1f(dr.uZoom,getEffectiveZoom(this.r)),lr.uniformMatrix3fv(dr.uPanZoomMatrix,!1,this.panZoomMatrix),lr.uniform1i(dr.uAtlasSize,this.batchManager.getAtlasSize());var yr=toWebGLColor(this.bgColor,1);lr.uniform4fv(dr.uBGColor,yr),lr.drawArraysInstanced(lr.TRIANGLES,0,cr,hr),lr.bindVertexArray(null),lr.bindTexture(lr.TEXTURE_2D,null),this.debug&&this.batchDebugInfo.push({count:hr,atlasCount:gr.length}),this.startBatch()}}},{key:"getDebugInfo",value:function(){var lr=this.atlasManager.getDebugInfo(),ur=lr.reduce(function(dr,fr){return dr+fr.atlasCount},0),cr=this.batchDebugInfo,hr=cr.reduce(function(dr,fr){return dr+fr.count},0);return{atlasInfo:lr,totalAtlases:ur,wrappedCount:this.wrappedCount,simpleCount:this.simpleCount,batchCount:cr.length,batchInfo:cr,totalInstances:hr}}}])}(),CRp$4={};CRp$4.initWebgl=function(or,ar){var lr=this,ur=lr.data.contexts[lr.WEBGL];or.bgColor=getBGColor(lr),or.webglTexSize=Math.min(or.webglTexSize,ur.getParameter(ur.MAX_TEXTURE_SIZE)),or.webglTexRows=Math.min(or.webglTexRows,54),or.webglTexRowsNodes=Math.min(or.webglTexRowsNodes,54),or.webglBatchSize=Math.min(or.webglBatchSize,16384),or.webglTexPerBatch=Math.min(or.webglTexPerBatch,ur.getParameter(ur.MAX_TEXTURE_IMAGE_UNITS)),lr.webglDebug=or.webglDebug,lr.webglDebugShowAtlases=or.webglDebugShowAtlases,lr.pickingFrameBuffer=createPickingFrameBuffer(ur),lr.pickingFrameBuffer.needsDraw=!0,lr.drawing=new ElementDrawingWebGL(lr,ur,or);var cr=function(mr){return function(br){return lr.getTextAngle(br,mr)}},hr=function(mr){return function(br){var yr=br.pstyle(mr);return yr&&yr.value}},dr=function(mr){return function(br){return br.pstyle("".concat(mr,"-opacity")).value>0}},fr=function(mr){var br=mr.pstyle("text-events").strValue==="yes";return br?TEX_PICKING_MODE.USE_BB:TEX_PICKING_MODE.IGNORE},pr=function(mr){var br=mr.position(),yr=br.x,xr=br.y,Cr=mr.outerWidth(),Sr=mr.outerHeight();return{w:Cr,h:Sr,x1:yr-Cr/2,y1:xr-Sr/2}};lr.drawing.addAtlasCollection("node",{texRows:or.webglTexRowsNodes}),lr.drawing.addAtlasCollection("label",{texRows:or.webglTexRows}),lr.drawing.addTextureAtlasRenderType("node-body",{collection:"node",getKey:ar.getStyleKey,getBoundingBox:ar.getElementBox,drawElement:ar.drawElement}),lr.drawing.addSimpleShapeRenderType("node-body",{getBoundingBox:pr,isSimple:isSimpleShape,shapeProps:{shape:"shape",color:"background-color",opacity:"background-opacity",radius:"corner-radius",border:!0}}),lr.drawing.addSimpleShapeRenderType("node-overlay",{getBoundingBox:pr,isVisible:dr("overlay"),shapeProps:{shape:"overlay-shape",color:"overlay-color",opacity:"overlay-opacity",padding:"overlay-padding",radius:"overlay-corner-radius"}}),lr.drawing.addSimpleShapeRenderType("node-underlay",{getBoundingBox:pr,isVisible:dr("underlay"),shapeProps:{shape:"underlay-shape",color:"underlay-color",opacity:"underlay-opacity",padding:"underlay-padding",radius:"underlay-corner-radius"}}),lr.drawing.addTextureAtlasRenderType("label",{collection:"label",getTexPickingMode:fr,getKey:getStyleKeysForLabel(ar.getLabelKey,null),getBoundingBox:getBoundingBoxForLabel(ar.getLabelBox,null),drawClipped:!0,drawElement:ar.drawLabel,getRotation:cr(null),getRotationPoint:ar.getLabelRotationPoint,getRotationOffset:ar.getLabelRotationOffset,isVisible:hr("label")}),lr.drawing.addTextureAtlasRenderType("edge-source-label",{collection:"label",getTexPickingMode:fr,getKey:getStyleKeysForLabel(ar.getSourceLabelKey,"source"),getBoundingBox:getBoundingBoxForLabel(ar.getSourceLabelBox,"source"),drawClipped:!0,drawElement:ar.drawSourceLabel,getRotation:cr("source"),getRotationPoint:ar.getSourceLabelRotationPoint,getRotationOffset:ar.getSourceLabelRotationOffset,isVisible:hr("source-label")}),lr.drawing.addTextureAtlasRenderType("edge-target-label",{collection:"label",getTexPickingMode:fr,getKey:getStyleKeysForLabel(ar.getTargetLabelKey,"target"),getBoundingBox:getBoundingBoxForLabel(ar.getTargetLabelBox,"target"),drawClipped:!0,drawElement:ar.drawTargetLabel,getRotation:cr("target"),getRotationPoint:ar.getTargetLabelRotationPoint,getRotationOffset:ar.getTargetLabelRotationOffset,isVisible:hr("target-label")});var vr=debounce(function(){console.log("garbage collect flag set"),lr.data.gc=!0},1e4);lr.onUpdateEleCalcs(function(gr,mr){var br=!1;mr&&mr.length>0&&(br|=lr.drawing.invalidate(mr)),br&&vr()}),overrideCanvasRendererFunctions(lr)};function getBGColor(or){var ar=or.cy.container(),lr=ar&&ar.style&&ar.style.backgroundColor||"white";return color2tuple(lr)}function getLabelLines(or,ar){var lr=or._private.rscratch;return getPrefixedProperty(lr,"labelWrapCachedLines",ar)||[]}var getStyleKeysForLabel=function or(ar,lr){return function(ur){var cr=ar(ur),hr=getLabelLines(ur,lr);return hr.length>1?hr.map(function(dr,fr){return"".concat(cr,"_").concat(fr)}):cr}},getBoundingBoxForLabel=function or(ar,lr){return function(ur,cr){var hr=ar(ur);if(typeof cr=="string"){var dr=cr.indexOf("_");if(dr>0){var fr=Number(cr.substring(dr+1)),pr=getLabelLines(ur,lr),vr=hr.h/pr.length,gr=vr*fr,mr=hr.y1+gr;return{x1:hr.x1,w:hr.w,y1:mr,h:vr,yOffset:gr}}}return hr}};function overrideCanvasRendererFunctions(or){{var ar=or.render;or.render=function(hr){hr=hr||{};var dr=or.cy;or.webgl&&(dr.zoom()>maxZoom$1?(clearWebgl(or),ar.call(or,hr)):(clearCanvas(or),renderWebgl(or,hr,RENDER_TARGET.SCREEN)))}}{var lr=or.matchCanvasSize;or.matchCanvasSize=function(hr){lr.call(or,hr),or.pickingFrameBuffer.setFramebufferAttachmentSizes(or.canvasWidth,or.canvasHeight),or.pickingFrameBuffer.needsDraw=!0}}or.findNearestElements=function(hr,dr,fr,pr){return findNearestElementsWebgl(or,hr,dr)};{var ur=or.invalidateCachedZSortedEles;or.invalidateCachedZSortedEles=function(){ur.call(or),or.pickingFrameBuffer.needsDraw=!0}}{var cr=or.notify;or.notify=function(hr,dr){cr.call(or,hr,dr),hr==="viewport"||hr==="bounds"?or.pickingFrameBuffer.needsDraw=!0:hr==="background"&&or.drawing.invalidate(dr,{type:"node-body"})}}}function clearWebgl(or){var ar=or.data.contexts[or.WEBGL];ar.clear(ar.COLOR_BUFFER_BIT|ar.DEPTH_BUFFER_BIT)}function clearCanvas(or){var ar=function(ur){ur.save(),ur.setTransform(1,0,0,1,0,0),ur.clearRect(0,0,or.canvasWidth,or.canvasHeight),ur.restore()};ar(or.data.contexts[or.NODE]),ar(or.data.contexts[or.DRAG])}function createPanZoomMatrix(or){var ar=or.canvasWidth,lr=or.canvasHeight,ur=getEffectivePanZoom(or),cr=ur.pan,hr=ur.zoom,dr=create();translate(dr,dr,[cr.x,cr.y]),scale(dr,dr,[hr,hr]);var fr=create();projection(fr,ar,lr);var pr=create();return multiply(pr,fr,dr),pr}function setContextTransform(or,ar){var lr=or.canvasWidth,ur=or.canvasHeight,cr=getEffectivePanZoom(or),hr=cr.pan,dr=cr.zoom;ar.setTransform(1,0,0,1,0,0),ar.clearRect(0,0,lr,ur),ar.translate(hr.x,hr.y),ar.scale(dr,dr)}function drawSelectionRectangle(or,ar){or.drawSelectionRectangle(ar,function(lr){return setContextTransform(or,lr)})}function drawAxes(or){var ar=or.data.contexts[or.NODE];ar.save(),setContextTransform(or,ar),ar.strokeStyle="rgba(0, 0, 0, 0.3)",ar.beginPath(),ar.moveTo(-1e3,0),ar.lineTo(1e3,0),ar.stroke(),ar.beginPath(),ar.moveTo(0,-1e3),ar.lineTo(0,1e3),ar.stroke(),ar.restore()}function drawAtlases(or){var ar=function(cr,hr,dr){for(var fr=cr.atlasManager.getAtlasCollection(hr),pr=or.data.contexts[or.NODE],vr=fr.atlases,gr=0;gr<vr.length;gr++){var mr=vr[gr],br=mr.canvas;if(br){var yr=br.width,xr=br.height,Cr=yr*gr,Sr=br.height*dr,wr=.4;pr.save(),pr.scale(wr,wr),pr.drawImage(br,Cr,Sr),pr.strokeStyle="black",pr.rect(Cr,Sr,yr,xr),pr.stroke(),pr.restore()}}},lr=0;ar(or.drawing,"node",lr++),ar(or.drawing,"label",lr++)}function getPickingIndexes(or,ar,lr,ur,cr){var hr,dr,fr,pr,vr=getEffectivePanZoom(or),gr=vr.pan,mr=vr.zoom;{var br=modelToRenderedPosition(or,gr,mr,ar,lr),yr=_slicedToArray(br,2),xr=yr[0],Cr=yr[1],Sr=6;hr=xr-Sr/2,dr=Cr-Sr/2,fr=Sr,pr=Sr}if(fr===0||pr===0)return[];var wr=or.data.contexts[or.WEBGL];wr.bindFramebuffer(wr.FRAMEBUFFER,or.pickingFrameBuffer),or.pickingFrameBuffer.needsDraw&&(wr.viewport(0,0,wr.canvas.width,wr.canvas.height),renderWebgl(or,null,RENDER_TARGET.PICKING),or.pickingFrameBuffer.needsDraw=!1);var Er=fr*pr,Ar=new Uint8Array(Er*4);wr.readPixels(hr,dr,fr,pr,wr.RGBA,wr.UNSIGNED_BYTE,Ar),wr.bindFramebuffer(wr.FRAMEBUFFER,null);for(var Tr=new Set,Rr=0;Rr<Er;Rr++){var Pr=Ar.slice(Rr*4,Rr*4+4),_r=vec4ToIndex(Pr)-1;_r>=0&&Tr.add(_r)}return Tr}function findNearestElementsWebgl(or,ar,lr){var ur=getPickingIndexes(or,ar,lr),cr=or.getCachedZSortedEles(),hr,dr,fr=_createForOfIteratorHelper(ur),pr;try{for(fr.s();!(pr=fr.n()).done;){var vr=pr.value,gr=cr[vr];if(!hr&&gr.isNode()&&(hr=gr),!dr&&gr.isEdge()&&(dr=gr),hr&&dr)break}}catch(mr){fr.e(mr)}finally{fr.f()}return[hr,dr].filter(Boolean)}function drawEle(or,ar,lr){var ur=or.drawing;ar+=1,lr.isNode()?(ur.drawNode(lr,ar,"node-underlay"),ur.drawNode(lr,ar,"node-body"),ur.drawTexture(lr,ar,"label"),ur.drawNode(lr,ar,"node-overlay")):(ur.drawEdgeLine(lr,ar),ur.drawEdgeArrow(lr,ar,"source"),ur.drawEdgeArrow(lr,ar,"target"),ur.drawTexture(lr,ar,"label"),ur.drawTexture(lr,ar,"edge-source-label"),ur.drawTexture(lr,ar,"edge-target-label"))}function renderWebgl(or,ar,lr){var ur;or.webglDebug&&(ur=performance.now());var cr=or.drawing,hr=0;if(lr.screen&&or.data.canvasNeedsRedraw[or.SELECT_BOX]&&drawSelectionRectangle(or,ar),or.data.canvasNeedsRedraw[or.NODE]||lr.picking){var dr=or.data.contexts[or.WEBGL];lr.screen?(dr.clearColor(0,0,0,0),dr.enable(dr.BLEND),dr.blendFunc(dr.ONE,dr.ONE_MINUS_SRC_ALPHA)):dr.disable(dr.BLEND),dr.clear(dr.COLOR_BUFFER_BIT|dr.DEPTH_BUFFER_BIT),dr.viewport(0,0,dr.canvas.width,dr.canvas.height);var fr=createPanZoomMatrix(or),pr=or.getCachedZSortedEles();if(hr=pr.length,cr.startFrame(fr,lr),lr.screen){for(var vr=0;vr<pr.nondrag.length;vr++)drawEle(or,vr,pr.nondrag[vr]);for(var gr=0;gr<pr.drag.length;gr++)drawEle(or,gr,pr.drag[gr])}else if(lr.picking)for(var mr=0;mr<pr.length;mr++)drawEle(or,mr,pr[mr]);cr.endFrame(),lr.screen&&or.webglDebugShowAtlases&&(drawAxes(or),drawAtlases(or)),or.data.canvasNeedsRedraw[or.NODE]=!1,or.data.canvasNeedsRedraw[or.DRAG]=!1}if(or.webglDebug){var br=performance.now(),yr=!1,xr=Math.ceil(br-ur),Cr=cr.getDebugInfo(),Sr=["".concat(hr," elements"),"".concat(Cr.totalInstances," instances"),"".concat(Cr.batchCount," batches"),"".concat(Cr.totalAtlases," atlases"),"".concat(Cr.wrappedCount," wrapped textures"),"".concat(Cr.simpleCount," simple shapes")].join(", ");if(yr)console.log("WebGL (".concat(lr.name,") - time ").concat(xr,"ms, ").concat(Sr));else{console.log("WebGL (".concat(lr.name,") - frame time ").concat(xr,"ms")),console.log("Totals:"),console.log("  ".concat(Sr)),console.log("Texture Atlases Used:");var wr=Cr.atlasInfo,Er=_createForOfIteratorHelper(wr),Ar;try{for(Er.s();!(Ar=Er.n()).done;){var Tr=Ar.value;console.log("  ".concat(Tr.type,": ").concat(Tr.keyCount," keys, ").concat(Tr.atlasCount," atlases"))}}catch(Rr){Er.e(Rr)}finally{Er.f()}console.log("")}}or.data.gc&&(console.log("Garbage Collect!"),or.data.gc=!1,cr.gc())}var CRp$3={};CRp$3.drawPolygonPath=function(or,ar,lr,ur,cr,hr){var dr=ur/2,fr=cr/2;or.beginPath&&or.beginPath(),or.moveTo(ar+dr*hr[0],lr+fr*hr[1]);for(var pr=1;pr<hr.length/2;pr++)or.lineTo(ar+dr*hr[pr*2],lr+fr*hr[pr*2+1]);or.closePath()};CRp$3.drawRoundPolygonPath=function(or,ar,lr,ur,cr,hr,dr){dr.forEach(function(fr){return drawPreparedRoundCorner(or,fr)}),or.closePath()};CRp$3.drawRoundRectanglePath=function(or,ar,lr,ur,cr,hr){var dr=ur/2,fr=cr/2,pr=hr==="auto"?getRoundRectangleRadius(ur,cr):Math.min(hr,fr,dr);or.beginPath&&or.beginPath(),or.moveTo(ar,lr-fr),or.arcTo(ar+dr,lr-fr,ar+dr,lr,pr),or.arcTo(ar+dr,lr+fr,ar,lr+fr,pr),or.arcTo(ar-dr,lr+fr,ar-dr,lr,pr),or.arcTo(ar-dr,lr-fr,ar,lr-fr,pr),or.lineTo(ar,lr-fr),or.closePath()};CRp$3.drawBottomRoundRectanglePath=function(or,ar,lr,ur,cr,hr){var dr=ur/2,fr=cr/2,pr=hr==="auto"?getRoundRectangleRadius(ur,cr):hr;or.beginPath&&or.beginPath(),or.moveTo(ar,lr-fr),or.lineTo(ar+dr,lr-fr),or.lineTo(ar+dr,lr),or.arcTo(ar+dr,lr+fr,ar,lr+fr,pr),or.arcTo(ar-dr,lr+fr,ar-dr,lr,pr),or.lineTo(ar-dr,lr-fr),or.lineTo(ar,lr-fr),or.closePath()};CRp$3.drawCutRectanglePath=function(or,ar,lr,ur,cr,hr,dr){var fr=ur/2,pr=cr/2,vr=dr==="auto"?getCutRectangleCornerLength():dr;or.beginPath&&or.beginPath(),or.moveTo(ar-fr+vr,lr-pr),or.lineTo(ar+fr-vr,lr-pr),or.lineTo(ar+fr,lr-pr+vr),or.lineTo(ar+fr,lr+pr-vr),or.lineTo(ar+fr-vr,lr+pr),or.lineTo(ar-fr+vr,lr+pr),or.lineTo(ar-fr,lr+pr-vr),or.lineTo(ar-fr,lr-pr+vr),or.closePath()};CRp$3.drawBarrelPath=function(or,ar,lr,ur,cr){var hr=ur/2,dr=cr/2,fr=ar-hr,pr=ar+hr,vr=lr-dr,gr=lr+dr,mr=getBarrelCurveConstants(ur,cr),br=mr.widthOffset,yr=mr.heightOffset,xr=mr.ctrlPtOffsetPct*br;or.beginPath&&or.beginPath(),or.moveTo(fr,vr+yr),or.lineTo(fr,gr-yr),or.quadraticCurveTo(fr+xr,gr,fr+br,gr),or.lineTo(pr-br,gr),or.quadraticCurveTo(pr-xr,gr,pr,gr-yr),or.lineTo(pr,vr+yr),or.quadraticCurveTo(pr-xr,vr,pr-br,vr),or.lineTo(fr+br,vr),or.quadraticCurveTo(fr+xr,vr,fr,vr+yr),or.closePath()};var sin0=Math.sin(0),cos0=Math.cos(0),sin={},cos={},ellipseStepSize=Math.PI/40;for(var i=0*Math.PI;i<2*Math.PI;i+=ellipseStepSize)sin[i]=Math.sin(i),cos[i]=Math.cos(i);CRp$3.drawEllipsePath=function(or,ar,lr,ur,cr){if(or.beginPath&&or.beginPath(),or.ellipse)or.ellipse(ar,lr,ur/2,cr/2,0,0,2*Math.PI);else for(var hr,dr,fr=ur/2,pr=cr/2,vr=0*Math.PI;vr<2*Math.PI;vr+=ellipseStepSize)hr=ar-fr*sin[vr]*sin0+fr*cos[vr]*cos0,dr=lr+pr*cos[vr]*sin0+pr*sin[vr]*cos0,vr===0?or.moveTo(hr,dr):or.lineTo(hr,dr);or.closePath()};var CRp$2={};CRp$2.createBuffer=function(or,ar){var lr=document.createElement("canvas");return lr.width=or,lr.height=ar,[lr,lr.getContext("2d")]};CRp$2.bufferCanvasImage=function(or){var ar=this.cy,lr=ar.mutableElements(),ur=lr.boundingBox(),cr=this.findContainerClientCoords(),hr=or.full?Math.ceil(ur.w):cr[2],dr=or.full?Math.ceil(ur.h):cr[3],fr=number$1(or.maxWidth)||number$1(or.maxHeight),pr=this.getPixelRatio(),vr=1;if(or.scale!==void 0)hr*=or.scale,dr*=or.scale,vr=or.scale;else if(fr){var gr=1/0,mr=1/0;number$1(or.maxWidth)&&(gr=vr*or.maxWidth/hr),number$1(or.maxHeight)&&(mr=vr*or.maxHeight/dr),vr=Math.min(gr,mr),hr*=vr,dr*=vr}fr||(hr*=pr,dr*=pr,vr*=pr);var br=document.createElement("canvas");br.width=hr,br.height=dr,br.style.width=hr+"px",br.style.height=dr+"px";var yr=br.getContext("2d");if(hr>0&&dr>0){yr.clearRect(0,0,hr,dr),yr.globalCompositeOperation="source-over";var xr=this.getCachedZSortedEles();if(or.full)yr.translate(-ur.x1*vr,-ur.y1*vr),yr.scale(vr,vr),this.drawElements(yr,xr),yr.scale(1/vr,1/vr),yr.translate(ur.x1*vr,ur.y1*vr);else{var Cr=ar.pan(),Sr={x:Cr.x*vr,y:Cr.y*vr};vr*=ar.zoom(),yr.translate(Sr.x,Sr.y),yr.scale(vr,vr),this.drawElements(yr,xr),yr.scale(1/vr,1/vr),yr.translate(-Sr.x,-Sr.y)}or.bg&&(yr.globalCompositeOperation="destination-over",yr.fillStyle=or.bg,yr.rect(0,0,hr,dr),yr.fill())}return br};function b64ToBlob(or,ar){for(var lr=atob(or),ur=new ArrayBuffer(lr.length),cr=new Uint8Array(ur),hr=0;hr<lr.length;hr++)cr[hr]=lr.charCodeAt(hr);return new Blob([ur],{type:ar})}function b64UriToB64(or){var ar=or.indexOf(",");return or.substr(ar+1)}function output(or,ar,lr){var ur=function(){return ar.toDataURL(lr,or.quality)};switch(or.output){case"blob-promise":return new Promise$1(function(cr,hr){try{ar.toBlob(function(dr){dr!=null?cr(dr):hr(new Error("`canvas.toBlob()` sent a null value in its callback"))},lr,or.quality)}catch(dr){hr(dr)}});case"blob":return b64ToBlob(b64UriToB64(ur()),lr);case"base64":return b64UriToB64(ur());case"base64uri":default:return ur()}}CRp$2.png=function(or){return output(or,this.bufferCanvasImage(or),"image/png")};CRp$2.jpg=function(or){return output(or,this.bufferCanvasImage(or),"image/jpeg")};var CRp$1={};CRp$1.nodeShapeImpl=function(or,ar,lr,ur,cr,hr,dr,fr){switch(or){case"ellipse":return this.drawEllipsePath(ar,lr,ur,cr,hr);case"polygon":return this.drawPolygonPath(ar,lr,ur,cr,hr,dr);case"round-polygon":return this.drawRoundPolygonPath(ar,lr,ur,cr,hr,dr,fr);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(ar,lr,ur,cr,hr,fr);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(ar,lr,ur,cr,hr,dr,fr);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(ar,lr,ur,cr,hr,fr);case"barrel":return this.drawBarrelPath(ar,lr,ur,cr,hr)}};var CR=CanvasRenderer,CRp=CanvasRenderer.prototype;CRp.CANVAS_LAYERS=3;CRp.SELECT_BOX=0;CRp.DRAG=1;CRp.NODE=2;CRp.WEBGL=3;CRp.CANVAS_TYPES=["2d","2d","2d","webgl2"];CRp.BUFFER_COUNT=3;CRp.TEXTURE_BUFFER=0;CRp.MOTIONBLUR_BUFFER_NODE=1;CRp.MOTIONBLUR_BUFFER_DRAG=2;function CanvasRenderer(or){var ar=this,lr=ar.cy.window(),ur=lr.document;or.webgl&&(CRp.CANVAS_LAYERS=ar.CANVAS_LAYERS=4,console.log("webgl rendering enabled")),ar.data={canvases:new Array(CRp.CANVAS_LAYERS),contexts:new Array(CRp.CANVAS_LAYERS),canvasNeedsRedraw:new Array(CRp.CANVAS_LAYERS),bufferCanvases:new Array(CRp.BUFFER_COUNT),bufferContexts:new Array(CRp.CANVAS_LAYERS)};var cr="-webkit-tap-highlight-color",hr="rgba(0,0,0,0)";ar.data.canvasContainer=ur.createElement("div");var dr=ar.data.canvasContainer.style;ar.data.canvasContainer.style[cr]=hr,dr.position="relative",dr.zIndex="0",dr.overflow="hidden";var fr=or.cy.container();fr.appendChild(ar.data.canvasContainer),fr.style[cr]=hr;var pr={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};ms()&&(pr["-ms-touch-action"]="none",pr["touch-action"]="none");for(var vr=0;vr<CRp.CANVAS_LAYERS;vr++){var gr=ar.data.canvases[vr]=ur.createElement("canvas"),mr=CRp.CANVAS_TYPES[vr];ar.data.contexts[vr]=gr.getContext(mr),ar.data.contexts[vr]||error("Could not create canvas of type "+mr),Object.keys(pr).forEach(function(Qr){gr.style[Qr]=pr[Qr]}),gr.style.position="absolute",gr.setAttribute("data-id","layer"+vr),gr.style.zIndex=String(CRp.CANVAS_LAYERS-vr),ar.data.canvasContainer.appendChild(gr),ar.data.canvasNeedsRedraw[vr]=!1}ar.data.topCanvas=ar.data.canvases[0],ar.data.canvases[CRp.NODE].setAttribute("data-id","layer"+CRp.NODE+"-node"),ar.data.canvases[CRp.SELECT_BOX].setAttribute("data-id","layer"+CRp.SELECT_BOX+"-selectbox"),ar.data.canvases[CRp.DRAG].setAttribute("data-id","layer"+CRp.DRAG+"-drag"),ar.data.canvases[CRp.WEBGL]&&ar.data.canvases[CRp.WEBGL].setAttribute("data-id","layer"+CRp.WEBGL+"-webgl");for(var vr=0;vr<CRp.BUFFER_COUNT;vr++)ar.data.bufferCanvases[vr]=ur.createElement("canvas"),ar.data.bufferContexts[vr]=ar.data.bufferCanvases[vr].getContext("2d"),ar.data.bufferCanvases[vr].style.position="absolute",ar.data.bufferCanvases[vr].setAttribute("data-id","buffer"+vr),ar.data.bufferCanvases[vr].style.zIndex=String(-vr-1),ar.data.bufferCanvases[vr].style.visibility="hidden";ar.pathsEnabled=!0;var br=makeBoundingBox(),yr=function(ga){return{x:(ga.x1+ga.x2)/2,y:(ga.y1+ga.y2)/2}},xr=function(ga){return{x:-ga.w/2,y:-ga.h/2}},Cr=function(ga){var ba=ga[0]._private,_i=ba.oldBackgroundTimestamp===ba.backgroundTimestamp;return!_i},Sr=function(ga){return ga[0]._private.nodeKey},wr=function(ga){return ga[0]._private.labelStyleKey},Er=function(ga){return ga[0]._private.sourceLabelStyleKey},Ar=function(ga){return ga[0]._private.targetLabelStyleKey},Tr=function(ga,ba,_i,os,ls){return ar.drawElement(ga,ba,_i,!1,!1,ls)},Rr=function(ga,ba,_i,os,ls){return ar.drawElementText(ga,ba,_i,os,"main",ls)},Pr=function(ga,ba,_i,os,ls){return ar.drawElementText(ga,ba,_i,os,"source",ls)},_r=function(ga,ba,_i,os,ls){return ar.drawElementText(ga,ba,_i,os,"target",ls)},kr=function(ga){return ga.boundingBox(),ga[0]._private.bodyBounds},Dr=function(ga){return ga.boundingBox(),ga[0]._private.labelBounds.main||br},Nr=function(ga){return ga.boundingBox(),ga[0]._private.labelBounds.source||br},Lr=function(ga){return ga.boundingBox(),ga[0]._private.labelBounds.target||br},Or=function(ga,ba){return ba},Ir=function(ga){return yr(kr(ga))},Mr=function(ga,ba,_i){var os=ga?ga+"-":"";return{x:ba.x+_i.pstyle(os+"text-margin-x").pfValue,y:ba.y+_i.pstyle(os+"text-margin-y").pfValue}},$r=function(ga,ba,_i){var os=ga[0]._private.rscratch;return{x:os[ba],y:os[_i]}},jr=function(ga){return Mr("",$r(ga,"labelX","labelY"),ga)},Fr=function(ga){return Mr("source",$r(ga,"sourceLabelX","sourceLabelY"),ga)},zr=function(ga){return Mr("target",$r(ga,"targetLabelX","targetLabelY"),ga)},Hr=function(ga){return xr(kr(ga))},Wr=function(ga){return xr(Nr(ga))},Yr=function(ga){return xr(Lr(ga))},qr=function(ga){var ba=Dr(ga),_i=xr(Dr(ga));if(ga.isNode()){switch(ga.pstyle("text-halign").value){case"left":_i.x=-ba.w-(ba.leftPad||0);break;case"right":_i.x=-(ba.rightPad||0);break}switch(ga.pstyle("text-valign").value){case"top":_i.y=-ba.h-(ba.topPad||0);break;case"bottom":_i.y=-(ba.botPad||0);break}}return _i},Br=ar.data.eleTxrCache=new ElementTextureCache(ar,{getKey:Sr,doesEleInvalidateKey:Cr,drawElement:Tr,getBoundingBox:kr,getRotationPoint:Ir,getRotationOffset:Hr,allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),Ur=ar.data.lblTxrCache=new ElementTextureCache(ar,{getKey:wr,drawElement:Rr,getBoundingBox:Dr,getRotationPoint:jr,getRotationOffset:qr,isVisible:Or}),Vr=ar.data.slbTxrCache=new ElementTextureCache(ar,{getKey:Er,drawElement:Pr,getBoundingBox:Nr,getRotationPoint:Fr,getRotationOffset:Wr,isVisible:Or}),Xr=ar.data.tlbTxrCache=new ElementTextureCache(ar,{getKey:Ar,drawElement:_r,getBoundingBox:Lr,getRotationPoint:zr,getRotationOffset:Yr,isVisible:Or}),Zr=ar.data.lyrTxrCache=new LayeredTextureCache(ar);ar.onUpdateEleCalcs(function(ga,ba){Br.invalidateElements(ba),Ur.invalidateElements(ba),Vr.invalidateElements(ba),Xr.invalidateElements(ba),Zr.invalidateElements(ba);for(var _i=0;_i<ba.length;_i++){var os=ba[_i]._private;os.oldBackgroundTimestamp=os.backgroundTimestamp}});var Jr=function(ga){for(var ba=0;ba<ga.length;ba++)Zr.enqueueElementRefinement(ga[ba].ele)};Br.onDequeue(Jr),Ur.onDequeue(Jr),Vr.onDequeue(Jr),Xr.onDequeue(Jr),or.webgl&&ar.initWebgl(or,{getStyleKey:Sr,getLabelKey:wr,getSourceLabelKey:Er,getTargetLabelKey:Ar,drawElement:Tr,drawLabel:Rr,drawSourceLabel:Pr,drawTargetLabel:_r,getElementBox:kr,getLabelBox:Dr,getSourceLabelBox:Nr,getTargetLabelBox:Lr,getElementRotationPoint:Ir,getElementRotationOffset:Hr,getLabelRotationPoint:jr,getSourceLabelRotationPoint:Fr,getTargetLabelRotationPoint:zr,getLabelRotationOffset:qr,getSourceLabelRotationOffset:Wr,getTargetLabelRotationOffset:Yr})}CRp.redrawHint=function(or,ar){var lr=this;switch(or){case"eles":lr.data.canvasNeedsRedraw[CRp.NODE]=ar;break;case"drag":lr.data.canvasNeedsRedraw[CRp.DRAG]=ar;break;case"select":lr.data.canvasNeedsRedraw[CRp.SELECT_BOX]=ar;break;case"gc":lr.data.gc=!0;break}};var pathsImpld=typeof Path2D<"u";CRp.path2dEnabled=function(or){if(or===void 0)return this.pathsEnabled;this.pathsEnabled=!!or};CRp.usePaths=function(){return pathsImpld&&this.pathsEnabled};CRp.setImgSmoothing=function(or,ar){or.imageSmoothingEnabled!=null?or.imageSmoothingEnabled=ar:(or.webkitImageSmoothingEnabled=ar,or.mozImageSmoothingEnabled=ar,or.msImageSmoothingEnabled=ar)};CRp.getImgSmoothing=function(or){return or.imageSmoothingEnabled!=null?or.imageSmoothingEnabled:or.webkitImageSmoothingEnabled||or.mozImageSmoothingEnabled||or.msImageSmoothingEnabled};CRp.makeOffscreenCanvas=function(or,ar){var lr;if((typeof OffscreenCanvas>"u"?"undefined":_typeof(OffscreenCanvas))!=="undefined")lr=new OffscreenCanvas(or,ar);else{var ur=this.cy.window(),cr=ur.document;lr=cr.createElement("canvas"),lr.width=or,lr.height=ar}return lr};[CRp$b,CRp$a,CRp$9,CRp$8,CRp$7,CRp$6,CRp$5,CRp$4,CRp$3,CRp$2,CRp$1].forEach(function(or){extend(CRp,or)});var renderer=[{name:"null",impl:NullRenderer},{name:"base",impl:BR},{name:"canvas",impl:CR}],incExts=[{type:"layout",extensions:layout},{type:"renderer",extensions:renderer}],extensions={},modules={};function setExtension(or,ar,lr){var ur=lr,cr=function(kr){warn("Can not register `"+ar+"` for `"+or+"` since `"+kr+"` already exists in the prototype and can not be overridden")};if(or==="core"){if(Core.prototype[ar])return cr(ar);Core.prototype[ar]=lr}else if(or==="collection"){if(Collection.prototype[ar])return cr(ar);Collection.prototype[ar]=lr}else if(or==="layout"){for(var hr=function(kr){this.options=kr,lr.call(this,kr),plainObject(this._private)||(this._private={}),this._private.cy=kr.cy,this._private.listeners=[],this.createEmitter()},dr=hr.prototype=Object.create(lr.prototype),fr=[],pr=0;pr<fr.length;pr++){var vr=fr[pr];dr[vr]=dr[vr]||function(){return this}}dr.start&&!dr.run?dr.run=function(){return this.start(),this}:!dr.start&&dr.run&&(dr.start=function(){return this.run(),this});var gr=lr.prototype.stop;dr.stop=function(){var _r=this.options;if(_r&&_r.animate){var kr=this.animations;if(kr)for(var Dr=0;Dr<kr.length;Dr++)kr[Dr].stop()}return gr?gr.call(this):this.emit("layoutstop"),this},dr.destroy||(dr.destroy=function(){return this}),dr.cy=function(){return this._private.cy};var mr=function(kr){return kr._private.cy},br={addEventFields:function(kr,Dr){Dr.layout=kr,Dr.cy=mr(kr),Dr.target=kr},bubble:function(){return!0},parent:function(kr){return mr(kr)}};extend(dr,{createEmitter:function(){return this._private.emitter=new Emitter(br,this),this},emitter:function(){return this._private.emitter},on:function(kr,Dr){return this.emitter().on(kr,Dr),this},one:function(kr,Dr){return this.emitter().one(kr,Dr),this},once:function(kr,Dr){return this.emitter().one(kr,Dr),this},removeListener:function(kr,Dr){return this.emitter().removeListener(kr,Dr),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(kr,Dr){return this.emitter().emit(kr,Dr),this}}),define.eventAliasesOn(dr),ur=hr}else if(or==="renderer"&&ar!=="null"&&ar!=="base"){var yr=getExtension("renderer","base"),xr=yr.prototype,Cr=lr,Sr=lr.prototype,wr=function(){yr.apply(this,arguments),Cr.apply(this,arguments)},Er=wr.prototype;for(var Ar in xr){var Tr=xr[Ar],Rr=Sr[Ar]!=null;if(Rr)return cr(Ar);Er[Ar]=Tr}for(var Pr in Sr)Er[Pr]=Sr[Pr];xr.clientFunctions.forEach(function(_r){Er[_r]=Er[_r]||function(){error("Renderer does not implement `renderer."+_r+"()` on its prototype")}}),ur=wr}else if(or==="__proto__"||or==="constructor"||or==="prototype")return error(or+" is an illegal type to be registered, possibly lead to prototype pollutions");return setMap({map:extensions,keys:[or,ar],value:ur})}function getExtension(or,ar){return getMap({map:extensions,keys:[or,ar]})}function setModule(or,ar,lr,ur,cr){return setMap({map:modules,keys:[or,ar,lr,ur],value:cr})}function getModule(or,ar,lr,ur){return getMap({map:modules,keys:[or,ar,lr,ur]})}var extension=function or(){if(arguments.length===2)return getExtension.apply(null,arguments);if(arguments.length===3)return setExtension.apply(null,arguments);if(arguments.length===4)return getModule.apply(null,arguments);if(arguments.length===5)return setModule.apply(null,arguments);error("Invalid extension access syntax")};Core.prototype.extension=extension;incExts.forEach(function(or){or.extensions.forEach(function(ar){setExtension(or.type,ar.name,ar.impl)})});var _Stylesheet=function or(){if(!(this instanceof _Stylesheet))return new _Stylesheet;this.length=0},sheetfn=_Stylesheet.prototype;sheetfn.instanceString=function(){return"stylesheet"};sheetfn.selector=function(or){var ar=this.length++;return this[ar]={selector:or,properties:[]},this};sheetfn.css=function(or,ar){var lr=this.length-1;if(string(or))this[lr].properties.push({name:or,value:ar});else if(plainObject(or))for(var ur=or,cr=Object.keys(ur),hr=0;hr<cr.length;hr++){var dr=cr[hr],fr=ur[dr];if(fr!=null){var pr=_Style.properties[dr]||_Style.properties[dash2camel(dr)];if(pr!=null){var vr=pr.name,gr=fr;this[lr].properties.push({name:vr,value:gr})}}}return this};sheetfn.style=sheetfn.css;sheetfn.generateStyle=function(or){var ar=new _Style(or);return this.appendToStyle(ar)};sheetfn.appendToStyle=function(or){for(var ar=0;ar<this.length;ar++){var lr=this[ar],ur=lr.selector,cr=lr.properties;or.selector(ur);for(var hr=0;hr<cr.length;hr++){var dr=cr[hr];or.css(dr.name,dr.value)}}return or};var version="3.33.1",cytoscape$1=function or(ar){if(ar===void 0&&(ar={}),plainObject(ar))return new Core(ar);if(string(ar))return extension.apply(extension,arguments)};cytoscape$1.use=function(or){var ar=Array.prototype.slice.call(arguments,1);return ar.unshift(cytoscape$1),or.apply(null,ar),this};cytoscape$1.warnings=function(or){return warnings(or)};cytoscape$1.version=version;cytoscape$1.stylesheet=cytoscape$1.Stylesheet=_Stylesheet;var cytoscapeEdgehandles={exports:{}},lodash_memoize,hasRequiredLodash_memoize;function requireLodash_memoize(){if(hasRequiredLodash_memoize)return lodash_memoize;hasRequiredLodash_memoize=1;var or="Expected a function",ar="__lodash_hash_undefined__",lr="[object Function]",ur="[object GeneratorFunction]",cr=/[\\^$.*+?()[\]{}|]/g,hr=/^\[object .+?Constructor\]$/,dr=typeof commonjsGlobal$1=="object"&&commonjsGlobal$1&&commonjsGlobal$1.Object===Object&&commonjsGlobal$1,fr=typeof self=="object"&&self&&self.Object===Object&&self,pr=dr||fr||Function("return this")();function vr(ns,as){return ns==null?void 0:ns[as]}function gr(ns){var as=!1;if(ns!=null&&typeof ns.toString!="function")try{as=!!(ns+"")}catch{}return as}var mr=Array.prototype,br=Function.prototype,yr=Object.prototype,xr=pr["__core-js_shared__"],Cr=function(){var ns=/[^.]+$/.exec(xr&&xr.keys&&xr.keys.IE_PROTO||"");return ns?"Symbol(src)_1."+ns:""}(),Sr=br.toString,wr=yr.hasOwnProperty,Er=yr.toString,Ar=RegExp("^"+Sr.call(wr).replace(cr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tr=mr.splice,Rr=Jr(pr,"Map"),Pr=Jr(Object,"create");function _r(ns){var as=-1,Kr=ns?ns.length:0;for(this.clear();++as<Kr;){var $a=ns[as];this.set($a[0],$a[1])}}function kr(){this.__data__=Pr?Pr(null):{}}function Dr(ns){return this.has(ns)&&delete this.__data__[ns]}function Nr(ns){var as=this.__data__;if(Pr){var Kr=as[ns];return Kr===ar?void 0:Kr}return wr.call(as,ns)?as[ns]:void 0}function Lr(ns){var as=this.__data__;return Pr?as[ns]!==void 0:wr.call(as,ns)}function Or(ns,as){var Kr=this.__data__;return Kr[ns]=Pr&&as===void 0?ar:as,this}_r.prototype.clear=kr,_r.prototype.delete=Dr,_r.prototype.get=Nr,_r.prototype.has=Lr,_r.prototype.set=Or;function Ir(ns){var as=-1,Kr=ns?ns.length:0;for(this.clear();++as<Kr;){var $a=ns[as];this.set($a[0],$a[1])}}function Mr(){this.__data__=[]}function $r(ns){var as=this.__data__,Kr=Vr(as,ns);if(Kr<0)return!1;var $a=as.length-1;return Kr==$a?as.pop():Tr.call(as,Kr,1),!0}function jr(ns){var as=this.__data__,Kr=Vr(as,ns);return Kr<0?void 0:as[Kr][1]}function Fr(ns){return Vr(this.__data__,ns)>-1}function zr(ns,as){var Kr=this.__data__,$a=Vr(Kr,ns);return $a<0?Kr.push([ns,as]):Kr[$a][1]=as,this}Ir.prototype.clear=Mr,Ir.prototype.delete=$r,Ir.prototype.get=jr,Ir.prototype.has=Fr,Ir.prototype.set=zr;function Hr(ns){var as=-1,Kr=ns?ns.length:0;for(this.clear();++as<Kr;){var $a=ns[as];this.set($a[0],$a[1])}}function Wr(){this.__data__={hash:new _r,map:new(Rr||Ir),string:new _r}}function Yr(ns){return Zr(this,ns).delete(ns)}function qr(ns){return Zr(this,ns).get(ns)}function Br(ns){return Zr(this,ns).has(ns)}function Ur(ns,as){return Zr(this,ns).set(ns,as),this}Hr.prototype.clear=Wr,Hr.prototype.delete=Yr,Hr.prototype.get=qr,Hr.prototype.has=Br,Hr.prototype.set=Ur;function Vr(ns,as){for(var Kr=ns.length;Kr--;)if(os(ns[Kr][0],as))return Kr;return-1}function Xr(ns){if(!ys(ns)||ga(ns))return!1;var as=ls(ns)||gr(ns)?Ar:hr;return as.test(ba(ns))}function Zr(ns,as){var Kr=ns.__data__;return Qr(as)?Kr[typeof as=="string"?"string":"hash"]:Kr.map}function Jr(ns,as){var Kr=vr(ns,as);return Xr(Kr)?Kr:void 0}function Qr(ns){var as=typeof ns;return as=="string"||as=="number"||as=="symbol"||as=="boolean"?ns!=="__proto__":ns===null}function ga(ns){return!!Cr&&Cr in ns}function ba(ns){if(ns!=null){try{return Sr.call(ns)}catch{}try{return ns+""}catch{}}return""}function _i(ns,as){if(typeof ns!="function"||as&&typeof as!="function")throw new TypeError(or);var Kr=function(){var $a=arguments,ss=as?as.apply(this,$a):$a[0],hs=Kr.cache;if(hs.has(ss))return hs.get(ss);var vs=ns.apply(this,$a);return Kr.cache=hs.set(ss,vs),vs};return Kr.cache=new(_i.Cache||Hr),Kr}_i.Cache=Hr;function os(ns,as){return ns===as||ns!==ns&&as!==as}function ls(ns){var as=ys(ns)?Er.call(ns):"";return as==lr||as==ur}function ys(ns){var as=typeof ns;return!!ns&&(as=="object"||as=="function")}return lodash_memoize=_i,lodash_memoize}var lodash_throttle,hasRequiredLodash_throttle;function requireLodash_throttle(){if(hasRequiredLodash_throttle)return lodash_throttle;hasRequiredLodash_throttle=1;var or="Expected a function",ar=NaN,lr="[object Symbol]",ur=/^\s+|\s+$/g,cr=/^[-+]0x[0-9a-f]+$/i,hr=/^0b[01]+$/i,dr=/^0o[0-7]+$/i,fr=parseInt,pr=typeof commonjsGlobal$1=="object"&&commonjsGlobal$1&&commonjsGlobal$1.Object===Object&&commonjsGlobal$1,vr=typeof self=="object"&&self&&self.Object===Object&&self,gr=pr||vr||Function("return this")(),mr=Object.prototype,br=mr.toString,yr=Math.max,xr=Math.min,Cr=function(){return gr.Date.now()};function Sr(Pr,_r,kr){var Dr,Nr,Lr,Or,Ir,Mr,$r=0,jr=!1,Fr=!1,zr=!0;if(typeof Pr!="function")throw new TypeError(or);_r=Rr(_r)||0,Er(kr)&&(jr=!!kr.leading,Fr="maxWait"in kr,Lr=Fr?yr(Rr(kr.maxWait)||0,_r):Lr,zr="trailing"in kr?!!kr.trailing:zr);function Hr(Jr){var Qr=Dr,ga=Nr;return Dr=Nr=void 0,$r=Jr,Or=Pr.apply(ga,Qr),Or}function Wr(Jr){return $r=Jr,Ir=setTimeout(Br,_r),jr?Hr(Jr):Or}function Yr(Jr){var Qr=Jr-Mr,ga=Jr-$r,ba=_r-Qr;return Fr?xr(ba,Lr-ga):ba}function qr(Jr){var Qr=Jr-Mr,ga=Jr-$r;return Mr===void 0||Qr>=_r||Qr<0||Fr&&ga>=Lr}function Br(){var Jr=Cr();if(qr(Jr))return Ur(Jr);Ir=setTimeout(Br,Yr(Jr))}function Ur(Jr){return Ir=void 0,zr&&Dr?Hr(Jr):(Dr=Nr=void 0,Or)}function Vr(){Ir!==void 0&&clearTimeout(Ir),$r=0,Dr=Mr=Nr=Ir=void 0}function Xr(){return Ir===void 0?Or:Ur(Cr())}function Zr(){var Jr=Cr(),Qr=qr(Jr);if(Dr=arguments,Nr=this,Mr=Jr,Qr){if(Ir===void 0)return Wr(Mr);if(Fr)return Ir=setTimeout(Br,_r),Hr(Mr)}return Ir===void 0&&(Ir=setTimeout(Br,_r)),Or}return Zr.cancel=Vr,Zr.flush=Xr,Zr}function wr(Pr,_r,kr){var Dr=!0,Nr=!0;if(typeof Pr!="function")throw new TypeError(or);return Er(kr)&&(Dr="leading"in kr?!!kr.leading:Dr,Nr="trailing"in kr?!!kr.trailing:Nr),Sr(Pr,_r,{leading:Dr,maxWait:_r,trailing:Nr})}function Er(Pr){var _r=typeof Pr;return!!Pr&&(_r=="object"||_r=="function")}function Ar(Pr){return!!Pr&&typeof Pr=="object"}function Tr(Pr){return typeof Pr=="symbol"||Ar(Pr)&&br.call(Pr)==lr}function Rr(Pr){if(typeof Pr=="number")return Pr;if(Tr(Pr))return ar;if(Er(Pr)){var _r=typeof Pr.valueOf=="function"?Pr.valueOf():Pr;Pr=Er(_r)?_r+"":_r}if(typeof Pr!="string")return Pr===0?Pr:+Pr;Pr=Pr.replace(ur,"");var kr=hr.test(Pr);return kr||dr.test(Pr)?fr(Pr.slice(2),kr?2:8):cr.test(Pr)?ar:+Pr}return lodash_throttle=wr,lodash_throttle}(function(or,ar){(function(ur,cr){or.exports=cr(requireLodash_memoize(),requireLodash_throttle())})(commonjsGlobal$1,function(lr,ur){return function(cr){var hr={};function dr(fr){if(hr[fr])return hr[fr].exports;var pr=hr[fr]={i:fr,l:!1,exports:{}};return cr[fr].call(pr.exports,pr,pr.exports,dr),pr.l=!0,pr.exports}return dr.m=cr,dr.c=hr,dr.i=function(fr){return fr},dr.d=function(fr,pr,vr){dr.o(fr,pr)||Object.defineProperty(fr,pr,{configurable:!1,enumerable:!0,get:vr})},dr.n=function(fr){var pr=fr&&fr.__esModule?function(){return fr.default}:function(){return fr};return dr.d(pr,"a",pr),pr},dr.o=function(fr,pr){return Object.prototype.hasOwnProperty.call(fr,pr)},dr.p="",dr(dr.s=12)}([function(cr,hr,dr){cr.exports=Object.assign!=null?Object.assign.bind(Object):function(fr){for(var pr=arguments.length,vr=Array(pr>1?pr-1:0),gr=1;gr<pr;gr++)vr[gr-1]=arguments[gr];return vr.filter(function(mr){return mr!=null}).forEach(function(mr){Object.keys(mr).forEach(function(br){return fr[br]=mr[br]})}),fr}},function(cr,hr,dr){var fr=dr(10),pr=dr(0);cr.exports=function(vr){var gr=this;return new fr(pr({cy:gr},vr))}},function(cr,hr,dr){function fr(){if(this.saveGestureState(),this.cy.zoomingEnabled(!1).panningEnabled(!1).boxSelectionEnabled(!1),this.options.disableBrowserGestures){var gr=this.windowListenerOptions;window.addEventListener("touchstart",this.preventDefault,gr),window.addEventListener("touchmove",this.preventDefault,gr),window.addEventListener("wheel",this.preventDefault,gr)}return this}function pr(){if(this.cy.zoomingEnabled(this.lastZoomingEnabled).panningEnabled(this.lastPanningEnabled).boxSelectionEnabled(this.lastBoxSelectionEnabled),this.options.disableBrowserGestures){var gr=this.windowListenerOptions;window.removeEventListener("touchstart",this.preventDefault,gr),window.removeEventListener("touchmove",this.preventDefault,gr),window.removeEventListener("wheel",this.preventDefault,gr)}return this}function vr(){var gr=this.cy;return this.lastPanningEnabled=gr.panningEnabled(),this.lastZoomingEnabled=gr.zoomingEnabled(),this.lastBoxSelectionEnabled=gr.boxSelectionEnabled(),this}cr.exports={disableGestures:fr,resetGestures:pr,saveGestureState:vr}},function(cr,hr,dr){function fr(){var pr=this,vr=this.cy,gr=this.options;return this.addListener(vr,"drag",function(){return pr.grabbingNode=!0}),this.addListener(vr,"free",function(){return pr.grabbingNode=!1}),this.addListener(vr,"tapstart","node",function(mr){var br=mr.target;pr.drawMode&&pr.start(br)}),this.addListener(vr,"tapdrag",function(mr){pr.update(mr.position)}),this.addListener(vr,"tapdragover","node",function(mr){gr.snap||pr.preview(mr.target)}),this.addListener(vr,"tapdragout","node",function(mr){gr.snap||pr.unpreview(mr.target)}),this.addListener(vr,"tapend",function(){pr.stop()}),this}cr.exports={addCytoscapeListeners:fr}},function(cr,hr,dr){var fr={canConnect:function(vr,gr){return!vr.same(gr)},edgeParams:function(vr,gr){return{}},hoverDelay:150,snap:!0,snapThreshold:50,snapFrequency:15,noEdgeEventsInDraw:!0,disableBrowserGestures:!0};cr.exports=fr},function(cr,hr,dr){function fr(gr){var mr=this.cy;return this.drawMode=gr??!this.drawMode,this.drawMode?(this.prevUngrabifyState=mr.autoungrabify(),mr.autoungrabify(!0),this.emit("drawon")):(mr.autoungrabify(this.prevUngrabifyState),this.emit("drawoff")),this}function pr(){return this.toggleDrawMode(!0)}function vr(){return this.toggleDrawMode(!1)}cr.exports={toggleDrawMode:fr,enableDrawMode:pr,disableDrawMode:vr}},function(cr,hr,dr){var fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(wr){return typeof wr}:function(wr){return wr&&typeof Symbol=="function"&&wr.constructor===Symbol&&wr!==Symbol.prototype?"symbol":typeof wr},pr=dr(0),vr=function(Er){return(typeof Er>"u"?"undefined":fr(Er))===fr("")},gr=function(Er){return(typeof Er>"u"?"undefined":fr(Er))===fr([])&&Er.length!=null};function mr(wr,Er,Ar){var Tr={};return pr(Tr,Er,wr),pr(Tr.data,Er.data,wr.data),vr(Er.classes)?Tr.classes=Er.classes+" "+Ar:gr(Er.classes)?Tr.classes=Er.classes.join(" ")+" "+Ar:Tr.classes=Ar,Tr}function br(){var wr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Er=this.cy;this.options;var Ar=this.presumptiveTargets,Tr=this.previewEles,Rr=this.active,Pr=this.sourceNode,_r=this.targetNode,kr=wr?"eh-preview":"",Dr=Er.collection(),Nr=this.canConnect(_r);if(Rr&&Nr){if(!_r||_r.size()===0){Tr.remove(),this.emit("cancel",this.mp(),Pr,Ar);return}if(!wr){Tr.removeClass("eh-preview").style("events",""),this.emit("complete",this.mp(),Pr,_r,Tr);return}var Lr=Er.add(mr({group:"edges",data:{source:Pr.id(),target:_r.id()}},this.edgeParams(_r),kr));return Dr=Dr.merge(Lr),wr?(this.previewEles=Dr,Dr.style("events","no")):(Dr.style("events",""),this.emit("complete",this.mp(),Pr,_r,Dr)),this}}function yr(){return this.makeEdges(!0),this}function xr(){return this.previewEles.nonempty()&&this.previewEles.inside()}function Cr(){return this.previewShown()&&this.previewEles.remove(),this}function Sr(){var wr=this,Er=this.sourceNode,Ar=this.ghostNode,Tr=this.cy,Rr=this.mx,Pr=this.my,_r=Rr,kr=Pr,Dr=void 0,Nr=void 0;if(Er)return(!Ar||Ar.length===0||Ar.removed())&&(Nr=this.ghostEles=Tr.collection(),Tr.batch(function(){Ar=wr.ghostNode=Tr.add({group:"nodes",classes:"eh-ghost eh-ghost-node",position:{x:0,y:0}}),Ar.style({"background-color":"blue",width:1e-4,height:1e-4,opacity:0,events:"no"});var Lr={};Dr=Tr.add(pr({},Lr,{group:"edges",data:pr({},Lr.data,{source:Er.id(),target:Ar.id()}),classes:"eh-ghost eh-ghost-edge"})),Dr.style({events:"no"})}),Nr.merge(Ar).merge(Dr)),Ar.position({x:_r,y:kr}),this}cr.exports={makeEdges:br,makePreview:yr,removePreview:Cr,previewShown:xr,updateEdge:Sr}},function(cr,hr,dr){function fr(){return this.options.noEdgeEventsInDraw&&this.cy.edges().style("events","no"),this}function pr(){return this.options.noEdgeEventsInDraw&&this.cy.edges().style("events",""),this}cr.exports={disableEdgeEvents:fr,enableEdgeEvents:pr}},function(cr,hr,dr){function fr(){return this.enabled=!0,this.emit("enable"),this}function pr(){return this.enabled=!1,this.emit("disable"),this}cr.exports={enable:fr,disable:pr}},function(cr,hr,dr){var fr=dr(13),pr=Math.sqrt(2);function vr(Er){var Ar=this.previewEles,Tr=this.ghostEles,Rr=function(Or){return Ar.anySame(Or)},Pr=function(Or){return Tr.anySame(Or)},_r=function(Or){return Rr(Or)||Pr(Or)},kr=this.enabled,Dr=this.active,Nr=this.grabbingNode;return kr&&!Dr&&!Nr&&Er!=null&&Er.nonempty()&&!_r(Er)}function gr(Er){return this.canStartOn(Er)&&this.drawMode}function mr(Er){return this.canStartOn(Er)&&!this.drawMode}function br(Er){var Ar=this;if(this.canStartOn(Er)){this.active=!0,this.sourceNode=Er,this.sourceNode.addClass("eh-source"),this.disableGestures(),this.disableEdgeEvents();var Tr=function(Pr){return Pr.id()};this.canConnect=fr(function(Rr){return Ar.options.canConnect(Ar.sourceNode,Rr)},Tr),this.edgeParams=fr(function(Rr){return Ar.options.edgeParams(Ar.sourceNode,Rr)},Tr),this.emit("start",this.hp(),Er)}}function yr(Er){if(this.active){var Ar=Er;return this.mx=Ar.x,this.my=Ar.y,this.updateEdge(),this.throttledSnap(),this}}function xr(){if(!this.active||!this.options.snap)return!1;var Er=this.cy,Ar=this.targetNode,Tr=this.options.snapThreshold,Rr=this.mp(),Pr=this.previewEles,_r=this.ghostNode,kr=function(Vr){return pr*Math.max(Vr.outerWidth(),Vr.outerHeight())/2},Dr=function(Vr,Xr,Zr,Jr){var Qr=Zr-Vr,ga=Jr-Xr;return Qr*Qr+ga*ga},Nr=function(Vr,Xr){return Dr(Vr.x,Vr.y,Xr.x,Xr.y)},Lr=function(Vr){return Nr(Vr.position(),Rr)},Or=function(Vr){var Xr=kr(Vr),Zr=Xr+Tr;return Zr*Zr},Ir=function(Vr){return Lr(Vr)<=Or(Vr)},Mr=function(Vr){var Xr=Vr.position(),Zr=Vr.outerWidth()/2,Jr=Vr.outerHeight()/2,Qr=Xr.x,ga=Xr.y,ba=Rr.x,_i=Rr.y,os=Qr-Zr,ls=Qr+Zr,ys=ga-Jr,ns=ga+Jr,as=os<=ba&&ba<=ls,Kr=ys<=_i&&_i<=ns;if(as&&Kr)return 0;if(as){var $a=_i-ys,ss=_i-ns;return Math.min($a*$a,ss*ss)}else if(Kr){var hs=ba-os,vs=ba-ls;return Math.min(hs*hs,vs*vs)}else return ba<os&&_i<ys?Dr(ba,_i,os,ys):ba>ls&&_i<ys?Dr(ba,_i,ls,ys):ba<os&&_i>ns?Dr(ba,_i,os,ns):Dr(ba,_i,ls,ns)},$r=function(Vr,Xr){return Mr(Vr)-Mr(Xr)},jr=$r,Fr=!1,zr=function(Vr){var Xr=Rr,Zr=Vr.outerWidth(),Jr=Zr/2,Qr=Vr.outerHeight(),ga=Qr/2,ba=Vr.position(),_i=ba.x-Jr,os=ba.x+Jr,ls=ba.y-ga,ys=ba.y+ga;return _i<=Xr.x&&Xr.x<=os&&ls<=Xr.y&&Xr.y<=ys},Hr=function(Vr){return Vr.same(Pr)||Vr.same(_r)},Wr=Er.nodes(function(Ur){return!Hr(Ur)&&Ir(Ur)}).sort(jr),Yr=!1;Ar.nonempty()&&!Ir(Ar)&&this.unpreview(Ar);for(var qr=0;qr<Wr.length;qr++){var Br=Wr[qr];if(!(Br.isParent()&&zr(Br))&&!(Br.isChild()&&!zr(Br.parent()))&&(Br.same(Ar)||this.preview(Br,Fr))){Yr=!0;break}}return Yr}function Cr(Er){var Ar=this,Tr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Rr=this.options,Pr=this.sourceNode,_r=this.ghostNode,kr=this.ghostEles,Dr=this.presumptiveTargets,Nr=this.previewEles,Lr=this.active,Or=Pr,Ir=Er.same(_r),Mr=!this.canConnect(Er),$r=Er.same(this.targetNode);if(!Lr||Ir||Mr||$r)return!1;this.targetNode.nonempty()&&this.unpreview(this.targetNode),clearTimeout(this.previewTimeout);var jr=function(){Ar.targetNode=Er,Dr.merge(Er),Er.addClass("eh-presumptive-target"),Er.addClass("eh-target"),Ar.emit("hoverover",Ar.mp(),Or,Er),Er.addClass("eh-preview"),kr.addClass("eh-preview-active"),Pr.addClass("eh-preview-active"),Er.addClass("eh-preview-active"),Ar.makePreview(),Ar.emit("previewon",Ar.mp(),Or,Er,Nr)};return Tr&&Rr.hoverDelay>0?this.previewTimeout=setTimeout(jr,Rr.hoverDelay):jr(),!0}function Sr(Er){if(this.active){var Ar=this.previewTimeout,Tr=this.sourceNode,Rr=this.previewEles,Pr=this.ghostEles,_r=this.cy;clearTimeout(Ar),this.previewTimeout=null;var kr=Tr;return Er.removeClass("eh-preview eh-target eh-presumptive-target eh-preview-active"),Pr.removeClass("eh-preview-active"),Tr.removeClass("eh-preview-active"),this.targetNode=_r.collection(),this.removePreview(kr,Er),this.emit("hoverout",this.mp(),kr,Er),this.emit("previewoff",this.mp(),kr,Er,Rr),this}}function wr(){if(this.active){var Er=this.sourceNode,Ar=this.targetNode,Tr=this.ghostEles,Rr=this.presumptiveTargets;return clearTimeout(this.previewTimeout),Er.removeClass("eh-source eh-preview-active"),Ar.removeClass("eh-target eh-preview eh-hover eh-preview-active"),Rr.removeClass("eh-presumptive-target"),this.makeEdges(),Tr.remove(),this.clearCollections(),this.resetGestures(),this.enableEdgeEvents(),this.active=!1,this.emit("stop",this.mp(),Er),this}}cr.exports={start:br,update:yr,preview:Cr,unpreview:Sr,stop:wr,snap:xr,canStartOn:vr,canStartDrawModeOn:gr,canStartNonDrawModeOn:mr}},function(cr,hr,dr){var fr=dr(4),pr=dr(0),vr=dr(14),gr=dr(2),mr=dr(3),br=dr(5),yr=dr(6),xr=dr(8),Cr=dr(9),Sr=dr(11),wr=dr(7);function Er(Rr){var Pr=Rr.cy;this.cy=Pr,this.listeners=[],this.enabled=!0,this.drawMode=!1,this.active=!1,this.grabbingNode=!1,this.clearCollections(),this.mx=0,this.my=0,this.options=pr({},fr,Rr),this.saveGestureState(),this.addListeners(),this.throttledSnap=vr(this.snap.bind(this),1e3/Rr.snapFrequency),this.preventDefault=function(Dr){return Dr.preventDefault()},this.canConnect=function(){return!1};var _r=!1;try{var kr=Object.defineProperty({},"passive",{get:function(){_r=!0}});window.addEventListener("test",null,kr)}catch{}_r?this.windowListenerOptions={capture:!0,passive:!1}:this.windowListenerOptions=!0}var Ar=Er.prototype={},Tr=function(Pr){return pr(Ar,Pr)};Ar.destroy=function(){this.removeListeners()},Ar.setOptions=function(Rr){pr(this.options,Rr)},Ar.mp=function(){return{x:this.mx,y:this.my}},Ar.hp=function(){return{x:this.hx,y:this.hy}},Ar.clearCollections=function(){var Rr=this.cy;this.previewEles=Rr.collection(),this.ghostEles=Rr.collection(),this.ghostNode=Rr.collection(),this.sourceNode=Rr.collection(),this.targetNode=Rr.collection(),this.presumptiveTargets=Rr.collection()},[gr,mr,br,yr,xr,Cr,Sr,wr].forEach(Tr),cr.exports=Er},function(cr,hr,dr){var fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Cr){return typeof Cr}:function(Cr){return Cr&&typeof Symbol=="function"&&Cr.constructor===Symbol&&Cr!==Symbol.prototype?"symbol":typeof Cr};function pr(){var Cr=this;return this.addCytoscapeListeners(),this.addListener(this.cy,"destroy",function(){return Cr.destroy()}),this}function vr(){for(var Cr=this.listeners.length-1;Cr>=0;Cr--){var Sr=this.listeners[Cr];this.removeListener(Sr.target,Sr.event,Sr.selector,Sr.callback,Sr.options)}return this}function gr(Cr,Sr,wr,Er,Ar){return(typeof wr>"u"?"undefined":fr(wr))!==fr("")&&(Er=wr,Ar=Er,wr=null),Ar==null&&(Ar=!1),{target:Cr,event:Sr,selector:wr,callback:Er,options:Ar}}function mr(Cr){return Cr instanceof Element}function br(Cr,Sr,wr,Er,Ar){var Tr=gr(Cr,Sr,wr,Er,Ar);return this.listeners.push(Tr),mr(Tr.target)?Tr.target.addEventListener(Tr.event,Tr.callback,Tr.options):Tr.selector?Tr.target.addListener(Tr.event,Tr.selector,Tr.callback,Tr.options):Tr.target.addListener(Tr.event,Tr.callback,Tr.options),this}function yr(Cr,Sr,wr,Er,Ar){for(var Tr=gr(Cr,Sr,wr,Er,Ar),Rr=this.listeners.length-1;Rr>=0;Rr--){var Pr=this.listeners[Rr];if(Tr.target===Pr.target&&Tr.event===Pr.event&&(Tr.selector==null||Tr.selector===Pr.selector)&&(Tr.callback==null||Tr.callback===Pr.callback)){this.listeners.splice(Rr,1),mr(Tr.target)?Tr.target.removeEventListener(Tr.event,Tr.callback,Tr.options):Tr.selector?Tr.target.removeListener(Tr.event,Tr.selector,Tr.callback,Tr.options):Tr.target.removeListener(Tr.event,Tr.callback,Tr.options);break}}return this}function xr(Cr,Sr){for(var wr=this.cy,Er=arguments.length,Ar=Array(Er>2?Er-2:0),Tr=2;Tr<Er;Tr++)Ar[Tr-2]=arguments[Tr];return wr.emit({type:"eh"+Cr,position:Sr},Ar),this}cr.exports={addListener:br,addListeners:pr,removeListener:yr,removeListeners:vr,emit:xr}},function(cr,hr,dr){var fr=dr(1),pr=function(gr){gr&&gr("core","edgehandles",fr)};typeof cytoscape<"u"&&pr(cytoscape),cr.exports=pr},function(cr,hr){cr.exports=lr},function(cr,hr){cr.exports=ur}])})})(cytoscapeEdgehandles);var cytoscapeEdgehandlesExports=cytoscapeEdgehandles.exports;const edgehandles=getDefaultExportFromCjs$1(cytoscapeEdgehandlesExports);var cytoscapeFcose={exports:{}},coseBase={exports:{}},layoutBase={exports:{}},hasRequiredLayoutBase;function requireLayoutBase(){return hasRequiredLayoutBase||(hasRequiredLayoutBase=1,function(or,ar){(function(ur,cr){or.exports=cr()})(commonjsGlobal$1,function(){return function(lr){var ur={};function cr(hr){if(ur[hr])return ur[hr].exports;var dr=ur[hr]={i:hr,l:!1,exports:{}};return lr[hr].call(dr.exports,dr,dr.exports,cr),dr.l=!0,dr.exports}return cr.m=lr,cr.c=ur,cr.i=function(hr){return hr},cr.d=function(hr,dr,fr){cr.o(hr,dr)||Object.defineProperty(hr,dr,{configurable:!1,enumerable:!0,get:fr})},cr.n=function(hr){var dr=hr&&hr.__esModule?function(){return hr.default}:function(){return hr};return cr.d(dr,"a",dr),dr},cr.o=function(hr,dr){return Object.prototype.hasOwnProperty.call(hr,dr)},cr.p="",cr(cr.s=28)}([function(lr,ur,cr){function hr(){}hr.QUALITY=1,hr.DEFAULT_CREATE_BENDS_AS_NEEDED=!1,hr.DEFAULT_INCREMENTAL=!1,hr.DEFAULT_ANIMATION_ON_LAYOUT=!0,hr.DEFAULT_ANIMATION_DURING_LAYOUT=!1,hr.DEFAULT_ANIMATION_PERIOD=50,hr.DEFAULT_UNIFORM_LEAF_NODE_SIZES=!1,hr.DEFAULT_GRAPH_MARGIN=15,hr.NODE_DIMENSIONS_INCLUDE_LABELS=!1,hr.SIMPLE_NODE_SIZE=40,hr.SIMPLE_NODE_HALF_SIZE=hr.SIMPLE_NODE_SIZE/2,hr.EMPTY_COMPOUND_NODE_SIZE=40,hr.MIN_EDGE_LENGTH=1,hr.WORLD_BOUNDARY=1e6,hr.INITIAL_WORLD_BOUNDARY=hr.WORLD_BOUNDARY/1e3,hr.WORLD_CENTER_X=1200,hr.WORLD_CENTER_Y=900,lr.exports=hr},function(lr,ur,cr){var hr=cr(2),dr=cr(8),fr=cr(9);function pr(gr,mr,br){hr.call(this,br),this.isOverlapingSourceAndTarget=!1,this.vGraphObject=br,this.bendpoints=[],this.source=gr,this.target=mr}pr.prototype=Object.create(hr.prototype);for(var vr in hr)pr[vr]=hr[vr];pr.prototype.getSource=function(){return this.source},pr.prototype.getTarget=function(){return this.target},pr.prototype.isInterGraph=function(){return this.isInterGraph},pr.prototype.getLength=function(){return this.length},pr.prototype.isOverlapingSourceAndTarget=function(){return this.isOverlapingSourceAndTarget},pr.prototype.getBendpoints=function(){return this.bendpoints},pr.prototype.getLca=function(){return this.lca},pr.prototype.getSourceInLca=function(){return this.sourceInLca},pr.prototype.getTargetInLca=function(){return this.targetInLca},pr.prototype.getOtherEnd=function(gr){if(this.source===gr)return this.target;if(this.target===gr)return this.source;throw"Node is not incident with this edge"},pr.prototype.getOtherEndInGraph=function(gr,mr){for(var br=this.getOtherEnd(gr),yr=mr.getGraphManager().getRoot();;){if(br.getOwner()==mr)return br;if(br.getOwner()==yr)break;br=br.getOwner().getParent()}return null},pr.prototype.updateLength=function(){var gr=new Array(4);this.isOverlapingSourceAndTarget=dr.getIntersection(this.target.getRect(),this.source.getRect(),gr),this.isOverlapingSourceAndTarget||(this.lengthX=gr[0]-gr[2],this.lengthY=gr[1]-gr[3],Math.abs(this.lengthX)<1&&(this.lengthX=fr.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=fr.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY))},pr.prototype.updateLengthSimple=function(){this.lengthX=this.target.getCenterX()-this.source.getCenterX(),this.lengthY=this.target.getCenterY()-this.source.getCenterY(),Math.abs(this.lengthX)<1&&(this.lengthX=fr.sign(this.lengthX)),Math.abs(this.lengthY)<1&&(this.lengthY=fr.sign(this.lengthY)),this.length=Math.sqrt(this.lengthX*this.lengthX+this.lengthY*this.lengthY)},lr.exports=pr},function(lr,ur,cr){function hr(dr){this.vGraphObject=dr}lr.exports=hr},function(lr,ur,cr){var hr=cr(2),dr=cr(10),fr=cr(13),pr=cr(0),vr=cr(16),gr=cr(5);function mr(yr,xr,Cr,Sr){Cr==null&&Sr==null&&(Sr=xr),hr.call(this,Sr),yr.graphManager!=null&&(yr=yr.graphManager),this.estimatedSize=dr.MIN_VALUE,this.inclusionTreeDepth=dr.MAX_VALUE,this.vGraphObject=Sr,this.edges=[],this.graphManager=yr,Cr!=null&&xr!=null?this.rect=new fr(xr.x,xr.y,Cr.width,Cr.height):this.rect=new fr}mr.prototype=Object.create(hr.prototype);for(var br in hr)mr[br]=hr[br];mr.prototype.getEdges=function(){return this.edges},mr.prototype.getChild=function(){return this.child},mr.prototype.getOwner=function(){return this.owner},mr.prototype.getWidth=function(){return this.rect.width},mr.prototype.setWidth=function(yr){this.rect.width=yr},mr.prototype.getHeight=function(){return this.rect.height},mr.prototype.setHeight=function(yr){this.rect.height=yr},mr.prototype.getCenterX=function(){return this.rect.x+this.rect.width/2},mr.prototype.getCenterY=function(){return this.rect.y+this.rect.height/2},mr.prototype.getCenter=function(){return new gr(this.rect.x+this.rect.width/2,this.rect.y+this.rect.height/2)},mr.prototype.getLocation=function(){return new gr(this.rect.x,this.rect.y)},mr.prototype.getRect=function(){return this.rect},mr.prototype.getDiagonal=function(){return Math.sqrt(this.rect.width*this.rect.width+this.rect.height*this.rect.height)},mr.prototype.getHalfTheDiagonal=function(){return Math.sqrt(this.rect.height*this.rect.height+this.rect.width*this.rect.width)/2},mr.prototype.setRect=function(yr,xr){this.rect.x=yr.x,this.rect.y=yr.y,this.rect.width=xr.width,this.rect.height=xr.height},mr.prototype.setCenter=function(yr,xr){this.rect.x=yr-this.rect.width/2,this.rect.y=xr-this.rect.height/2},mr.prototype.setLocation=function(yr,xr){this.rect.x=yr,this.rect.y=xr},mr.prototype.moveBy=function(yr,xr){this.rect.x+=yr,this.rect.y+=xr},mr.prototype.getEdgeListToNode=function(yr){var xr=[],Cr=this;return Cr.edges.forEach(function(Sr){if(Sr.target==yr){if(Sr.source!=Cr)throw"Incorrect edge source!";xr.push(Sr)}}),xr},mr.prototype.getEdgesBetween=function(yr){var xr=[],Cr=this;return Cr.edges.forEach(function(Sr){if(!(Sr.source==Cr||Sr.target==Cr))throw"Incorrect edge source and/or target";(Sr.target==yr||Sr.source==yr)&&xr.push(Sr)}),xr},mr.prototype.getNeighborsList=function(){var yr=new Set,xr=this;return xr.edges.forEach(function(Cr){if(Cr.source==xr)yr.add(Cr.target);else{if(Cr.target!=xr)throw"Incorrect incidency!";yr.add(Cr.source)}}),yr},mr.prototype.withChildren=function(){var yr=new Set,xr,Cr;if(yr.add(this),this.child!=null)for(var Sr=this.child.getNodes(),wr=0;wr<Sr.length;wr++)xr=Sr[wr],Cr=xr.withChildren(),Cr.forEach(function(Er){yr.add(Er)});return yr},mr.prototype.getNoOfChildren=function(){var yr=0,xr;if(this.child==null)yr=1;else for(var Cr=this.child.getNodes(),Sr=0;Sr<Cr.length;Sr++)xr=Cr[Sr],yr+=xr.getNoOfChildren();return yr==0&&(yr=1),yr},mr.prototype.getEstimatedSize=function(){if(this.estimatedSize==dr.MIN_VALUE)throw"assert failed";return this.estimatedSize},mr.prototype.calcEstimatedSize=function(){return this.child==null?this.estimatedSize=(this.rect.width+this.rect.height)/2:(this.estimatedSize=this.child.calcEstimatedSize(),this.rect.width=this.estimatedSize,this.rect.height=this.estimatedSize,this.estimatedSize)},mr.prototype.scatter=function(){var yr,xr,Cr=-pr.INITIAL_WORLD_BOUNDARY,Sr=pr.INITIAL_WORLD_BOUNDARY;yr=pr.WORLD_CENTER_X+vr.nextDouble()*(Sr-Cr)+Cr;var wr=-pr.INITIAL_WORLD_BOUNDARY,Er=pr.INITIAL_WORLD_BOUNDARY;xr=pr.WORLD_CENTER_Y+vr.nextDouble()*(Er-wr)+wr,this.rect.x=yr,this.rect.y=xr},mr.prototype.updateBounds=function(){if(this.getChild()==null)throw"assert failed";if(this.getChild().getNodes().length!=0){var yr=this.getChild();if(yr.updateBounds(!0),this.rect.x=yr.getLeft(),this.rect.y=yr.getTop(),this.setWidth(yr.getRight()-yr.getLeft()),this.setHeight(yr.getBottom()-yr.getTop()),pr.NODE_DIMENSIONS_INCLUDE_LABELS){var xr=yr.getRight()-yr.getLeft(),Cr=yr.getBottom()-yr.getTop();this.labelWidth&&(this.labelPosHorizontal=="left"?(this.rect.x-=this.labelWidth,this.setWidth(xr+this.labelWidth)):this.labelPosHorizontal=="center"&&this.labelWidth>xr?(this.rect.x-=(this.labelWidth-xr)/2,this.setWidth(this.labelWidth)):this.labelPosHorizontal=="right"&&this.setWidth(xr+this.labelWidth)),this.labelHeight&&(this.labelPosVertical=="top"?(this.rect.y-=this.labelHeight,this.setHeight(Cr+this.labelHeight)):this.labelPosVertical=="center"&&this.labelHeight>Cr?(this.rect.y-=(this.labelHeight-Cr)/2,this.setHeight(this.labelHeight)):this.labelPosVertical=="bottom"&&this.setHeight(Cr+this.labelHeight))}}},mr.prototype.getInclusionTreeDepth=function(){if(this.inclusionTreeDepth==dr.MAX_VALUE)throw"assert failed";return this.inclusionTreeDepth},mr.prototype.transform=function(yr){var xr=this.rect.x;xr>pr.WORLD_BOUNDARY?xr=pr.WORLD_BOUNDARY:xr<-pr.WORLD_BOUNDARY&&(xr=-pr.WORLD_BOUNDARY);var Cr=this.rect.y;Cr>pr.WORLD_BOUNDARY?Cr=pr.WORLD_BOUNDARY:Cr<-pr.WORLD_BOUNDARY&&(Cr=-pr.WORLD_BOUNDARY);var Sr=new gr(xr,Cr),wr=yr.inverseTransformPoint(Sr);this.setLocation(wr.x,wr.y)},mr.prototype.getLeft=function(){return this.rect.x},mr.prototype.getRight=function(){return this.rect.x+this.rect.width},mr.prototype.getTop=function(){return this.rect.y},mr.prototype.getBottom=function(){return this.rect.y+this.rect.height},mr.prototype.getParent=function(){return this.owner==null?null:this.owner.getParent()},lr.exports=mr},function(lr,ur,cr){var hr=cr(0);function dr(){}for(var fr in hr)dr[fr]=hr[fr];dr.MAX_ITERATIONS=2500,dr.DEFAULT_EDGE_LENGTH=50,dr.DEFAULT_SPRING_STRENGTH=.45,dr.DEFAULT_REPULSION_STRENGTH=4500,dr.DEFAULT_GRAVITY_STRENGTH=.4,dr.DEFAULT_COMPOUND_GRAVITY_STRENGTH=1,dr.DEFAULT_GRAVITY_RANGE_FACTOR=3.8,dr.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=1.5,dr.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION=!0,dr.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION=!0,dr.DEFAULT_COOLING_FACTOR_INCREMENTAL=.3,dr.COOLING_ADAPTATION_FACTOR=.33,dr.ADAPTATION_LOWER_NODE_LIMIT=1e3,dr.ADAPTATION_UPPER_NODE_LIMIT=5e3,dr.MAX_NODE_DISPLACEMENT_INCREMENTAL=100,dr.MAX_NODE_DISPLACEMENT=dr.MAX_NODE_DISPLACEMENT_INCREMENTAL*3,dr.MIN_REPULSION_DIST=dr.DEFAULT_EDGE_LENGTH/10,dr.CONVERGENCE_CHECK_PERIOD=100,dr.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=.1,dr.MIN_EDGE_LENGTH=1,dr.GRID_CALCULATION_CHECK_PERIOD=10,lr.exports=dr},function(lr,ur,cr){function hr(dr,fr){dr==null&&fr==null?(this.x=0,this.y=0):(this.x=dr,this.y=fr)}hr.prototype.getX=function(){return this.x},hr.prototype.getY=function(){return this.y},hr.prototype.setX=function(dr){this.x=dr},hr.prototype.setY=function(dr){this.y=dr},hr.prototype.getDifference=function(dr){return new DimensionD(this.x-dr.x,this.y-dr.y)},hr.prototype.getCopy=function(){return new hr(this.x,this.y)},hr.prototype.translate=function(dr){return this.x+=dr.width,this.y+=dr.height,this},lr.exports=hr},function(lr,ur,cr){var hr=cr(2),dr=cr(10),fr=cr(0),pr=cr(7),vr=cr(3),gr=cr(1),mr=cr(13),br=cr(12),yr=cr(11);function xr(Sr,wr,Er){hr.call(this,Er),this.estimatedSize=dr.MIN_VALUE,this.margin=fr.DEFAULT_GRAPH_MARGIN,this.edges=[],this.nodes=[],this.isConnected=!1,this.parent=Sr,wr!=null&&wr instanceof pr?this.graphManager=wr:wr!=null&&wr instanceof Layout&&(this.graphManager=wr.graphManager)}xr.prototype=Object.create(hr.prototype);for(var Cr in hr)xr[Cr]=hr[Cr];xr.prototype.getNodes=function(){return this.nodes},xr.prototype.getEdges=function(){return this.edges},xr.prototype.getGraphManager=function(){return this.graphManager},xr.prototype.getParent=function(){return this.parent},xr.prototype.getLeft=function(){return this.left},xr.prototype.getRight=function(){return this.right},xr.prototype.getTop=function(){return this.top},xr.prototype.getBottom=function(){return this.bottom},xr.prototype.isConnected=function(){return this.isConnected},xr.prototype.add=function(Sr,wr,Er){if(wr==null&&Er==null){var Ar=Sr;if(this.graphManager==null)throw"Graph has no graph mgr!";if(this.getNodes().indexOf(Ar)>-1)throw"Node already in graph!";return Ar.owner=this,this.getNodes().push(Ar),Ar}else{var Tr=Sr;if(!(this.getNodes().indexOf(wr)>-1&&this.getNodes().indexOf(Er)>-1))throw"Source or target not in graph!";if(!(wr.owner==Er.owner&&wr.owner==this))throw"Both owners must be this graph!";return wr.owner!=Er.owner?null:(Tr.source=wr,Tr.target=Er,Tr.isInterGraph=!1,this.getEdges().push(Tr),wr.edges.push(Tr),Er!=wr&&Er.edges.push(Tr),Tr)}},xr.prototype.remove=function(Sr){var wr=Sr;if(Sr instanceof vr){if(wr==null)throw"Node is null!";if(!(wr.owner!=null&&wr.owner==this))throw"Owner graph is invalid!";if(this.graphManager==null)throw"Owner graph manager is invalid!";for(var Er=wr.edges.slice(),Ar,Tr=Er.length,Rr=0;Rr<Tr;Rr++)Ar=Er[Rr],Ar.isInterGraph?this.graphManager.remove(Ar):Ar.source.owner.remove(Ar);var Pr=this.nodes.indexOf(wr);if(Pr==-1)throw"Node not in owner node list!";this.nodes.splice(Pr,1)}else if(Sr instanceof gr){var Ar=Sr;if(Ar==null)throw"Edge is null!";if(!(Ar.source!=null&&Ar.target!=null))throw"Source and/or target is null!";if(!(Ar.source.owner!=null&&Ar.target.owner!=null&&Ar.source.owner==this&&Ar.target.owner==this))throw"Source and/or target owner is invalid!";var _r=Ar.source.edges.indexOf(Ar),kr=Ar.target.edges.indexOf(Ar);if(!(_r>-1&&kr>-1))throw"Source and/or target doesn't know this edge!";Ar.source.edges.splice(_r,1),Ar.target!=Ar.source&&Ar.target.edges.splice(kr,1);var Pr=Ar.source.owner.getEdges().indexOf(Ar);if(Pr==-1)throw"Not in owner's edge list!";Ar.source.owner.getEdges().splice(Pr,1)}},xr.prototype.updateLeftTop=function(){for(var Sr=dr.MAX_VALUE,wr=dr.MAX_VALUE,Er,Ar,Tr,Rr=this.getNodes(),Pr=Rr.length,_r=0;_r<Pr;_r++){var kr=Rr[_r];Er=kr.getTop(),Ar=kr.getLeft(),Sr>Er&&(Sr=Er),wr>Ar&&(wr=Ar)}return Sr==dr.MAX_VALUE?null:(Rr[0].getParent().paddingLeft!=null?Tr=Rr[0].getParent().paddingLeft:Tr=this.margin,this.left=wr-Tr,this.top=Sr-Tr,new br(this.left,this.top))},xr.prototype.updateBounds=function(Sr){for(var wr=dr.MAX_VALUE,Er=-dr.MAX_VALUE,Ar=dr.MAX_VALUE,Tr=-dr.MAX_VALUE,Rr,Pr,_r,kr,Dr,Nr=this.nodes,Lr=Nr.length,Or=0;Or<Lr;Or++){var Ir=Nr[Or];Sr&&Ir.child!=null&&Ir.updateBounds(),Rr=Ir.getLeft(),Pr=Ir.getRight(),_r=Ir.getTop(),kr=Ir.getBottom(),wr>Rr&&(wr=Rr),Er<Pr&&(Er=Pr),Ar>_r&&(Ar=_r),Tr<kr&&(Tr=kr)}var Mr=new mr(wr,Ar,Er-wr,Tr-Ar);wr==dr.MAX_VALUE&&(this.left=this.parent.getLeft(),this.right=this.parent.getRight(),this.top=this.parent.getTop(),this.bottom=this.parent.getBottom()),Nr[0].getParent().paddingLeft!=null?Dr=Nr[0].getParent().paddingLeft:Dr=this.margin,this.left=Mr.x-Dr,this.right=Mr.x+Mr.width+Dr,this.top=Mr.y-Dr,this.bottom=Mr.y+Mr.height+Dr},xr.calculateBounds=function(Sr){for(var wr=dr.MAX_VALUE,Er=-dr.MAX_VALUE,Ar=dr.MAX_VALUE,Tr=-dr.MAX_VALUE,Rr,Pr,_r,kr,Dr=Sr.length,Nr=0;Nr<Dr;Nr++){var Lr=Sr[Nr];Rr=Lr.getLeft(),Pr=Lr.getRight(),_r=Lr.getTop(),kr=Lr.getBottom(),wr>Rr&&(wr=Rr),Er<Pr&&(Er=Pr),Ar>_r&&(Ar=_r),Tr<kr&&(Tr=kr)}var Or=new mr(wr,Ar,Er-wr,Tr-Ar);return Or},xr.prototype.getInclusionTreeDepth=function(){return this==this.graphManager.getRoot()?1:this.parent.getInclusionTreeDepth()},xr.prototype.getEstimatedSize=function(){if(this.estimatedSize==dr.MIN_VALUE)throw"assert failed";return this.estimatedSize},xr.prototype.calcEstimatedSize=function(){for(var Sr=0,wr=this.nodes,Er=wr.length,Ar=0;Ar<Er;Ar++){var Tr=wr[Ar];Sr+=Tr.calcEstimatedSize()}return Sr==0?this.estimatedSize=fr.EMPTY_COMPOUND_NODE_SIZE:this.estimatedSize=Sr/Math.sqrt(this.nodes.length),this.estimatedSize},xr.prototype.updateConnected=function(){var Sr=this;if(this.nodes.length==0){this.isConnected=!0;return}var wr=new yr,Er=new Set,Ar=this.nodes[0],Tr,Rr,Pr=Ar.withChildren();for(Pr.forEach(function(Or){wr.push(Or),Er.add(Or)});wr.length!==0;){Ar=wr.shift(),Tr=Ar.getEdges();for(var _r=Tr.length,kr=0;kr<_r;kr++){var Dr=Tr[kr];if(Rr=Dr.getOtherEndInGraph(Ar,this),Rr!=null&&!Er.has(Rr)){var Nr=Rr.withChildren();Nr.forEach(function(Or){wr.push(Or),Er.add(Or)})}}}if(this.isConnected=!1,Er.size>=this.nodes.length){var Lr=0;Er.forEach(function(Or){Or.owner==Sr&&Lr++}),Lr==this.nodes.length&&(this.isConnected=!0)}},lr.exports=xr},function(lr,ur,cr){var hr,dr=cr(1);function fr(pr){hr=cr(6),this.layout=pr,this.graphs=[],this.edges=[]}fr.prototype.addRoot=function(){var pr=this.layout.newGraph(),vr=this.layout.newNode(null),gr=this.add(pr,vr);return this.setRootGraph(gr),this.rootGraph},fr.prototype.add=function(pr,vr,gr,mr,br){if(gr==null&&mr==null&&br==null){if(pr==null)throw"Graph is null!";if(vr==null)throw"Parent node is null!";if(this.graphs.indexOf(pr)>-1)throw"Graph already in this graph mgr!";if(this.graphs.push(pr),pr.parent!=null)throw"Already has a parent!";if(vr.child!=null)throw"Already has a child!";return pr.parent=vr,vr.child=pr,pr}else{br=gr,mr=vr,gr=pr;var yr=mr.getOwner(),xr=br.getOwner();if(!(yr!=null&&yr.getGraphManager()==this))throw"Source not in this graph mgr!";if(!(xr!=null&&xr.getGraphManager()==this))throw"Target not in this graph mgr!";if(yr==xr)return gr.isInterGraph=!1,yr.add(gr,mr,br);if(gr.isInterGraph=!0,gr.source=mr,gr.target=br,this.edges.indexOf(gr)>-1)throw"Edge already in inter-graph edge list!";if(this.edges.push(gr),!(gr.source!=null&&gr.target!=null))throw"Edge source and/or target is null!";if(!(gr.source.edges.indexOf(gr)==-1&&gr.target.edges.indexOf(gr)==-1))throw"Edge already in source and/or target incidency list!";return gr.source.edges.push(gr),gr.target.edges.push(gr),gr}},fr.prototype.remove=function(pr){if(pr instanceof hr){var vr=pr;if(vr.getGraphManager()!=this)throw"Graph not in this graph mgr";if(!(vr==this.rootGraph||vr.parent!=null&&vr.parent.graphManager==this))throw"Invalid parent node!";var gr=[];gr=gr.concat(vr.getEdges());for(var mr,br=gr.length,yr=0;yr<br;yr++)mr=gr[yr],vr.remove(mr);var xr=[];xr=xr.concat(vr.getNodes());var Cr;br=xr.length;for(var yr=0;yr<br;yr++)Cr=xr[yr],vr.remove(Cr);vr==this.rootGraph&&this.setRootGraph(null);var Sr=this.graphs.indexOf(vr);this.graphs.splice(Sr,1),vr.parent=null}else if(pr instanceof dr){if(mr=pr,mr==null)throw"Edge is null!";if(!mr.isInterGraph)throw"Not an inter-graph edge!";if(!(mr.source!=null&&mr.target!=null))throw"Source and/or target is null!";if(!(mr.source.edges.indexOf(mr)!=-1&&mr.target.edges.indexOf(mr)!=-1))throw"Source and/or target doesn't know this edge!";var Sr=mr.source.edges.indexOf(mr);if(mr.source.edges.splice(Sr,1),Sr=mr.target.edges.indexOf(mr),mr.target.edges.splice(Sr,1),!(mr.source.owner!=null&&mr.source.owner.getGraphManager()!=null))throw"Edge owner graph or owner graph manager is null!";if(mr.source.owner.getGraphManager().edges.indexOf(mr)==-1)throw"Not in owner graph manager's edge list!";var Sr=mr.source.owner.getGraphManager().edges.indexOf(mr);mr.source.owner.getGraphManager().edges.splice(Sr,1)}},fr.prototype.updateBounds=function(){this.rootGraph.updateBounds(!0)},fr.prototype.getGraphs=function(){return this.graphs},fr.prototype.getAllNodes=function(){if(this.allNodes==null){for(var pr=[],vr=this.getGraphs(),gr=vr.length,mr=0;mr<gr;mr++)pr=pr.concat(vr[mr].getNodes());this.allNodes=pr}return this.allNodes},fr.prototype.resetAllNodes=function(){this.allNodes=null},fr.prototype.resetAllEdges=function(){this.allEdges=null},fr.prototype.resetAllNodesToApplyGravitation=function(){this.allNodesToApplyGravitation=null},fr.prototype.getAllEdges=function(){if(this.allEdges==null){var pr=[],vr=this.getGraphs();vr.length;for(var gr=0;gr<vr.length;gr++)pr=pr.concat(vr[gr].getEdges());pr=pr.concat(this.edges),this.allEdges=pr}return this.allEdges},fr.prototype.getAllNodesToApplyGravitation=function(){return this.allNodesToApplyGravitation},fr.prototype.setAllNodesToApplyGravitation=function(pr){if(this.allNodesToApplyGravitation!=null)throw"assert failed";this.allNodesToApplyGravitation=pr},fr.prototype.getRoot=function(){return this.rootGraph},fr.prototype.setRootGraph=function(pr){if(pr.getGraphManager()!=this)throw"Root not in this graph mgr!";this.rootGraph=pr,pr.parent==null&&(pr.parent=this.layout.newNode("Root node"))},fr.prototype.getLayout=function(){return this.layout},fr.prototype.isOneAncestorOfOther=function(pr,vr){if(!(pr!=null&&vr!=null))throw"assert failed";if(pr==vr)return!0;var gr=pr.getOwner(),mr;do{if(mr=gr.getParent(),mr==null)break;if(mr==vr)return!0;if(gr=mr.getOwner(),gr==null)break}while(!0);gr=vr.getOwner();do{if(mr=gr.getParent(),mr==null)break;if(mr==pr)return!0;if(gr=mr.getOwner(),gr==null)break}while(!0);return!1},fr.prototype.calcLowestCommonAncestors=function(){for(var pr,vr,gr,mr,br,yr=this.getAllEdges(),xr=yr.length,Cr=0;Cr<xr;Cr++){if(pr=yr[Cr],vr=pr.source,gr=pr.target,pr.lca=null,pr.sourceInLca=vr,pr.targetInLca=gr,vr==gr){pr.lca=vr.getOwner();continue}for(mr=vr.getOwner();pr.lca==null;){for(pr.targetInLca=gr,br=gr.getOwner();pr.lca==null;){if(br==mr){pr.lca=br;break}if(br==this.rootGraph)break;if(pr.lca!=null)throw"assert failed";pr.targetInLca=br.getParent(),br=pr.targetInLca.getOwner()}if(mr==this.rootGraph)break;pr.lca==null&&(pr.sourceInLca=mr.getParent(),mr=pr.sourceInLca.getOwner())}if(pr.lca==null)throw"assert failed"}},fr.prototype.calcLowestCommonAncestor=function(pr,vr){if(pr==vr)return pr.getOwner();var gr=pr.getOwner();do{if(gr==null)break;var mr=vr.getOwner();do{if(mr==null)break;if(mr==gr)return mr;mr=mr.getParent().getOwner()}while(!0);gr=gr.getParent().getOwner()}while(!0);return gr},fr.prototype.calcInclusionTreeDepths=function(pr,vr){pr==null&&vr==null&&(pr=this.rootGraph,vr=1);for(var gr,mr=pr.getNodes(),br=mr.length,yr=0;yr<br;yr++)gr=mr[yr],gr.inclusionTreeDepth=vr,gr.child!=null&&this.calcInclusionTreeDepths(gr.child,vr+1)},fr.prototype.includesInvalidEdge=function(){for(var pr,vr=[],gr=this.edges.length,mr=0;mr<gr;mr++)pr=this.edges[mr],this.isOneAncestorOfOther(pr.source,pr.target)&&vr.push(pr);for(var mr=0;mr<vr.length;mr++)this.remove(vr[mr]);return!1},lr.exports=fr},function(lr,ur,cr){var hr=cr(12);function dr(){}dr.calcSeparationAmount=function(fr,pr,vr,gr){if(!fr.intersects(pr))throw"assert failed";var mr=new Array(2);this.decideDirectionsForOverlappingNodes(fr,pr,mr),vr[0]=Math.min(fr.getRight(),pr.getRight())-Math.max(fr.x,pr.x),vr[1]=Math.min(fr.getBottom(),pr.getBottom())-Math.max(fr.y,pr.y),fr.getX()<=pr.getX()&&fr.getRight()>=pr.getRight()?vr[0]+=Math.min(pr.getX()-fr.getX(),fr.getRight()-pr.getRight()):pr.getX()<=fr.getX()&&pr.getRight()>=fr.getRight()&&(vr[0]+=Math.min(fr.getX()-pr.getX(),pr.getRight()-fr.getRight())),fr.getY()<=pr.getY()&&fr.getBottom()>=pr.getBottom()?vr[1]+=Math.min(pr.getY()-fr.getY(),fr.getBottom()-pr.getBottom()):pr.getY()<=fr.getY()&&pr.getBottom()>=fr.getBottom()&&(vr[1]+=Math.min(fr.getY()-pr.getY(),pr.getBottom()-fr.getBottom()));var br=Math.abs((pr.getCenterY()-fr.getCenterY())/(pr.getCenterX()-fr.getCenterX()));pr.getCenterY()===fr.getCenterY()&&pr.getCenterX()===fr.getCenterX()&&(br=1);var yr=br*vr[0],xr=vr[1]/br;vr[0]<xr?xr=vr[0]:yr=vr[1],vr[0]=-1*mr[0]*(xr/2+gr),vr[1]=-1*mr[1]*(yr/2+gr)},dr.decideDirectionsForOverlappingNodes=function(fr,pr,vr){fr.getCenterX()<pr.getCenterX()?vr[0]=-1:vr[0]=1,fr.getCenterY()<pr.getCenterY()?vr[1]=-1:vr[1]=1},dr.getIntersection2=function(fr,pr,vr){var gr=fr.getCenterX(),mr=fr.getCenterY(),br=pr.getCenterX(),yr=pr.getCenterY();if(fr.intersects(pr))return vr[0]=gr,vr[1]=mr,vr[2]=br,vr[3]=yr,!0;var xr=fr.getX(),Cr=fr.getY(),Sr=fr.getRight(),wr=fr.getX(),Er=fr.getBottom(),Ar=fr.getRight(),Tr=fr.getWidthHalf(),Rr=fr.getHeightHalf(),Pr=pr.getX(),_r=pr.getY(),kr=pr.getRight(),Dr=pr.getX(),Nr=pr.getBottom(),Lr=pr.getRight(),Or=pr.getWidthHalf(),Ir=pr.getHeightHalf(),Mr=!1,$r=!1;if(gr===br){if(mr>yr)return vr[0]=gr,vr[1]=Cr,vr[2]=br,vr[3]=Nr,!1;if(mr<yr)return vr[0]=gr,vr[1]=Er,vr[2]=br,vr[3]=_r,!1}else if(mr===yr){if(gr>br)return vr[0]=xr,vr[1]=mr,vr[2]=kr,vr[3]=yr,!1;if(gr<br)return vr[0]=Sr,vr[1]=mr,vr[2]=Pr,vr[3]=yr,!1}else{var jr=fr.height/fr.width,Fr=pr.height/pr.width,zr=(yr-mr)/(br-gr),Hr=void 0,Wr=void 0,Yr=void 0,qr=void 0,Br=void 0,Ur=void 0;if(-jr===zr?gr>br?(vr[0]=wr,vr[1]=Er,Mr=!0):(vr[0]=Sr,vr[1]=Cr,Mr=!0):jr===zr&&(gr>br?(vr[0]=xr,vr[1]=Cr,Mr=!0):(vr[0]=Ar,vr[1]=Er,Mr=!0)),-Fr===zr?br>gr?(vr[2]=Dr,vr[3]=Nr,$r=!0):(vr[2]=kr,vr[3]=_r,$r=!0):Fr===zr&&(br>gr?(vr[2]=Pr,vr[3]=_r,$r=!0):(vr[2]=Lr,vr[3]=Nr,$r=!0)),Mr&&$r)return!1;if(gr>br?mr>yr?(Hr=this.getCardinalDirection(jr,zr,4),Wr=this.getCardinalDirection(Fr,zr,2)):(Hr=this.getCardinalDirection(-jr,zr,3),Wr=this.getCardinalDirection(-Fr,zr,1)):mr>yr?(Hr=this.getCardinalDirection(-jr,zr,1),Wr=this.getCardinalDirection(-Fr,zr,3)):(Hr=this.getCardinalDirection(jr,zr,2),Wr=this.getCardinalDirection(Fr,zr,4)),!Mr)switch(Hr){case 1:qr=Cr,Yr=gr+-Rr/zr,vr[0]=Yr,vr[1]=qr;break;case 2:Yr=Ar,qr=mr+Tr*zr,vr[0]=Yr,vr[1]=qr;break;case 3:qr=Er,Yr=gr+Rr/zr,vr[0]=Yr,vr[1]=qr;break;case 4:Yr=wr,qr=mr+-Tr*zr,vr[0]=Yr,vr[1]=qr;break}if(!$r)switch(Wr){case 1:Ur=_r,Br=br+-Ir/zr,vr[2]=Br,vr[3]=Ur;break;case 2:Br=Lr,Ur=yr+Or*zr,vr[2]=Br,vr[3]=Ur;break;case 3:Ur=Nr,Br=br+Ir/zr,vr[2]=Br,vr[3]=Ur;break;case 4:Br=Dr,Ur=yr+-Or*zr,vr[2]=Br,vr[3]=Ur;break}}return!1},dr.getCardinalDirection=function(fr,pr,vr){return fr>pr?vr:1+vr%4},dr.getIntersection=function(fr,pr,vr,gr){if(gr==null)return this.getIntersection2(fr,pr,vr);var mr=fr.x,br=fr.y,yr=pr.x,xr=pr.y,Cr=vr.x,Sr=vr.y,wr=gr.x,Er=gr.y,Ar=void 0,Tr=void 0,Rr=void 0,Pr=void 0,_r=void 0,kr=void 0,Dr=void 0,Nr=void 0,Lr=void 0;return Rr=xr-br,_r=mr-yr,Dr=yr*br-mr*xr,Pr=Er-Sr,kr=Cr-wr,Nr=wr*Sr-Cr*Er,Lr=Rr*kr-Pr*_r,Lr===0?null:(Ar=(_r*Nr-kr*Dr)/Lr,Tr=(Pr*Dr-Rr*Nr)/Lr,new hr(Ar,Tr))},dr.angleOfVector=function(fr,pr,vr,gr){var mr=void 0;return fr!==vr?(mr=Math.atan((gr-pr)/(vr-fr)),vr<fr?mr+=Math.PI:gr<pr&&(mr+=this.TWO_PI)):gr<pr?mr=this.ONE_AND_HALF_PI:mr=this.HALF_PI,mr},dr.doIntersect=function(fr,pr,vr,gr){var mr=fr.x,br=fr.y,yr=pr.x,xr=pr.y,Cr=vr.x,Sr=vr.y,wr=gr.x,Er=gr.y,Ar=(yr-mr)*(Er-Sr)-(wr-Cr)*(xr-br);if(Ar===0)return!1;var Tr=((Er-Sr)*(wr-mr)+(Cr-wr)*(Er-br))/Ar,Rr=((br-xr)*(wr-mr)+(yr-mr)*(Er-br))/Ar;return 0<Tr&&Tr<1&&0<Rr&&Rr<1},dr.findCircleLineIntersections=function(fr,pr,vr,gr,mr,br,yr){var xr=(vr-fr)*(vr-fr)+(gr-pr)*(gr-pr),Cr=2*((fr-mr)*(vr-fr)+(pr-br)*(gr-pr)),Sr=(fr-mr)*(fr-mr)+(pr-br)*(pr-br)-yr*yr,wr=Cr*Cr-4*xr*Sr;if(wr>=0){var Er=(-Cr+Math.sqrt(Cr*Cr-4*xr*Sr))/(2*xr),Ar=(-Cr-Math.sqrt(Cr*Cr-4*xr*Sr))/(2*xr),Tr=null;return Er>=0&&Er<=1?[Er]:Ar>=0&&Ar<=1?[Ar]:Tr}else return null},dr.HALF_PI=.5*Math.PI,dr.ONE_AND_HALF_PI=1.5*Math.PI,dr.TWO_PI=2*Math.PI,dr.THREE_PI=3*Math.PI,lr.exports=dr},function(lr,ur,cr){function hr(){}hr.sign=function(dr){return dr>0?1:dr<0?-1:0},hr.floor=function(dr){return dr<0?Math.ceil(dr):Math.floor(dr)},hr.ceil=function(dr){return dr<0?Math.floor(dr):Math.ceil(dr)},lr.exports=hr},function(lr,ur,cr){function hr(){}hr.MAX_VALUE=2147483647,hr.MIN_VALUE=-2147483648,lr.exports=hr},function(lr,ur,cr){var hr=function(){function mr(br,yr){for(var xr=0;xr<yr.length;xr++){var Cr=yr[xr];Cr.enumerable=Cr.enumerable||!1,Cr.configurable=!0,"value"in Cr&&(Cr.writable=!0),Object.defineProperty(br,Cr.key,Cr)}}return function(br,yr,xr){return yr&&mr(br.prototype,yr),xr&&mr(br,xr),br}}();function dr(mr,br){if(!(mr instanceof br))throw new TypeError("Cannot call a class as a function")}var fr=function(br){return{value:br,next:null,prev:null}},pr=function(br,yr,xr,Cr){return br!==null?br.next=yr:Cr.head=yr,xr!==null?xr.prev=yr:Cr.tail=yr,yr.prev=br,yr.next=xr,Cr.length++,yr},vr=function(br,yr){var xr=br.prev,Cr=br.next;return xr!==null?xr.next=Cr:yr.head=Cr,Cr!==null?Cr.prev=xr:yr.tail=xr,br.prev=br.next=null,yr.length--,br},gr=function(){function mr(br){var yr=this;dr(this,mr),this.length=0,this.head=null,this.tail=null,br!=null&&br.forEach(function(xr){return yr.push(xr)})}return hr(mr,[{key:"size",value:function(){return this.length}},{key:"insertBefore",value:function(yr,xr){return pr(xr.prev,fr(yr),xr,this)}},{key:"insertAfter",value:function(yr,xr){return pr(xr,fr(yr),xr.next,this)}},{key:"insertNodeBefore",value:function(yr,xr){return pr(xr.prev,yr,xr,this)}},{key:"insertNodeAfter",value:function(yr,xr){return pr(xr,yr,xr.next,this)}},{key:"push",value:function(yr){return pr(this.tail,fr(yr),null,this)}},{key:"unshift",value:function(yr){return pr(null,fr(yr),this.head,this)}},{key:"remove",value:function(yr){return vr(yr,this)}},{key:"pop",value:function(){return vr(this.tail,this).value}},{key:"popNode",value:function(){return vr(this.tail,this)}},{key:"shift",value:function(){return vr(this.head,this).value}},{key:"shiftNode",value:function(){return vr(this.head,this)}},{key:"get_object_at",value:function(yr){if(yr<=this.length()){for(var xr=1,Cr=this.head;xr<yr;)Cr=Cr.next,xr++;return Cr.value}}},{key:"set_object_at",value:function(yr,xr){if(yr<=this.length()){for(var Cr=1,Sr=this.head;Cr<yr;)Sr=Sr.next,Cr++;Sr.value=xr}}}]),mr}();lr.exports=gr},function(lr,ur,cr){function hr(dr,fr,pr){this.x=null,this.y=null,dr==null&&fr==null&&pr==null?(this.x=0,this.y=0):typeof dr=="number"&&typeof fr=="number"&&pr==null?(this.x=dr,this.y=fr):dr.constructor.name=="Point"&&fr==null&&pr==null&&(pr=dr,this.x=pr.x,this.y=pr.y)}hr.prototype.getX=function(){return this.x},hr.prototype.getY=function(){return this.y},hr.prototype.getLocation=function(){return new hr(this.x,this.y)},hr.prototype.setLocation=function(dr,fr,pr){dr.constructor.name=="Point"&&fr==null&&pr==null?(pr=dr,this.setLocation(pr.x,pr.y)):typeof dr=="number"&&typeof fr=="number"&&pr==null&&(parseInt(dr)==dr&&parseInt(fr)==fr?this.move(dr,fr):(this.x=Math.floor(dr+.5),this.y=Math.floor(fr+.5)))},hr.prototype.move=function(dr,fr){this.x=dr,this.y=fr},hr.prototype.translate=function(dr,fr){this.x+=dr,this.y+=fr},hr.prototype.equals=function(dr){if(dr.constructor.name=="Point"){var fr=dr;return this.x==fr.x&&this.y==fr.y}return this==dr},hr.prototype.toString=function(){return new hr().constructor.name+"[x="+this.x+",y="+this.y+"]"},lr.exports=hr},function(lr,ur,cr){function hr(dr,fr,pr,vr){this.x=0,this.y=0,this.width=0,this.height=0,dr!=null&&fr!=null&&pr!=null&&vr!=null&&(this.x=dr,this.y=fr,this.width=pr,this.height=vr)}hr.prototype.getX=function(){return this.x},hr.prototype.setX=function(dr){this.x=dr},hr.prototype.getY=function(){return this.y},hr.prototype.setY=function(dr){this.y=dr},hr.prototype.getWidth=function(){return this.width},hr.prototype.setWidth=function(dr){this.width=dr},hr.prototype.getHeight=function(){return this.height},hr.prototype.setHeight=function(dr){this.height=dr},hr.prototype.getRight=function(){return this.x+this.width},hr.prototype.getBottom=function(){return this.y+this.height},hr.prototype.intersects=function(dr){return!(this.getRight()<dr.x||this.getBottom()<dr.y||dr.getRight()<this.x||dr.getBottom()<this.y)},hr.prototype.getCenterX=function(){return this.x+this.width/2},hr.prototype.getMinX=function(){return this.getX()},hr.prototype.getMaxX=function(){return this.getX()+this.width},hr.prototype.getCenterY=function(){return this.y+this.height/2},hr.prototype.getMinY=function(){return this.getY()},hr.prototype.getMaxY=function(){return this.getY()+this.height},hr.prototype.getWidthHalf=function(){return this.width/2},hr.prototype.getHeightHalf=function(){return this.height/2},lr.exports=hr},function(lr,ur,cr){var hr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(fr){return typeof fr}:function(fr){return fr&&typeof Symbol=="function"&&fr.constructor===Symbol&&fr!==Symbol.prototype?"symbol":typeof fr};function dr(){}dr.lastID=0,dr.createID=function(fr){return dr.isPrimitive(fr)?fr:(fr.uniqueID!=null||(fr.uniqueID=dr.getString(),dr.lastID++),fr.uniqueID)},dr.getString=function(fr){return fr==null&&(fr=dr.lastID),"Object#"+fr},dr.isPrimitive=function(fr){var pr=typeof fr>"u"?"undefined":hr(fr);return fr==null||pr!="object"&&pr!="function"},lr.exports=dr},function(lr,ur,cr){function hr(Cr){if(Array.isArray(Cr)){for(var Sr=0,wr=Array(Cr.length);Sr<Cr.length;Sr++)wr[Sr]=Cr[Sr];return wr}else return Array.from(Cr)}var dr=cr(0),fr=cr(7),pr=cr(3),vr=cr(1),gr=cr(6),mr=cr(5),br=cr(17),yr=cr(29);function xr(Cr){yr.call(this),this.layoutQuality=dr.QUALITY,this.createBendsAsNeeded=dr.DEFAULT_CREATE_BENDS_AS_NEEDED,this.incremental=dr.DEFAULT_INCREMENTAL,this.animationOnLayout=dr.DEFAULT_ANIMATION_ON_LAYOUT,this.animationDuringLayout=dr.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=dr.DEFAULT_ANIMATION_PERIOD,this.uniformLeafNodeSizes=dr.DEFAULT_UNIFORM_LEAF_NODE_SIZES,this.edgeToDummyNodes=new Map,this.graphManager=new fr(this),this.isLayoutFinished=!1,this.isSubLayout=!1,this.isRemoteUse=!1,Cr!=null&&(this.isRemoteUse=Cr)}xr.RANDOM_SEED=1,xr.prototype=Object.create(yr.prototype),xr.prototype.getGraphManager=function(){return this.graphManager},xr.prototype.getAllNodes=function(){return this.graphManager.getAllNodes()},xr.prototype.getAllEdges=function(){return this.graphManager.getAllEdges()},xr.prototype.getAllNodesToApplyGravitation=function(){return this.graphManager.getAllNodesToApplyGravitation()},xr.prototype.newGraphManager=function(){var Cr=new fr(this);return this.graphManager=Cr,Cr},xr.prototype.newGraph=function(Cr){return new gr(null,this.graphManager,Cr)},xr.prototype.newNode=function(Cr){return new pr(this.graphManager,Cr)},xr.prototype.newEdge=function(Cr){return new vr(null,null,Cr)},xr.prototype.checkLayoutSuccess=function(){return this.graphManager.getRoot()==null||this.graphManager.getRoot().getNodes().length==0||this.graphManager.includesInvalidEdge()},xr.prototype.runLayout=function(){this.isLayoutFinished=!1,this.tilingPreLayout&&this.tilingPreLayout(),this.initParameters();var Cr;return this.checkLayoutSuccess()?Cr=!1:Cr=this.layout(),dr.ANIMATE==="during"?!1:(Cr&&(this.isSubLayout||this.doPostLayout()),this.tilingPostLayout&&this.tilingPostLayout(),this.isLayoutFinished=!0,Cr)},xr.prototype.doPostLayout=function(){this.incremental||this.transform(),this.update()},xr.prototype.update2=function(){if(this.createBendsAsNeeded&&(this.createBendpointsFromDummyNodes(),this.graphManager.resetAllEdges()),!this.isRemoteUse){for(var Cr=this.graphManager.getAllEdges(),Sr=0;Sr<Cr.length;Sr++)Cr[Sr];for(var wr=this.graphManager.getRoot().getNodes(),Sr=0;Sr<wr.length;Sr++)wr[Sr];this.update(this.graphManager.getRoot())}},xr.prototype.update=function(Cr){if(Cr==null)this.update2();else if(Cr instanceof pr){var Sr=Cr;if(Sr.getChild()!=null)for(var wr=Sr.getChild().getNodes(),Er=0;Er<wr.length;Er++)update(wr[Er]);if(Sr.vGraphObject!=null){var Ar=Sr.vGraphObject;Ar.update(Sr)}}else if(Cr instanceof vr){var Tr=Cr;if(Tr.vGraphObject!=null){var Rr=Tr.vGraphObject;Rr.update(Tr)}}else if(Cr instanceof gr){var Pr=Cr;if(Pr.vGraphObject!=null){var _r=Pr.vGraphObject;_r.update(Pr)}}},xr.prototype.initParameters=function(){this.isSubLayout||(this.layoutQuality=dr.QUALITY,this.animationDuringLayout=dr.DEFAULT_ANIMATION_DURING_LAYOUT,this.animationPeriod=dr.DEFAULT_ANIMATION_PERIOD,this.animationOnLayout=dr.DEFAULT_ANIMATION_ON_LAYOUT,this.incremental=dr.DEFAULT_INCREMENTAL,this.createBendsAsNeeded=dr.DEFAULT_CREATE_BENDS_AS_NEEDED,this.uniformLeafNodeSizes=dr.DEFAULT_UNIFORM_LEAF_NODE_SIZES),this.animationDuringLayout&&(this.animationOnLayout=!1)},xr.prototype.transform=function(Cr){if(Cr==null)this.transform(new mr(0,0));else{var Sr=new br,wr=this.graphManager.getRoot().updateLeftTop();if(wr!=null){Sr.setWorldOrgX(Cr.x),Sr.setWorldOrgY(Cr.y),Sr.setDeviceOrgX(wr.x),Sr.setDeviceOrgY(wr.y);for(var Er=this.getAllNodes(),Ar,Tr=0;Tr<Er.length;Tr++)Ar=Er[Tr],Ar.transform(Sr)}}},xr.prototype.positionNodesRandomly=function(Cr){if(Cr==null)this.positionNodesRandomly(this.getGraphManager().getRoot()),this.getGraphManager().getRoot().updateBounds(!0);else for(var Sr,wr,Er=Cr.getNodes(),Ar=0;Ar<Er.length;Ar++)Sr=Er[Ar],wr=Sr.getChild(),wr==null||wr.getNodes().length==0?Sr.scatter():(this.positionNodesRandomly(wr),Sr.updateBounds())},xr.prototype.getFlatForest=function(){for(var Cr=[],Sr=!0,wr=this.graphManager.getRoot().getNodes(),Er=!0,Ar=0;Ar<wr.length;Ar++)wr[Ar].getChild()!=null&&(Er=!1);if(!Er)return Cr;var Tr=new Set,Rr=[],Pr=new Map,_r=[];for(_r=_r.concat(wr);_r.length>0&&Sr;){for(Rr.push(_r[0]);Rr.length>0&&Sr;){var kr=Rr[0];Rr.splice(0,1),Tr.add(kr);for(var Dr=kr.getEdges(),Ar=0;Ar<Dr.length;Ar++){var Nr=Dr[Ar].getOtherEnd(kr);if(Pr.get(kr)!=Nr)if(!Tr.has(Nr))Rr.push(Nr),Pr.set(Nr,kr);else{Sr=!1;break}}}if(!Sr)Cr=[];else{var Lr=[].concat(hr(Tr));Cr.push(Lr);for(var Ar=0;Ar<Lr.length;Ar++){var Or=Lr[Ar],Ir=_r.indexOf(Or);Ir>-1&&_r.splice(Ir,1)}Tr=new Set,Pr=new Map}}return Cr},xr.prototype.createDummyNodesForBendpoints=function(Cr){for(var Sr=[],wr=Cr.source,Er=this.graphManager.calcLowestCommonAncestor(Cr.source,Cr.target),Ar=0;Ar<Cr.bendpoints.length;Ar++){var Tr=this.newNode(null);Tr.setRect(new Point(0,0),new Dimension(1,1)),Er.add(Tr);var Rr=this.newEdge(null);this.graphManager.add(Rr,wr,Tr),Sr.add(Tr),wr=Tr}var Rr=this.newEdge(null);return this.graphManager.add(Rr,wr,Cr.target),this.edgeToDummyNodes.set(Cr,Sr),Cr.isInterGraph()?this.graphManager.remove(Cr):Er.remove(Cr),Sr},xr.prototype.createBendpointsFromDummyNodes=function(){var Cr=[];Cr=Cr.concat(this.graphManager.getAllEdges()),Cr=[].concat(hr(this.edgeToDummyNodes.keys())).concat(Cr);for(var Sr=0;Sr<Cr.length;Sr++){var wr=Cr[Sr];if(wr.bendpoints.length>0){for(var Er=this.edgeToDummyNodes.get(wr),Ar=0;Ar<Er.length;Ar++){var Tr=Er[Ar],Rr=new mr(Tr.getCenterX(),Tr.getCenterY()),Pr=wr.bendpoints.get(Ar);Pr.x=Rr.x,Pr.y=Rr.y,Tr.getOwner().remove(Tr)}this.graphManager.add(wr,wr.source,wr.target)}}},xr.transform=function(Cr,Sr,wr,Er){if(wr!=null&&Er!=null){var Ar=Sr;if(Cr<=50){var Tr=Sr/wr;Ar-=(Sr-Tr)/50*(50-Cr)}else{var Rr=Sr*Er;Ar+=(Rr-Sr)/50*(Cr-50)}return Ar}else{var Pr,_r;return Cr<=50?(Pr=9*Sr/500,_r=Sr/10):(Pr=9*Sr/50,_r=-8*Sr),Pr*Cr+_r}},xr.findCenterOfTree=function(Cr){var Sr=[];Sr=Sr.concat(Cr);var wr=[],Er=new Map,Ar=!1,Tr=null;(Sr.length==1||Sr.length==2)&&(Ar=!0,Tr=Sr[0]);for(var Rr=0;Rr<Sr.length;Rr++){var Pr=Sr[Rr],_r=Pr.getNeighborsList().size;Er.set(Pr,Pr.getNeighborsList().size),_r==1&&wr.push(Pr)}var kr=[];for(kr=kr.concat(wr);!Ar;){var Dr=[];Dr=Dr.concat(kr),kr=[];for(var Rr=0;Rr<Sr.length;Rr++){var Pr=Sr[Rr],Nr=Sr.indexOf(Pr);Nr>=0&&Sr.splice(Nr,1);var Lr=Pr.getNeighborsList();Lr.forEach(function(Mr){if(wr.indexOf(Mr)<0){var $r=Er.get(Mr),jr=$r-1;jr==1&&kr.push(Mr),Er.set(Mr,jr)}})}wr=wr.concat(kr),(Sr.length==1||Sr.length==2)&&(Ar=!0,Tr=Sr[0])}return Tr},xr.prototype.setGraphManager=function(Cr){this.graphManager=Cr},lr.exports=xr},function(lr,ur,cr){function hr(){}hr.seed=1,hr.x=0,hr.nextDouble=function(){return hr.x=Math.sin(hr.seed++)*1e4,hr.x-Math.floor(hr.x)},lr.exports=hr},function(lr,ur,cr){var hr=cr(5);function dr(fr,pr){this.lworldOrgX=0,this.lworldOrgY=0,this.ldeviceOrgX=0,this.ldeviceOrgY=0,this.lworldExtX=1,this.lworldExtY=1,this.ldeviceExtX=1,this.ldeviceExtY=1}dr.prototype.getWorldOrgX=function(){return this.lworldOrgX},dr.prototype.setWorldOrgX=function(fr){this.lworldOrgX=fr},dr.prototype.getWorldOrgY=function(){return this.lworldOrgY},dr.prototype.setWorldOrgY=function(fr){this.lworldOrgY=fr},dr.prototype.getWorldExtX=function(){return this.lworldExtX},dr.prototype.setWorldExtX=function(fr){this.lworldExtX=fr},dr.prototype.getWorldExtY=function(){return this.lworldExtY},dr.prototype.setWorldExtY=function(fr){this.lworldExtY=fr},dr.prototype.getDeviceOrgX=function(){return this.ldeviceOrgX},dr.prototype.setDeviceOrgX=function(fr){this.ldeviceOrgX=fr},dr.prototype.getDeviceOrgY=function(){return this.ldeviceOrgY},dr.prototype.setDeviceOrgY=function(fr){this.ldeviceOrgY=fr},dr.prototype.getDeviceExtX=function(){return this.ldeviceExtX},dr.prototype.setDeviceExtX=function(fr){this.ldeviceExtX=fr},dr.prototype.getDeviceExtY=function(){return this.ldeviceExtY},dr.prototype.setDeviceExtY=function(fr){this.ldeviceExtY=fr},dr.prototype.transformX=function(fr){var pr=0,vr=this.lworldExtX;return vr!=0&&(pr=this.ldeviceOrgX+(fr-this.lworldOrgX)*this.ldeviceExtX/vr),pr},dr.prototype.transformY=function(fr){var pr=0,vr=this.lworldExtY;return vr!=0&&(pr=this.ldeviceOrgY+(fr-this.lworldOrgY)*this.ldeviceExtY/vr),pr},dr.prototype.inverseTransformX=function(fr){var pr=0,vr=this.ldeviceExtX;return vr!=0&&(pr=this.lworldOrgX+(fr-this.ldeviceOrgX)*this.lworldExtX/vr),pr},dr.prototype.inverseTransformY=function(fr){var pr=0,vr=this.ldeviceExtY;return vr!=0&&(pr=this.lworldOrgY+(fr-this.ldeviceOrgY)*this.lworldExtY/vr),pr},dr.prototype.inverseTransformPoint=function(fr){var pr=new hr(this.inverseTransformX(fr.x),this.inverseTransformY(fr.y));return pr},lr.exports=dr},function(lr,ur,cr){function hr(yr){if(Array.isArray(yr)){for(var xr=0,Cr=Array(yr.length);xr<yr.length;xr++)Cr[xr]=yr[xr];return Cr}else return Array.from(yr)}var dr=cr(15),fr=cr(4),pr=cr(0),vr=cr(8),gr=cr(9);function mr(){dr.call(this),this.useSmartIdealEdgeLengthCalculation=fr.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=fr.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=fr.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=fr.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=fr.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.displacementThresholdPerNode=3*fr.DEFAULT_EDGE_LENGTH/100,this.coolingFactor=fr.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.initialCoolingFactor=fr.DEFAULT_COOLING_FACTOR_INCREMENTAL,this.totalDisplacement=0,this.oldTotalDisplacement=0,this.maxIterations=fr.MAX_ITERATIONS}mr.prototype=Object.create(dr.prototype);for(var br in dr)mr[br]=dr[br];mr.prototype.initParameters=function(){dr.prototype.initParameters.call(this,arguments),this.totalIterations=0,this.notAnimatedIterations=0,this.useFRGridVariant=fr.DEFAULT_USE_SMART_REPULSION_RANGE_CALCULATION,this.grid=[]},mr.prototype.calcIdealEdgeLengths=function(){for(var yr,xr,Cr,Sr,wr,Er,Ar,Tr=this.getGraphManager().getAllEdges(),Rr=0;Rr<Tr.length;Rr++)yr=Tr[Rr],xr=yr.idealLength,yr.isInterGraph&&(Sr=yr.getSource(),wr=yr.getTarget(),Er=yr.getSourceInLca().getEstimatedSize(),Ar=yr.getTargetInLca().getEstimatedSize(),this.useSmartIdealEdgeLengthCalculation&&(yr.idealLength+=Er+Ar-2*pr.SIMPLE_NODE_SIZE),Cr=yr.getLca().getInclusionTreeDepth(),yr.idealLength+=xr*fr.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR*(Sr.getInclusionTreeDepth()+wr.getInclusionTreeDepth()-2*Cr))},mr.prototype.initSpringEmbedder=function(){var yr=this.getAllNodes().length;this.incremental?(yr>fr.ADAPTATION_LOWER_NODE_LIMIT&&(this.coolingFactor=Math.max(this.coolingFactor*fr.COOLING_ADAPTATION_FACTOR,this.coolingFactor-(yr-fr.ADAPTATION_LOWER_NODE_LIMIT)/(fr.ADAPTATION_UPPER_NODE_LIMIT-fr.ADAPTATION_LOWER_NODE_LIMIT)*this.coolingFactor*(1-fr.COOLING_ADAPTATION_FACTOR))),this.maxNodeDisplacement=fr.MAX_NODE_DISPLACEMENT_INCREMENTAL):(yr>fr.ADAPTATION_LOWER_NODE_LIMIT?this.coolingFactor=Math.max(fr.COOLING_ADAPTATION_FACTOR,1-(yr-fr.ADAPTATION_LOWER_NODE_LIMIT)/(fr.ADAPTATION_UPPER_NODE_LIMIT-fr.ADAPTATION_LOWER_NODE_LIMIT)*(1-fr.COOLING_ADAPTATION_FACTOR)):this.coolingFactor=1,this.initialCoolingFactor=this.coolingFactor,this.maxNodeDisplacement=fr.MAX_NODE_DISPLACEMENT),this.maxIterations=Math.max(this.getAllNodes().length*5,this.maxIterations),this.displacementThresholdPerNode=3*fr.DEFAULT_EDGE_LENGTH/100,this.totalDisplacementThreshold=this.displacementThresholdPerNode*this.getAllNodes().length,this.repulsionRange=this.calcRepulsionRange()},mr.prototype.calcSpringForces=function(){for(var yr=this.getAllEdges(),xr,Cr=0;Cr<yr.length;Cr++)xr=yr[Cr],this.calcSpringForce(xr,xr.idealLength)},mr.prototype.calcRepulsionForces=function(){var yr=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,xr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Cr,Sr,wr,Er,Ar=this.getAllNodes(),Tr;if(this.useFRGridVariant)for(this.totalIterations%fr.GRID_CALCULATION_CHECK_PERIOD==1&&yr&&this.updateGrid(),Tr=new Set,Cr=0;Cr<Ar.length;Cr++)wr=Ar[Cr],this.calculateRepulsionForceOfANode(wr,Tr,yr,xr),Tr.add(wr);else for(Cr=0;Cr<Ar.length;Cr++)for(wr=Ar[Cr],Sr=Cr+1;Sr<Ar.length;Sr++)Er=Ar[Sr],wr.getOwner()==Er.getOwner()&&this.calcRepulsionForce(wr,Er)},mr.prototype.calcGravitationalForces=function(){for(var yr,xr=this.getAllNodesToApplyGravitation(),Cr=0;Cr<xr.length;Cr++)yr=xr[Cr],this.calcGravitationalForce(yr)},mr.prototype.moveNodes=function(){for(var yr=this.getAllNodes(),xr,Cr=0;Cr<yr.length;Cr++)xr=yr[Cr],xr.move()},mr.prototype.calcSpringForce=function(yr,xr){var Cr=yr.getSource(),Sr=yr.getTarget(),wr,Er,Ar,Tr;if(this.uniformLeafNodeSizes&&Cr.getChild()==null&&Sr.getChild()==null)yr.updateLengthSimple();else if(yr.updateLength(),yr.isOverlapingSourceAndTarget)return;wr=yr.getLength(),wr!=0&&(Er=yr.edgeElasticity*(wr-xr),Ar=Er*(yr.lengthX/wr),Tr=Er*(yr.lengthY/wr),Cr.springForceX+=Ar,Cr.springForceY+=Tr,Sr.springForceX-=Ar,Sr.springForceY-=Tr)},mr.prototype.calcRepulsionForce=function(yr,xr){var Cr=yr.getRect(),Sr=xr.getRect(),wr=new Array(2),Er=new Array(4),Ar,Tr,Rr,Pr,_r,kr,Dr;if(Cr.intersects(Sr)){vr.calcSeparationAmount(Cr,Sr,wr,fr.DEFAULT_EDGE_LENGTH/2),kr=2*wr[0],Dr=2*wr[1];var Nr=yr.noOfChildren*xr.noOfChildren/(yr.noOfChildren+xr.noOfChildren);yr.repulsionForceX-=Nr*kr,yr.repulsionForceY-=Nr*Dr,xr.repulsionForceX+=Nr*kr,xr.repulsionForceY+=Nr*Dr}else this.uniformLeafNodeSizes&&yr.getChild()==null&&xr.getChild()==null?(Ar=Sr.getCenterX()-Cr.getCenterX(),Tr=Sr.getCenterY()-Cr.getCenterY()):(vr.getIntersection(Cr,Sr,Er),Ar=Er[2]-Er[0],Tr=Er[3]-Er[1]),Math.abs(Ar)<fr.MIN_REPULSION_DIST&&(Ar=gr.sign(Ar)*fr.MIN_REPULSION_DIST),Math.abs(Tr)<fr.MIN_REPULSION_DIST&&(Tr=gr.sign(Tr)*fr.MIN_REPULSION_DIST),Rr=Ar*Ar+Tr*Tr,Pr=Math.sqrt(Rr),_r=(yr.nodeRepulsion/2+xr.nodeRepulsion/2)*yr.noOfChildren*xr.noOfChildren/Rr,kr=_r*Ar/Pr,Dr=_r*Tr/Pr,yr.repulsionForceX-=kr,yr.repulsionForceY-=Dr,xr.repulsionForceX+=kr,xr.repulsionForceY+=Dr},mr.prototype.calcGravitationalForce=function(yr){var xr,Cr,Sr,wr,Er,Ar,Tr,Rr;xr=yr.getOwner(),Cr=(xr.getRight()+xr.getLeft())/2,Sr=(xr.getTop()+xr.getBottom())/2,wr=yr.getCenterX()-Cr,Er=yr.getCenterY()-Sr,Ar=Math.abs(wr)+yr.getWidth()/2,Tr=Math.abs(Er)+yr.getHeight()/2,yr.getOwner()==this.graphManager.getRoot()?(Rr=xr.getEstimatedSize()*this.gravityRangeFactor,(Ar>Rr||Tr>Rr)&&(yr.gravitationForceX=-this.gravityConstant*wr,yr.gravitationForceY=-this.gravityConstant*Er)):(Rr=xr.getEstimatedSize()*this.compoundGravityRangeFactor,(Ar>Rr||Tr>Rr)&&(yr.gravitationForceX=-this.gravityConstant*wr*this.compoundGravityConstant,yr.gravitationForceY=-this.gravityConstant*Er*this.compoundGravityConstant))},mr.prototype.isConverged=function(){var yr,xr=!1;return this.totalIterations>this.maxIterations/3&&(xr=Math.abs(this.totalDisplacement-this.oldTotalDisplacement)<2),yr=this.totalDisplacement<this.totalDisplacementThreshold,this.oldTotalDisplacement=this.totalDisplacement,yr||xr},mr.prototype.animate=function(){this.animationDuringLayout&&!this.isSubLayout&&(this.notAnimatedIterations==this.animationPeriod?(this.update(),this.notAnimatedIterations=0):this.notAnimatedIterations++)},mr.prototype.calcNoOfChildrenForAllNodes=function(){for(var yr,xr=this.graphManager.getAllNodes(),Cr=0;Cr<xr.length;Cr++)yr=xr[Cr],yr.noOfChildren=yr.getNoOfChildren()},mr.prototype.calcGrid=function(yr){var xr=0,Cr=0;xr=parseInt(Math.ceil((yr.getRight()-yr.getLeft())/this.repulsionRange)),Cr=parseInt(Math.ceil((yr.getBottom()-yr.getTop())/this.repulsionRange));for(var Sr=new Array(xr),wr=0;wr<xr;wr++)Sr[wr]=new Array(Cr);for(var wr=0;wr<xr;wr++)for(var Er=0;Er<Cr;Er++)Sr[wr][Er]=new Array;return Sr},mr.prototype.addNodeToGrid=function(yr,xr,Cr){var Sr=0,wr=0,Er=0,Ar=0;Sr=parseInt(Math.floor((yr.getRect().x-xr)/this.repulsionRange)),wr=parseInt(Math.floor((yr.getRect().width+yr.getRect().x-xr)/this.repulsionRange)),Er=parseInt(Math.floor((yr.getRect().y-Cr)/this.repulsionRange)),Ar=parseInt(Math.floor((yr.getRect().height+yr.getRect().y-Cr)/this.repulsionRange));for(var Tr=Sr;Tr<=wr;Tr++)for(var Rr=Er;Rr<=Ar;Rr++)this.grid[Tr][Rr].push(yr),yr.setGridCoordinates(Sr,wr,Er,Ar)},mr.prototype.updateGrid=function(){var yr,xr,Cr=this.getAllNodes();for(this.grid=this.calcGrid(this.graphManager.getRoot()),yr=0;yr<Cr.length;yr++)xr=Cr[yr],this.addNodeToGrid(xr,this.graphManager.getRoot().getLeft(),this.graphManager.getRoot().getTop())},mr.prototype.calculateRepulsionForceOfANode=function(yr,xr,Cr,Sr){if(this.totalIterations%fr.GRID_CALCULATION_CHECK_PERIOD==1&&Cr||Sr){var wr=new Set;yr.surrounding=new Array;for(var Er,Ar=this.grid,Tr=yr.startX-1;Tr<yr.finishX+2;Tr++)for(var Rr=yr.startY-1;Rr<yr.finishY+2;Rr++)if(!(Tr<0||Rr<0||Tr>=Ar.length||Rr>=Ar[0].length)){for(var Pr=0;Pr<Ar[Tr][Rr].length;Pr++)if(Er=Ar[Tr][Rr][Pr],!(yr.getOwner()!=Er.getOwner()||yr==Er)&&!xr.has(Er)&&!wr.has(Er)){var _r=Math.abs(yr.getCenterX()-Er.getCenterX())-(yr.getWidth()/2+Er.getWidth()/2),kr=Math.abs(yr.getCenterY()-Er.getCenterY())-(yr.getHeight()/2+Er.getHeight()/2);_r<=this.repulsionRange&&kr<=this.repulsionRange&&wr.add(Er)}}yr.surrounding=[].concat(hr(wr))}for(Tr=0;Tr<yr.surrounding.length;Tr++)this.calcRepulsionForce(yr,yr.surrounding[Tr])},mr.prototype.calcRepulsionRange=function(){return 0},lr.exports=mr},function(lr,ur,cr){var hr=cr(1),dr=cr(4);function fr(vr,gr,mr){hr.call(this,vr,gr,mr),this.idealLength=dr.DEFAULT_EDGE_LENGTH,this.edgeElasticity=dr.DEFAULT_SPRING_STRENGTH}fr.prototype=Object.create(hr.prototype);for(var pr in hr)fr[pr]=hr[pr];lr.exports=fr},function(lr,ur,cr){var hr=cr(3),dr=cr(4);function fr(vr,gr,mr,br){hr.call(this,vr,gr,mr,br),this.nodeRepulsion=dr.DEFAULT_REPULSION_STRENGTH,this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0,this.startX=0,this.finishX=0,this.startY=0,this.finishY=0,this.surrounding=[]}fr.prototype=Object.create(hr.prototype);for(var pr in hr)fr[pr]=hr[pr];fr.prototype.setGridCoordinates=function(vr,gr,mr,br){this.startX=vr,this.finishX=gr,this.startY=mr,this.finishY=br},lr.exports=fr},function(lr,ur,cr){function hr(dr,fr){this.width=0,this.height=0,dr!==null&&fr!==null&&(this.height=fr,this.width=dr)}hr.prototype.getWidth=function(){return this.width},hr.prototype.setWidth=function(dr){this.width=dr},hr.prototype.getHeight=function(){return this.height},hr.prototype.setHeight=function(dr){this.height=dr},lr.exports=hr},function(lr,ur,cr){var hr=cr(14);function dr(){this.map={},this.keys=[]}dr.prototype.put=function(fr,pr){var vr=hr.createID(fr);this.contains(vr)||(this.map[vr]=pr,this.keys.push(fr))},dr.prototype.contains=function(fr){return hr.createID(fr),this.map[fr]!=null},dr.prototype.get=function(fr){var pr=hr.createID(fr);return this.map[pr]},dr.prototype.keySet=function(){return this.keys},lr.exports=dr},function(lr,ur,cr){var hr=cr(14);function dr(){this.set={}}dr.prototype.add=function(fr){var pr=hr.createID(fr);this.contains(pr)||(this.set[pr]=fr)},dr.prototype.remove=function(fr){delete this.set[hr.createID(fr)]},dr.prototype.clear=function(){this.set={}},dr.prototype.contains=function(fr){return this.set[hr.createID(fr)]==fr},dr.prototype.isEmpty=function(){return this.size()===0},dr.prototype.size=function(){return Object.keys(this.set).length},dr.prototype.addAllTo=function(fr){for(var pr=Object.keys(this.set),vr=pr.length,gr=0;gr<vr;gr++)fr.push(this.set[pr[gr]])},dr.prototype.size=function(){return Object.keys(this.set).length},dr.prototype.addAll=function(fr){for(var pr=fr.length,vr=0;vr<pr;vr++){var gr=fr[vr];this.add(gr)}},lr.exports=dr},function(lr,ur,cr){function hr(){}hr.multMat=function(dr,fr){for(var pr=[],vr=0;vr<dr.length;vr++){pr[vr]=[];for(var gr=0;gr<fr[0].length;gr++){pr[vr][gr]=0;for(var mr=0;mr<dr[0].length;mr++)pr[vr][gr]+=dr[vr][mr]*fr[mr][gr]}}return pr},hr.transpose=function(dr){for(var fr=[],pr=0;pr<dr[0].length;pr++){fr[pr]=[];for(var vr=0;vr<dr.length;vr++)fr[pr][vr]=dr[vr][pr]}return fr},hr.multCons=function(dr,fr){for(var pr=[],vr=0;vr<dr.length;vr++)pr[vr]=dr[vr]*fr;return pr},hr.minusOp=function(dr,fr){for(var pr=[],vr=0;vr<dr.length;vr++)pr[vr]=dr[vr]-fr[vr];return pr},hr.dotProduct=function(dr,fr){for(var pr=0,vr=0;vr<dr.length;vr++)pr+=dr[vr]*fr[vr];return pr},hr.mag=function(dr){return Math.sqrt(this.dotProduct(dr,dr))},hr.normalize=function(dr){for(var fr=[],pr=this.mag(dr),vr=0;vr<dr.length;vr++)fr[vr]=dr[vr]/pr;return fr},hr.multGamma=function(dr){for(var fr=[],pr=0,vr=0;vr<dr.length;vr++)pr+=dr[vr];pr*=-1/dr.length;for(var gr=0;gr<dr.length;gr++)fr[gr]=pr+dr[gr];return fr},hr.multL=function(dr,fr,pr){for(var vr=[],gr=[],mr=[],br=0;br<fr[0].length;br++){for(var yr=0,xr=0;xr<fr.length;xr++)yr+=-.5*fr[xr][br]*dr[xr];gr[br]=yr}for(var Cr=0;Cr<pr.length;Cr++){for(var Sr=0,wr=0;wr<pr.length;wr++)Sr+=pr[Cr][wr]*gr[wr];mr[Cr]=Sr}for(var Er=0;Er<fr.length;Er++){for(var Ar=0,Tr=0;Tr<fr[0].length;Tr++)Ar+=fr[Er][Tr]*mr[Tr];vr[Er]=Ar}return vr},lr.exports=hr},function(lr,ur,cr){var hr=function(){function vr(gr,mr){for(var br=0;br<mr.length;br++){var yr=mr[br];yr.enumerable=yr.enumerable||!1,yr.configurable=!0,"value"in yr&&(yr.writable=!0),Object.defineProperty(gr,yr.key,yr)}}return function(gr,mr,br){return mr&&vr(gr.prototype,mr),br&&vr(gr,br),gr}}();function dr(vr,gr){if(!(vr instanceof gr))throw new TypeError("Cannot call a class as a function")}var fr=cr(11),pr=function(){function vr(gr,mr){dr(this,vr),(mr!==null||mr!==void 0)&&(this.compareFunction=this._defaultCompareFunction);var br=void 0;gr instanceof fr?br=gr.size():br=gr.length,this._quicksort(gr,0,br-1)}return hr(vr,[{key:"_quicksort",value:function(mr,br,yr){if(br<yr){var xr=this._partition(mr,br,yr);this._quicksort(mr,br,xr),this._quicksort(mr,xr+1,yr)}}},{key:"_partition",value:function(mr,br,yr){for(var xr=this._get(mr,br),Cr=br,Sr=yr;;){for(;this.compareFunction(xr,this._get(mr,Sr));)Sr--;for(;this.compareFunction(this._get(mr,Cr),xr);)Cr++;if(Cr<Sr)this._swap(mr,Cr,Sr),Cr++,Sr--;else return Sr}}},{key:"_get",value:function(mr,br){return mr instanceof fr?mr.get_object_at(br):mr[br]}},{key:"_set",value:function(mr,br,yr){mr instanceof fr?mr.set_object_at(br,yr):mr[br]=yr}},{key:"_swap",value:function(mr,br,yr){var xr=this._get(mr,br);this._set(mr,br,this._get(mr,yr)),this._set(mr,yr,xr)}},{key:"_defaultCompareFunction",value:function(mr,br){return br>mr}}]),vr}();lr.exports=pr},function(lr,ur,cr){function hr(){}hr.svd=function(dr){this.U=null,this.V=null,this.s=null,this.m=0,this.n=0,this.m=dr.length,this.n=dr[0].length;var fr=Math.min(this.m,this.n);this.s=function(As){for(var ks=[];As-- >0;)ks.push(0);return ks}(Math.min(this.m+1,this.n)),this.U=function(As){var ks=function js(zs){if(zs.length==0)return 0;for(var Fs=[],qs=0;qs<zs[0];qs++)Fs.push(js(zs.slice(1)));return Fs};return ks(As)}([this.m,fr]),this.V=function(As){var ks=function js(zs){if(zs.length==0)return 0;for(var Fs=[],qs=0;qs<zs[0];qs++)Fs.push(js(zs.slice(1)));return Fs};return ks(As)}([this.n,this.n]);for(var pr=function(As){for(var ks=[];As-- >0;)ks.push(0);return ks}(this.n),vr=function(As){for(var ks=[];As-- >0;)ks.push(0);return ks}(this.m),gr=!0,mr=Math.min(this.m-1,this.n),br=Math.max(0,Math.min(this.n-2,this.m)),yr=0;yr<Math.max(mr,br);yr++){if(yr<mr){this.s[yr]=0;for(var xr=yr;xr<this.m;xr++)this.s[yr]=hr.hypot(this.s[yr],dr[xr][yr]);if(this.s[yr]!==0){dr[yr][yr]<0&&(this.s[yr]=-this.s[yr]);for(var Cr=yr;Cr<this.m;Cr++)dr[Cr][yr]/=this.s[yr];dr[yr][yr]+=1}this.s[yr]=-this.s[yr]}for(var Sr=yr+1;Sr<this.n;Sr++){if(function(As,ks){return As&&ks}(yr<mr,this.s[yr]!==0)){for(var wr=0,Er=yr;Er<this.m;Er++)wr+=dr[Er][yr]*dr[Er][Sr];wr=-wr/dr[yr][yr];for(var Ar=yr;Ar<this.m;Ar++)dr[Ar][Sr]+=wr*dr[Ar][yr]}pr[Sr]=dr[yr][Sr]}if(function(As,ks){return ks}(gr,yr<mr))for(var Tr=yr;Tr<this.m;Tr++)this.U[Tr][yr]=dr[Tr][yr];if(yr<br){pr[yr]=0;for(var Rr=yr+1;Rr<this.n;Rr++)pr[yr]=hr.hypot(pr[yr],pr[Rr]);if(pr[yr]!==0){pr[yr+1]<0&&(pr[yr]=-pr[yr]);for(var Pr=yr+1;Pr<this.n;Pr++)pr[Pr]/=pr[yr];pr[yr+1]+=1}if(pr[yr]=-pr[yr],function(As,ks){return As&&ks}(yr+1<this.m,pr[yr]!==0)){for(var _r=yr+1;_r<this.m;_r++)vr[_r]=0;for(var kr=yr+1;kr<this.n;kr++)for(var Dr=yr+1;Dr<this.m;Dr++)vr[Dr]+=pr[kr]*dr[Dr][kr];for(var Nr=yr+1;Nr<this.n;Nr++)for(var Lr=-pr[Nr]/pr[yr+1],Or=yr+1;Or<this.m;Or++)dr[Or][Nr]+=Lr*vr[Or]}for(var Ir=yr+1;Ir<this.n;Ir++)this.V[Ir][yr]=pr[Ir]}}var Mr=Math.min(this.n,this.m+1);mr<this.n&&(this.s[mr]=dr[mr][mr]),this.m<Mr&&(this.s[Mr-1]=0),br+1<Mr&&(pr[br]=dr[br][Mr-1]),pr[Mr-1]=0;{for(var $r=mr;$r<fr;$r++){for(var jr=0;jr<this.m;jr++)this.U[jr][$r]=0;this.U[$r][$r]=1}for(var Fr=mr-1;Fr>=0;Fr--)if(this.s[Fr]!==0){for(var zr=Fr+1;zr<fr;zr++){for(var Hr=0,Wr=Fr;Wr<this.m;Wr++)Hr+=this.U[Wr][Fr]*this.U[Wr][zr];Hr=-Hr/this.U[Fr][Fr];for(var Yr=Fr;Yr<this.m;Yr++)this.U[Yr][zr]+=Hr*this.U[Yr][Fr]}for(var qr=Fr;qr<this.m;qr++)this.U[qr][Fr]=-this.U[qr][Fr];this.U[Fr][Fr]=1+this.U[Fr][Fr];for(var Br=0;Br<Fr-1;Br++)this.U[Br][Fr]=0}else{for(var Ur=0;Ur<this.m;Ur++)this.U[Ur][Fr]=0;this.U[Fr][Fr]=1}}for(var Vr=this.n-1;Vr>=0;Vr--){if(function(As,ks){return As&&ks}(Vr<br,pr[Vr]!==0))for(var Xr=Vr+1;Xr<fr;Xr++){for(var Zr=0,Jr=Vr+1;Jr<this.n;Jr++)Zr+=this.V[Jr][Vr]*this.V[Jr][Xr];Zr=-Zr/this.V[Vr+1][Vr];for(var Qr=Vr+1;Qr<this.n;Qr++)this.V[Qr][Xr]+=Zr*this.V[Qr][Vr]}for(var ga=0;ga<this.n;ga++)this.V[ga][Vr]=0;this.V[Vr][Vr]=1}for(var ba=Mr-1,_i=Math.pow(2,-52),os=Math.pow(2,-966);Mr>0;){var ls=void 0,ys=void 0;for(ls=Mr-2;ls>=-1&&ls!==-1;ls--)if(Math.abs(pr[ls])<=os+_i*(Math.abs(this.s[ls])+Math.abs(this.s[ls+1]))){pr[ls]=0;break}if(ls===Mr-2)ys=4;else{var ns=void 0;for(ns=Mr-1;ns>=ls&&ns!==ls;ns--){var as=(ns!==Mr?Math.abs(pr[ns]):0)+(ns!==ls+1?Math.abs(pr[ns-1]):0);if(Math.abs(this.s[ns])<=os+_i*as){this.s[ns]=0;break}}ns===ls?ys=3:ns===Mr-1?ys=1:(ys=2,ls=ns)}switch(ls++,ys){case 1:{var Kr=pr[Mr-2];pr[Mr-2]=0;for(var $a=Mr-2;$a>=ls;$a--){var ss=hr.hypot(this.s[$a],Kr),hs=this.s[$a]/ss,vs=Kr/ss;this.s[$a]=ss,$a!==ls&&(Kr=-vs*pr[$a-1],pr[$a-1]=hs*pr[$a-1]);for(var bs=0;bs<this.n;bs++)ss=hs*this.V[bs][$a]+vs*this.V[bs][Mr-1],this.V[bs][Mr-1]=-vs*this.V[bs][$a]+hs*this.V[bs][Mr-1],this.V[bs][$a]=ss}}break;case 2:{var xs=pr[ls-1];pr[ls-1]=0;for(var fs=ls;fs<Mr;fs++){var Is=hr.hypot(this.s[fs],xs),Os=this.s[fs]/Is,Us=xs/Is;this.s[fs]=Is,xs=-Us*pr[fs],pr[fs]=Os*pr[fs];for(var $s=0;$s<this.m;$s++)Is=Os*this.U[$s][fs]+Us*this.U[$s][ls-1],this.U[$s][ls-1]=-Us*this.U[$s][fs]+Os*this.U[$s][ls-1],this.U[$s][fs]=Is}}break;case 3:{var Bs=Math.max(Math.max(Math.max(Math.max(Math.abs(this.s[Mr-1]),Math.abs(this.s[Mr-2])),Math.abs(pr[Mr-2])),Math.abs(this.s[ls])),Math.abs(pr[ls])),Ns=this.s[Mr-1]/Bs,us=this.s[Mr-2]/Bs,na=pr[Mr-2]/Bs,ds=this.s[ls]/Bs,is=pr[ls]/Bs,_a=((us+Ns)*(us-Ns)+na*na)/2,rs=Ns*na*(Ns*na),Cs=0;(function(As,ks){return As||ks})(_a!==0,rs!==0)&&(Cs=Math.sqrt(_a*_a+rs),_a<0&&(Cs=-Cs),Cs=rs/(_a+Cs));for(var Es=(ds+Ns)*(ds-Ns)+Cs,Rs=ds*is,xa=ls;xa<Mr-1;xa++){var ps=hr.hypot(Es,Rs),Ps=Es/ps,Ms=Rs/ps;xa!==ls&&(pr[xa-1]=ps),Es=Ps*this.s[xa]+Ms*pr[xa],pr[xa]=Ps*pr[xa]-Ms*this.s[xa],Rs=Ms*this.s[xa+1],this.s[xa+1]=Ps*this.s[xa+1];for(var Ls=0;Ls<this.n;Ls++)ps=Ps*this.V[Ls][xa]+Ms*this.V[Ls][xa+1],this.V[Ls][xa+1]=-Ms*this.V[Ls][xa]+Ps*this.V[Ls][xa+1],this.V[Ls][xa]=ps;if(ps=hr.hypot(Es,Rs),Ps=Es/ps,Ms=Rs/ps,this.s[xa]=ps,Es=Ps*pr[xa]+Ms*this.s[xa+1],this.s[xa+1]=-Ms*pr[xa]+Ps*this.s[xa+1],Rs=Ms*pr[xa+1],pr[xa+1]=Ps*pr[xa+1],xa<this.m-1)for(var Ds=0;Ds<this.m;Ds++)ps=Ps*this.U[Ds][xa]+Ms*this.U[Ds][xa+1],this.U[Ds][xa+1]=-Ms*this.U[Ds][xa]+Ps*this.U[Ds][xa+1],this.U[Ds][xa]=ps}pr[Mr-2]=Es}break;case 4:{if(this.s[ls]<=0){this.s[ls]=this.s[ls]<0?-this.s[ls]:0;for(var es=0;es<=ba;es++)this.V[es][ls]=-this.V[es][ls]}for(;ls<ba&&!(this.s[ls]>=this.s[ls+1]);){var ts=this.s[ls];if(this.s[ls]=this.s[ls+1],this.s[ls+1]=ts,ls<this.n-1)for(var cs=0;cs<this.n;cs++)ts=this.V[cs][ls+1],this.V[cs][ls+1]=this.V[cs][ls],this.V[cs][ls]=ts;if(ls<this.m-1)for(var gs=0;gs<this.m;gs++)ts=this.U[gs][ls+1],this.U[gs][ls+1]=this.U[gs][ls],this.U[gs][ls]=ts;ls++}Mr--}break}}var Ss={U:this.U,V:this.V,S:this.s};return Ss},hr.hypot=function(dr,fr){var pr=void 0;return Math.abs(dr)>Math.abs(fr)?(pr=fr/dr,pr=Math.abs(dr)*Math.sqrt(1+pr*pr)):fr!=0?(pr=dr/fr,pr=Math.abs(fr)*Math.sqrt(1+pr*pr)):pr=0,pr},lr.exports=hr},function(lr,ur,cr){var hr=function(){function pr(vr,gr){for(var mr=0;mr<gr.length;mr++){var br=gr[mr];br.enumerable=br.enumerable||!1,br.configurable=!0,"value"in br&&(br.writable=!0),Object.defineProperty(vr,br.key,br)}}return function(vr,gr,mr){return gr&&pr(vr.prototype,gr),mr&&pr(vr,mr),vr}}();function dr(pr,vr){if(!(pr instanceof vr))throw new TypeError("Cannot call a class as a function")}var fr=function(){function pr(vr,gr){var mr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,br=arguments.length>3&&arguments[3]!==void 0?arguments[3]:-1,yr=arguments.length>4&&arguments[4]!==void 0?arguments[4]:-1;dr(this,pr),this.sequence1=vr,this.sequence2=gr,this.match_score=mr,this.mismatch_penalty=br,this.gap_penalty=yr,this.iMax=vr.length+1,this.jMax=gr.length+1,this.grid=new Array(this.iMax);for(var xr=0;xr<this.iMax;xr++){this.grid[xr]=new Array(this.jMax);for(var Cr=0;Cr<this.jMax;Cr++)this.grid[xr][Cr]=0}this.tracebackGrid=new Array(this.iMax);for(var Sr=0;Sr<this.iMax;Sr++){this.tracebackGrid[Sr]=new Array(this.jMax);for(var wr=0;wr<this.jMax;wr++)this.tracebackGrid[Sr][wr]=[null,null,null]}this.alignments=[],this.score=-1,this.computeGrids()}return hr(pr,[{key:"getScore",value:function(){return this.score}},{key:"getAlignments",value:function(){return this.alignments}},{key:"computeGrids",value:function(){for(var gr=1;gr<this.jMax;gr++)this.grid[0][gr]=this.grid[0][gr-1]+this.gap_penalty,this.tracebackGrid[0][gr]=[!1,!1,!0];for(var mr=1;mr<this.iMax;mr++)this.grid[mr][0]=this.grid[mr-1][0]+this.gap_penalty,this.tracebackGrid[mr][0]=[!1,!0,!1];for(var br=1;br<this.iMax;br++)for(var yr=1;yr<this.jMax;yr++){var xr=void 0;this.sequence1[br-1]===this.sequence2[yr-1]?xr=this.grid[br-1][yr-1]+this.match_score:xr=this.grid[br-1][yr-1]+this.mismatch_penalty;var Cr=this.grid[br-1][yr]+this.gap_penalty,Sr=this.grid[br][yr-1]+this.gap_penalty,wr=[xr,Cr,Sr],Er=this.arrayAllMaxIndexes(wr);this.grid[br][yr]=wr[Er[0]],this.tracebackGrid[br][yr]=[Er.includes(0),Er.includes(1),Er.includes(2)]}this.score=this.grid[this.iMax-1][this.jMax-1]}},{key:"alignmentTraceback",value:function(){var gr=[];for(gr.push({pos:[this.sequence1.length,this.sequence2.length],seq1:"",seq2:""});gr[0];){var mr=gr[0],br=this.tracebackGrid[mr.pos[0]][mr.pos[1]];br[0]&&gr.push({pos:[mr.pos[0]-1,mr.pos[1]-1],seq1:this.sequence1[mr.pos[0]-1]+mr.seq1,seq2:this.sequence2[mr.pos[1]-1]+mr.seq2}),br[1]&&gr.push({pos:[mr.pos[0]-1,mr.pos[1]],seq1:this.sequence1[mr.pos[0]-1]+mr.seq1,seq2:"-"+mr.seq2}),br[2]&&gr.push({pos:[mr.pos[0],mr.pos[1]-1],seq1:"-"+mr.seq1,seq2:this.sequence2[mr.pos[1]-1]+mr.seq2}),mr.pos[0]===0&&mr.pos[1]===0&&this.alignments.push({sequence1:mr.seq1,sequence2:mr.seq2}),gr.shift()}return this.alignments}},{key:"getAllIndexes",value:function(gr,mr){for(var br=[],yr=-1;(yr=gr.indexOf(mr,yr+1))!==-1;)br.push(yr);return br}},{key:"arrayAllMaxIndexes",value:function(gr){return this.getAllIndexes(gr,Math.max.apply(null,gr))}}]),pr}();lr.exports=fr},function(lr,ur,cr){var hr=function(){};hr.FDLayout=cr(18),hr.FDLayoutConstants=cr(4),hr.FDLayoutEdge=cr(19),hr.FDLayoutNode=cr(20),hr.DimensionD=cr(21),hr.HashMap=cr(22),hr.HashSet=cr(23),hr.IGeometry=cr(8),hr.IMath=cr(9),hr.Integer=cr(10),hr.Point=cr(12),hr.PointD=cr(5),hr.RandomSeed=cr(16),hr.RectangleD=cr(13),hr.Transform=cr(17),hr.UniqueIDGeneretor=cr(14),hr.Quicksort=cr(25),hr.LinkedList=cr(11),hr.LGraphObject=cr(2),hr.LGraph=cr(6),hr.LEdge=cr(1),hr.LGraphManager=cr(7),hr.LNode=cr(3),hr.Layout=cr(15),hr.LayoutConstants=cr(0),hr.NeedlemanWunsch=cr(27),hr.Matrix=cr(24),hr.SVD=cr(26),lr.exports=hr},function(lr,ur,cr){function hr(){this.listeners=[]}var dr=hr.prototype;dr.addListener=function(fr,pr){this.listeners.push({event:fr,callback:pr})},dr.removeListener=function(fr,pr){for(var vr=this.listeners.length;vr>=0;vr--){var gr=this.listeners[vr];gr.event===fr&&gr.callback===pr&&this.listeners.splice(vr,1)}},dr.emit=function(fr,pr){for(var vr=0;vr<this.listeners.length;vr++){var gr=this.listeners[vr];fr===gr.event&&gr.callback(pr)}},lr.exports=hr}])})}(layoutBase)),layoutBase.exports}var hasRequiredCoseBase;function requireCoseBase(){return hasRequiredCoseBase||(hasRequiredCoseBase=1,function(or,ar){(function(ur,cr){or.exports=cr(requireLayoutBase())})(commonjsGlobal$1,function(lr){return(()=>{var ur={45:(fr,pr,vr)=>{var gr={};gr.layoutBase=vr(551),gr.CoSEConstants=vr(806),gr.CoSEEdge=vr(767),gr.CoSEGraph=vr(880),gr.CoSEGraphManager=vr(578),gr.CoSELayout=vr(765),gr.CoSENode=vr(991),gr.ConstraintHandler=vr(902),fr.exports=gr},806:(fr,pr,vr)=>{var gr=vr(551).FDLayoutConstants;function mr(){}for(var br in gr)mr[br]=gr[br];mr.DEFAULT_USE_MULTI_LEVEL_SCALING=!1,mr.DEFAULT_RADIAL_SEPARATION=gr.DEFAULT_EDGE_LENGTH,mr.DEFAULT_COMPONENT_SEPERATION=60,mr.TILE=!0,mr.TILING_PADDING_VERTICAL=10,mr.TILING_PADDING_HORIZONTAL=10,mr.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,mr.ENFORCE_CONSTRAINTS=!0,mr.APPLY_LAYOUT=!0,mr.RELAX_MOVEMENT_ON_CONSTRAINTS=!0,mr.TREE_REDUCTION_ON_INCREMENTAL=!0,mr.PURE_INCREMENTAL=mr.DEFAULT_INCREMENTAL,fr.exports=mr},767:(fr,pr,vr)=>{var gr=vr(551).FDLayoutEdge;function mr(yr,xr,Cr){gr.call(this,yr,xr,Cr)}mr.prototype=Object.create(gr.prototype);for(var br in gr)mr[br]=gr[br];fr.exports=mr},880:(fr,pr,vr)=>{var gr=vr(551).LGraph;function mr(yr,xr,Cr){gr.call(this,yr,xr,Cr)}mr.prototype=Object.create(gr.prototype);for(var br in gr)mr[br]=gr[br];fr.exports=mr},578:(fr,pr,vr)=>{var gr=vr(551).LGraphManager;function mr(yr){gr.call(this,yr)}mr.prototype=Object.create(gr.prototype);for(var br in gr)mr[br]=gr[br];fr.exports=mr},765:(fr,pr,vr)=>{var gr=vr(551).FDLayout,mr=vr(578),br=vr(880),yr=vr(991),xr=vr(767),Cr=vr(806),Sr=vr(902),wr=vr(551).FDLayoutConstants,Er=vr(551).LayoutConstants,Ar=vr(551).Point,Tr=vr(551).PointD,Rr=vr(551).DimensionD,Pr=vr(551).Layout,_r=vr(551).Integer,kr=vr(551).IGeometry,Dr=vr(551).LGraph,Nr=vr(551).Transform,Lr=vr(551).LinkedList;function Or(){gr.call(this),this.toBeTiled={},this.constraints={}}Or.prototype=Object.create(gr.prototype);for(var Ir in gr)Or[Ir]=gr[Ir];Or.prototype.newGraphManager=function(){var Mr=new mr(this);return this.graphManager=Mr,Mr},Or.prototype.newGraph=function(Mr){return new br(null,this.graphManager,Mr)},Or.prototype.newNode=function(Mr){return new yr(this.graphManager,Mr)},Or.prototype.newEdge=function(Mr){return new xr(null,null,Mr)},Or.prototype.initParameters=function(){gr.prototype.initParameters.call(this,arguments),this.isSubLayout||(Cr.DEFAULT_EDGE_LENGTH<10?this.idealEdgeLength=10:this.idealEdgeLength=Cr.DEFAULT_EDGE_LENGTH,this.useSmartIdealEdgeLengthCalculation=Cr.DEFAULT_USE_SMART_IDEAL_EDGE_LENGTH_CALCULATION,this.gravityConstant=wr.DEFAULT_GRAVITY_STRENGTH,this.compoundGravityConstant=wr.DEFAULT_COMPOUND_GRAVITY_STRENGTH,this.gravityRangeFactor=wr.DEFAULT_GRAVITY_RANGE_FACTOR,this.compoundGravityRangeFactor=wr.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR,this.prunedNodesAll=[],this.growTreeIterations=0,this.afterGrowthIterations=0,this.isTreeGrowing=!1,this.isGrowthFinished=!1)},Or.prototype.initSpringEmbedder=function(){gr.prototype.initSpringEmbedder.call(this),this.coolingCycle=0,this.maxCoolingCycle=this.maxIterations/wr.CONVERGENCE_CHECK_PERIOD,this.finalTemperature=.04,this.coolingAdjuster=1},Or.prototype.layout=function(){var Mr=Er.DEFAULT_CREATE_BENDS_AS_NEEDED;return Mr&&(this.createBendpoints(),this.graphManager.resetAllEdges()),this.level=0,this.classicLayout()},Or.prototype.classicLayout=function(){if(this.nodesWithGravity=this.calculateNodesToApplyGravitationTo(),this.graphManager.setAllNodesToApplyGravitation(this.nodesWithGravity),this.calcNoOfChildrenForAllNodes(),this.graphManager.calcLowestCommonAncestors(),this.graphManager.calcInclusionTreeDepths(),this.graphManager.getRoot().calcEstimatedSize(),this.calcIdealEdgeLengths(),this.incremental){if(Cr.TREE_REDUCTION_ON_INCREMENTAL){this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var $r=new Set(this.getAllNodes()),jr=this.nodesWithGravity.filter(function(Hr){return $r.has(Hr)});this.graphManager.setAllNodesToApplyGravitation(jr)}}else{var Mr=this.getFlatForest();if(Mr.length>0)this.positionNodesRadially(Mr);else{this.reduceTrees(),this.graphManager.resetAllNodesToApplyGravitation();var $r=new Set(this.getAllNodes()),jr=this.nodesWithGravity.filter(function(Fr){return $r.has(Fr)});this.graphManager.setAllNodesToApplyGravitation(jr),this.positionNodesRandomly()}}return Object.keys(this.constraints).length>0&&(Sr.handleConstraints(this),this.initConstraintVariables()),this.initSpringEmbedder(),Cr.APPLY_LAYOUT&&this.runSpringEmbedder(),!0},Or.prototype.tick=function(){if(this.totalIterations++,this.totalIterations===this.maxIterations&&!this.isTreeGrowing&&!this.isGrowthFinished)if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;if(this.totalIterations%wr.CONVERGENCE_CHECK_PERIOD==0&&!this.isTreeGrowing&&!this.isGrowthFinished){if(this.isConverged())if(this.prunedNodesAll.length>0)this.isTreeGrowing=!0;else return!0;this.coolingCycle++,this.layoutQuality==0?this.coolingAdjuster=this.coolingCycle:this.layoutQuality==1&&(this.coolingAdjuster=this.coolingCycle/3),this.coolingFactor=Math.max(this.initialCoolingFactor-Math.pow(this.coolingCycle,Math.log(100*(this.initialCoolingFactor-this.finalTemperature))/Math.log(this.maxCoolingCycle))/100*this.coolingAdjuster,this.finalTemperature),this.animationPeriod=Math.ceil(this.initialAnimationPeriod*Math.sqrt(this.coolingFactor))}if(this.isTreeGrowing){if(this.growTreeIterations%10==0)if(this.prunedNodesAll.length>0){this.graphManager.updateBounds(),this.updateGrid(),this.growTree(this.prunedNodesAll),this.graphManager.resetAllNodesToApplyGravitation();var Mr=new Set(this.getAllNodes()),$r=this.nodesWithGravity.filter(function(zr){return Mr.has(zr)});this.graphManager.setAllNodesToApplyGravitation($r),this.graphManager.updateBounds(),this.updateGrid(),Cr.PURE_INCREMENTAL?this.coolingFactor=wr.DEFAULT_COOLING_FACTOR_INCREMENTAL/2:this.coolingFactor=wr.DEFAULT_COOLING_FACTOR_INCREMENTAL}else this.isTreeGrowing=!1,this.isGrowthFinished=!0;this.growTreeIterations++}if(this.isGrowthFinished){if(this.isConverged())return!0;this.afterGrowthIterations%10==0&&(this.graphManager.updateBounds(),this.updateGrid()),Cr.PURE_INCREMENTAL?this.coolingFactor=wr.DEFAULT_COOLING_FACTOR_INCREMENTAL/2*((100-this.afterGrowthIterations)/100):this.coolingFactor=wr.DEFAULT_COOLING_FACTOR_INCREMENTAL*((100-this.afterGrowthIterations)/100),this.afterGrowthIterations++}var jr=!this.isTreeGrowing&&!this.isGrowthFinished,Fr=this.growTreeIterations%10==1&&this.isTreeGrowing||this.afterGrowthIterations%10==1&&this.isGrowthFinished;return this.totalDisplacement=0,this.graphManager.updateBounds(),this.calcSpringForces(),this.calcRepulsionForces(jr,Fr),this.calcGravitationalForces(),this.moveNodes(),this.animate(),!1},Or.prototype.getPositionsData=function(){for(var Mr=this.graphManager.getAllNodes(),$r={},jr=0;jr<Mr.length;jr++){var Fr=Mr[jr].rect,zr=Mr[jr].id;$r[zr]={id:zr,x:Fr.getCenterX(),y:Fr.getCenterY(),w:Fr.width,h:Fr.height}}return $r},Or.prototype.runSpringEmbedder=function(){this.initialAnimationPeriod=25,this.animationPeriod=this.initialAnimationPeriod;var Mr=!1;if(wr.ANIMATE==="during")this.emit("layoutstarted");else{for(;!Mr;)Mr=this.tick();this.graphManager.updateBounds()}},Or.prototype.moveNodes=function(){for(var Mr=this.getAllNodes(),$r,jr=0;jr<Mr.length;jr++)$r=Mr[jr],$r.calculateDisplacement();Object.keys(this.constraints).length>0&&this.updateDisplacements();for(var jr=0;jr<Mr.length;jr++)$r=Mr[jr],$r.move()},Or.prototype.initConstraintVariables=function(){var Mr=this;this.idToNodeMap=new Map,this.fixedNodeSet=new Set;for(var $r=this.graphManager.getAllNodes(),jr=0;jr<$r.length;jr++){var Fr=$r[jr];this.idToNodeMap.set(Fr.id,Fr)}var zr=function Qr(ga){for(var ba=ga.getChild().getNodes(),_i,os=0,ls=0;ls<ba.length;ls++)_i=ba[ls],_i.getChild()==null?Mr.fixedNodeSet.has(_i.id)&&(os+=100):os+=Qr(_i);return os};if(this.constraints.fixedNodeConstraint){this.constraints.fixedNodeConstraint.forEach(function(ba){Mr.fixedNodeSet.add(ba.nodeId)});for(var $r=this.graphManager.getAllNodes(),Fr,jr=0;jr<$r.length;jr++)if(Fr=$r[jr],Fr.getChild()!=null){var Hr=zr(Fr);Hr>0&&(Fr.fixedNodeWeight=Hr)}}if(this.constraints.relativePlacementConstraint){var Wr=new Map,Yr=new Map;if(this.dummyToNodeForVerticalAlignment=new Map,this.dummyToNodeForHorizontalAlignment=new Map,this.fixedNodesOnHorizontal=new Set,this.fixedNodesOnVertical=new Set,this.fixedNodeSet.forEach(function(Qr){Mr.fixedNodesOnHorizontal.add(Qr),Mr.fixedNodesOnVertical.add(Qr)}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var qr=this.constraints.alignmentConstraint.vertical,jr=0;jr<qr.length;jr++)this.dummyToNodeForVerticalAlignment.set("dummy"+jr,[]),qr[jr].forEach(function(ga){Wr.set(ga,"dummy"+jr),Mr.dummyToNodeForVerticalAlignment.get("dummy"+jr).push(ga),Mr.fixedNodeSet.has(ga)&&Mr.fixedNodesOnHorizontal.add("dummy"+jr)});if(this.constraints.alignmentConstraint.horizontal)for(var Br=this.constraints.alignmentConstraint.horizontal,jr=0;jr<Br.length;jr++)this.dummyToNodeForHorizontalAlignment.set("dummy"+jr,[]),Br[jr].forEach(function(ga){Yr.set(ga,"dummy"+jr),Mr.dummyToNodeForHorizontalAlignment.get("dummy"+jr).push(ga),Mr.fixedNodeSet.has(ga)&&Mr.fixedNodesOnVertical.add("dummy"+jr)})}if(Cr.RELAX_MOVEMENT_ON_CONSTRAINTS)this.shuffle=function(Qr){var ga,ba,_i;for(_i=Qr.length-1;_i>=2*Qr.length/3;_i--)ga=Math.floor(Math.random()*(_i+1)),ba=Qr[_i],Qr[_i]=Qr[ga],Qr[ga]=ba;return Qr},this.nodesInRelativeHorizontal=[],this.nodesInRelativeVertical=[],this.nodeToRelativeConstraintMapHorizontal=new Map,this.nodeToRelativeConstraintMapVertical=new Map,this.nodeToTempPositionMapHorizontal=new Map,this.nodeToTempPositionMapVertical=new Map,this.constraints.relativePlacementConstraint.forEach(function(Qr){if(Qr.left){var ga=Wr.has(Qr.left)?Wr.get(Qr.left):Qr.left,ba=Wr.has(Qr.right)?Wr.get(Qr.right):Qr.right;Mr.nodesInRelativeHorizontal.includes(ga)||(Mr.nodesInRelativeHorizontal.push(ga),Mr.nodeToRelativeConstraintMapHorizontal.set(ga,[]),Mr.dummyToNodeForVerticalAlignment.has(ga)?Mr.nodeToTempPositionMapHorizontal.set(ga,Mr.idToNodeMap.get(Mr.dummyToNodeForVerticalAlignment.get(ga)[0]).getCenterX()):Mr.nodeToTempPositionMapHorizontal.set(ga,Mr.idToNodeMap.get(ga).getCenterX())),Mr.nodesInRelativeHorizontal.includes(ba)||(Mr.nodesInRelativeHorizontal.push(ba),Mr.nodeToRelativeConstraintMapHorizontal.set(ba,[]),Mr.dummyToNodeForVerticalAlignment.has(ba)?Mr.nodeToTempPositionMapHorizontal.set(ba,Mr.idToNodeMap.get(Mr.dummyToNodeForVerticalAlignment.get(ba)[0]).getCenterX()):Mr.nodeToTempPositionMapHorizontal.set(ba,Mr.idToNodeMap.get(ba).getCenterX())),Mr.nodeToRelativeConstraintMapHorizontal.get(ga).push({right:ba,gap:Qr.gap}),Mr.nodeToRelativeConstraintMapHorizontal.get(ba).push({left:ga,gap:Qr.gap})}else{var _i=Yr.has(Qr.top)?Yr.get(Qr.top):Qr.top,os=Yr.has(Qr.bottom)?Yr.get(Qr.bottom):Qr.bottom;Mr.nodesInRelativeVertical.includes(_i)||(Mr.nodesInRelativeVertical.push(_i),Mr.nodeToRelativeConstraintMapVertical.set(_i,[]),Mr.dummyToNodeForHorizontalAlignment.has(_i)?Mr.nodeToTempPositionMapVertical.set(_i,Mr.idToNodeMap.get(Mr.dummyToNodeForHorizontalAlignment.get(_i)[0]).getCenterY()):Mr.nodeToTempPositionMapVertical.set(_i,Mr.idToNodeMap.get(_i).getCenterY())),Mr.nodesInRelativeVertical.includes(os)||(Mr.nodesInRelativeVertical.push(os),Mr.nodeToRelativeConstraintMapVertical.set(os,[]),Mr.dummyToNodeForHorizontalAlignment.has(os)?Mr.nodeToTempPositionMapVertical.set(os,Mr.idToNodeMap.get(Mr.dummyToNodeForHorizontalAlignment.get(os)[0]).getCenterY()):Mr.nodeToTempPositionMapVertical.set(os,Mr.idToNodeMap.get(os).getCenterY())),Mr.nodeToRelativeConstraintMapVertical.get(_i).push({bottom:os,gap:Qr.gap}),Mr.nodeToRelativeConstraintMapVertical.get(os).push({top:_i,gap:Qr.gap})}});else{var Ur=new Map,Vr=new Map;this.constraints.relativePlacementConstraint.forEach(function(Qr){if(Qr.left){var ga=Wr.has(Qr.left)?Wr.get(Qr.left):Qr.left,ba=Wr.has(Qr.right)?Wr.get(Qr.right):Qr.right;Ur.has(ga)?Ur.get(ga).push(ba):Ur.set(ga,[ba]),Ur.has(ba)?Ur.get(ba).push(ga):Ur.set(ba,[ga])}else{var _i=Yr.has(Qr.top)?Yr.get(Qr.top):Qr.top,os=Yr.has(Qr.bottom)?Yr.get(Qr.bottom):Qr.bottom;Vr.has(_i)?Vr.get(_i).push(os):Vr.set(_i,[os]),Vr.has(os)?Vr.get(os).push(_i):Vr.set(os,[_i])}});var Xr=function(ga,ba){var _i=[],os=[],ls=new Lr,ys=new Set,ns=0;return ga.forEach(function(as,Kr){if(!ys.has(Kr)){_i[ns]=[],os[ns]=!1;var $a=Kr;for(ls.push($a),ys.add($a),_i[ns].push($a);ls.length!=0;){$a=ls.shift(),ba.has($a)&&(os[ns]=!0);var ss=ga.get($a);ss.forEach(function(hs){ys.has(hs)||(ls.push(hs),ys.add(hs),_i[ns].push(hs))})}ns++}}),{components:_i,isFixed:os}},Zr=Xr(Ur,Mr.fixedNodesOnHorizontal);this.componentsOnHorizontal=Zr.components,this.fixedComponentsOnHorizontal=Zr.isFixed;var Jr=Xr(Vr,Mr.fixedNodesOnVertical);this.componentsOnVertical=Jr.components,this.fixedComponentsOnVertical=Jr.isFixed}}},Or.prototype.updateDisplacements=function(){var Mr=this;if(this.constraints.fixedNodeConstraint&&this.constraints.fixedNodeConstraint.forEach(function(Jr){var Qr=Mr.idToNodeMap.get(Jr.nodeId);Qr.displacementX=0,Qr.displacementY=0}),this.constraints.alignmentConstraint){if(this.constraints.alignmentConstraint.vertical)for(var $r=this.constraints.alignmentConstraint.vertical,jr=0;jr<$r.length;jr++){for(var Fr=0,zr=0;zr<$r[jr].length;zr++){if(this.fixedNodeSet.has($r[jr][zr])){Fr=0;break}Fr+=this.idToNodeMap.get($r[jr][zr]).displacementX}for(var Hr=Fr/$r[jr].length,zr=0;zr<$r[jr].length;zr++)this.idToNodeMap.get($r[jr][zr]).displacementX=Hr}if(this.constraints.alignmentConstraint.horizontal)for(var Wr=this.constraints.alignmentConstraint.horizontal,jr=0;jr<Wr.length;jr++){for(var Yr=0,zr=0;zr<Wr[jr].length;zr++){if(this.fixedNodeSet.has(Wr[jr][zr])){Yr=0;break}Yr+=this.idToNodeMap.get(Wr[jr][zr]).displacementY}for(var qr=Yr/Wr[jr].length,zr=0;zr<Wr[jr].length;zr++)this.idToNodeMap.get(Wr[jr][zr]).displacementY=qr}}if(this.constraints.relativePlacementConstraint)if(Cr.RELAX_MOVEMENT_ON_CONSTRAINTS)this.totalIterations%10==0&&(this.shuffle(this.nodesInRelativeHorizontal),this.shuffle(this.nodesInRelativeVertical)),this.nodesInRelativeHorizontal.forEach(function(Jr){if(!Mr.fixedNodesOnHorizontal.has(Jr)){var Qr=0;Mr.dummyToNodeForVerticalAlignment.has(Jr)?Qr=Mr.idToNodeMap.get(Mr.dummyToNodeForVerticalAlignment.get(Jr)[0]).displacementX:Qr=Mr.idToNodeMap.get(Jr).displacementX,Mr.nodeToRelativeConstraintMapHorizontal.get(Jr).forEach(function(ga){if(ga.right){var ba=Mr.nodeToTempPositionMapHorizontal.get(ga.right)-Mr.nodeToTempPositionMapHorizontal.get(Jr)-Qr;ba<ga.gap&&(Qr-=ga.gap-ba)}else{var ba=Mr.nodeToTempPositionMapHorizontal.get(Jr)-Mr.nodeToTempPositionMapHorizontal.get(ga.left)+Qr;ba<ga.gap&&(Qr+=ga.gap-ba)}}),Mr.nodeToTempPositionMapHorizontal.set(Jr,Mr.nodeToTempPositionMapHorizontal.get(Jr)+Qr),Mr.dummyToNodeForVerticalAlignment.has(Jr)?Mr.dummyToNodeForVerticalAlignment.get(Jr).forEach(function(ga){Mr.idToNodeMap.get(ga).displacementX=Qr}):Mr.idToNodeMap.get(Jr).displacementX=Qr}}),this.nodesInRelativeVertical.forEach(function(Jr){if(!Mr.fixedNodesOnHorizontal.has(Jr)){var Qr=0;Mr.dummyToNodeForHorizontalAlignment.has(Jr)?Qr=Mr.idToNodeMap.get(Mr.dummyToNodeForHorizontalAlignment.get(Jr)[0]).displacementY:Qr=Mr.idToNodeMap.get(Jr).displacementY,Mr.nodeToRelativeConstraintMapVertical.get(Jr).forEach(function(ga){if(ga.bottom){var ba=Mr.nodeToTempPositionMapVertical.get(ga.bottom)-Mr.nodeToTempPositionMapVertical.get(Jr)-Qr;ba<ga.gap&&(Qr-=ga.gap-ba)}else{var ba=Mr.nodeToTempPositionMapVertical.get(Jr)-Mr.nodeToTempPositionMapVertical.get(ga.top)+Qr;ba<ga.gap&&(Qr+=ga.gap-ba)}}),Mr.nodeToTempPositionMapVertical.set(Jr,Mr.nodeToTempPositionMapVertical.get(Jr)+Qr),Mr.dummyToNodeForHorizontalAlignment.has(Jr)?Mr.dummyToNodeForHorizontalAlignment.get(Jr).forEach(function(ga){Mr.idToNodeMap.get(ga).displacementY=Qr}):Mr.idToNodeMap.get(Jr).displacementY=Qr}});else{for(var jr=0;jr<this.componentsOnHorizontal.length;jr++){var Br=this.componentsOnHorizontal[jr];if(this.fixedComponentsOnHorizontal[jr])for(var zr=0;zr<Br.length;zr++)this.dummyToNodeForVerticalAlignment.has(Br[zr])?this.dummyToNodeForVerticalAlignment.get(Br[zr]).forEach(function(ga){Mr.idToNodeMap.get(ga).displacementX=0}):this.idToNodeMap.get(Br[zr]).displacementX=0;else{for(var Ur=0,Vr=0,zr=0;zr<Br.length;zr++)if(this.dummyToNodeForVerticalAlignment.has(Br[zr])){var Xr=this.dummyToNodeForVerticalAlignment.get(Br[zr]);Ur+=Xr.length*this.idToNodeMap.get(Xr[0]).displacementX,Vr+=Xr.length}else Ur+=this.idToNodeMap.get(Br[zr]).displacementX,Vr++;for(var Zr=Ur/Vr,zr=0;zr<Br.length;zr++)this.dummyToNodeForVerticalAlignment.has(Br[zr])?this.dummyToNodeForVerticalAlignment.get(Br[zr]).forEach(function(ga){Mr.idToNodeMap.get(ga).displacementX=Zr}):this.idToNodeMap.get(Br[zr]).displacementX=Zr}}for(var jr=0;jr<this.componentsOnVertical.length;jr++){var Br=this.componentsOnVertical[jr];if(this.fixedComponentsOnVertical[jr])for(var zr=0;zr<Br.length;zr++)this.dummyToNodeForHorizontalAlignment.has(Br[zr])?this.dummyToNodeForHorizontalAlignment.get(Br[zr]).forEach(function(ba){Mr.idToNodeMap.get(ba).displacementY=0}):this.idToNodeMap.get(Br[zr]).displacementY=0;else{for(var Ur=0,Vr=0,zr=0;zr<Br.length;zr++)if(this.dummyToNodeForHorizontalAlignment.has(Br[zr])){var Xr=this.dummyToNodeForHorizontalAlignment.get(Br[zr]);Ur+=Xr.length*this.idToNodeMap.get(Xr[0]).displacementY,Vr+=Xr.length}else Ur+=this.idToNodeMap.get(Br[zr]).displacementY,Vr++;for(var Zr=Ur/Vr,zr=0;zr<Br.length;zr++)this.dummyToNodeForHorizontalAlignment.has(Br[zr])?this.dummyToNodeForHorizontalAlignment.get(Br[zr]).forEach(function(ls){Mr.idToNodeMap.get(ls).displacementY=Zr}):this.idToNodeMap.get(Br[zr]).displacementY=Zr}}}},Or.prototype.calculateNodesToApplyGravitationTo=function(){var Mr=[],$r,jr=this.graphManager.getGraphs(),Fr=jr.length,zr;for(zr=0;zr<Fr;zr++)$r=jr[zr],$r.updateConnected(),$r.isConnected||(Mr=Mr.concat($r.getNodes()));return Mr},Or.prototype.createBendpoints=function(){var Mr=[];Mr=Mr.concat(this.graphManager.getAllEdges());var $r=new Set,jr;for(jr=0;jr<Mr.length;jr++){var Fr=Mr[jr];if(!$r.has(Fr)){var zr=Fr.getSource(),Hr=Fr.getTarget();if(zr==Hr)Fr.getBendpoints().push(new Tr),Fr.getBendpoints().push(new Tr),this.createDummyNodesForBendpoints(Fr),$r.add(Fr);else{var Wr=[];if(Wr=Wr.concat(zr.getEdgeListToNode(Hr)),Wr=Wr.concat(Hr.getEdgeListToNode(zr)),!$r.has(Wr[0])){if(Wr.length>1){var Yr;for(Yr=0;Yr<Wr.length;Yr++){var qr=Wr[Yr];qr.getBendpoints().push(new Tr),this.createDummyNodesForBendpoints(qr)}}Wr.forEach(function(Br){$r.add(Br)})}}}if($r.size==Mr.length)break}},Or.prototype.positionNodesRadially=function(Mr){for(var $r=new Ar(0,0),jr=Math.ceil(Math.sqrt(Mr.length)),Fr=0,zr=0,Hr=0,Wr=new Tr(0,0),Yr=0;Yr<Mr.length;Yr++){Yr%jr==0&&(Hr=0,zr=Fr,Yr!=0&&(zr+=Cr.DEFAULT_COMPONENT_SEPERATION),Fr=0);var qr=Mr[Yr],Br=Pr.findCenterOfTree(qr);$r.x=Hr,$r.y=zr,Wr=Or.radialLayout(qr,Br,$r),Wr.y>Fr&&(Fr=Math.floor(Wr.y)),Hr=Math.floor(Wr.x+Cr.DEFAULT_COMPONENT_SEPERATION)}this.transform(new Tr(Er.WORLD_CENTER_X-Wr.x/2,Er.WORLD_CENTER_Y-Wr.y/2))},Or.radialLayout=function(Mr,$r,jr){var Fr=Math.max(this.maxDiagonalInTree(Mr),Cr.DEFAULT_RADIAL_SEPARATION);Or.branchRadialLayout($r,null,0,359,0,Fr);var zr=Dr.calculateBounds(Mr),Hr=new Nr;Hr.setDeviceOrgX(zr.getMinX()),Hr.setDeviceOrgY(zr.getMinY()),Hr.setWorldOrgX(jr.x),Hr.setWorldOrgY(jr.y);for(var Wr=0;Wr<Mr.length;Wr++){var Yr=Mr[Wr];Yr.transform(Hr)}var qr=new Tr(zr.getMaxX(),zr.getMaxY());return Hr.inverseTransformPoint(qr)},Or.branchRadialLayout=function(Mr,$r,jr,Fr,zr,Hr){var Wr=(Fr-jr+1)/2;Wr<0&&(Wr+=180);var Yr=(Wr+jr)%360,qr=Yr*kr.TWO_PI/360,Br=zr*Math.cos(qr),Ur=zr*Math.sin(qr);Mr.setCenter(Br,Ur);var Vr=[];Vr=Vr.concat(Mr.getEdges());var Xr=Vr.length;$r!=null&&Xr--;for(var Zr=0,Jr=Vr.length,Qr,ga=Mr.getEdgesBetween($r);ga.length>1;){var ba=ga[0];ga.splice(0,1);var _i=Vr.indexOf(ba);_i>=0&&Vr.splice(_i,1),Jr--,Xr--}$r!=null?Qr=(Vr.indexOf(ga[0])+1)%Jr:Qr=0;for(var os=Math.abs(Fr-jr)/Xr,ls=Qr;Zr!=Xr;ls=++ls%Jr){var ys=Vr[ls].getOtherEnd(Mr);if(ys!=$r){var ns=(jr+Zr*os)%360,as=(ns+os)%360;Or.branchRadialLayout(ys,Mr,ns,as,zr+Hr,Hr),Zr++}}},Or.maxDiagonalInTree=function(Mr){for(var $r=_r.MIN_VALUE,jr=0;jr<Mr.length;jr++){var Fr=Mr[jr],zr=Fr.getDiagonal();zr>$r&&($r=zr)}return $r},Or.prototype.calcRepulsionRange=function(){return 2*(this.level+1)*this.idealEdgeLength},Or.prototype.groupZeroDegreeMembers=function(){var Mr=this,$r={};this.memberGroups={},this.idToDummyNode={};for(var jr=[],Fr=this.graphManager.getAllNodes(),zr=0;zr<Fr.length;zr++){var Hr=Fr[zr],Wr=Hr.getParent();this.getNodeDegreeWithChildren(Hr)===0&&(Wr.id==null||!this.getToBeTiled(Wr))&&jr.push(Hr)}for(var zr=0;zr<jr.length;zr++){var Hr=jr[zr],Yr=Hr.getParent().id;typeof $r[Yr]>"u"&&($r[Yr]=[]),$r[Yr]=$r[Yr].concat(Hr)}Object.keys($r).forEach(function(qr){if($r[qr].length>1){var Br="DummyCompound_"+qr;Mr.memberGroups[Br]=$r[qr];var Ur=$r[qr][0].getParent(),Vr=new yr(Mr.graphManager);Vr.id=Br,Vr.paddingLeft=Ur.paddingLeft||0,Vr.paddingRight=Ur.paddingRight||0,Vr.paddingBottom=Ur.paddingBottom||0,Vr.paddingTop=Ur.paddingTop||0,Mr.idToDummyNode[Br]=Vr;var Xr=Mr.getGraphManager().add(Mr.newGraph(),Vr),Zr=Ur.getChild();Zr.add(Vr);for(var Jr=0;Jr<$r[qr].length;Jr++){var Qr=$r[qr][Jr];Zr.remove(Qr),Xr.add(Qr)}}})},Or.prototype.clearCompounds=function(){var Mr={},$r={};this.performDFSOnCompounds();for(var jr=0;jr<this.compoundOrder.length;jr++)$r[this.compoundOrder[jr].id]=this.compoundOrder[jr],Mr[this.compoundOrder[jr].id]=[].concat(this.compoundOrder[jr].getChild().getNodes()),this.graphManager.remove(this.compoundOrder[jr].getChild()),this.compoundOrder[jr].child=null;this.graphManager.resetAllNodes(),this.tileCompoundMembers(Mr,$r)},Or.prototype.clearZeroDegreeMembers=function(){var Mr=this,$r=this.tiledZeroDegreePack=[];Object.keys(this.memberGroups).forEach(function(jr){var Fr=Mr.idToDummyNode[jr];if($r[jr]=Mr.tileNodes(Mr.memberGroups[jr],Fr.paddingLeft+Fr.paddingRight),Fr.rect.width=$r[jr].width,Fr.rect.height=$r[jr].height,Fr.setCenter($r[jr].centerX,$r[jr].centerY),Fr.labelMarginLeft=0,Fr.labelMarginTop=0,Cr.NODE_DIMENSIONS_INCLUDE_LABELS){var zr=Fr.rect.width,Hr=Fr.rect.height;Fr.labelWidth&&(Fr.labelPosHorizontal=="left"?(Fr.rect.x-=Fr.labelWidth,Fr.setWidth(zr+Fr.labelWidth),Fr.labelMarginLeft=Fr.labelWidth):Fr.labelPosHorizontal=="center"&&Fr.labelWidth>zr?(Fr.rect.x-=(Fr.labelWidth-zr)/2,Fr.setWidth(Fr.labelWidth),Fr.labelMarginLeft=(Fr.labelWidth-zr)/2):Fr.labelPosHorizontal=="right"&&Fr.setWidth(zr+Fr.labelWidth)),Fr.labelHeight&&(Fr.labelPosVertical=="top"?(Fr.rect.y-=Fr.labelHeight,Fr.setHeight(Hr+Fr.labelHeight),Fr.labelMarginTop=Fr.labelHeight):Fr.labelPosVertical=="center"&&Fr.labelHeight>Hr?(Fr.rect.y-=(Fr.labelHeight-Hr)/2,Fr.setHeight(Fr.labelHeight),Fr.labelMarginTop=(Fr.labelHeight-Hr)/2):Fr.labelPosVertical=="bottom"&&Fr.setHeight(Hr+Fr.labelHeight))}})},Or.prototype.repopulateCompounds=function(){for(var Mr=this.compoundOrder.length-1;Mr>=0;Mr--){var $r=this.compoundOrder[Mr],jr=$r.id,Fr=$r.paddingLeft,zr=$r.paddingTop,Hr=$r.labelMarginLeft,Wr=$r.labelMarginTop;this.adjustLocations(this.tiledMemberPack[jr],$r.rect.x,$r.rect.y,Fr,zr,Hr,Wr)}},Or.prototype.repopulateZeroDegreeMembers=function(){var Mr=this,$r=this.tiledZeroDegreePack;Object.keys($r).forEach(function(jr){var Fr=Mr.idToDummyNode[jr],zr=Fr.paddingLeft,Hr=Fr.paddingTop,Wr=Fr.labelMarginLeft,Yr=Fr.labelMarginTop;Mr.adjustLocations($r[jr],Fr.rect.x,Fr.rect.y,zr,Hr,Wr,Yr)})},Or.prototype.getToBeTiled=function(Mr){var $r=Mr.id;if(this.toBeTiled[$r]!=null)return this.toBeTiled[$r];var jr=Mr.getChild();if(jr==null)return this.toBeTiled[$r]=!1,!1;for(var Fr=jr.getNodes(),zr=0;zr<Fr.length;zr++){var Hr=Fr[zr];if(this.getNodeDegree(Hr)>0)return this.toBeTiled[$r]=!1,!1;if(Hr.getChild()==null){this.toBeTiled[Hr.id]=!1;continue}if(!this.getToBeTiled(Hr))return this.toBeTiled[$r]=!1,!1}return this.toBeTiled[$r]=!0,!0},Or.prototype.getNodeDegree=function(Mr){Mr.id;for(var $r=Mr.getEdges(),jr=0,Fr=0;Fr<$r.length;Fr++){var zr=$r[Fr];zr.getSource().id!==zr.getTarget().id&&(jr=jr+1)}return jr},Or.prototype.getNodeDegreeWithChildren=function(Mr){var $r=this.getNodeDegree(Mr);if(Mr.getChild()==null)return $r;for(var jr=Mr.getChild().getNodes(),Fr=0;Fr<jr.length;Fr++){var zr=jr[Fr];$r+=this.getNodeDegreeWithChildren(zr)}return $r},Or.prototype.performDFSOnCompounds=function(){this.compoundOrder=[],this.fillCompexOrderByDFS(this.graphManager.getRoot().getNodes())},Or.prototype.fillCompexOrderByDFS=function(Mr){for(var $r=0;$r<Mr.length;$r++){var jr=Mr[$r];jr.getChild()!=null&&this.fillCompexOrderByDFS(jr.getChild().getNodes()),this.getToBeTiled(jr)&&this.compoundOrder.push(jr)}},Or.prototype.adjustLocations=function(Mr,$r,jr,Fr,zr,Hr,Wr){$r+=Fr+Hr,jr+=zr+Wr;for(var Yr=$r,qr=0;qr<Mr.rows.length;qr++){var Br=Mr.rows[qr];$r=Yr;for(var Ur=0,Vr=0;Vr<Br.length;Vr++){var Xr=Br[Vr];Xr.rect.x=$r,Xr.rect.y=jr,$r+=Xr.rect.width+Mr.horizontalPadding,Xr.rect.height>Ur&&(Ur=Xr.rect.height)}jr+=Ur+Mr.verticalPadding}},Or.prototype.tileCompoundMembers=function(Mr,$r){var jr=this;this.tiledMemberPack=[],Object.keys(Mr).forEach(function(Fr){var zr=$r[Fr];if(jr.tiledMemberPack[Fr]=jr.tileNodes(Mr[Fr],zr.paddingLeft+zr.paddingRight),zr.rect.width=jr.tiledMemberPack[Fr].width,zr.rect.height=jr.tiledMemberPack[Fr].height,zr.setCenter(jr.tiledMemberPack[Fr].centerX,jr.tiledMemberPack[Fr].centerY),zr.labelMarginLeft=0,zr.labelMarginTop=0,Cr.NODE_DIMENSIONS_INCLUDE_LABELS){var Hr=zr.rect.width,Wr=zr.rect.height;zr.labelWidth&&(zr.labelPosHorizontal=="left"?(zr.rect.x-=zr.labelWidth,zr.setWidth(Hr+zr.labelWidth),zr.labelMarginLeft=zr.labelWidth):zr.labelPosHorizontal=="center"&&zr.labelWidth>Hr?(zr.rect.x-=(zr.labelWidth-Hr)/2,zr.setWidth(zr.labelWidth),zr.labelMarginLeft=(zr.labelWidth-Hr)/2):zr.labelPosHorizontal=="right"&&zr.setWidth(Hr+zr.labelWidth)),zr.labelHeight&&(zr.labelPosVertical=="top"?(zr.rect.y-=zr.labelHeight,zr.setHeight(Wr+zr.labelHeight),zr.labelMarginTop=zr.labelHeight):zr.labelPosVertical=="center"&&zr.labelHeight>Wr?(zr.rect.y-=(zr.labelHeight-Wr)/2,zr.setHeight(zr.labelHeight),zr.labelMarginTop=(zr.labelHeight-Wr)/2):zr.labelPosVertical=="bottom"&&zr.setHeight(Wr+zr.labelHeight))}})},Or.prototype.tileNodes=function(Mr,$r){var jr=this.tileNodesByFavoringDim(Mr,$r,!0),Fr=this.tileNodesByFavoringDim(Mr,$r,!1),zr=this.getOrgRatio(jr),Hr=this.getOrgRatio(Fr),Wr;return Hr<zr?Wr=Fr:Wr=jr,Wr},Or.prototype.getOrgRatio=function(Mr){var $r=Mr.width,jr=Mr.height,Fr=$r/jr;return Fr<1&&(Fr=1/Fr),Fr},Or.prototype.calcIdealRowWidth=function(Mr,$r){var jr=Cr.TILING_PADDING_VERTICAL,Fr=Cr.TILING_PADDING_HORIZONTAL,zr=Mr.length,Hr=0,Wr=0,Yr=0;Mr.forEach(function(Jr){Hr+=Jr.getWidth(),Wr+=Jr.getHeight(),Jr.getWidth()>Yr&&(Yr=Jr.getWidth())});var qr=Hr/zr,Br=Wr/zr,Ur=Math.pow(jr-Fr,2)+4*(qr+Fr)*(Br+jr)*zr,Vr=(Fr-jr+Math.sqrt(Ur))/(2*(qr+Fr)),Xr;$r?(Xr=Math.ceil(Vr),Xr==Vr&&Xr++):Xr=Math.floor(Vr);var Zr=Xr*(qr+Fr)-Fr;return Yr>Zr&&(Zr=Yr),Zr+=Fr*2,Zr},Or.prototype.tileNodesByFavoringDim=function(Mr,$r,jr){var Fr=Cr.TILING_PADDING_VERTICAL,zr=Cr.TILING_PADDING_HORIZONTAL,Hr=Cr.TILING_COMPARE_BY,Wr={rows:[],rowWidth:[],rowHeight:[],width:0,height:$r,verticalPadding:Fr,horizontalPadding:zr,centerX:0,centerY:0};Hr&&(Wr.idealRowWidth=this.calcIdealRowWidth(Mr,jr));var Yr=function(Qr){return Qr.rect.width*Qr.rect.height},qr=function(Qr,ga){return Yr(ga)-Yr(Qr)};Mr.sort(function(Jr,Qr){var ga=qr;return Wr.idealRowWidth?(ga=Hr,ga(Jr.id,Qr.id)):ga(Jr,Qr)});for(var Br=0,Ur=0,Vr=0;Vr<Mr.length;Vr++){var Xr=Mr[Vr];Br+=Xr.getCenterX(),Ur+=Xr.getCenterY()}Wr.centerX=Br/Mr.length,Wr.centerY=Ur/Mr.length;for(var Vr=0;Vr<Mr.length;Vr++){var Xr=Mr[Vr];if(Wr.rows.length==0)this.insertNodeToRow(Wr,Xr,0,$r);else if(this.canAddHorizontal(Wr,Xr.rect.width,Xr.rect.height)){var Zr=Wr.rows.length-1;Wr.idealRowWidth||(Zr=this.getShortestRowIndex(Wr)),this.insertNodeToRow(Wr,Xr,Zr,$r)}else this.insertNodeToRow(Wr,Xr,Wr.rows.length,$r);this.shiftToLastRow(Wr)}return Wr},Or.prototype.insertNodeToRow=function(Mr,$r,jr,Fr){var zr=Fr;if(jr==Mr.rows.length){var Hr=[];Mr.rows.push(Hr),Mr.rowWidth.push(zr),Mr.rowHeight.push(0)}var Wr=Mr.rowWidth[jr]+$r.rect.width;Mr.rows[jr].length>0&&(Wr+=Mr.horizontalPadding),Mr.rowWidth[jr]=Wr,Mr.width<Wr&&(Mr.width=Wr);var Yr=$r.rect.height;jr>0&&(Yr+=Mr.verticalPadding);var qr=0;Yr>Mr.rowHeight[jr]&&(qr=Mr.rowHeight[jr],Mr.rowHeight[jr]=Yr,qr=Mr.rowHeight[jr]-qr),Mr.height+=qr,Mr.rows[jr].push($r)},Or.prototype.getShortestRowIndex=function(Mr){for(var $r=-1,jr=Number.MAX_VALUE,Fr=0;Fr<Mr.rows.length;Fr++)Mr.rowWidth[Fr]<jr&&($r=Fr,jr=Mr.rowWidth[Fr]);return $r},Or.prototype.getLongestRowIndex=function(Mr){for(var $r=-1,jr=Number.MIN_VALUE,Fr=0;Fr<Mr.rows.length;Fr++)Mr.rowWidth[Fr]>jr&&($r=Fr,jr=Mr.rowWidth[Fr]);return $r},Or.prototype.canAddHorizontal=function(Mr,$r,jr){if(Mr.idealRowWidth){var Fr=Mr.rows.length-1,zr=Mr.rowWidth[Fr];return zr+$r+Mr.horizontalPadding<=Mr.idealRowWidth}var Hr=this.getShortestRowIndex(Mr);if(Hr<0)return!0;var Wr=Mr.rowWidth[Hr];if(Wr+Mr.horizontalPadding+$r<=Mr.width)return!0;var Yr=0;Mr.rowHeight[Hr]<jr&&Hr>0&&(Yr=jr+Mr.verticalPadding-Mr.rowHeight[Hr]);var qr;Mr.width-Wr>=$r+Mr.horizontalPadding?qr=(Mr.height+Yr)/(Wr+$r+Mr.horizontalPadding):qr=(Mr.height+Yr)/Mr.width,Yr=jr+Mr.verticalPadding;var Br;return Mr.width<$r?Br=(Mr.height+Yr)/$r:Br=(Mr.height+Yr)/Mr.width,Br<1&&(Br=1/Br),qr<1&&(qr=1/qr),qr<Br},Or.prototype.shiftToLastRow=function(Mr){var $r=this.getLongestRowIndex(Mr),jr=Mr.rowWidth.length-1,Fr=Mr.rows[$r],zr=Fr[Fr.length-1],Hr=zr.width+Mr.horizontalPadding;if(Mr.width-Mr.rowWidth[jr]>Hr&&$r!=jr){Fr.splice(-1,1),Mr.rows[jr].push(zr),Mr.rowWidth[$r]=Mr.rowWidth[$r]-Hr,Mr.rowWidth[jr]=Mr.rowWidth[jr]+Hr,Mr.width=Mr.rowWidth[instance.getLongestRowIndex(Mr)];for(var Wr=Number.MIN_VALUE,Yr=0;Yr<Fr.length;Yr++)Fr[Yr].height>Wr&&(Wr=Fr[Yr].height);$r>0&&(Wr+=Mr.verticalPadding);var qr=Mr.rowHeight[$r]+Mr.rowHeight[jr];Mr.rowHeight[$r]=Wr,Mr.rowHeight[jr]<zr.height+Mr.verticalPadding&&(Mr.rowHeight[jr]=zr.height+Mr.verticalPadding);var Br=Mr.rowHeight[$r]+Mr.rowHeight[jr];Mr.height+=Br-qr,this.shiftToLastRow(Mr)}},Or.prototype.tilingPreLayout=function(){Cr.TILE&&(this.groupZeroDegreeMembers(),this.clearCompounds(),this.clearZeroDegreeMembers())},Or.prototype.tilingPostLayout=function(){Cr.TILE&&(this.repopulateZeroDegreeMembers(),this.repopulateCompounds())},Or.prototype.reduceTrees=function(){for(var Mr=[],$r=!0,jr;$r;){var Fr=this.graphManager.getAllNodes(),zr=[];$r=!1;for(var Hr=0;Hr<Fr.length;Hr++)if(jr=Fr[Hr],jr.getEdges().length==1&&!jr.getEdges()[0].isInterGraph&&jr.getChild()==null){if(Cr.PURE_INCREMENTAL){var Wr=jr.getEdges()[0].getOtherEnd(jr),Yr=new Rr(jr.getCenterX()-Wr.getCenterX(),jr.getCenterY()-Wr.getCenterY());zr.push([jr,jr.getEdges()[0],jr.getOwner(),Yr])}else zr.push([jr,jr.getEdges()[0],jr.getOwner()]);$r=!0}if($r==!0){for(var qr=[],Br=0;Br<zr.length;Br++)zr[Br][0].getEdges().length==1&&(qr.push(zr[Br]),zr[Br][0].getOwner().remove(zr[Br][0]));Mr.push(qr),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()}}this.prunedNodesAll=Mr},Or.prototype.growTree=function(Mr){for(var $r=Mr.length,jr=Mr[$r-1],Fr,zr=0;zr<jr.length;zr++)Fr=jr[zr],this.findPlaceforPrunedNode(Fr),Fr[2].add(Fr[0]),Fr[2].add(Fr[1],Fr[1].source,Fr[1].target);Mr.splice(Mr.length-1,1),this.graphManager.resetAllNodes(),this.graphManager.resetAllEdges()},Or.prototype.findPlaceforPrunedNode=function(Mr){var $r,jr,Fr=Mr[0];if(Fr==Mr[1].source?jr=Mr[1].target:jr=Mr[1].source,Cr.PURE_INCREMENTAL)Fr.setCenter(jr.getCenterX()+Mr[3].getWidth(),jr.getCenterY()+Mr[3].getHeight());else{var zr=jr.startX,Hr=jr.finishX,Wr=jr.startY,Yr=jr.finishY,qr=0,Br=0,Ur=0,Vr=0,Xr=[qr,Ur,Br,Vr];if(Wr>0)for(var Zr=zr;Zr<=Hr;Zr++)Xr[0]+=this.grid[Zr][Wr-1].length+this.grid[Zr][Wr].length-1;if(Hr<this.grid.length-1)for(var Zr=Wr;Zr<=Yr;Zr++)Xr[1]+=this.grid[Hr+1][Zr].length+this.grid[Hr][Zr].length-1;if(Yr<this.grid[0].length-1)for(var Zr=zr;Zr<=Hr;Zr++)Xr[2]+=this.grid[Zr][Yr+1].length+this.grid[Zr][Yr].length-1;if(zr>0)for(var Zr=Wr;Zr<=Yr;Zr++)Xr[3]+=this.grid[zr-1][Zr].length+this.grid[zr][Zr].length-1;for(var Jr=_r.MAX_VALUE,Qr,ga,ba=0;ba<Xr.length;ba++)Xr[ba]<Jr?(Jr=Xr[ba],Qr=1,ga=ba):Xr[ba]==Jr&&Qr++;if(Qr==3&&Jr==0)Xr[0]==0&&Xr[1]==0&&Xr[2]==0?$r=1:Xr[0]==0&&Xr[1]==0&&Xr[3]==0?$r=0:Xr[0]==0&&Xr[2]==0&&Xr[3]==0?$r=3:Xr[1]==0&&Xr[2]==0&&Xr[3]==0&&($r=2);else if(Qr==2&&Jr==0){var _i=Math.floor(Math.random()*2);Xr[0]==0&&Xr[1]==0?_i==0?$r=0:$r=1:Xr[0]==0&&Xr[2]==0?_i==0?$r=0:$r=2:Xr[0]==0&&Xr[3]==0?_i==0?$r=0:$r=3:Xr[1]==0&&Xr[2]==0?_i==0?$r=1:$r=2:Xr[1]==0&&Xr[3]==0?_i==0?$r=1:$r=3:_i==0?$r=2:$r=3}else if(Qr==4&&Jr==0){var _i=Math.floor(Math.random()*4);$r=_i}else $r=ga;$r==0?Fr.setCenter(jr.getCenterX(),jr.getCenterY()-jr.getHeight()/2-wr.DEFAULT_EDGE_LENGTH-Fr.getHeight()/2):$r==1?Fr.setCenter(jr.getCenterX()+jr.getWidth()/2+wr.DEFAULT_EDGE_LENGTH+Fr.getWidth()/2,jr.getCenterY()):$r==2?Fr.setCenter(jr.getCenterX(),jr.getCenterY()+jr.getHeight()/2+wr.DEFAULT_EDGE_LENGTH+Fr.getHeight()/2):Fr.setCenter(jr.getCenterX()-jr.getWidth()/2-wr.DEFAULT_EDGE_LENGTH-Fr.getWidth()/2,jr.getCenterY())}},fr.exports=Or},991:(fr,pr,vr)=>{var gr=vr(551).FDLayoutNode,mr=vr(551).IMath;function br(xr,Cr,Sr,wr){gr.call(this,xr,Cr,Sr,wr)}br.prototype=Object.create(gr.prototype);for(var yr in gr)br[yr]=gr[yr];br.prototype.calculateDisplacement=function(){var xr=this.graphManager.getLayout();this.getChild()!=null&&this.fixedNodeWeight?(this.displacementX+=xr.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.fixedNodeWeight,this.displacementY+=xr.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.fixedNodeWeight):(this.displacementX+=xr.coolingFactor*(this.springForceX+this.repulsionForceX+this.gravitationForceX)/this.noOfChildren,this.displacementY+=xr.coolingFactor*(this.springForceY+this.repulsionForceY+this.gravitationForceY)/this.noOfChildren),Math.abs(this.displacementX)>xr.coolingFactor*xr.maxNodeDisplacement&&(this.displacementX=xr.coolingFactor*xr.maxNodeDisplacement*mr.sign(this.displacementX)),Math.abs(this.displacementY)>xr.coolingFactor*xr.maxNodeDisplacement&&(this.displacementY=xr.coolingFactor*xr.maxNodeDisplacement*mr.sign(this.displacementY)),this.child&&this.child.getNodes().length>0&&this.propogateDisplacementToChildren(this.displacementX,this.displacementY)},br.prototype.propogateDisplacementToChildren=function(xr,Cr){for(var Sr=this.getChild().getNodes(),wr,Er=0;Er<Sr.length;Er++)wr=Sr[Er],wr.getChild()==null?(wr.displacementX+=xr,wr.displacementY+=Cr):wr.propogateDisplacementToChildren(xr,Cr)},br.prototype.move=function(){var xr=this.graphManager.getLayout();(this.child==null||this.child.getNodes().length==0)&&(this.moveBy(this.displacementX,this.displacementY),xr.totalDisplacement+=Math.abs(this.displacementX)+Math.abs(this.displacementY)),this.springForceX=0,this.springForceY=0,this.repulsionForceX=0,this.repulsionForceY=0,this.gravitationForceX=0,this.gravitationForceY=0,this.displacementX=0,this.displacementY=0},br.prototype.setPred1=function(xr){this.pred1=xr},br.prototype.getPred1=function(){return pred1},br.prototype.getPred2=function(){return pred2},br.prototype.setNext=function(xr){this.next=xr},br.prototype.getNext=function(){return next},br.prototype.setProcessed=function(xr){this.processed=xr},br.prototype.isProcessed=function(){return processed},fr.exports=br},902:(fr,pr,vr)=>{function gr(Sr){if(Array.isArray(Sr)){for(var wr=0,Er=Array(Sr.length);wr<Sr.length;wr++)Er[wr]=Sr[wr];return Er}else return Array.from(Sr)}var mr=vr(806),br=vr(551).LinkedList,yr=vr(551).Matrix,xr=vr(551).SVD;function Cr(){}Cr.handleConstraints=function(Sr){var wr={};wr.fixedNodeConstraint=Sr.constraints.fixedNodeConstraint,wr.alignmentConstraint=Sr.constraints.alignmentConstraint,wr.relativePlacementConstraint=Sr.constraints.relativePlacementConstraint;for(var Er=new Map,Ar=new Map,Tr=[],Rr=[],Pr=Sr.getAllNodes(),_r=0,kr=0;kr<Pr.length;kr++){var Dr=Pr[kr];Dr.getChild()==null&&(Ar.set(Dr.id,_r++),Tr.push(Dr.getCenterX()),Rr.push(Dr.getCenterY()),Er.set(Dr.id,Dr))}wr.relativePlacementConstraint&&wr.relativePlacementConstraint.forEach(function(us){!us.gap&&us.gap!=0&&(us.left?us.gap=mr.DEFAULT_EDGE_LENGTH+Er.get(us.left).getWidth()/2+Er.get(us.right).getWidth()/2:us.gap=mr.DEFAULT_EDGE_LENGTH+Er.get(us.top).getHeight()/2+Er.get(us.bottom).getHeight()/2)});var Nr=function(na,ds){return{x:na.x-ds.x,y:na.y-ds.y}},Lr=function(na){var ds=0,is=0;return na.forEach(function(_a){ds+=Tr[Ar.get(_a)],is+=Rr[Ar.get(_a)]}),{x:ds/na.size,y:is/na.size}},Or=function(na,ds,is,_a,rs){function Cs(Ds,es){var ts=new Set(Ds),cs=!0,gs=!1,Ss=void 0;try{for(var As=es[Symbol.iterator](),ks;!(cs=(ks=As.next()).done);cs=!0){var js=ks.value;ts.add(js)}}catch(zs){gs=!0,Ss=zs}finally{try{!cs&&As.return&&As.return()}finally{if(gs)throw Ss}}return ts}var Es=new Map;na.forEach(function(Ds,es){Es.set(es,0)}),na.forEach(function(Ds,es){Ds.forEach(function(ts){Es.set(ts.id,Es.get(ts.id)+1)})});var Rs=new Map,xa=new Map,ps=new br;Es.forEach(function(Ds,es){Ds==0?(ps.push(es),is||(ds=="horizontal"?Rs.set(es,Ar.has(es)?Tr[Ar.get(es)]:_a.get(es)):Rs.set(es,Ar.has(es)?Rr[Ar.get(es)]:_a.get(es)))):Rs.set(es,Number.NEGATIVE_INFINITY),is&&xa.set(es,new Set([es]))}),is&&rs.forEach(function(Ds){var es=[];if(Ds.forEach(function(gs){is.has(gs)&&es.push(gs)}),es.length>0){var ts=0;es.forEach(function(gs){ds=="horizontal"?(Rs.set(gs,Ar.has(gs)?Tr[Ar.get(gs)]:_a.get(gs)),ts+=Rs.get(gs)):(Rs.set(gs,Ar.has(gs)?Rr[Ar.get(gs)]:_a.get(gs)),ts+=Rs.get(gs))}),ts=ts/es.length,Ds.forEach(function(gs){is.has(gs)||Rs.set(gs,ts)})}else{var cs=0;Ds.forEach(function(gs){ds=="horizontal"?cs+=Ar.has(gs)?Tr[Ar.get(gs)]:_a.get(gs):cs+=Ar.has(gs)?Rr[Ar.get(gs)]:_a.get(gs)}),cs=cs/Ds.length,Ds.forEach(function(gs){Rs.set(gs,cs)})}});for(var Ps=function(){var es=ps.shift(),ts=na.get(es);ts.forEach(function(cs){if(Rs.get(cs.id)<Rs.get(es)+cs.gap)if(is&&is.has(cs.id)){var gs=void 0;if(ds=="horizontal"?gs=Ar.has(cs.id)?Tr[Ar.get(cs.id)]:_a.get(cs.id):gs=Ar.has(cs.id)?Rr[Ar.get(cs.id)]:_a.get(cs.id),Rs.set(cs.id,gs),gs<Rs.get(es)+cs.gap){var Ss=Rs.get(es)+cs.gap-gs;xa.get(es).forEach(function(As){Rs.set(As,Rs.get(As)-Ss)})}}else Rs.set(cs.id,Rs.get(es)+cs.gap);Es.set(cs.id,Es.get(cs.id)-1),Es.get(cs.id)==0&&ps.push(cs.id),is&&xa.set(cs.id,Cs(xa.get(es),xa.get(cs.id)))})};ps.length!=0;)Ps();if(is){var Ms=new Set;na.forEach(function(Ds,es){Ds.length==0&&Ms.add(es)});var Ls=[];xa.forEach(function(Ds,es){if(Ms.has(es)){var ts=!1,cs=!0,gs=!1,Ss=void 0;try{for(var As=Ds[Symbol.iterator](),ks;!(cs=(ks=As.next()).done);cs=!0){var js=ks.value;is.has(js)&&(ts=!0)}}catch(qs){gs=!0,Ss=qs}finally{try{!cs&&As.return&&As.return()}finally{if(gs)throw Ss}}if(!ts){var zs=!1,Fs=void 0;Ls.forEach(function(qs,Hs){qs.has([].concat(gr(Ds))[0])&&(zs=!0,Fs=Hs)}),zs?Ds.forEach(function(qs){Ls[Fs].add(qs)}):Ls.push(new Set(Ds))}}}),Ls.forEach(function(Ds,es){var ts=Number.POSITIVE_INFINITY,cs=Number.POSITIVE_INFINITY,gs=Number.NEGATIVE_INFINITY,Ss=Number.NEGATIVE_INFINITY,As=!0,ks=!1,js=void 0;try{for(var zs=Ds[Symbol.iterator](),Fs;!(As=(Fs=zs.next()).done);As=!0){var qs=Fs.value,Hs=void 0;ds=="horizontal"?Hs=Ar.has(qs)?Tr[Ar.get(qs)]:_a.get(qs):Hs=Ar.has(qs)?Rr[Ar.get(qs)]:_a.get(qs);var Vs=Rs.get(qs);Hs<ts&&(ts=Hs),Hs>gs&&(gs=Hs),Vs<cs&&(cs=Vs),Vs>Ss&&(Ss=Vs)}}catch(ao){ks=!0,js=ao}finally{try{!As&&zs.return&&zs.return()}finally{if(ks)throw js}}var Gs=(ts+gs)/2-(cs+Ss)/2,Ws=!0,Xs=!1,Ys=void 0;try{for(var Qs=Ds[Symbol.iterator](),Js;!(Ws=(Js=Qs.next()).done);Ws=!0){var to=Js.value;Rs.set(to,Rs.get(to)+Gs)}}catch(ao){Xs=!0,Ys=ao}finally{try{!Ws&&Qs.return&&Qs.return()}finally{if(Xs)throw Ys}}})}return Rs},Ir=function(na){var ds=0,is=0,_a=0,rs=0;if(na.forEach(function(xa){xa.left?Tr[Ar.get(xa.left)]-Tr[Ar.get(xa.right)]>=0?ds++:is++:Rr[Ar.get(xa.top)]-Rr[Ar.get(xa.bottom)]>=0?_a++:rs++}),ds>is&&_a>rs)for(var Cs=0;Cs<Ar.size;Cs++)Tr[Cs]=-1*Tr[Cs],Rr[Cs]=-1*Rr[Cs];else if(ds>is)for(var Es=0;Es<Ar.size;Es++)Tr[Es]=-1*Tr[Es];else if(_a>rs)for(var Rs=0;Rs<Ar.size;Rs++)Rr[Rs]=-1*Rr[Rs]},Mr=function(na){var ds=[],is=new br,_a=new Set,rs=0;return na.forEach(function(Cs,Es){if(!_a.has(Es)){ds[rs]=[];var Rs=Es;for(is.push(Rs),_a.add(Rs),ds[rs].push(Rs);is.length!=0;){Rs=is.shift();var xa=na.get(Rs);xa.forEach(function(ps){_a.has(ps.id)||(is.push(ps.id),_a.add(ps.id),ds[rs].push(ps.id))})}rs++}}),ds},$r=function(na){var ds=new Map;return na.forEach(function(is,_a){ds.set(_a,[])}),na.forEach(function(is,_a){is.forEach(function(rs){ds.get(_a).push(rs),ds.get(rs.id).push({id:_a,gap:rs.gap,direction:rs.direction})})}),ds},jr=function(na){var ds=new Map;return na.forEach(function(is,_a){ds.set(_a,[])}),na.forEach(function(is,_a){is.forEach(function(rs){ds.get(rs.id).push({id:_a,gap:rs.gap,direction:rs.direction})})}),ds},Fr=[],zr=[],Hr=!1,Wr=!1,Yr=new Set,qr=new Map,Br=new Map,Ur=[];if(wr.fixedNodeConstraint&&wr.fixedNodeConstraint.forEach(function(us){Yr.add(us.nodeId)}),wr.relativePlacementConstraint&&(wr.relativePlacementConstraint.forEach(function(us){us.left?(qr.has(us.left)?qr.get(us.left).push({id:us.right,gap:us.gap,direction:"horizontal"}):qr.set(us.left,[{id:us.right,gap:us.gap,direction:"horizontal"}]),qr.has(us.right)||qr.set(us.right,[])):(qr.has(us.top)?qr.get(us.top).push({id:us.bottom,gap:us.gap,direction:"vertical"}):qr.set(us.top,[{id:us.bottom,gap:us.gap,direction:"vertical"}]),qr.has(us.bottom)||qr.set(us.bottom,[]))}),Br=$r(qr),Ur=Mr(Br)),mr.TRANSFORM_ON_CONSTRAINT_HANDLING){if(wr.fixedNodeConstraint&&wr.fixedNodeConstraint.length>1)wr.fixedNodeConstraint.forEach(function(us,na){Fr[na]=[us.position.x,us.position.y],zr[na]=[Tr[Ar.get(us.nodeId)],Rr[Ar.get(us.nodeId)]]}),Hr=!0;else if(wr.alignmentConstraint)(function(){var us=0;if(wr.alignmentConstraint.vertical){for(var na=wr.alignmentConstraint.vertical,ds=function(Rs){var xa=new Set;na[Rs].forEach(function(Ms){xa.add(Ms)});var ps=new Set([].concat(gr(xa)).filter(function(Ms){return Yr.has(Ms)})),Ps=void 0;ps.size>0?Ps=Tr[Ar.get(ps.values().next().value)]:Ps=Lr(xa).x,na[Rs].forEach(function(Ms){Fr[us]=[Ps,Rr[Ar.get(Ms)]],zr[us]=[Tr[Ar.get(Ms)],Rr[Ar.get(Ms)]],us++})},is=0;is<na.length;is++)ds(is);Hr=!0}if(wr.alignmentConstraint.horizontal){for(var _a=wr.alignmentConstraint.horizontal,rs=function(Rs){var xa=new Set;_a[Rs].forEach(function(Ms){xa.add(Ms)});var ps=new Set([].concat(gr(xa)).filter(function(Ms){return Yr.has(Ms)})),Ps=void 0;ps.size>0?Ps=Tr[Ar.get(ps.values().next().value)]:Ps=Lr(xa).y,_a[Rs].forEach(function(Ms){Fr[us]=[Tr[Ar.get(Ms)],Ps],zr[us]=[Tr[Ar.get(Ms)],Rr[Ar.get(Ms)]],us++})},Cs=0;Cs<_a.length;Cs++)rs(Cs);Hr=!0}wr.relativePlacementConstraint&&(Wr=!0)})();else if(wr.relativePlacementConstraint){for(var Vr=0,Xr=0,Zr=0;Zr<Ur.length;Zr++)Ur[Zr].length>Vr&&(Vr=Ur[Zr].length,Xr=Zr);if(Vr<Br.size/2)Ir(wr.relativePlacementConstraint),Hr=!1,Wr=!1;else{var Jr=new Map,Qr=new Map,ga=[];Ur[Xr].forEach(function(us){qr.get(us).forEach(function(na){na.direction=="horizontal"?(Jr.has(us)?Jr.get(us).push(na):Jr.set(us,[na]),Jr.has(na.id)||Jr.set(na.id,[]),ga.push({left:us,right:na.id})):(Qr.has(us)?Qr.get(us).push(na):Qr.set(us,[na]),Qr.has(na.id)||Qr.set(na.id,[]),ga.push({top:us,bottom:na.id}))})}),Ir(ga),Wr=!1;var ba=Or(Jr,"horizontal"),_i=Or(Qr,"vertical");Ur[Xr].forEach(function(us,na){zr[na]=[Tr[Ar.get(us)],Rr[Ar.get(us)]],Fr[na]=[],ba.has(us)?Fr[na][0]=ba.get(us):Fr[na][0]=Tr[Ar.get(us)],_i.has(us)?Fr[na][1]=_i.get(us):Fr[na][1]=Rr[Ar.get(us)]}),Hr=!0}}if(Hr){for(var os=void 0,ls=yr.transpose(Fr),ys=yr.transpose(zr),ns=0;ns<ls.length;ns++)ls[ns]=yr.multGamma(ls[ns]),ys[ns]=yr.multGamma(ys[ns]);var as=yr.multMat(ls,yr.transpose(ys)),Kr=xr.svd(as);os=yr.multMat(Kr.V,yr.transpose(Kr.U));for(var $a=0;$a<Ar.size;$a++){var ss=[Tr[$a],Rr[$a]],hs=[os[0][0],os[1][0]],vs=[os[0][1],os[1][1]];Tr[$a]=yr.dotProduct(ss,hs),Rr[$a]=yr.dotProduct(ss,vs)}Wr&&Ir(wr.relativePlacementConstraint)}}if(mr.ENFORCE_CONSTRAINTS){if(wr.fixedNodeConstraint&&wr.fixedNodeConstraint.length>0){var bs={x:0,y:0};wr.fixedNodeConstraint.forEach(function(us,na){var ds={x:Tr[Ar.get(us.nodeId)],y:Rr[Ar.get(us.nodeId)]},is=us.position,_a=Nr(is,ds);bs.x+=_a.x,bs.y+=_a.y}),bs.x/=wr.fixedNodeConstraint.length,bs.y/=wr.fixedNodeConstraint.length,Tr.forEach(function(us,na){Tr[na]+=bs.x}),Rr.forEach(function(us,na){Rr[na]+=bs.y}),wr.fixedNodeConstraint.forEach(function(us){Tr[Ar.get(us.nodeId)]=us.position.x,Rr[Ar.get(us.nodeId)]=us.position.y})}if(wr.alignmentConstraint){if(wr.alignmentConstraint.vertical)for(var xs=wr.alignmentConstraint.vertical,fs=function(na){var ds=new Set;xs[na].forEach(function(rs){ds.add(rs)});var is=new Set([].concat(gr(ds)).filter(function(rs){return Yr.has(rs)})),_a=void 0;is.size>0?_a=Tr[Ar.get(is.values().next().value)]:_a=Lr(ds).x,ds.forEach(function(rs){Yr.has(rs)||(Tr[Ar.get(rs)]=_a)})},Is=0;Is<xs.length;Is++)fs(Is);if(wr.alignmentConstraint.horizontal)for(var Os=wr.alignmentConstraint.horizontal,Us=function(na){var ds=new Set;Os[na].forEach(function(rs){ds.add(rs)});var is=new Set([].concat(gr(ds)).filter(function(rs){return Yr.has(rs)})),_a=void 0;is.size>0?_a=Rr[Ar.get(is.values().next().value)]:_a=Lr(ds).y,ds.forEach(function(rs){Yr.has(rs)||(Rr[Ar.get(rs)]=_a)})},$s=0;$s<Os.length;$s++)Us($s)}wr.relativePlacementConstraint&&function(){var us=new Map,na=new Map,ds=new Map,is=new Map,_a=new Map,rs=new Map,Cs=new Set,Es=new Set;if(Yr.forEach(function(ro){Cs.add(ro),Es.add(ro)}),wr.alignmentConstraint){if(wr.alignmentConstraint.vertical)for(var Rs=wr.alignmentConstraint.vertical,xa=function(Ks){ds.set("dummy"+Ks,[]),Rs[Ks].forEach(function(eo){us.set(eo,"dummy"+Ks),ds.get("dummy"+Ks).push(eo),Yr.has(eo)&&Cs.add("dummy"+Ks)}),_a.set("dummy"+Ks,Tr[Ar.get(Rs[Ks][0])])},ps=0;ps<Rs.length;ps++)xa(ps);if(wr.alignmentConstraint.horizontal)for(var Ps=wr.alignmentConstraint.horizontal,Ms=function(Ks){is.set("dummy"+Ks,[]),Ps[Ks].forEach(function(eo){na.set(eo,"dummy"+Ks),is.get("dummy"+Ks).push(eo),Yr.has(eo)&&Es.add("dummy"+Ks)}),rs.set("dummy"+Ks,Rr[Ar.get(Ps[Ks][0])])},Ls=0;Ls<Ps.length;Ls++)Ms(Ls)}var Ds=new Map,es=new Map,ts=function(Ks){qr.get(Ks).forEach(function(eo){var no=void 0,io=void 0;eo.direction=="horizontal"?(no=us.get(Ks)?us.get(Ks):Ks,us.get(eo.id)?io={id:us.get(eo.id),gap:eo.gap,direction:eo.direction}:io=eo,Ds.has(no)?Ds.get(no).push(io):Ds.set(no,[io]),Ds.has(io.id)||Ds.set(io.id,[])):(no=na.get(Ks)?na.get(Ks):Ks,na.get(eo.id)?io={id:na.get(eo.id),gap:eo.gap,direction:eo.direction}:io=eo,es.has(no)?es.get(no).push(io):es.set(no,[io]),es.has(io.id)||es.set(io.id,[]))})},cs=!0,gs=!1,Ss=void 0;try{for(var As=qr.keys()[Symbol.iterator](),ks;!(cs=(ks=As.next()).done);cs=!0){var js=ks.value;ts(js)}}catch(ro){gs=!0,Ss=ro}finally{try{!cs&&As.return&&As.return()}finally{if(gs)throw Ss}}var zs=$r(Ds),Fs=$r(es),qs=Mr(zs),Hs=Mr(Fs),Vs=jr(Ds),Gs=jr(es),Ws=[],Xs=[];qs.forEach(function(ro,Ks){Ws[Ks]=[],ro.forEach(function(eo){Vs.get(eo).length==0&&Ws[Ks].push(eo)})}),Hs.forEach(function(ro,Ks){Xs[Ks]=[],ro.forEach(function(eo){Gs.get(eo).length==0&&Xs[Ks].push(eo)})});var Ys=Or(Ds,"horizontal",Cs,_a,Ws),Qs=Or(es,"vertical",Es,rs,Xs),Js=function(Ks){ds.get(Ks)?ds.get(Ks).forEach(function(eo){Tr[Ar.get(eo)]=Ys.get(Ks)}):Tr[Ar.get(Ks)]=Ys.get(Ks)},to=!0,ao=!1,so=void 0;try{for(var co=Ys.keys()[Symbol.iterator](),Mo;!(to=(Mo=co.next()).done);to=!0){var wo=Mo.value;Js(wo)}}catch(ro){ao=!0,so=ro}finally{try{!to&&co.return&&co.return()}finally{if(ao)throw so}}var Xo=function(Ks){is.get(Ks)?is.get(Ks).forEach(function(eo){Rr[Ar.get(eo)]=Qs.get(Ks)}):Rr[Ar.get(Ks)]=Qs.get(Ks)},Eo=!0,Lo=!1,ho=void 0;try{for(var fo=Qs.keys()[Symbol.iterator](),po;!(Eo=(po=fo.next()).done);Eo=!0){var wo=po.value;Xo(wo)}}catch(ro){Lo=!0,ho=ro}finally{try{!Eo&&fo.return&&fo.return()}finally{if(Lo)throw ho}}}()}for(var Bs=0;Bs<Pr.length;Bs++){var Ns=Pr[Bs];Ns.getChild()==null&&Ns.setCenter(Tr[Ar.get(Ns.id)],Rr[Ar.get(Ns.id)])}},fr.exports=Cr},551:fr=>{fr.exports=lr}},cr={};function hr(fr){var pr=cr[fr];if(pr!==void 0)return pr.exports;var vr=cr[fr]={exports:{}};return ur[fr](vr,vr.exports,hr),vr.exports}var dr=hr(45);return dr})()})}(coseBase)),coseBase.exports}(function(or,ar){(function(ur,cr){or.exports=cr(requireCoseBase())})(commonjsGlobal$1,function(lr){return(()=>{var ur={658:fr=>{fr.exports=Object.assign!=null?Object.assign.bind(Object):function(pr){for(var vr=arguments.length,gr=Array(vr>1?vr-1:0),mr=1;mr<vr;mr++)gr[mr-1]=arguments[mr];return gr.forEach(function(br){Object.keys(br).forEach(function(yr){return pr[yr]=br[yr]})}),pr}},548:(fr,pr,vr)=>{var gr=function(){function yr(xr,Cr){var Sr=[],wr=!0,Er=!1,Ar=void 0;try{for(var Tr=xr[Symbol.iterator](),Rr;!(wr=(Rr=Tr.next()).done)&&(Sr.push(Rr.value),!(Cr&&Sr.length===Cr));wr=!0);}catch(Pr){Er=!0,Ar=Pr}finally{try{!wr&&Tr.return&&Tr.return()}finally{if(Er)throw Ar}}return Sr}return function(xr,Cr){if(Array.isArray(xr))return xr;if(Symbol.iterator in Object(xr))return yr(xr,Cr);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),mr=vr(140).layoutBase.LinkedList,br={};br.getTopMostNodes=function(yr){for(var xr={},Cr=0;Cr<yr.length;Cr++)xr[yr[Cr].id()]=!0;var Sr=yr.filter(function(wr,Er){typeof wr=="number"&&(wr=Er);for(var Ar=wr.parent()[0];Ar!=null;){if(xr[Ar.id()])return!1;Ar=Ar.parent()[0]}return!0});return Sr},br.connectComponents=function(yr,xr,Cr,Sr){var wr=new mr,Er=new Set,Ar=[],Tr=void 0,Rr=void 0,Pr=void 0,_r=!1,kr=1,Dr=[],Nr=[],Lr=function(){var Ir=yr.collection();Nr.push(Ir);var Mr=Cr[0],$r=yr.collection();$r.merge(Mr).merge(Mr.descendants().intersection(xr)),Ar.push(Mr),$r.forEach(function(zr){wr.push(zr),Er.add(zr),Ir.merge(zr)});for(var jr=function(){Mr=wr.shift();var Hr=yr.collection();Mr.neighborhood().nodes().forEach(function(Br){xr.intersection(Mr.edgesWith(Br)).length>0&&Hr.merge(Br)});for(var Wr=0;Wr<Hr.length;Wr++){var Yr=Hr[Wr];if(Tr=Cr.intersection(Yr.union(Yr.ancestors())),Tr!=null&&!Er.has(Tr[0])){var qr=Tr.union(Tr.descendants());qr.forEach(function(Br){wr.push(Br),Er.add(Br),Ir.merge(Br),Cr.has(Br)&&Ar.push(Br)})}}};wr.length!=0;)jr();if(Ir.forEach(function(zr){xr.intersection(zr.connectedEdges()).forEach(function(Hr){Ir.has(Hr.source())&&Ir.has(Hr.target())&&Ir.merge(Hr)})}),Ar.length==Cr.length&&(_r=!0),!_r||_r&&kr>1){Rr=Ar[0],Pr=Rr.connectedEdges().length,Ar.forEach(function(zr){zr.connectedEdges().length<Pr&&(Pr=zr.connectedEdges().length,Rr=zr)}),Dr.push(Rr.id());var Fr=yr.collection();Fr.merge(Ar[0]),Ar.forEach(function(zr){Fr.merge(zr)}),Ar=[],Cr=Cr.difference(Fr),kr++}};do Lr();while(!_r);return Sr&&Dr.length>0&&Sr.set("dummy"+(Sr.size+1),Dr),Nr},br.relocateComponent=function(yr,xr,Cr){if(!Cr.fixedNodeConstraint){var Sr=Number.POSITIVE_INFINITY,wr=Number.NEGATIVE_INFINITY,Er=Number.POSITIVE_INFINITY,Ar=Number.NEGATIVE_INFINITY;if(Cr.quality=="draft"){var Tr=!0,Rr=!1,Pr=void 0;try{for(var _r=xr.nodeIndexes[Symbol.iterator](),kr;!(Tr=(kr=_r.next()).done);Tr=!0){var Dr=kr.value,Nr=gr(Dr,2),Lr=Nr[0],Or=Nr[1],Ir=Cr.cy.getElementById(Lr);if(Ir){var Mr=Ir.boundingBox(),$r=xr.xCoords[Or]-Mr.w/2,jr=xr.xCoords[Or]+Mr.w/2,Fr=xr.yCoords[Or]-Mr.h/2,zr=xr.yCoords[Or]+Mr.h/2;$r<Sr&&(Sr=$r),jr>wr&&(wr=jr),Fr<Er&&(Er=Fr),zr>Ar&&(Ar=zr)}}}catch(Br){Rr=!0,Pr=Br}finally{try{!Tr&&_r.return&&_r.return()}finally{if(Rr)throw Pr}}var Hr=yr.x-(wr+Sr)/2,Wr=yr.y-(Ar+Er)/2;xr.xCoords=xr.xCoords.map(function(Br){return Br+Hr}),xr.yCoords=xr.yCoords.map(function(Br){return Br+Wr})}else{Object.keys(xr).forEach(function(Br){var Ur=xr[Br],Vr=Ur.getRect().x,Xr=Ur.getRect().x+Ur.getRect().width,Zr=Ur.getRect().y,Jr=Ur.getRect().y+Ur.getRect().height;Vr<Sr&&(Sr=Vr),Xr>wr&&(wr=Xr),Zr<Er&&(Er=Zr),Jr>Ar&&(Ar=Jr)});var Yr=yr.x-(wr+Sr)/2,qr=yr.y-(Ar+Er)/2;Object.keys(xr).forEach(function(Br){var Ur=xr[Br];Ur.setCenter(Ur.getCenterX()+Yr,Ur.getCenterY()+qr)})}}},br.calcBoundingBox=function(yr,xr,Cr,Sr){for(var wr=Number.MAX_SAFE_INTEGER,Er=Number.MIN_SAFE_INTEGER,Ar=Number.MAX_SAFE_INTEGER,Tr=Number.MIN_SAFE_INTEGER,Rr=void 0,Pr=void 0,_r=void 0,kr=void 0,Dr=yr.descendants().not(":parent"),Nr=Dr.length,Lr=0;Lr<Nr;Lr++){var Or=Dr[Lr];Rr=xr[Sr.get(Or.id())]-Or.width()/2,Pr=xr[Sr.get(Or.id())]+Or.width()/2,_r=Cr[Sr.get(Or.id())]-Or.height()/2,kr=Cr[Sr.get(Or.id())]+Or.height()/2,wr>Rr&&(wr=Rr),Er<Pr&&(Er=Pr),Ar>_r&&(Ar=_r),Tr<kr&&(Tr=kr)}var Ir={};return Ir.topLeftX=wr,Ir.topLeftY=Ar,Ir.width=Er-wr,Ir.height=Tr-Ar,Ir},br.calcParentsWithoutChildren=function(yr,xr){var Cr=yr.collection();return xr.nodes(":parent").forEach(function(Sr){var wr=!1;Sr.children().forEach(function(Er){Er.css("display")!="none"&&(wr=!0)}),wr||Cr.merge(Sr)}),Cr},fr.exports=br},816:(fr,pr,vr)=>{var gr=vr(548),mr=vr(140).CoSELayout,br=vr(140).CoSENode,yr=vr(140).layoutBase.PointD,xr=vr(140).layoutBase.DimensionD,Cr=vr(140).layoutBase.LayoutConstants,Sr=vr(140).layoutBase.FDLayoutConstants,wr=vr(140).CoSEConstants,Er=function(Tr,Rr){var Pr=Tr.cy,_r=Tr.eles,kr=_r.nodes(),Dr=_r.edges(),Nr=void 0,Lr=void 0,Or=void 0,Ir={};Tr.randomize&&(Nr=Rr.nodeIndexes,Lr=Rr.xCoords,Or=Rr.yCoords);var Mr=function(Br){return typeof Br=="function"},$r=function(Br,Ur){return Mr(Br)?Br(Ur):Br},jr=gr.calcParentsWithoutChildren(Pr,_r),Fr=function qr(Br,Ur,Vr,Xr){for(var Zr=Ur.length,Jr=0;Jr<Zr;Jr++){var Qr=Ur[Jr],ga=null;Qr.intersection(jr).length==0&&(ga=Qr.children());var ba=void 0,_i=Qr.layoutDimensions({nodeDimensionsIncludeLabels:Xr.nodeDimensionsIncludeLabels});if(Qr.outerWidth()!=null&&Qr.outerHeight()!=null)if(Xr.randomize)if(!Qr.isParent())ba=Br.add(new br(Vr.graphManager,new yr(Lr[Nr.get(Qr.id())]-_i.w/2,Or[Nr.get(Qr.id())]-_i.h/2),new xr(parseFloat(_i.w),parseFloat(_i.h))));else{var os=gr.calcBoundingBox(Qr,Lr,Or,Nr);Qr.intersection(jr).length==0?ba=Br.add(new br(Vr.graphManager,new yr(os.topLeftX,os.topLeftY),new xr(os.width,os.height))):ba=Br.add(new br(Vr.graphManager,new yr(os.topLeftX,os.topLeftY),new xr(parseFloat(_i.w),parseFloat(_i.h))))}else ba=Br.add(new br(Vr.graphManager,new yr(Qr.position("x")-_i.w/2,Qr.position("y")-_i.h/2),new xr(parseFloat(_i.w),parseFloat(_i.h))));else ba=Br.add(new br(this.graphManager));if(ba.id=Qr.data("id"),ba.nodeRepulsion=$r(Xr.nodeRepulsion,Qr),ba.paddingLeft=parseInt(Qr.css("padding")),ba.paddingTop=parseInt(Qr.css("padding")),ba.paddingRight=parseInt(Qr.css("padding")),ba.paddingBottom=parseInt(Qr.css("padding")),Xr.nodeDimensionsIncludeLabels&&(ba.labelWidth=Qr.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).w,ba.labelHeight=Qr.boundingBox({includeLabels:!0,includeNodes:!1,includeOverlays:!1}).h,ba.labelPosVertical=Qr.css("text-valign"),ba.labelPosHorizontal=Qr.css("text-halign")),Ir[Qr.data("id")]=ba,isNaN(ba.rect.x)&&(ba.rect.x=0),isNaN(ba.rect.y)&&(ba.rect.y=0),ga!=null&&ga.length>0){var ls=void 0;ls=Vr.getGraphManager().add(Vr.newGraph(),ba),qr(ls,ga,Vr,Xr)}}},zr=function(Br,Ur,Vr){for(var Xr=0,Zr=0,Jr=0;Jr<Vr.length;Jr++){var Qr=Vr[Jr],ga=Ir[Qr.data("source")],ba=Ir[Qr.data("target")];if(ga&&ba&&ga!==ba&&ga.getEdgesBetween(ba).length==0){var _i=Ur.add(Br.newEdge(),ga,ba);_i.id=Qr.id(),_i.idealLength=$r(Tr.idealEdgeLength,Qr),_i.edgeElasticity=$r(Tr.edgeElasticity,Qr),Xr+=_i.idealLength,Zr++}}Tr.idealEdgeLength!=null&&(Zr>0?wr.DEFAULT_EDGE_LENGTH=Sr.DEFAULT_EDGE_LENGTH=Xr/Zr:Mr(Tr.idealEdgeLength)?wr.DEFAULT_EDGE_LENGTH=Sr.DEFAULT_EDGE_LENGTH=50:wr.DEFAULT_EDGE_LENGTH=Sr.DEFAULT_EDGE_LENGTH=Tr.idealEdgeLength,wr.MIN_REPULSION_DIST=Sr.MIN_REPULSION_DIST=Sr.DEFAULT_EDGE_LENGTH/10,wr.DEFAULT_RADIAL_SEPARATION=Sr.DEFAULT_EDGE_LENGTH)},Hr=function(Br,Ur){Ur.fixedNodeConstraint&&(Br.constraints.fixedNodeConstraint=Ur.fixedNodeConstraint),Ur.alignmentConstraint&&(Br.constraints.alignmentConstraint=Ur.alignmentConstraint),Ur.relativePlacementConstraint&&(Br.constraints.relativePlacementConstraint=Ur.relativePlacementConstraint)};Tr.nestingFactor!=null&&(wr.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=Sr.PER_LEVEL_IDEAL_EDGE_LENGTH_FACTOR=Tr.nestingFactor),Tr.gravity!=null&&(wr.DEFAULT_GRAVITY_STRENGTH=Sr.DEFAULT_GRAVITY_STRENGTH=Tr.gravity),Tr.numIter!=null&&(wr.MAX_ITERATIONS=Sr.MAX_ITERATIONS=Tr.numIter),Tr.gravityRange!=null&&(wr.DEFAULT_GRAVITY_RANGE_FACTOR=Sr.DEFAULT_GRAVITY_RANGE_FACTOR=Tr.gravityRange),Tr.gravityCompound!=null&&(wr.DEFAULT_COMPOUND_GRAVITY_STRENGTH=Sr.DEFAULT_COMPOUND_GRAVITY_STRENGTH=Tr.gravityCompound),Tr.gravityRangeCompound!=null&&(wr.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=Sr.DEFAULT_COMPOUND_GRAVITY_RANGE_FACTOR=Tr.gravityRangeCompound),Tr.initialEnergyOnIncremental!=null&&(wr.DEFAULT_COOLING_FACTOR_INCREMENTAL=Sr.DEFAULT_COOLING_FACTOR_INCREMENTAL=Tr.initialEnergyOnIncremental),Tr.tilingCompareBy!=null&&(wr.TILING_COMPARE_BY=Tr.tilingCompareBy),Tr.quality=="proof"?Cr.QUALITY=2:Cr.QUALITY=0,wr.NODE_DIMENSIONS_INCLUDE_LABELS=Sr.NODE_DIMENSIONS_INCLUDE_LABELS=Cr.NODE_DIMENSIONS_INCLUDE_LABELS=Tr.nodeDimensionsIncludeLabels,wr.DEFAULT_INCREMENTAL=Sr.DEFAULT_INCREMENTAL=Cr.DEFAULT_INCREMENTAL=!Tr.randomize,wr.ANIMATE=Sr.ANIMATE=Cr.ANIMATE=Tr.animate,wr.TILE=Tr.tile,wr.TILING_PADDING_VERTICAL=typeof Tr.tilingPaddingVertical=="function"?Tr.tilingPaddingVertical.call():Tr.tilingPaddingVertical,wr.TILING_PADDING_HORIZONTAL=typeof Tr.tilingPaddingHorizontal=="function"?Tr.tilingPaddingHorizontal.call():Tr.tilingPaddingHorizontal,wr.DEFAULT_INCREMENTAL=Sr.DEFAULT_INCREMENTAL=Cr.DEFAULT_INCREMENTAL=!0,wr.PURE_INCREMENTAL=!Tr.randomize,Cr.DEFAULT_UNIFORM_LEAF_NODE_SIZES=Tr.uniformNodeDimensions,Tr.step=="transformed"&&(wr.TRANSFORM_ON_CONSTRAINT_HANDLING=!0,wr.ENFORCE_CONSTRAINTS=!1,wr.APPLY_LAYOUT=!1),Tr.step=="enforced"&&(wr.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,wr.ENFORCE_CONSTRAINTS=!0,wr.APPLY_LAYOUT=!1),Tr.step=="cose"&&(wr.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,wr.ENFORCE_CONSTRAINTS=!1,wr.APPLY_LAYOUT=!0),Tr.step=="all"&&(Tr.randomize?wr.TRANSFORM_ON_CONSTRAINT_HANDLING=!0:wr.TRANSFORM_ON_CONSTRAINT_HANDLING=!1,wr.ENFORCE_CONSTRAINTS=!0,wr.APPLY_LAYOUT=!0),Tr.fixedNodeConstraint||Tr.alignmentConstraint||Tr.relativePlacementConstraint?wr.TREE_REDUCTION_ON_INCREMENTAL=!1:wr.TREE_REDUCTION_ON_INCREMENTAL=!0;var Wr=new mr,Yr=Wr.newGraphManager();return Fr(Yr.addRoot(),gr.getTopMostNodes(kr),Wr,Tr),zr(Wr,Yr,Dr),Hr(Wr,Tr),Wr.runLayout(),Ir};fr.exports={coseLayout:Er}},212:(fr,pr,vr)=>{var gr=function(){function Tr(Rr,Pr){for(var _r=0;_r<Pr.length;_r++){var kr=Pr[_r];kr.enumerable=kr.enumerable||!1,kr.configurable=!0,"value"in kr&&(kr.writable=!0),Object.defineProperty(Rr,kr.key,kr)}}return function(Rr,Pr,_r){return Pr&&Tr(Rr.prototype,Pr),_r&&Tr(Rr,_r),Rr}}();function mr(Tr,Rr){if(!(Tr instanceof Rr))throw new TypeError("Cannot call a class as a function")}var br=vr(658),yr=vr(548),xr=vr(657),Cr=xr.spectralLayout,Sr=vr(816),wr=Sr.coseLayout,Er=Object.freeze({quality:"default",randomize:!0,animate:!0,animationDuration:1e3,animationEasing:void 0,fit:!0,padding:30,nodeDimensionsIncludeLabels:!1,uniformNodeDimensions:!1,packComponents:!0,step:"all",samplingType:!0,sampleSize:25,nodeSeparation:75,piTol:1e-7,nodeRepulsion:function(Rr){return 4500},idealEdgeLength:function(Rr){return 50},edgeElasticity:function(Rr){return .45},nestingFactor:.1,gravity:.25,numIter:2500,tile:!0,tilingCompareBy:void 0,tilingPaddingVertical:10,tilingPaddingHorizontal:10,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.3,fixedNodeConstraint:void 0,alignmentConstraint:void 0,relativePlacementConstraint:void 0,ready:function(){},stop:function(){}}),Ar=function(){function Tr(Rr){mr(this,Tr),this.options=br({},Er,Rr)}return gr(Tr,[{key:"run",value:function(){var Pr=this,_r=this.options,kr=_r.cy,Dr=_r.eles,Nr=[],Lr=[],Or=void 0,Ir=[];_r.fixedNodeConstraint&&(!Array.isArray(_r.fixedNodeConstraint)||_r.fixedNodeConstraint.length==0)&&(_r.fixedNodeConstraint=void 0),_r.alignmentConstraint&&(_r.alignmentConstraint.vertical&&(!Array.isArray(_r.alignmentConstraint.vertical)||_r.alignmentConstraint.vertical.length==0)&&(_r.alignmentConstraint.vertical=void 0),_r.alignmentConstraint.horizontal&&(!Array.isArray(_r.alignmentConstraint.horizontal)||_r.alignmentConstraint.horizontal.length==0)&&(_r.alignmentConstraint.horizontal=void 0)),_r.relativePlacementConstraint&&(!Array.isArray(_r.relativePlacementConstraint)||_r.relativePlacementConstraint.length==0)&&(_r.relativePlacementConstraint=void 0);var Mr=_r.fixedNodeConstraint||_r.alignmentConstraint||_r.relativePlacementConstraint;Mr&&(_r.tile=!1,_r.packComponents=!1);var $r=void 0,jr=!1;if(kr.layoutUtilities&&_r.packComponents&&($r=kr.layoutUtilities("get"),$r||($r=kr.layoutUtilities()),jr=!0),Dr.nodes().length>0)if(jr){var Hr=yr.getTopMostNodes(_r.eles.nodes());if(Or=yr.connectComponents(kr,_r.eles,Hr),Or.forEach(function(as){var Kr=as.boundingBox();Ir.push({x:Kr.x1+Kr.w/2,y:Kr.y1+Kr.h/2})}),_r.randomize&&Or.forEach(function(as){_r.eles=as,Nr.push(Cr(_r))}),_r.quality=="default"||_r.quality=="proof"){var Wr=kr.collection();if(_r.tile){var Yr=new Map,qr=[],Br=[],Ur=0,Vr={nodeIndexes:Yr,xCoords:qr,yCoords:Br},Xr=[];if(Or.forEach(function(as,Kr){as.edges().length==0&&(as.nodes().forEach(function($a,ss){Wr.merge(as.nodes()[ss]),$a.isParent()||(Vr.nodeIndexes.set(as.nodes()[ss].id(),Ur++),Vr.xCoords.push(as.nodes()[0].position().x),Vr.yCoords.push(as.nodes()[0].position().y))}),Xr.push(Kr))}),Wr.length>1){var Zr=Wr.boundingBox();Ir.push({x:Zr.x1+Zr.w/2,y:Zr.y1+Zr.h/2}),Or.push(Wr),Nr.push(Vr);for(var Jr=Xr.length-1;Jr>=0;Jr--)Or.splice(Xr[Jr],1),Nr.splice(Xr[Jr],1),Ir.splice(Xr[Jr],1)}}Or.forEach(function(as,Kr){_r.eles=as,Lr.push(wr(_r,Nr[Kr])),yr.relocateComponent(Ir[Kr],Lr[Kr],_r)})}else Or.forEach(function(as,Kr){yr.relocateComponent(Ir[Kr],Nr[Kr],_r)});var Qr=new Set;if(Or.length>1){var ga=[],ba=Dr.filter(function(as){return as.css("display")=="none"});Or.forEach(function(as,Kr){var $a=void 0;if(_r.quality=="draft"&&($a=Nr[Kr].nodeIndexes),as.nodes().not(ba).length>0){var ss={};ss.edges=[],ss.nodes=[];var hs=void 0;as.nodes().not(ba).forEach(function(vs){if(_r.quality=="draft")if(!vs.isParent())hs=$a.get(vs.id()),ss.nodes.push({x:Nr[Kr].xCoords[hs]-vs.boundingbox().w/2,y:Nr[Kr].yCoords[hs]-vs.boundingbox().h/2,width:vs.boundingbox().w,height:vs.boundingbox().h});else{var bs=yr.calcBoundingBox(vs,Nr[Kr].xCoords,Nr[Kr].yCoords,$a);ss.nodes.push({x:bs.topLeftX,y:bs.topLeftY,width:bs.width,height:bs.height})}else Lr[Kr][vs.id()]&&ss.nodes.push({x:Lr[Kr][vs.id()].getLeft(),y:Lr[Kr][vs.id()].getTop(),width:Lr[Kr][vs.id()].getWidth(),height:Lr[Kr][vs.id()].getHeight()})}),as.edges().forEach(function(vs){var bs=vs.source(),xs=vs.target();if(bs.css("display")!="none"&&xs.css("display")!="none")if(_r.quality=="draft"){var fs=$a.get(bs.id()),Is=$a.get(xs.id()),Os=[],Us=[];if(bs.isParent()){var $s=yr.calcBoundingBox(bs,Nr[Kr].xCoords,Nr[Kr].yCoords,$a);Os.push($s.topLeftX+$s.width/2),Os.push($s.topLeftY+$s.height/2)}else Os.push(Nr[Kr].xCoords[fs]),Os.push(Nr[Kr].yCoords[fs]);if(xs.isParent()){var Bs=yr.calcBoundingBox(xs,Nr[Kr].xCoords,Nr[Kr].yCoords,$a);Us.push(Bs.topLeftX+Bs.width/2),Us.push(Bs.topLeftY+Bs.height/2)}else Us.push(Nr[Kr].xCoords[Is]),Us.push(Nr[Kr].yCoords[Is]);ss.edges.push({startX:Os[0],startY:Os[1],endX:Us[0],endY:Us[1]})}else Lr[Kr][bs.id()]&&Lr[Kr][xs.id()]&&ss.edges.push({startX:Lr[Kr][bs.id()].getCenterX(),startY:Lr[Kr][bs.id()].getCenterY(),endX:Lr[Kr][xs.id()].getCenterX(),endY:Lr[Kr][xs.id()].getCenterY()})}),ss.nodes.length>0&&(ga.push(ss),Qr.add(Kr))}});var _i=$r.packComponents(ga,_r.randomize).shifts;if(_r.quality=="draft")Nr.forEach(function(as,Kr){var $a=as.xCoords.map(function(hs){return hs+_i[Kr].dx}),ss=as.yCoords.map(function(hs){return hs+_i[Kr].dy});as.xCoords=$a,as.yCoords=ss});else{var os=0;Qr.forEach(function(as){Object.keys(Lr[as]).forEach(function(Kr){var $a=Lr[as][Kr];$a.setCenter($a.getCenterX()+_i[os].dx,$a.getCenterY()+_i[os].dy)}),os++})}}}else{var Fr=_r.eles.boundingBox();if(Ir.push({x:Fr.x1+Fr.w/2,y:Fr.y1+Fr.h/2}),_r.randomize){var zr=Cr(_r);Nr.push(zr)}_r.quality=="default"||_r.quality=="proof"?(Lr.push(wr(_r,Nr[0])),yr.relocateComponent(Ir[0],Lr[0],_r)):yr.relocateComponent(Ir[0],Nr[0],_r)}var ls=function(Kr,$a){if(_r.quality=="default"||_r.quality=="proof"){typeof Kr=="number"&&(Kr=$a);var ss=void 0,hs=void 0,vs=Kr.data("id");return Lr.forEach(function(xs){vs in xs&&(ss={x:xs[vs].getRect().getCenterX(),y:xs[vs].getRect().getCenterY()},hs=xs[vs])}),_r.nodeDimensionsIncludeLabels&&(hs.labelWidth&&(hs.labelPosHorizontal=="left"?ss.x+=hs.labelWidth/2:hs.labelPosHorizontal=="right"&&(ss.x-=hs.labelWidth/2)),hs.labelHeight&&(hs.labelPosVertical=="top"?ss.y+=hs.labelHeight/2:hs.labelPosVertical=="bottom"&&(ss.y-=hs.labelHeight/2))),ss==null&&(ss={x:Kr.position("x"),y:Kr.position("y")}),{x:ss.x,y:ss.y}}else{var bs=void 0;return Nr.forEach(function(xs){var fs=xs.nodeIndexes.get(Kr.id());fs!=null&&(bs={x:xs.xCoords[fs],y:xs.yCoords[fs]})}),bs==null&&(bs={x:Kr.position("x"),y:Kr.position("y")}),{x:bs.x,y:bs.y}}};if(_r.quality=="default"||_r.quality=="proof"||_r.randomize){var ys=yr.calcParentsWithoutChildren(kr,Dr),ns=Dr.filter(function(as){return as.css("display")=="none"});_r.eles=Dr.not(ns),Dr.nodes().not(":parent").not(ns).layoutPositions(Pr,_r,ls),ys.length>0&&ys.forEach(function(as){as.position(ls(as))})}else console.log("If randomize option is set to false, then quality option must be 'default' or 'proof'.")}}]),Tr}();fr.exports=Ar},657:(fr,pr,vr)=>{var gr=vr(548),mr=vr(140).layoutBase.Matrix,br=vr(140).layoutBase.SVD,yr=function(Cr){var Sr=Cr.cy,wr=Cr.eles,Er=wr.nodes(),Ar=wr.nodes(":parent"),Tr=new Map,Rr=new Map,Pr=new Map,_r=[],kr=[],Dr=[],Nr=[],Lr=[],Or=[],Ir=[],Mr=[],$r=void 0,jr=1e8,Fr=1e-9,zr=Cr.piTol,Hr=Cr.samplingType,Wr=Cr.nodeSeparation,Yr=void 0,qr=function(){for(var na=0,ds=0,is=!1;ds<Yr;){na=Math.floor(Math.random()*$r),is=!1;for(var _a=0;_a<ds;_a++)if(Nr[_a]==na){is=!0;break}if(!is)Nr[ds]=na,ds++;else continue}},Br=function(na,ds,is){for(var _a=[],rs=0,Cs=0,Es=0,Rs=void 0,xa=[],ps=0,Ps=1,Ms=0;Ms<$r;Ms++)xa[Ms]=jr;for(_a[Cs]=na,xa[na]=0;Cs>=rs;){Es=_a[rs++];for(var Ls=_r[Es],Ds=0;Ds<Ls.length;Ds++)Rs=Rr.get(Ls[Ds]),xa[Rs]==jr&&(xa[Rs]=xa[Es]+1,_a[++Cs]=Rs);Or[Es][ds]=xa[Es]*Wr}if(is){for(var es=0;es<$r;es++)Or[es][ds]<Lr[es]&&(Lr[es]=Or[es][ds]);for(var ts=0;ts<$r;ts++)Lr[ts]>ps&&(ps=Lr[ts],Ps=ts)}return Ps},Ur=function(na){var ds=void 0;if(na){ds=Math.floor(Math.random()*$r);for(var _a=0;_a<$r;_a++)Lr[_a]=jr;for(var rs=0;rs<Yr;rs++)Nr[rs]=ds,ds=Br(ds,rs,na)}else{qr();for(var is=0;is<Yr;is++)Br(Nr[is],is,na)}for(var Cs=0;Cs<$r;Cs++)for(var Es=0;Es<Yr;Es++)Or[Cs][Es]*=Or[Cs][Es];for(var Rs=0;Rs<Yr;Rs++)Ir[Rs]=[];for(var xa=0;xa<Yr;xa++)for(var ps=0;ps<Yr;ps++)Ir[xa][ps]=Or[Nr[ps]][xa]},Vr=function(){for(var na=br.svd(Ir),ds=na.S,is=na.U,_a=na.V,rs=ds[0]*ds[0]*ds[0],Cs=[],Es=0;Es<Yr;Es++){Cs[Es]=[];for(var Rs=0;Rs<Yr;Rs++)Cs[Es][Rs]=0,Es==Rs&&(Cs[Es][Rs]=ds[Es]/(ds[Es]*ds[Es]+rs/(ds[Es]*ds[Es])))}Mr=mr.multMat(mr.multMat(_a,Cs),mr.transpose(is))},Xr=function(){for(var na=void 0,ds=void 0,is=[],_a=[],rs=[],Cs=[],Es=0;Es<$r;Es++)is[Es]=Math.random(),_a[Es]=Math.random();is=mr.normalize(is),_a=mr.normalize(_a);for(var Rs=Fr,xa=Fr,ps=void 0;;){for(var Ps=0;Ps<$r;Ps++)rs[Ps]=is[Ps];if(is=mr.multGamma(mr.multL(mr.multGamma(rs),Or,Mr)),na=mr.dotProduct(rs,is),is=mr.normalize(is),Rs=mr.dotProduct(rs,is),ps=Math.abs(Rs/xa),ps<=1+zr&&ps>=1)break;xa=Rs}for(var Ms=0;Ms<$r;Ms++)rs[Ms]=is[Ms];for(xa=Fr;;){for(var Ls=0;Ls<$r;Ls++)Cs[Ls]=_a[Ls];if(Cs=mr.minusOp(Cs,mr.multCons(rs,mr.dotProduct(rs,Cs))),_a=mr.multGamma(mr.multL(mr.multGamma(Cs),Or,Mr)),ds=mr.dotProduct(Cs,_a),_a=mr.normalize(_a),Rs=mr.dotProduct(Cs,_a),ps=Math.abs(Rs/xa),ps<=1+zr&&ps>=1)break;xa=Rs}for(var Ds=0;Ds<$r;Ds++)Cs[Ds]=_a[Ds];kr=mr.multCons(rs,Math.sqrt(Math.abs(na))),Dr=mr.multCons(Cs,Math.sqrt(Math.abs(ds)))};gr.connectComponents(Sr,wr,gr.getTopMostNodes(Er),Tr),Ar.forEach(function(us){gr.connectComponents(Sr,wr,gr.getTopMostNodes(us.descendants().intersection(wr)),Tr)});for(var Zr=0,Jr=0;Jr<Er.length;Jr++)Er[Jr].isParent()||Rr.set(Er[Jr].id(),Zr++);var Qr=!0,ga=!1,ba=void 0;try{for(var _i=Tr.keys()[Symbol.iterator](),os;!(Qr=(os=_i.next()).done);Qr=!0){var ls=os.value;Rr.set(ls,Zr++)}}catch(us){ga=!0,ba=us}finally{try{!Qr&&_i.return&&_i.return()}finally{if(ga)throw ba}}for(var ys=0;ys<Rr.size;ys++)_r[ys]=[];Ar.forEach(function(us){for(var na=us.children().intersection(wr);na.nodes(":childless").length==0;)na=na.nodes()[0].children().intersection(wr);var ds=0,is=na.nodes(":childless")[0].connectedEdges().length;na.nodes(":childless").forEach(function(_a,rs){_a.connectedEdges().length<is&&(is=_a.connectedEdges().length,ds=rs)}),Pr.set(us.id(),na.nodes(":childless")[ds].id())}),Er.forEach(function(us){var na=void 0;us.isParent()?na=Rr.get(Pr.get(us.id())):na=Rr.get(us.id()),us.neighborhood().nodes().forEach(function(ds){wr.intersection(us.edgesWith(ds)).length>0&&(ds.isParent()?_r[na].push(Pr.get(ds.id())):_r[na].push(ds.id()))})});var ns=function(na){var ds=Rr.get(na),is=void 0;Tr.get(na).forEach(function(_a){Sr.getElementById(_a).isParent()?is=Pr.get(_a):is=_a,_r[ds].push(is),_r[Rr.get(is)].push(na)})},as=!0,Kr=!1,$a=void 0;try{for(var ss=Tr.keys()[Symbol.iterator](),hs;!(as=(hs=ss.next()).done);as=!0){var vs=hs.value;ns(vs)}}catch(us){Kr=!0,$a=us}finally{try{!as&&ss.return&&ss.return()}finally{if(Kr)throw $a}}$r=Rr.size;var bs=void 0;if($r>2){Yr=$r<Cr.sampleSize?$r:Cr.sampleSize;for(var xs=0;xs<$r;xs++)Or[xs]=[];for(var fs=0;fs<Yr;fs++)Mr[fs]=[];return Cr.quality=="draft"||Cr.step=="all"?(Ur(Hr),Vr(),Xr(),bs={nodeIndexes:Rr,xCoords:kr,yCoords:Dr}):(Rr.forEach(function(us,na){kr.push(Sr.getElementById(na).position("x")),Dr.push(Sr.getElementById(na).position("y"))}),bs={nodeIndexes:Rr,xCoords:kr,yCoords:Dr}),bs}else{var Is=Rr.keys(),Os=Sr.getElementById(Is.next().value),Us=Os.position(),$s=Os.outerWidth();if(kr.push(Us.x),Dr.push(Us.y),$r==2){var Bs=Sr.getElementById(Is.next().value),Ns=Bs.outerWidth();kr.push(Us.x+$s/2+Ns/2+Cr.idealEdgeLength),Dr.push(Us.y)}return bs={nodeIndexes:Rr,xCoords:kr,yCoords:Dr},bs}};fr.exports={spectralLayout:yr}},579:(fr,pr,vr)=>{var gr=vr(212),mr=function(yr){yr&&yr("layout","fcose",gr)};typeof cytoscape<"u"&&mr(cytoscape),fr.exports=mr},140:fr=>{fr.exports=lr}},cr={};function hr(fr){var pr=cr[fr];if(pr!==void 0)return pr.exports;var vr=cr[fr]={exports:{}};return ur[fr](vr,vr.exports,hr),vr.exports}var dr=hr(579);return dr})()})})(cytoscapeFcose);var cytoscapeFcoseExports=cytoscapeFcose.exports;const fcose=getDefaultExportFromCjs$1(cytoscapeFcoseExports);cytoscape$1.use(edgehandles);cytoscape$1.use(fcose);const RELATIONSHIP_COLORS$1={family:"#007AFF",romantic:"#FF3B30",conflict:"#FF9500",professional:"#34C759",friendship:"#5AC8FA",other:"#8E8E93"},NODE_COLORS={active:"#007AFF",recent:"#5856D6",inactive:"#D1D1D6",new:"#30D158",dead:"#8E8E93"};function CytoscapeCharacterMap({characters:or,currentChapter:ar,onCharacterSelect:lr,className:ur=""}){const cr=reactExports.useRef(null),hr=reactExports.useRef(null),[dr,fr]=reactExports.useState(!1),[pr,vr]=reactExports.useState(new Map),[gr,mr]=reactExports.useState({width:0,height:0});reactExports.useEffect(()=>{const kr=()=>{if(cr.current){const Dr=cr.current.getBoundingClientRect(),Nr={width:Dr.width||window.innerWidth-100,height:Dr.height||Math.max(400,window.innerHeight-300)};mr(Nr),hr.current&&hr.current.resize()}};return kr(),window.addEventListener("resize",kr),window.addEventListener("orientationchange",()=>{setTimeout(kr,100)}),()=>{window.removeEventListener("resize",kr),window.removeEventListener("orientationchange",kr)}},[]);const br=kr=>kr.firstAppearance===ar,yr=kr=>ar-kr.lastMentioned>3,xr=kr=>kr.status==="Dead"?NODE_COLORS.dead:br(kr)?NODE_COLORS.new:yr(kr)?NODE_COLORS.inactive:ar-kr.lastMentioned<=1?NODE_COLORS.active:NODE_COLORS.recent,Cr=kr=>{if(kr.status==="Dead")return .4;if(yr(kr))return .6;switch(kr.relevance){case"Major":return 1;case"Supporting":return .9;case"Minor":return .7;default:return 1}},Sr=(kr,Dr)=>{if(Dr===0)return{width:100,height:35};const Nr=window.innerWidth<768||"ontouchstart"in window,Lr=Math.log(kr.mentionCount+1)/Math.log(Dr+1);let Or=Nr?25+Lr*30:30+Lr*40;const Ir=kr.relevance==="Major"?1.2:kr.relevance==="Supporting"?1:.8;Or*=Ir,yr(kr)&&(Or*=.7);const Mr=kr.name.length,$r=Nr?6:8,jr=Nr?16:24,Fr=Mr*$r+jr,zr=Math.max(Fr,Or*1.8),Hr=Math.max(Or*.7,32);return{width:Math.max(zr,80),height:Math.max(Hr,32)}},wr=()=>{const kr=or.filter(Mr=>Mr.firstAppearance<=ar),Dr=Math.max(...kr.map(Mr=>Mr.mentionCount),1),Nr=kr.map(Mr=>{const $r=Sr(Mr,Dr),jr=xr(Mr),Fr=Cr(Mr);return{data:{id:Mr.id,label:Mr.name,character:Mr,width:$r.width,height:$r.height,color:jr,opacity:Fr}}}),Lr=[],Or=new Map(kr.map(Mr=>[Mr.id,Mr])),Ir=new Set;return kr.forEach(Mr=>{Mr.relationships.forEach($r=>{if($r.establishedInChapter<=ar&&Or.get($r.targetCharacterId)){const Fr=Mr.id<$r.targetCharacterId?`${Mr.id}-${$r.targetCharacterId}`:`${$r.targetCharacterId}-${Mr.id}`;if(Ir.has(Fr))return;Lr.push({data:{id:Fr,source:Mr.id,target:$r.targetCharacterId,relationship:$r,color:RELATIONSHIP_COLORS$1[$r.type],label:""}}),Ir.add(Fr)}})}),{nodes:Nr,edges:Lr}},Er=()=>{if(!cr.current||dr)return;const{nodes:kr,edges:Dr}=wr();if(kr.length===0)return;const Nr=cytoscape$1({container:cr.current,elements:[...kr,...Dr],style:[{selector:"node",style:{width:"data(width)",height:"data(height)","background-color":"data(color)","border-width":0,label:"data(label)","text-valign":"center","text-halign":"center",color:Mr=>{const $r=Mr.data("character");return!$r||$r.status==="Dead"||yr($r)?"#000000":"#FFFFFF"},"font-family":'-apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", sans-serif',"font-size":Mr=>{const $r=Mr.data("height");return Math.max(Math.min($r*.4,14),10)},"font-weight":"600","text-wrap":"wrap","text-max-width":Mr=>Mr.data("width")-16,opacity:Mr=>Mr.data("opacity"),shape:"round-rectangle","border-radius":"12px","overlay-padding":"8px","shadow-blur":"8","shadow-color":"#000000","shadow-opacity":.1,"shadow-offset-x":"0","shadow-offset-y":"2"}},{selector:"node[character.firstAppearance = "+ar+"]",style:{"shadow-blur":"12","shadow-color":"#30D158","shadow-opacity":.4,"shadow-offset-x":"0","shadow-offset-y":"0"}},{selector:'node[character.status = "Dead"]',style:{"background-color":"#F2F2F7",color:"#8E8E93","shadow-opacity":.05}},{selector:"edge",style:{width:4,"line-color":"data(color)","target-arrow-shape":"none","source-arrow-shape":"none","curve-style":"straight",opacity:.85,label:"","text-opacity":0}},{selector:"node:hover",style:{"shadow-blur":"16","shadow-color":"#000000","shadow-opacity":.2,"shadow-offset-y":"4","z-index":10,transform:"scale(1.05)"}},{selector:"edge:hover",style:{width:3,opacity:1,"z-index":10,"font-weight":"600"}},{selector:"node:selected",style:{"shadow-blur":"20","shadow-color":"#007AFF","shadow-opacity":.5,"shadow-offset-x":"0","shadow-offset-y":"0","z-index":999,transform:"scale(1.1)"}},{selector:"node.merge-selected",style:{"shadow-blur":"25","shadow-color":"#FF9500","shadow-opacity":.8,"shadow-offset-x":"0","shadow-offset-y":"0","z-index":998,transform:"scale(1.15)","border-width":"3px","border-color":"#FF9500","border-opacity":.9}},{selector:"edge:selected, edge.highlighted",style:{width:3,opacity:1,"font-weight":"600"}}],layout:{name:"fcose",animate:!1,quality:"proof",randomize:!0,nodeRepulsion:Mr=>2e4,idealEdgeLength:Mr=>300,edgeElasticity:Mr=>.3,nodeSeparation:150,fit:!0,padding:50,samplingType:!0,sampleSize:25,uniformNodeDimensions:!1,numIter:3e3,tile:!1,tilingPaddingVertical:20,tilingPaddingHorizontal:20,gravity:.1,gravityRangeCompound:1.5,gravityCompound:1,gravityRange:3.8,initialEnergyOnIncremental:.3},minZoom:.3,maxZoom:2.5,zoomingEnabled:!0,userZoomingEnabled:!0,panningEnabled:!0,userPanningEnabled:!0,boxSelectionEnabled:!1,selectionType:"single",touchTapThreshold:6,desktopTapThreshold:3,autolock:!1,autoungrabify:!1,autounselectify:!1,wheelSensitivity:.2});Nr.nodes().forEach(Mr=>{const $r=pr.get(Mr.id());$r&&Mr.position($r)}),Nr.on("tap","node",Mr=>{const jr=Mr.target.data("character");jr&&lr(jr)});let Lr=0,Or=null,Ir=null;Nr.on("tap","node",Mr=>{const $r=new Date().getTime(),jr=Mr.target;if($r-Lr<300&&Or&&Or.id()===jr.id())Ir&&Ir.id()===jr.id()?(Ir.removeClass("merge-selected"),Ir=null,Rr("Merge selection cancelled","info")):(Ir&&Ir.removeClass("merge-selected"),Ir=jr,jr.addClass("merge-selected"),Rr(`"${jr.data("character").name}" selected for merge. Tap another character to merge with.`,"merge"));else if(Ir&&Ir.id()!==jr.id())Tr(Ir.data("character"),jr.data("character")),Ir.removeClass("merge-selected"),Ir=null;else{const zr=jr.data("character");zr&&lr(zr)}Lr=$r,Or=jr}),Nr.on("free","node",Mr=>{const $r=Mr.target.position();vr(jr=>new Map(jr.set(Mr.target.id(),$r)))}),Nr.on("layoutstop",()=>{const Mr=new Map;Nr.nodes().forEach($r=>{Mr.set($r.id(),$r.position())}),vr(Mr)}),Nr.on("mouseover","node",Mr=>{const jr=Mr.target.data("character");if(jr){const Fr=document.createElement("div");Fr.className="character-tooltip",Fr.style.cssText=`
          position: absolute;
          background: rgba(28, 28, 30, 0.98);
          color: #FFFFFF;
          padding: 16px 20px;
          border-radius: 14px;
          font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
          font-size: 15px;
          font-weight: 400;
          line-height: 1.4;
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3), 0 0 0 0.5px rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(20px);
          border: 0.5px solid rgba(255, 255, 255, 0.15);
          pointer-events: none;
          z-index: 9999;
          max-width: 220px;
          transform: translateY(-8px);
        `,Fr.innerHTML=`
          <div style="font-weight: 600; font-size: 16px; margin-bottom: 8px; color: #FFFFFF;">${jr.name}</div>
          <div style="font-size: 13px; color: #E5E5E7; line-height: 1.5;">
            <div style="margin-bottom: 3px;">Status: <span style="color: #FFFFFF;">${jr.status}</span></div>
            <div style="margin-bottom: 3px;">Mentions: <span style="color: #FFFFFF;">${jr.mentionCount}</span></div>
            <div>Relevance: <span style="color: #FFFFFF;">${jr.relevance}</span></div>
          </div>
        `,document.body.appendChild(Fr);const zr=Hr=>{Fr.style.left=Hr.clientX+15+"px",Fr.style.top=Hr.clientY-10+"px"};document.addEventListener("mousemove",zr),Fr.cleanup=()=>{document.removeEventListener("mousemove",zr),document.body.removeChild(Fr)}}}),Nr.on("mouseout","node",()=>{document.querySelectorAll(".character-tooltip").forEach(Mr=>{Mr.cleanup?Mr.cleanup():Mr.remove()})}),hr.current=Nr,fr(!0)},Ar=()=>{if(!hr.current||!dr)return;const{nodes:kr,edges:Dr}=wr(),Nr=hr.current;Nr.elements().remove(),Nr.add([...kr,...Dr]),Nr.layout({name:"fcose",animate:!1,randomize:!1,fit:!0,padding:50,nodeRepulsion:15e3,idealEdgeLength:250,numIter:1e3}).run()};reactExports.useEffect(()=>{dr?Ar():Er()},[or,ar,gr,dr]),reactExports.useEffect(()=>{if(dr&&or.length>0){const kr=setTimeout(()=>{_r()},500);return()=>clearTimeout(kr)}},[or.length]);const Tr=async(kr,Dr)=>{const Nr=`Merge "${kr.name}" into "${Dr.name}"?

This will:
 Combine their relationships and chapter history
 Add "${kr.name}" as an alias for "${Dr.name}"
 Delete the "${kr.name}" character

This action cannot be undone.`;if(window.confirm(Nr))try{const{characterService:Lr}=await __vitePreload(async()=>{const{characterService:Or}=await Promise.resolve().then(()=>services);return{characterService:Or}},void 0);await Lr.mergeCharacters(kr.id,Dr.id),hr.current&&(hr.current.destroy(),fr(!1)),Rr(`Successfully merged "${kr.name}" into "${Dr.name}"`,"success")}catch(Lr){console.error("Character merge failed:",Lr),Rr(`Failed to merge characters: ${Lr instanceof Error?Lr.message:"Unknown error"}`,"error")}},Rr=(kr,Dr)=>{document.querySelectorAll(".merge-tooltip").forEach(Or=>Or.remove());const Nr=document.createElement("div");Nr.className="merge-tooltip";const Lr={merge:{bg:"rgba(255, 149, 0, 0.95)",border:"#FF9500"},success:{bg:"rgba(52, 199, 89, 0.95)",border:"#34C759"},error:{bg:"rgba(255, 59, 48, 0.95)",border:"#FF3B30"},info:{bg:"rgba(0, 122, 255, 0.95)",border:"#007AFF"}};Nr.style.cssText=`
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: ${Lr[Dr].bg};
      color: white;
      padding: 16px 24px;
      border-radius: 12px;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif;
      font-size: 15px;
      font-weight: 500;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      border: 2px solid ${Lr[Dr].border};
      z-index: 10000;
      max-width: 90vw;
      text-align: center;
      backdrop-filter: blur(10px);
    `,Nr.textContent=kr,document.body.appendChild(Nr),setTimeout(()=>{Nr.parentNode&&(Nr.style.opacity="0",Nr.style.transform="translateX(-50%) translateY(-20px)",setTimeout(()=>Nr.remove(),300))},Dr==="merge"?4e3:2500)},Pr=()=>{if(!hr.current)return;const kr=hr.current;Rr("Reordering nodes...","info"),kr.nodes().removeClass("merge-selected");const Dr=kr.layout({name:"fcose",animate:!0,animationDuration:1e3,animationEasing:"ease-out-cubic",quality:"proof",randomize:!1,nodeRepulsion:Nr=>25e3,idealEdgeLength:Nr=>350,edgeElasticity:Nr=>.2,nodeSeparation:200,fit:!0,padding:60,samplingType:!0,sampleSize:30,numIter:4e3,gravity:.05,gravityRangeCompound:2,gravityCompound:.8,gravityRange:4.5,initialEnergyOnIncremental:.2,tile:!0,tilingPaddingVertical:50,tilingPaddingHorizontal:50});Dr.run(),Dr.one("layoutstop",()=>{const Nr=new Map;kr.nodes().forEach(Lr=>{const Or=Lr.position();Nr.set(Lr.id(),Or)}),vr(Nr),Rr("Nodes reordered successfully!","success")})},_r=()=>{if(!hr.current)return;const kr=hr.current;Rr("Randomizing and reordering...","info"),kr.nodes().removeClass("merge-selected");const Dr=kr.layout({name:"fcose",animate:!0,animationDuration:1200,animationEasing:"ease-out-cubic",quality:"proof",randomize:!0,nodeRepulsion:Nr=>3e4,idealEdgeLength:Nr=>400,edgeElasticity:Nr=>.15,nodeSeparation:250,fit:!0,padding:60,samplingType:!0,sampleSize:35,numIter:5e3,gravity:.02,gravityRangeCompound:2.5,gravityCompound:.6,gravityRange:5,initialEnergyOnIncremental:.1,tile:!0,tilingPaddingVertical:75,tilingPaddingHorizontal:75});Dr.run(),Dr.one("layoutstop",()=>{const Nr=new Map;kr.nodes().forEach(Lr=>{const Or=Lr.position();Nr.set(Lr.id(),Or)}),vr(Nr),Rr("Nodes randomized and reordered successfully!","success")})};return reactExports.useEffect(()=>()=>{hr.current&&hr.current.destroy(),document.querySelectorAll(".character-tooltip").forEach(kr=>{kr.remove()})},[]),jsxRuntimeExports.jsxs("div",{className:`character-map-container relative w-full h-full ${ur}`,children:[jsxRuntimeExports.jsx("div",{ref:cr,style:{width:"100%",height:"100%",borderRadius:"16px",background:"#FFFFFF",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",border:"1px solid rgba(0, 0, 0, 0.06)",overflow:"hidden"}}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-4 right-4 flex flex-col space-y-2 z-20",children:[jsxRuntimeExports.jsx("button",{onClick:Pr,title:"Reorganize nodes using fCoSE algorithm for better spacing",className:"px-3 py-2 bg-green-500 hover:bg-green-600 active:bg-green-700 text-white text-xs font-medium rounded-lg transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif'},children:" Reorder"}),jsxRuntimeExports.jsx("button",{onClick:_r,title:"Randomize positions and apply fCoSE layout for fresh arrangement",className:"px-4 py-2.5 bg-purple-500 hover:bg-purple-600 active:bg-purple-700 text-white text-sm font-medium rounded-lg transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95",style:{fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif',minWidth:"100px"},children:" Randomize"})]}),jsxRuntimeExports.jsxs("div",{className:"absolute bottom-6 left-6 bg-white bg-opacity-95 backdrop-blur-sm rounded-lg shadow-lg p-4 z-20",style:{fontSize:"12px",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif',minWidth:"160px"},children:[jsxRuntimeExports.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2 uppercase tracking-wide",children:"Relationship Types"}),jsxRuntimeExports.jsxs("div",{className:"space-y-1.5",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-0.5",style:{backgroundColor:RELATIONSHIP_COLORS$1.family,borderRadius:"2px"}}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600",children:"Family"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-0.5",style:{backgroundColor:RELATIONSHIP_COLORS$1.friendship,borderRadius:"2px"}}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600",children:"Friendship"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-0.5",style:{backgroundColor:RELATIONSHIP_COLORS$1.conflict,borderRadius:"2px"}}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600",children:"Conflict"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-0.5",style:{backgroundColor:RELATIONSHIP_COLORS$1.romantic,borderRadius:"2px"}}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600",children:"Romantic"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-0.5",style:{backgroundColor:RELATIONSHIP_COLORS$1.professional,borderRadius:"2px"}}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600",children:"Professional"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-0.5",style:{backgroundColor:RELATIONSHIP_COLORS$1.other,borderRadius:"2px"}}),jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-600",children:"Other"})]})]})]}),or.length===0&&jsxRuntimeExports.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{width:gr.width||"100%",height:gr.height||400,color:"#8E8E93",fontSize:"17px",fontFamily:'-apple-system, BlinkMacSystemFont, "SF Pro Text", "Helvetica Neue", sans-serif',fontWeight:"400"},children:"No characters found yet. Analyze a chapter to get started."})]})}const RELATIONSHIP_COLORS={family:"#3B82F6",romantic:"#EF4444",conflict:"#991B1B",professional:"#10B981",friendship:"#F59E0B",other:"#6B7280"},RELATIONSHIP_LABELS={family:"Family",romantic:"Romance",conflict:"Conflict",professional:"Professional",friendship:"Friendship",other:"Other"};function CharacterDetail({character:or,characters:ar,currentChapter:lr,onClose:ur}){const cr=pr=>ar.find(vr=>vr.id===pr),hr=pr=>{switch(pr){case"Dead":return jsxRuntimeExports.jsx("span",{className:"text-red-600",children:""});case"Alive":return jsxRuntimeExports.jsx("span",{className:"text-green-600",children:""});default:return jsxRuntimeExports.jsx("span",{className:"text-gray-400",children:""})}},dr=or.relationships.filter(pr=>pr.establishedInChapter<=lr),fr=or.chapterHistory.filter(pr=>pr.chapter<=lr);return jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-sm border h-full flex flex-col overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"p-2 sm:p-4 border-b flex-shrink-0",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900 truncate",children:or.name}),hr(or.status)]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 text-xs sm:text-sm text-gray-600",children:[jsxRuntimeExports.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${or.relevance==="Major"?"bg-blue-100 text-blue-800":or.relevance==="Supporting"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:or.relevance}),jsxRuntimeExports.jsxs("span",{children:["First appeared: Ch. ",or.firstAppearance]})]})]}),jsxRuntimeExports.jsx("button",{onClick:ur,className:"text-gray-400 hover:text-gray-600 transition-colors p-1",title:"Close character details",children:jsxRuntimeExports.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 p-2 sm:p-4 space-y-4 sm:space-y-6 overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Information"}),jsxRuntimeExports.jsxs("div",{className:"space-y-2 text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Occupation:"}),jsxRuntimeExports.jsx("span",{className:"text-gray-900",children:or.occupation||"Unknown"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Age:"}),jsxRuntimeExports.jsx("span",{className:"text-gray-900",children:or.age||"Unknown"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Location:"}),jsxRuntimeExports.jsx("span",{className:"text-gray-900",children:or.location||"Unknown"})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Status:"}),jsxRuntimeExports.jsx("span",{className:`font-medium ${or.status==="Alive"?"text-green-600":or.status==="Dead"?"text-red-600":"text-gray-500"}`,children:or.status})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"First Appearance:"}),jsxRuntimeExports.jsxs("span",{className:"text-gray-900",children:["Chapter ",or.firstAppearance]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("span",{className:"text-gray-600",children:"Last Mentioned:"}),jsxRuntimeExports.jsxs("span",{className:"text-gray-900",children:["Chapter ",or.lastMentioned]})]})]})]}),dr.length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Relationships"}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:dr.map((pr,vr)=>{const gr=cr(pr.targetCharacterId);return gr?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded-md text-sm",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2",children:[jsxRuntimeExports.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:RELATIONSHIP_COLORS[pr.type]}}),jsxRuntimeExports.jsx("span",{className:"font-medium",children:gr.name})]}),jsxRuntimeExports.jsxs("div",{className:"text-right",children:[jsxRuntimeExports.jsx("div",{className:"font-medium text-gray-700",children:pr.description}),jsxRuntimeExports.jsx("div",{className:"text-xs text-gray-500",children:RELATIONSHIP_LABELS[pr.type]})]})]},vr):null})})]}),fr.length>0&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Chapter History"}),jsxRuntimeExports.jsx("div",{className:"space-y-3",children:fr.map((pr,vr)=>jsxRuntimeExports.jsxs("div",{className:"border-l-2 border-blue-200 pl-3",children:[jsxRuntimeExports.jsxs("div",{className:"font-medium text-sm text-blue-600 mb-1",children:["Chapter ",pr.chapter]}),jsxRuntimeExports.jsx("ul",{className:"space-y-1",children:pr.updates.map((gr,mr)=>jsxRuntimeExports.jsxs("li",{className:"text-sm text-gray-600",children:[" ",gr]},mr))})]},vr))})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 rounded-md p-3",children:[jsxRuntimeExports.jsx("h3",{className:"font-medium text-gray-900 mb-2 text-sm",children:"Statistics"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 gap-4 text-xs",children:[jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"font-semibold text-blue-600",children:or.mentionCount}),jsxRuntimeExports.jsx("div",{className:"text-gray-600",children:"Total Mentions"})]}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"font-semibold text-green-600",children:dr.length}),jsxRuntimeExports.jsx("div",{className:"text-gray-600",children:"Relationships"})]})]})]})]})]})}const GEMINI_API_KEY="AIzaSyCSRMKrutHao_uOqRy_IgzmPURA68VR7Vs",GEMINI_API_URL="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent";class CharacterExtractionService{normalizeCharacterName(ar){return ar.replace(/^(Mr|Mrs|Ms|Miss|Dr|Prof|Sir|Lady|Lord)\s+/i,"").replace(/\s+(Jr|Sr|III|IV)\s*$/i,"").trim().split(/\s+/).filter(cr=>cr.length>1).join(" ")}findSimilarCharacterNames(ar,lr,ur){const cr=this.normalizeCharacterName(lr).toLowerCase(),hr=cr.split(" ");for(const dr of ur){if(dr.bookId!==ar)continue;const fr=this.normalizeCharacterName(dr.name).toLowerCase(),pr=fr.split(" ");if(cr===fr||hr.length===1&&pr.length>1&&pr.includes(hr[0])&&hr[0].length>2||pr.length===1&&hr.length>1&&hr.includes(pr[0])&&pr[0].length>2)return dr;if(hr.length>1&&pr.length>1){const mr=hr[hr.length-1],br=pr[pr.length-1];if(mr===br&&mr.length>2&&hr[0][0]===pr[0][0])return dr}const vr={william:["bill","billy","will"],robert:["bob","bobby","rob"],richard:["rick","dick","rich"],elizabeth:["liz","beth","betty"],margaret:["meg","maggie","peggy"],katherine:["kate","katie","kathy"],michael:["mike","mick"],christopher:["chris"],anthony:["tony"],benjamin:["ben"],samuel:["sam"],alexander:["alex"],nicholas:["nick"]},gr=(mr,br)=>{var Cr,Sr;const yr=mr.toLowerCase(),xr=br.toLowerCase();return!!((Cr=vr[yr])!=null&&Cr.includes(xr)||(Sr=vr[xr])!=null&&Sr.includes(yr)||xr.length>=3&&yr.startsWith(xr))};if(hr.length>=1&&pr.length>=1&&(gr(hr[0],pr[0])||gr(pr[0],hr[0])))if(hr.length>1&&pr.length>1){if(hr[hr.length-1]===pr[pr.length-1])return dr}else return dr}return null}createCharacterExtractionPrompt(ar){return`Analyze the following book chapter and extract character information. ONLY include characters that meet these relevance criteria:

RELEVANCE CRITERIA (character must meet at least ONE):
- Mentioned 3 or more times in this chapter
- Has dialogue or speaks in the chapter
- Performs significant actions or drives the plot
- Has detailed description (physical appearance, personality, background)
- Interacts meaningfully with other important characters
- Is central to a scene or event in the chapter

DO NOT INCLUDE:
- Background characters mentioned only in passing
- Crowd members or unnamed individuals
- Characters mentioned only once without detail
- Historical figures mentioned in conversation but not present
- Generic roles (like "the waiter", "a guard") unless they have names and importance

For each RELEVANT character, provide:
1. Full name (as it appears in the text)
2. Occupation (if mentioned, otherwise "Unknown")
3. Age or age range (if mentioned, otherwise "Unknown")  
4. Location/residence (if mentioned, otherwise "Unknown")
5. Current status (Alive/Dead/Unknown)
6. Relevance level (Major/Supporting/Minor) based on their importance in this chapter
7. Brief description (one sentence summarizing who they are and why they're relevant)
8. Relationships with other characters in this chapter

Relevance Levels:
- Major: Central to the chapter, drives plot, has extensive dialogue/action
- Supporting: Important to scenes, meaningful interactions, some dialogue
- Minor: Relevant but limited role, few mentions but significant context

Relationships should include:
- Family relations (parent, child, sibling, married to)
- Romantic relationships (lovers, engaged to, dating)
- Conflicts (enemies, killed by, attacked by, fighting with)
- Professional connections (works with, servant of, mentor to, boss of)
- Friendships (friends with, allied with, companions)

Return ONLY valid JSON in this exact format with no additional text or markdown:
{
  "characters": [
    {
      "name": "Character Name",
      "occupation": "Their job or role",
      "age": "Age or age range",
      "location": "Where they live or are located",
      "status": "Alive",
      "relevance": "Major",
      "briefDescription": "One sentence description including why they're relevant",
      "relationships": [
        {
          "targetName": "Other Character Name",
          "type": "family",
          "description": "father of"
        }
      ]
    }
  ]
}

Relationship types must be exactly one of: family, romantic, conflict, professional, friendship, other
Relevance levels must be exactly one of: Major, Supporting, Minor

Chapter text:
${ar}`}async extractCharacters(ar,lr,ur){try{const cr=this.createCharacterExtractionPrompt(ur),hr=await fetch(GEMINI_API_URL,{method:"POST",headers:{"Content-Type":"application/json","X-goog-api-key":GEMINI_API_KEY},body:JSON.stringify({contents:[{parts:[{text:cr}]}]})});if(!hr.ok)throw new Error(`Gemini API error: ${hr.status}`);const dr=await hr.json();if(!dr.candidates||dr.candidates.length===0)throw new Error("No candidates returned from Gemini API");const fr=dr.candidates[0].content.parts[0].text;return await this.processGeminiResponse(ar,lr,fr)}catch(cr){throw console.error("Error extracting characters:",cr),cr}}async processGeminiResponse(ar,lr,ur){try{const cr=ur.indexOf("{"),hr=ur.lastIndexOf("}")+1;if(cr===-1||hr===0)throw new Error("No valid JSON found in response");const dr=ur.substring(cr,hr),fr=JSON.parse(dr);if(!fr.characters||!Array.isArray(fr.characters))throw new Error("Invalid response format: missing characters array");const pr=[];for(const vr of fr.characters){if(!vr.name||vr.name.trim()==="")continue;const gr=await characterService.getCharactersForBook(ar);let mr=await characterService.findCharacterByName(ar,vr.name);if(!mr&&(mr=this.findSimilarCharacterNames(ar,vr.name,gr)||void 0,mr)){const yr=mr.name,xr=vr.name;(xr.length>yr.length||xr.includes(" ")&&!yr.includes(" "))&&(mr.name=xr)}if(mr)mr=await this.updateExistingCharacter(mr,vr,lr),pr.push(mr);else{const br=await this.createNewCharacter(ar,vr,lr);pr.push(br)}}return await this.processRelationships(pr,fr.characters,lr),pr}catch(cr){throw console.error("Error processing Gemini response:",cr),new Error("Failed to parse character data from AI response")}}async updateExistingCharacter(ar,lr,ur){const cr={...ar,lastMentioned:ur,mentionCount:ar.mentionCount+1};if(lr.occupation&&lr.occupation!=="Unknown"&&(cr.occupation=lr.occupation),lr.age&&lr.age!=="Unknown"&&(cr.age=lr.age),lr.location&&lr.location!=="Unknown"&&(cr.location=lr.location),lr.status&&lr.status!=="Unknown"&&(cr.status=lr.status),lr.relevance){const dr={Minor:1,Supporting:2,Major:3};dr[lr.relevance]>dr[cr.relevance]&&(cr.relevance=lr.relevance)}lr.briefDescription&&(cr.briefDescription=lr.briefDescription);const hr=[];return lr.occupation&&lr.occupation!=="Unknown"&&hr.push(`Occupation: ${lr.occupation}`),lr.briefDescription&&hr.push(lr.briefDescription),hr.length>0&&cr.chapterHistory.push({chapter:ur,updates:hr}),cr}async createNewCharacter(ar,lr,ur){return{id:crypto.randomUUID(),bookId:ar,name:lr.name,occupation:lr.occupation||"Unknown",age:lr.age||"Unknown",location:lr.location||"Unknown",status:lr.status||"Unknown",relevance:lr.relevance||"Minor",relationships:[],firstAppearance:ur,lastMentioned:ur,briefDescription:lr.briefDescription,chapterHistory:[{chapter:ur,updates:[lr.briefDescription||"First appearance",...lr.occupation&&lr.occupation!=="Unknown"?[`Occupation: ${lr.occupation}`]:[]]}],mentionCount:1}}async processRelationships(ar,lr,ur){const cr=new Map;ar.forEach(hr=>{cr.set(hr.name.toLowerCase(),hr)});for(const hr of lr){const dr=cr.get(hr.name.toLowerCase());if(!(!dr||!hr.relationships))for(const fr of hr.relationships){const pr=cr.get(fr.targetName.toLowerCase());if(!pr)continue;dr.relationships.find(gr=>gr.targetCharacterId===pr.id&&gr.type===fr.type)||dr.relationships.push({targetCharacterId:pr.id,type:fr.type,description:fr.description,establishedInChapter:ur})}}}}const characterExtractionService=new CharacterExtractionService;function ChapterAnalysis({book:or,onClose:ar,onCharactersUpdated:lr,isAnalyzing:ur,setIsAnalyzing:cr}){const[hr,dr]=reactExports.useState(""),[fr,pr]=reactExports.useState([]),[vr,gr]=reactExports.useState(null),[mr,br]=reactExports.useState(!1),yr=or.chapterBoundaries.find(Sr=>Sr.chapter===or.currentChapter),xr=async()=>{if(!yr){gr("Could not find chapter boundary information");return}cr(!0),gr(null),dr("");try{if(dr("Validating PDF and extracting text..."),!or.pdfBlob||or.pdfBlob.size===0)throw new Error("PDF file is not available. Please re-upload the book.");try{await or.pdfBlob.slice(0,1024).arrayBuffer()}catch(Ar){throw console.error("PDF blob corruption detected:",Ar),new Error("PDF file appears to be corrupted. Please re-upload the book.")}const Sr=new File([or.pdfBlob],or.fileName,{type:"application/pdf"}),wr=await pdfService.extractChapterText(Sr,yr);if(wr.trim().length<100)throw new Error(`Chapter text is too short (${wr.trim().length} characters). This might be frontmatter, table of contents, or incorrect chapter boundaries. Please use "Edit Chapters" to adjust the chapter start page.`);dr("Analyzing characters with AI...");const Er=await characterExtractionService.extractCharacters(or.id,or.currentChapter,wr);dr("Saving character data..."),await characterService.saveCharacters(or.id,Er),pr(Er),dr("Analysis complete!"),br(!0),lr()}catch(Sr){console.error("Analysis error:",Sr),gr(Sr instanceof Error?Sr.message:"An unexpected error occurred")}finally{cr(!1)}},Cr=()=>{ur||(pdfService.cleanup(),ar())};return jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Analyze Chapter"}),jsxRuntimeExports.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Chapter ",or.currentChapter,' of "',or.title,'"']})]}),jsxRuntimeExports.jsx("button",{onClick:Cr,disabled:ur,className:"text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",children:jsxRuntimeExports.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[!mr&&!vr&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("div",{className:"mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx("svg",{className:"h-8 w-8 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Chapter Analysis"}),jsxRuntimeExports.jsxs("p",{className:"text-gray-600 text-sm mb-6",children:["This will extract character information from Chapter ",or.currentChapter," using AI analysis. Only characters mentioned 2 or more times will be included."]})]}),ur?jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-blue-600 border-t-transparent rounded-full"})}),jsxRuntimeExports.jsx("p",{className:"text-blue-600 font-medium",children:hr}),jsxRuntimeExports.jsx("p",{className:"text-gray-500 text-sm",children:"This may take 10-20 seconds..."})]}):jsxRuntimeExports.jsx("button",{onClick:xr,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-medium transition-colors",children:"Start Analysis"})]}),vr&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx("svg",{className:"h-8 w-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-red-900 mb-2",children:"Analysis Failed"}),jsxRuntimeExports.jsx("p",{className:"text-red-700 text-sm mb-6",children:vr}),jsxRuntimeExports.jsxs("div",{className:"space-x-3",children:[jsxRuntimeExports.jsx("button",{onClick:xr,className:"bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-md font-medium transition-colors",children:"Try Again"}),jsxRuntimeExports.jsx("button",{onClick:Cr,className:"bg-gray-300 hover:bg-gray-400 text-gray-700 px-6 py-2 rounded-md font-medium transition-colors",children:"Close"})]})]}),mr&&jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:jsxRuntimeExports.jsx("svg",{className:"h-8 w-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-medium text-green-900 mb-2",children:"Analysis Complete!"}),fr.length>0?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("p",{className:"text-green-700 text-sm mb-4",children:["Found ",fr.length," character",fr.length!==1?"s":""," in this chapter"]}),jsxRuntimeExports.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6 text-left",children:[jsxRuntimeExports.jsx("h4",{className:"font-medium text-green-900 mb-2",children:"Characters discovered:"}),jsxRuntimeExports.jsx("ul",{className:"space-y-1",children:fr.map((Sr,wr)=>jsxRuntimeExports.jsxs("li",{className:"text-sm text-green-800",children:[" ",jsxRuntimeExports.jsx("span",{className:"font-medium",children:Sr.name}),Sr.briefDescription&&jsxRuntimeExports.jsxs("span",{className:"text-green-600",children:[" - ",Sr.briefDescription]})]},wr))})]})]}):jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"No new characters found in this chapter that meet the criteria (mentioned 2+ times)."}),jsxRuntimeExports.jsx("button",{onClick:Cr,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-lg font-medium transition-colors",children:"Close"})]})]}),!ur&&jsxRuntimeExports.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t text-xs text-gray-500",children:jsxRuntimeExports.jsxs("p",{children:[jsxRuntimeExports.jsx("strong",{children:"Note:"})," This analysis requires an internet connection and may take 10-20 seconds. Character data will be saved locally and available offline afterward."]})})]})})}function NewChapterBoundaryEditor({file:or,detectedChapters:ar,totalPages:lr,bookId:ur,onChaptersUpdated:cr,onClose:hr}){const[dr,fr]=reactExports.useState(null),[pr,vr]=reactExports.useState([]),[gr,mr]=reactExports.useState(0),[br,yr]=reactExports.useState(1),[xr,Cr]=reactExports.useState(!0),[Sr,wr]=reactExports.useState(null);reactExports.useEffect(()=>{Er()},[or]),reactExports.useEffect(()=>{if(ar.length>0){const kr=ar.map((Dr,Nr)=>({id:Nr+1,title:`Chapter ${Nr+1}`,startPage:Dr.startPage,endPage:Dr.endPage}));vr(kr)}else{const kr=[{id:1,title:"Chapter 1",startPage:1,endPage:10},{id:2,title:"Chapter 2",startPage:11,endPage:20},{id:3,title:"Chapter 3",startPage:21,endPage:Math.min(30,lr)}];vr(kr)}},[ar,lr]);const Er=async()=>{try{Cr(!0),wr(null),pdfExports.GlobalWorkerOptions.workerSrc||(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?pdfExports.GlobalWorkerOptions.workerSrc="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js":pdfExports.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfExports.version}/pdf.worker.min.js`);let kr;try{if(kr=await or.arrayBuffer(),kr.byteLength===0)throw new Error("PDF file is empty")}catch(Lr){throw new Error(`Failed to read PDF file: ${Lr instanceof Error?Lr.message:"Unknown error"}`)}const Nr=await pdfExports.getDocument({data:kr,verbosity:0,maxImageSize:1024*1024,disableFontFace:!1,disableRange:!0,disableStream:!0}).promise;fr(Nr),Cr(!1)}catch(kr){console&&console.error&&console.error("Error loading PDF:",kr),wr("Failed to load PDF file. Please try a smaller PDF file if using Safari."),Cr(!1)}},Ar=(kr,Dr,Nr)=>{vr(Lr=>{const Or=[...Lr],Ir=Or.findIndex(Mr=>Mr.id===kr);if(Ir===-1)return Or;if(Or[Ir]={...Or[Ir],[Dr]:Nr},Dr==="endPage"&&typeof Nr=="number"){const Mr=Ir+1;Mr<Or.length&&(Or[Mr]={...Or[Mr],startPage:Nr+1})}if(Dr==="startPage"&&typeof Nr=="number"&&Ir>0){const Mr=Ir-1;Nr>1&&(Or[Mr]={...Or[Mr],endPage:Nr-1})}return Or})},Tr=()=>{const kr=Math.max(...pr.map(Lr=>Lr.id))+1,Dr=pr[pr.length-1],Nr=Dr?Dr.endPage+1:1;vr(Lr=>[...Lr,{id:kr,title:`Chapter ${kr}`,startPage:Nr,endPage:Math.min(Nr+10,lr)}])},Rr=kr=>{if(pr.length<=1){alert("You must have at least one chapter");return}vr(Dr=>Dr.filter(Nr=>Nr.id!==kr)),gr>=pr.length-1&&mr(Math.max(0,pr.length-2))},Pr=async()=>{console&&console.log&&console.log("Editor: Starting save process...");try{const kr=pr.filter(Ir=>!Ir.startPage||!Ir.endPage||Ir.startPage>Ir.endPage||Ir.startPage<1||Ir.endPage>lr);if(kr.length>0){const Ir=`Please fix the following chapters:
`+kr.map(Mr=>`${Mr.title}: Invalid page range (${Mr.startPage}-${Mr.endPage})`).join(`
`);alert(Ir);return}for(let Ir=0;Ir<pr.length-1;Ir++){const Mr=pr[Ir],$r=pr[Ir+1];if(Mr.endPage>=$r.startPage){alert(`Chapter overlap detected: ${Mr.title} ends on page ${Mr.endPage} but ${$r.title} starts on page ${$r.startPage}`);return}}const Dr=[...pr].sort((Ir,Mr)=>Ir.startPage-Mr.startPage),Nr=[];for(let Ir=0;Ir<Dr.length;Ir++){const Mr=Dr[Ir];Nr.push({chapter:Ir+1,startPage:Mr.startPage,endPage:Mr.endPage})}console&&console.log&&(console.log("Editor: Saving chapter boundaries, count:",Nr.length),console.log("Editor: Book ID:",ur));let Lr=!1,Or=null;try{await cr(Nr),Lr=!0,console&&console.log&&console.log("Editor: Chapter boundaries save completed successfully")}catch(Ir){Or=Ir,console&&console.error&&console.error("Editor: Failed to save chapter boundaries:",Ir)}if(Lr)setTimeout(()=>{hr()},100);else{const Ir=Or instanceof Error?Or.message:"Unknown error";alert(`Failed to save changes: ${Ir}. Please try refreshing the page and re-uploading your book.`)}}catch(kr){console&&console.error&&console.error("Editor: Main save error:",kr),alert("An unexpected error occurred while saving. Please try again.")}},_r=kr=>{yr(Math.max(1,Math.min(kr,lr)))};return xr?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsx("div",{className:"bg-white p-6 rounded-lg shadow-xl",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),jsxRuntimeExports.jsx("span",{children:"Loading PDF..."})]})})}):Sr?jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md",children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-red-600 mb-2",children:"Error"}),jsxRuntimeExports.jsx("p",{className:"text-gray-700 mb-4",children:Sr}),jsxRuntimeExports.jsx("button",{onClick:hr,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close"})]})}):jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-gray-100 z-50",children:jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Chapter Boundary Editor"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-600",children:"Set where each chapter starts and ends"})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:hr,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),jsxRuntimeExports.jsx("button",{onClick:Pr,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save & Continue"})]})]})}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex",children:[jsxRuntimeExports.jsxs("div",{className:"w-96 bg-white border-r border-gray-200 flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"p-4 border-b border-gray-200",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("h2",{className:"font-semibold text-gray-900",children:"Chapters"}),jsxRuntimeExports.jsx("button",{onClick:Tr,className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700",children:"Add Chapter"})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:jsxRuntimeExports.jsx("div",{className:"space-y-3",children:pr.map((kr,Dr)=>jsxRuntimeExports.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${gr===Dr?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>{mr(Dr),_r(kr.startPage)},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mb-3",children:[jsxRuntimeExports.jsx("input",{type:"text",value:kr.title,onChange:Nr=>Ar(kr.id,"title",Nr.target.value),className:"font-medium text-gray-900 bg-transparent border-none outline-none p-0",onClick:Nr=>Nr.stopPropagation()}),pr.length>1&&jsxRuntimeExports.jsx("button",{onClick:Nr=>{Nr.stopPropagation(),Rr(kr.id)},className:"text-red-500 hover:text-red-700 text-sm",children:""})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("label",{className:"text-sm text-gray-600 w-16",children:"Start:"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",max:lr,value:kr.startPage,onChange:Nr=>Ar(kr.id,"startPage",parseInt(Nr.target.value)||1),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded",onClick:Nr=>Nr.stopPropagation()}),jsxRuntimeExports.jsx("button",{onClick:Nr=>{Nr.stopPropagation(),_r(kr.startPage)},className:"text-xs text-blue-600 hover:text-blue-700",children:"Go to"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("label",{className:"text-sm text-gray-600 w-16",children:"End:"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",max:lr,value:kr.endPage,onChange:Nr=>Ar(kr.id,"endPage",parseInt(Nr.target.value)||1),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded",onClick:Nr=>Nr.stopPropagation()}),jsxRuntimeExports.jsx("button",{onClick:Nr=>{Nr.stopPropagation(),_r(kr.endPage)},className:"text-xs text-blue-600 hover:text-blue-700",children:"Go to"})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Pages: ",kr.endPage-kr.startPage+1]})]},kr.id))})})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 bg-gray-50 flex flex-col",children:jsxRuntimeExports.jsx(PDFViewer,{pdfDocument:dr,currentPage:br,totalPages:lr,onPageChange:yr})})]})]})})}function PDFViewer({pdfDocument:or,currentPage:ar,totalPages:lr,onPageChange:ur}){const[cr,hr]=reactExports.useState(null),[dr,fr]=reactExports.useState(!1),pr=reactExports.useCallback(async()=>{if(!(!cr||!or||dr))try{fr(!0);const vr=await or.getPage(ar),gr=cr.getContext("2d"),mr=vr.getViewport({scale:1.2});cr.width=mr.width,cr.height=mr.height,await vr.render({canvasContext:gr,viewport:mr}).promise,fr(!1)}catch(vr){console.error("Error rendering page:",vr),fr(!1)}},[cr,or,ar,dr]);return reactExports.useEffect(()=>{pr()},[pr]),jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col",children:[jsxRuntimeExports.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-3",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ur(ar-1),disabled:ar<=1,className:"px-3 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 hover:bg-gray-50",children:" Previous"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-sm text-gray-600",children:"Page"}),jsxRuntimeExports.jsx("input",{type:"number",min:"1",max:lr,value:ar,onChange:vr=>ur(parseInt(vr.target.value)||1),className:"w-16 px-2 py-1 text-sm border border-gray-300 rounded text-center"}),jsxRuntimeExports.jsxs("span",{className:"text-sm text-gray-600",children:["of ",lr]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>ur(ar+1),disabled:ar>=lr,className:"px-3 py-1 text-sm border border-gray-300 rounded disabled:opacity-50 hover:bg-gray-50",children:"Next "})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto p-4",children:jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx("div",{className:"border border-gray-300 shadow-lg",children:jsxRuntimeExports.jsx("canvas",{ref:hr,className:`block ${dr?"opacity-50":""}`})})})})]})}function MainApp({book:or,onBackToLibrary:ar,onBookUpdated:lr}){const[ur,cr]=reactExports.useState([]),[hr,dr]=reactExports.useState(null),[fr,pr]=reactExports.useState(!1),[vr,gr]=reactExports.useState(!1),[mr,br]=reactExports.useState(!1),[yr,xr]=reactExports.useState(new Set);reactExports.useEffect(()=>{Cr()},[or.id,or.currentChapter]);const Cr=async()=>{try{const _r=await characterService.getCharactersUpToChapter(or.id,or.currentChapter);cr(_r);const kr=await characterService.getAnalyzedChapters(or.id);xr(kr)}catch(_r){console.error("Error loading characters:",_r)}},Sr=async _r=>{if(!(_r<1||_r>or.totalChapters))try{await bookService.updateBookChapter(or.id,_r),lr();const kr=await characterService.getCharactersUpToChapter(or.id,_r);cr(kr)}catch(kr){console.error("Error updating chapter:",kr)}},wr=_r=>{dr(_r)},Er=()=>{Cr()},Ar=async _r=>{try{console&&console.log&&(console.log("MainApp: Updating chapter boundaries for book ID:",or.id),console.log("MainApp: New boundaries count:",_r.length));const{DatabaseIntegrityChecker:kr}=await __vitePreload(async()=>{const{DatabaseIntegrityChecker:Ir}=await import("./databaseIntegrityChecker-BmNzoUfA.js");return{DatabaseIntegrityChecker:Ir}},[]);console&&console.log&&console.log("MainApp: Cleaning duplicates before chapter boundary update...");try{await bookService.removeDuplicateBooks()}catch(Ir){console&&console.warn&&console.warn("MainApp: Duplicate cleanup failed:",Ir)}await kr.waitForDatabaseSettle(),await kr.checkDatabaseHealth()||console&&console.warn&&console.warn("MainApp: Database health check failed, attempting to continue...");let Nr=await kr.verifyBookExists(or.id);if(Nr||(console&&console.warn&&console.warn("MainApp: Book not found by ID, trying alternative search..."),Nr=await kr.findBookByAlternatives({fileName:or.fileName,title:or.title,author:or.author})),console&&console.log&&console.log("MainApp: Book verification result:",!!Nr),!Nr){if(console&&console.error&&console.error("MainApp: Cannot find book for chapter boundary update"),confirm(`Unable to locate the book in the database for saving chapter boundaries.

This sometimes happens with Safari. Would you like to:
- Retry the save operation
- The app will wait longer for database operations to complete

Click OK to retry, or Cancel to go back.`))try{console&&console.log&&console.log("MainApp: Retrying save operation with extended wait..."),await kr.waitForDatabaseSettle(3e3),await bookService.updateChapterBoundaries(or.id,_r),console&&console.log&&console.log("MainApp: Retry successful!"),await new Promise(Mr=>setTimeout(Mr,500)),await lr(),br(!1);return}catch(Mr){console&&console.error&&console.error("MainApp: Retry failed:",Mr),alert("Unable to save chapter boundaries. Please try refreshing the page.")}br(!1);return}const{SafeBookOperations:Lr}=await __vitePreload(async()=>{const{SafeBookOperations:Ir}=await import("./safeBookOperations-HustMfgK.js");return{SafeBookOperations:Ir}},[]),Or=Nr?Nr.id:or.id;console&&console.log&&console.log("MainApp: Using safe book operations to update chapter boundaries for ID:",Or);try{await Lr.updateChapterBoundariesSafe(Or,_r),console&&console.log&&console.log("MainApp: Successfully updated chapter boundaries using safe operations")}catch(Ir){console&&console.warn&&console.warn("MainApp: Safe update failed, trying fallback method:",Ir),await bookService.updateChapterBoundaries(Or,_r),console&&console.log&&console.log("MainApp: Fallback update completed")}await new Promise(Ir=>setTimeout(Ir,1e3)),console&&console.log&&console.log("MainApp: Calling onBookUpdated to refresh book data..."),await lr(),br(!1),console&&console.log&&console.log("MainApp: Chapter boundaries update process completed")}catch(kr){console.error("Error updating chapter boundaries:",kr),alert(`Failed to update chapter boundaries: ${kr instanceof Error?kr.message:"Unknown error"}`)}},Tr=async()=>{var _r,kr;try{if(console.log("Opening chapter editor for book:",{id:or.id,title:or.title,fileName:or.fileName,pdfBlobSize:(_r=or.pdfBlob)==null?void 0:_r.size,chapterBoundaries:(kr=or.chapterBoundaries)==null?void 0:kr.length}),!or.pdfBlob||or.pdfBlob.size===0){alert("PDF file is not available. Please re-upload the book.");return}await or.pdfBlob.slice(0,100).arrayBuffer(),br(!0)}catch(Dr){console.error("Error accessing PDF blob:",Dr),alert("Cannot access PDF file. The file may be corrupted. Please re-upload the book.")}},Rr=or.currentChapter<or.totalChapters,Pr=or.currentChapter>1;return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[jsxRuntimeExports.jsx("header",{className:"bg-white shadow-sm border-b",children:jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 py-2 sm:py-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 w-full sm:w-auto",children:[jsxRuntimeExports.jsx("button",{onClick:ar,className:"text-gray-600 hover:text-gray-900 transition-colors p-2 sm:p-1 -ml-2 sm:ml-0",title:"Back to library",children:jsxRuntimeExports.jsx("svg",{className:"h-5 w-5 sm:h-6 sm:w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsxs("div",{className:"min-w-0 flex-1",children:[jsxRuntimeExports.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900 truncate",children:or.title}),jsxRuntimeExports.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 truncate",children:["by ",or.author]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 w-full sm:w-auto mt-2 sm:mt-0",children:[jsxRuntimeExports.jsx("button",{onClick:Tr,className:"text-xs sm:text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 px-2 sm:px-3 py-1.5 sm:py-2 rounded-md transition-colors whitespace-nowrap",title:"Edit chapter boundaries",children:"Edit Chapters"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Sr(or.currentChapter-1),disabled:!Pr,className:"p-1.5 sm:p-2 rounded-md border border-gray-300 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors",title:"Previous chapter",children:jsxRuntimeExports.jsx("svg",{className:"h-3 w-3 sm:h-4 sm:w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),jsxRuntimeExports.jsxs("div",{className:"text-center px-2 sm:px-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-1 text-xs sm:text-sm text-gray-600 mb-1",children:[jsxRuntimeExports.jsx("span",{children:"Chapter"}),jsxRuntimeExports.jsx("div",{className:`w-1.5 h-1.5 sm:w-2 sm:h-2 rounded-full ${yr.has(or.currentChapter)?"bg-green-500":"bg-gray-300"}`,title:yr.has(or.currentChapter)?"Chapter analyzed by AI":"Chapter not yet analyzed"})]}),jsxRuntimeExports.jsxs("div",{className:"font-semibold text-gray-900 text-sm sm:text-base",children:[or.currentChapter," / ",or.totalChapters]})]}),jsxRuntimeExports.jsx("button",{onClick:()=>Sr(or.currentChapter+1),disabled:!Rr,className:"p-1.5 sm:p-2 rounded-md border border-gray-300 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors",title:"Next chapter",children:jsxRuntimeExports.jsx("svg",{className:"h-3 w-3 sm:h-4 sm:w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),jsxRuntimeExports.jsx("button",{onClick:()=>pr(!0),disabled:vr,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-2 sm:px-4 py-1.5 sm:py-2 rounded-md font-medium transition-colors text-xs sm:text-sm whitespace-nowrap flex-shrink-0",children:vr?"Analyzing...":"Analyze Chapter"})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-3 space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:jsxRuntimeExports.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${or.currentChapter/or.totalChapters*100}%`}})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0",children:"Analysis:"}),jsxRuntimeExports.jsx("div",{className:"flex gap-1 flex-wrap overflow-hidden",children:Array.from({length:or.totalChapters},(_r,kr)=>{const Dr=kr+1,Nr=yr.has(Dr),Lr=Dr===or.currentChapter;return jsxRuntimeExports.jsx("button",{onClick:()=>Sr(Dr),className:`w-3 h-3 sm:w-4 sm:h-4 rounded-sm transition-all flex-shrink-0 ${Lr?"ring-2 ring-blue-500 ring-offset-1":""} ${Nr?"bg-green-500 hover:bg-green-600":"bg-gray-300 hover:bg-gray-400"}`,title:`Chapter ${Dr}${Nr?" (analyzed)":" (not analyzed)"}`},Dr)})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 ml-auto",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-sm"}),jsxRuntimeExports.jsx("span",{children:"Analyzed"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsx("div",{className:"w-2 h-2 bg-gray-300 rounded-sm"}),jsxRuntimeExports.jsx("span",{children:"Pending"})]})]})]})]})]})}),jsxRuntimeExports.jsx("main",{className:"flex-1 max-w-7xl mx-auto w-full p-2 sm:p-4",style:{height:"calc(100vh - 140px)"},children:jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-2 sm:gap-6 h-full",children:[jsxRuntimeExports.jsx("div",{className:"lg:col-span-3 h-full min-h-0",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-sm border h-full flex flex-col",children:[jsxRuntimeExports.jsxs("div",{className:"p-2 sm:p-4 border-b flex-shrink-0",children:[jsxRuntimeExports.jsx("h2",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Character Relationships"}),jsxRuntimeExports.jsx("p",{className:"text-xs sm:text-sm text-gray-600 mt-1",children:ur.length===0?"No characters discovered yet. Analyze a chapter to get started.":`Showing ${ur.length} character${ur.length!==1?"s":""} up to chapter ${or.currentChapter}`})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 min-h-0 overflow-hidden",children:jsxRuntimeExports.jsx(CytoscapeCharacterMap,{characters:ur,currentChapter:or.currentChapter,onCharacterSelect:wr,className:"w-full h-full"})})]})}),jsxRuntimeExports.jsx("div",{className:"lg:col-span-1 h-full",children:hr?jsxRuntimeExports.jsx("div",{className:"h-full",children:jsxRuntimeExports.jsx(CharacterDetail,{character:hr,characters:ur,currentChapter:or.currentChapter,onClose:()=>dr(null)})}):jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6 text-center h-full flex flex-col justify-center",children:[jsxRuntimeExports.jsx("div",{className:"text-gray-400 mb-4",children:jsxRuntimeExports.jsx("svg",{className:"mx-auto h-12 w-12 sm:h-16 sm:w-16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),jsxRuntimeExports.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"No Character Selected"}),jsxRuntimeExports.jsx("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Click on a character in the map to view their details and relationships."})]})})]})}),fr&&jsxRuntimeExports.jsx(ChapterAnalysis,{book:or,onClose:()=>pr(!1),onCharactersUpdated:Er,isAnalyzing:vr,setIsAnalyzing:gr}),mr&&or.pdfBlob&&(()=>{var _r;try{const kr=new File([or.pdfBlob],or.fileName,{type:"application/pdf"});return jsxRuntimeExports.jsx(NewChapterBoundaryEditor,{file:kr,detectedChapters:or.chapterBoundaries,totalPages:((_r=or.chapterBoundaries[or.chapterBoundaries.length-1])==null?void 0:_r.endPage)||1,bookId:or.id,onChaptersUpdated:Ar,onClose:()=>br(!1)})}catch(kr){return console.error("Error creating file from blob:",kr),setTimeout(()=>{br(!1),alert("Cannot access PDF file. Please try re-uploading the book.")},0),null}})()]})}window.debugBooks=async()=>{try{console.log("=== DATABASE DEBUG INFO ===");const or=await db.books.toArray();console.log(" Total books in database:",or.length),or.forEach((ur,cr)=>{var hr;console.log(` Book ${cr+1}:`,{id:ur.id,title:ur.title,author:ur.author,fileName:ur.fileName,totalChapters:ur.totalChapters,chapterBoundariesCount:((hr=ur.chapterBoundaries)==null?void 0:hr.length)||0,chapterBoundaries:ur.chapterBoundaries,uploadDate:ur.uploadDate})});const ar=or.map(ur=>ur.fileName),lr=ar.filter((ur,cr)=>ar.indexOf(ur)!==cr);lr.length>0&&console.warn(" Duplicate files found:",[...new Set(lr)]),console.log("=== END DEBUG INFO ===")}catch(or){console.error(" Error debugging books:",or)}};window.debugDatabase=async()=>{try{console.log("=== FULL DATABASE DEBUG ==="),await window.debugBooks();const or=await db.characters.toArray();console.log(" Total characters:",or.length);const ar=or.reduce((ur,cr)=>(ur[cr.bookId]=(ur[cr.bookId]||0)+1,ur),{});console.log(" Characters per book:",ar);const lr=await db.settings.toArray();console.log(" Settings:",lr),console.log("=== END FULL DEBUG ===")}catch(or){console.error(" Database debug error:",or)}};window.clearDatabase=async()=>{if(window.confirm("Are you sure you want to clear the entire database? This cannot be undone!"))try{await db.books.clear(),await db.characters.clear(),await db.settings.clear(),console.log(" Database cleared successfully"),window.location.reload()}catch(ar){console.error(" Error clearing database:",ar)}};window.cleanDuplicates=async()=>{try{console.log(" Starting duplicate cleanup...");const{SafeBookOperations:or}=await __vitePreload(async()=>{const{SafeBookOperations:ar}=await import("./safeBookOperations-HustMfgK.js");return{SafeBookOperations:ar}},[]);await or.emergencyCleanup(),console.log(" Duplicate cleanup completed!"),console.log(" Run window.debugBooks() to see the cleaned database"),window.confirm("Duplicate cleanup completed! Refresh page to see changes?")&&window.location.reload()}catch(or){console.error(" Duplicate cleanup failed:",or)}};console.log(" Debug tools loaded! Available commands:");console.log("- window.debugBooks() - Show all books");console.log("- window.debugDatabase() - Show full database info");console.log("- window.clearDatabase() - Clear entire database");console.log("- window.cleanDuplicates() - Remove duplicate books");function App(){const[or,ar]=reactExports.useState(null),[lr,ur]=reactExports.useState([]);reactExports.useEffect(()=>{cr()},[]);const cr=async()=>{try{console&&console.log&&console.log("App: Starting loadBooks process...");const{DatabaseIntegrityChecker:vr}=await __vitePreload(async()=>{const{DatabaseIntegrityChecker:xr}=await import("./databaseIntegrityChecker-BmNzoUfA.js");return{DatabaseIntegrityChecker:xr}},[]);try{console&&console.log&&console.log("App: Cleaning duplicates before loading books..."),await bookService.removeDuplicateBooks()}catch(xr){console&&console.warn&&console.warn("App: Duplicate cleanup failed:",xr)}if(await vr.waitForDatabaseSettle(1e3),!await vr.checkDatabaseHealth()&&(console&&console.warn&&console.warn("App: Database health check failed, checking for corruption..."),await databaseManager.isDatabaseCorrupted()))if(confirm("The database appears to be corrupted. Would you like to reset it? This will delete all existing books and characters."))await databaseManager.resetDatabase();else return;let mr=[],br=!1;for(let xr=0;xr<3;xr++)try{if(console&&console.log&&console.log("App: Load attempt",xr+1,"of 3"),xr===0&&(await bookService.removeDuplicateBooks(),await bookService.validateAndFixBooks()),mr=await db.books.toArray(),mr.length>=0){br=!0;break}}catch(Cr){console&&console.warn&&console.warn("App: Load attempt",xr+1,"failed:",Cr),await new Promise(Sr=>setTimeout(Sr,300*(xr+1)))}br?(console&&console.log&&console.log("App: Successfully loaded",mr.length,"books from database"),ur(mr)):(console&&console.error&&console.error("App: Failed to load books after all attempts"),ur([]));const yr=await db.settings.get("settings");if(yr!=null&&yr.currentBookId){const xr=mr.find(Cr=>Cr.id===yr.currentBookId);xr&&ar(xr)}}catch(vr){if(console.error("Error loading books:",vr),confirm("There was an error loading your books. Would you like to reset the database? This will delete all existing data but should fix any corruption issues."))try{await databaseManager.resetDatabase(),ur([]),ar(null)}catch(mr){console.error("Error resetting database:",mr),alert("Failed to reset database. Please clear your browser data manually.")}}},hr=async vr=>{ar(vr);try{await db.settings.put({id:"settings",currentBookId:vr.id,theme:"light"})}catch(gr){console.error("Error saving current book:",gr)}},dr=vr=>{ur(gr=>[...gr,vr]),ar(vr)},fr=()=>{ar(null)},pr=async()=>{console&&console.log&&console.log("App: handleBookUpdated called, reloading books...");try{if(!or){console&&console.log&&console.log("App: No current book, just reloading books list"),await cr();return}console&&console.log&&console.log("App: Refreshing current book with ID:",or.id);let vr=null,gr=[];await new Promise(mr=>setTimeout(mr,500));for(let mr=0;mr<6;mr++)try{if(console&&console.log&&console.log("App: Refresh attempt",mr+1,"of 6"),gr=await bookService.getAllBooks(),gr.length===0){console&&console.warn&&console.warn("App: Database appears empty on attempt",mr+1,"waiting longer..."),await new Promise(yr=>setTimeout(yr,500*(mr+1)));continue}if(vr=await bookService.getBook(or.id),vr){console&&console.log&&console.log("App: Successfully found updated book on attempt",mr+1);break}const br=gr.find(yr=>yr.fileName===or.fileName||yr.title===or.title&&yr.author===or.author);if(br){console&&console.log&&console.log("App: Found matching book by filename/title on attempt",mr+1),vr=br;break}await new Promise(yr=>setTimeout(yr,400*(mr+1)))}catch(br){console&&console.warn&&console.warn("App: Attempt",mr+1,"error:",br),await new Promise(yr=>setTimeout(yr,300*(mr+1)))}vr?(console&&console.log&&console.log("App: Successfully refreshed current book!"),ar(vr),ur(gr)):(console&&console.error&&(console.error("App: Failed to find current book after all attempts"),console.error("App: Current book:",{id:or.id,title:or.title,fileName:or.fileName}),console.error("App: Available books:",gr.map(mr=>({id:mr.id,title:mr.title,fileName:mr.fileName})))),gr.length>0&&ur(gr))}catch(vr){console&&console.error&&console.error("App: Main error in handleBookUpdated:",vr);try{await cr()}catch(gr){console&&console.error&&console.error("App: Fallback loadBooks also failed:",gr)}}};return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gray-50",children:or?jsxRuntimeExports.jsx(MainApp,{book:or,onBackToLibrary:fr,onBookUpdated:pr}):jsxRuntimeExports.jsx(BookLibrary,{books:lr,onBookSelect:hr,onBookAdded:dr,onBooksUpdated:cr})})}client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));export{db as d};
